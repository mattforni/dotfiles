(()=>{var e={5186:(e,t,i)=>{var r=i(3698),s=i(2505),n=i(6417),o=Function.bind,a=o.bind(o);function c(e,t,i){var r=a(n,null).apply(null,i?[t,i]:[t]);e.api={remove:r},e.remove=r,["before","error","after","wrap"].forEach((function(r){var n=i?[t,r,i]:[t,r];e[r]=e.api[r]=a(s,null).apply(null,n)}))}function l(){var e={registry:{}},t=r.bind(null,e);return c(t,e),t}var h=!1;function u(){return h||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),h=!0),l()}u.Singular=function(){var e={registry:{}},t=r.bind(null,e,"h");return c(t,e,"h"),t}.bind(),u.Collection=l.bind(),e.exports=u,e.exports.Hook=u,e.exports.Singular=u.Singular,e.exports.Collection=u.Collection},2505:e=>{e.exports=function(e,t,i,r){var s=r;e.registry[i]||(e.registry[i]=[]);"before"===t&&(r=function(e,t){return Promise.resolve().then(s.bind(null,t)).then(e.bind(null,t))});"after"===t&&(r=function(e,t){var i;return Promise.resolve().then(e.bind(null,t)).then((function(e){return s(i=e,t)})).then((function(){return i}))});"error"===t&&(r=function(e,t){return Promise.resolve().then(e.bind(null,t)).catch((function(e){return s(e,t)}))});e.registry[i].push({hook:r,orig:s})}},3698:e=>{e.exports=function e(t,i,r,s){if("function"!=typeof r)throw new Error("method for before hook must be a function");s||(s={});if(Array.isArray(i))return i.reverse().reduce((function(i,r){return e.bind(null,t,r,i,s)}),r)();return Promise.resolve().then((function(){return t.registry[i]?t.registry[i].reduce((function(e,t){return t.hook.bind(null,e,s)}),r)():r(s)}))}},6417:e=>{e.exports=function(e,t,i){if(!e.registry[t])return;var r=e.registry[t].map((function(e){return e.orig})).indexOf(i);if(-1===r)return;e.registry[t].splice(r,1)}},5640:(e,t,i)=>{i.d(t,{QO:()=>r,qb:()=>s});var r=(e=>(e[e.Force=0]="Force",e[e.ForceWithLease=1]="ForceWithLease",e))(r||{}),s=(e=>(e[e.INDEX_MODIFIED=0]="INDEX_MODIFIED",e[e.INDEX_ADDED=1]="INDEX_ADDED",e[e.INDEX_DELETED=2]="INDEX_DELETED",e[e.INDEX_RENAMED=3]="INDEX_RENAMED",e[e.INDEX_COPIED=4]="INDEX_COPIED",e[e.MODIFIED=5]="MODIFIED",e[e.DELETED=6]="DELETED",e[e.UNTRACKED=7]="UNTRACKED",e[e.IGNORED=8]="IGNORED",e[e.INTENT_TO_ADD=9]="INTENT_TO_ADD",e[e.ADDED_BY_US=10]="ADDED_BY_US",e[e.ADDED_BY_THEM=11]="ADDED_BY_THEM",e[e.DELETED_BY_US=12]="DELETED_BY_US",e[e.DELETED_BY_THEM=13]="DELETED_BY_THEM",e[e.BOTH_ADDED=14]="BOTH_ADDED",e[e.BOTH_DELETED=15]="BOTH_DELETED",e[e.BOTH_MODIFIED=16]="BOTH_MODIFIED",e))(s||{})},4398:(e,t,i)=>{i.d(t,{h:()=>s});var r=i(5255);function s(e){if(e.scheme===r.sN.Git)try{return JSON.parse(e.query)}catch{}}},2022:(e,t,i)=>{i.d(t,{HU:()=>AnnotationProviderBase,jp:()=>o,mc:()=>a});var r=i(9496),s=i(2061),n=i(4336),o=(e=>(e.Computing="computing",e.Computed="computed",e))(o||{});function a(e){return`${e?.document.uri.toString()}|${e?.viewColumn}`}class AnnotationProviderBase{constructor(e,t,i){this.annotationType=e,this.editor=t,this.trackedDocument=i,this.correlationKey=a(this.editor),this.document=this.editor.document,this.disposable=r.Disposable.from(r.window.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged,this))}dispose(){this.clear(),this.disposable.dispose()}onTextEditorSelectionChanged(e){this.document===e.textEditor.document&&this.selection({line:e.selections[0].active.line})}get editorUri(){return this.editor?.document?.uri}clear(){if(this.annotationContext=void 0,this.status=void 0,null!=this.editor&&this.decorations?.length){for(const e of this.decorations)try{this.editor.setDecorations(e.decorationType,[])}catch{}this.decorations=void 0}}mustReopen(e){return!1}refresh(e){if(null==this.editor||!this.decorations?.length)return;const t=[];for(const i of this.decorations){const r=e.get(i.decorationType);null!==r&&(null!=r&&(i.decorationType=r),t.push(i))}this.setDecorations(this.decorations)}async restore(e){if(!1!==this.editor._disposed){if(this.status="computing",e===r.window.activeTextEditor&&await(0,s.v)("gitlens:annotationStatus",this.status),this.editor=e,this.correlationKey=a(e),this.document=e.document,this.decorations?.length)for(const e of this.decorations)this.editor.setDecorations(e.decorationType,e.rangesOrOptions);this.status="computed",e===r.window.activeTextEditor&&await(0,s.v)("gitlens:annotationStatus",this.status)}}async provideAnnotation(e){this.status="computing";try{if(await this.onProvideAnnotation(e))return this.status="computed",!0}catch(e){n.Yd.error(e)}return this.status=void 0,!1}setDecorations(e){if(this.decorations?.length&&this.clear(),this.decorations=e,this.decorations?.length)for(const e of this.decorations)this.editor.setDecorations(e.decorationType,e.rangesOrOptions)}}},248:(e,t,i)=>{i.d(t,{Lx:()=>D,iF:()=>R,U5:()=>k,Vz:()=>_,HM:()=>S,sV:()=>T});var r=i(9496),s=i(2540),n=i(5255),o=i(9338);function a(e){const t=g(e);return null==t?null:[t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a]}function c(e,t){const i=Math.pow(10,t);return Math.round(e*i)/i}class RGBA{constructor(e,t,i,r=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,e)),this.g=0|Math.min(255,Math.max(0,t)),this.b=0|Math.min(255,Math.max(0,i)),this.a=c(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class HSLA{constructor(e,t,i,r){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=c(Math.max(Math.min(1,t),0),3),this.l=c(Math.max(Math.min(1,i),0),3),this.a=c(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,r=e.b/255,s=e.a,n=Math.max(t,i,r),o=Math.min(t,i,r);let a=0,c=0;const l=(o+n)/2,h=n-o;if(h>0){switch(c=Math.min(l<=.5?h/(2*l):h/(2-2*l),1),n){case t:a=(i-r)/h+(i<r?6:0);break;case i:a=(r-t)/h+2;break;case r:a=(t-i)/h+4}a*=60,a=Math.round(a)}return new HSLA(a,c,l,s)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:r,a:s}=e;let n,o,a;if(0===i)n=o=a=r;else{const e=r<.5?r*(1+i):r+i-r*i,s=2*r-e;n=HSLA._hue2rgb(s,e,t+1/3),o=HSLA._hue2rgb(s,e,t),a=HSLA._hue2rgb(s,e,t-1/3)}return new RGBA(Math.round(255*n),Math.round(255*o),Math.round(255*a),s)}}class HSVA{constructor(e,t,i,r){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=c(Math.max(Math.min(1,t),0),3),this.v=c(Math.max(Math.min(1,i),0),3),this.a=c(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,r=e.b/255,s=Math.max(t,i,r),n=s-Math.min(t,i,r),o=0===s?0:n/s;let a;return a=0===n?0:s===t?((i-r)/n%6+6)%6:s===i?(r-t)/n+2:(t-i)/n+4,new HSVA(Math.round(60*a),o,s,e.a)}static toRGBA(e){const{h:t,s:i,v:r,a:s}=e,n=r*i,o=n*(1-Math.abs(t/60%2-1)),a=r-n;let[c,l,h]=[0,0,0];return t<60?(c=n,l=o):t<120?(c=o,l=n):t<180?(l=n,h=o):t<240?(l=o,h=n):t<300?(c=o,h=n):t<=360&&(c=n,h=o),c=Math.round(255*(c+a)),l=Math.round(255*(l+a)),h=Math.round(255*(h+a)),new RGBA(c,l,h,s)}}const l=class{static from(e){return e instanceof l?e:g(e)||l.red}static fromCssVariable(e,t){return g(function(e,t){return t.getPropertyValue(e).trim()}(e,t))||l.red}static fromHex(e){return f(e)||l.red}static equals(e,t){return!e&&!t||!(!e||!t)&&e.equals(t)}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}constructor(e){if(!e)throw new Error("Color needs a value");if(e instanceof RGBA)this.rgba=e;else if(e instanceof HSLA)this._hsla=e,this.rgba=HSLA.toRGBA(e);else{if(!(e instanceof HSVA))throw new Error("Invalid color ctor argument");this._hsva=e,this.rgba=HSVA.toRGBA(e)}}equals(e){return null!=e&&(Boolean(e)&&RGBA.equals(this.rgba,e.rgba)&&HSLA.equals(this.hsla,e.hsla)&&HSVA.equals(this.hsva,e.hsva))}getRelativeLuminance(){return c(.2126*l._relativeLuminanceForComponent(this.rgba.r)+.7152*l._relativeLuminanceForComponent(this.rgba.g)+.0722*l._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}luminance(e){return function(e,t){if(0===t)return new h(new RGBA(0,0,0,e.rgba.a));if(1===t)return new h(new RGBA(255,255,255,e.rgba.a));const i=e.getRelativeLuminance();let r=20;const s=(e,i)=>{const n=e.mix(i,.5),o=n.getRelativeLuminance();return Math.abs(t-o)<1e-7||!r--?n:o>t?s(e,n):s(n,i)},n=(i>t?s(h.black,e):s(e,h.white)).rgba;return new h(new RGBA(n.r,n.g,n.b,e.rgba.a))}(this,e)}getContrastRatio(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)}isDarker(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3<128}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(e){return this.getRelativeLuminance()>e.getRelativeLuminance()}isDarkerThan(e){return this.getRelativeLuminance()<e.getRelativeLuminance()}lighten(e){return new l(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new l(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:r,a:s}=this.rgba;return new l(new RGBA(t,i,r,s*e))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new l(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){const t=e.rgba,i=this.rgba.a,r=t.a,s=i+r*(1-i);if(s<1e-6)return l.transparent;const n=this.rgba.r*i/s+t.r*r*(1-i)/s,o=this.rgba.g*i/s+t.g*r*(1-i)/s,a=this.rgba.b*i/s+t.b*r*(1-i)/s;return new l(new RGBA(n,o,a,s))}mix(e,t){return function(e,t,i){const r=e.rgba,s=t.rgba;return new h(new RGBA(r.r+i*(s.r-r.r),r.g+i*(s.g-r.g),r.b+i*(s.b-r.b),r.a+i*(s.a-r.a)))}(this,e,t)}makeOpaque(e){if(this.isOpaque()||1!==e.rgba.a)return this;const{r:t,g:i,b:r,a:s}=this.rgba;return new l(new RGBA(e.rgba.r-s*(e.rgba.r-t),e.rgba.g-s*(e.rgba.g-i),e.rgba.b-s*(e.rgba.b-r),1))}flatten(...e){const t=e.reduceRight(((e,t)=>l._flatten(t,e)));return l._flatten(this,t)}static _flatten(e,t){const i=1-e.rgba.a;return new l(new RGBA(i*t.rgba.r+e.rgba.a*e.rgba.r,i*t.rgba.g+e.rgba.a*e.rgba.g,i*t.rgba.b+e.rgba.a*e.rgba.b))}toString(){return this._toString||(this._toString=function(e){if(e.isOpaque())return p(e);return u(e)}(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const r=e.getRelativeLuminance(),s=t.getRelativeLuminance();return i=i*(s-r)/s,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const r=e.getRelativeLuminance();return i=i*(r-t.getRelativeLuminance())/r,e.darken(i)}};let h=l;function u(e){return`rgba(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b}, ${Number(e.rgba.a.toFixed(2))})`}function d(e){const t=e.toString(16);return 2!==t.length?`0${t}`:t}function p(e){return`#${d(e.rgba.r)}${d(e.rgba.g)}${d(e.rgba.b)}`}h.white=new l(new RGBA(255,255,255,1)),h.black=new l(new RGBA(0,0,0,1)),h.red=new l(new RGBA(255,0,0,1)),h.blue=new l(new RGBA(0,0,255,1)),h.green=new l(new RGBA(0,255,0,1)),h.cyan=new l(new RGBA(0,255,255,1)),h.lightgrey=new l(new RGBA(211,211,211,1)),h.transparent=new l(new RGBA(0,0,0,0));const m=/^((?:rgb|hsl)a?)\((-?\d+%?)[,\s]+(-?\d+%?)[,\s]+(-?\d+%?)[,\s]*(-?[\d.]+%?)?\)$/i;function g(e){if(0===(e=e.trim()).length)return null;if(e.charCodeAt(0)===n.mN.Hash)return f(e);const t=m.exec(e);if(null==t)return null;const i=t[1];let r;switch(i){case"rgb":case"hsl":r=[parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),1];break;case"rgba":case"hsla":r=[parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),parseFloat(t[5])];break;default:return null}switch(i){case"rgb":case"rgba":return new h(new RGBA(r[0],r[1],r[2],r[3]));case"hsl":case"hsla":return new h(new HSLA(r[0],r[1],r[2],r[3]))}return h.red}function f(e){const t=(e=e.trim()).length;if(0===t)return null;if(e.charCodeAt(0)!==n.mN.Hash)return null;switch(t){case 7:{const t=16*w(e.charCodeAt(1))+w(e.charCodeAt(2)),i=16*w(e.charCodeAt(3))+w(e.charCodeAt(4)),r=16*w(e.charCodeAt(5))+w(e.charCodeAt(6));return new h(new RGBA(t,i,r,1))}case 9:{const t=16*w(e.charCodeAt(1))+w(e.charCodeAt(2)),i=16*w(e.charCodeAt(3))+w(e.charCodeAt(4)),r=16*w(e.charCodeAt(5))+w(e.charCodeAt(6)),s=16*w(e.charCodeAt(7))+w(e.charCodeAt(8));return new h(new RGBA(t,i,r,s/255))}case 4:{const t=w(e.charCodeAt(1)),i=w(e.charCodeAt(2)),r=w(e.charCodeAt(3));return new h(new RGBA(16*t+t,16*i+i,16*r+r))}case 5:{const t=w(e.charCodeAt(1)),i=w(e.charCodeAt(2)),r=w(e.charCodeAt(3)),s=w(e.charCodeAt(4));return new h(new RGBA(16*t+t,16*i+i,16*r+r,(16*s+s)/255))}default:return null}}function w(e){switch(e){case n.mN.Digit0:return 0;case n.mN.Digit1:return 1;case n.mN.Digit2:return 2;case n.mN.Digit3:return 3;case n.mN.Digit4:return 4;case n.mN.Digit5:return 5;case n.mN.Digit6:return 6;case n.mN.Digit7:return 7;case n.mN.Digit8:return 8;case n.mN.Digit9:return 9;case n.mN.a:case n.mN.A:return 10;case n.mN.b:case n.mN.B:return 11;case n.mN.c:case n.mN.C:return 12;case n.mN.d:case n.mN.D:return 13;case n.mN.e:case n.mN.E:return 14;case n.mN.f:case n.mN.F:return 15}return 0}var v=i(5148),y=i(3620);const b="#f66a0a",C="#0a60f6",A=["#f66a0a","#ef6939","#e96950","#e26862","#db6871","#d3677e","#cc678a","#c46696","#bb66a0","#b365a9","#a965b3","#a064bb","#9664c4","#8a63cc","#7e63d3","#7162db","#6262e2","#5061e9","#3961ef","#0a60f6"];let P;function S(){if(null==P){const{coldColor:e,hotColor:t}=v.D.get("heatmap");let i;i=e===C&&t===b?A:function(e,t,i){const r=[],s=h.from(e),n=h.from(t);r.push(s.toString());const o=i-1;for(let e=1;e<o;e++){const t=s.mix(n,e/o);r.push(t.toString())}return r.push(n.toString()),r}(t,e,20),P={hot:i.slice(0,10),cold:i.slice(10,20)};const r=v.D.onDidChange((e=>{v.D.changed(e,["heatmap.ageThreshold","heatmap.hotColor","heatmap.coldColor"])&&(r.dispose(),P=void 0)}))}return P}function R(e,t,i){const[r,s,n,o]=F(t,i);e.renderOptions.before.borderColor=`rgba(${r},${s},${n},${o})`}function D(e,t,i,n){const[o,a,c,l]=F(e,t),{fadeLines:h,locations:u}=v.D.get("heatmap"),d=u.includes(s.o9.Gutter),p=u.includes(s.o9.Line),m=u.includes(s.o9.Scrollbar),g=`${o},${a},${c},${l}`;let f=n.get(g);return null==f?(f={decorationType:r.window.createTextEditorDecorationType({backgroundColor:p?`rgba(${o},${a},${c},${.15*l})`:void 0,opacity:h?`${t.computeOpacity(e).toFixed(2)} !important`:void 0,isWholeLine:!(!p&&!h)||void 0,gutterIconPath:d?r.Uri.parse(`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='rgb(${o},${a},${c})' fill-opacity='${l}' x='15' y='0' width='3' height='18'/></svg>`)}`):void 0,gutterIconSize:d?"contain":void 0,overviewRulerLane:m?r.OverviewRulerLane.Center:void 0,overviewRulerColor:m?`rgba(${o},${a},${c},${.7*l})`:void 0}),rangesOrOptions:[i]},n.set(g,f)):f.rangesOrOptions.push(i),f.decorationType}function k(e,t,i,r){const s={renderOptions:{before:{...r}}};e.isUncommitted&&(s.renderOptions.before.color=r.uncommittedColor);const a=o.i.fromTemplate(t,e,i);return s.renderOptions.before.contentText=(0,y.vk)(a.replace(/ /g,n.NE.Space),1,1),s}function _(e,t,i,s,n){let o,a,c,l=0;for(const e of Object.values(n.tokenOptions))if(void 0!==e){if(null==e.truncateTo){l=-1;break}l+=e.truncateTo}if(l>=0&&(l+=(0,y.dz)((0,y.sX)(s,void 0)),l>0&&(l+=3)),t.enabled&&(o="solid",a="left"===t.location?"0 0 0 2px":"0 2px 0 0"),l>=0){const e=v.D.getAny("editor.letterSpacing");c=null!=e&&0!==e?`calc(${l}ch + ${Math.round(l*e)+(i?13:-6)}px)`:`calc(${l}ch ${i?"+ 13px":"- 6px"})`}return{backgroundColor:new r.ThemeColor("gitlens.gutterBackgroundColor"),borderStyle:o,borderWidth:a,color:new r.ThemeColor("gitlens.gutterForegroundColor"),fontWeight:"normal",fontStyle:"normal",height:"100%",margin:"0 26px -1px 0",textDecoration:`${e?"overline solid rgba(0, 0, 0, .2)":"none"};box-sizing: border-box${i?";padding: 0 0 0 18px":""}`,width:c,uncommittedColor:new r.ThemeColor("gitlens.gutterUncommittedForegroundColor")}}function T(e,t,i,s=!0){const a=o.i.fromTemplate(t,e,{...i,messageTruncateAtNewLine:!0});return{renderOptions:{after:{backgroundColor:new r.ThemeColor("gitlens.trailingLineBackgroundColor"),color:new r.ThemeColor("gitlens.trailingLineForegroundColor"),contentText:(0,y.vk)(a.replace(/ /g,n.NE.Space),1,1),fontWeight:"normal",fontStyle:"normal",textDecoration:"none;"+(s?"":" position: absolute;")}}}}function F(e,t){const i=t.computeRelativeAge(e),r=a((e.getTime()<t.coldThresholdTimestamp?t.colors.cold:t.colors.hot)[i]);return[...r??[0,0,0],null==r?0:0===i?1:i<=5?.8:.6]}},3139:(e,t,i)=>{i.d(t,{G:()=>y,P:()=>Autolinks});var r=i(9496),s=i(5255),n=i(8452),o=i(5148),a=i(7512),c=i(4241),l=i(8786),h=i(3105),u=i(4336),d=i(7469),p=i(3620),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&m(t,i,n),n};const w=Object.freeze(new Map),v=/<num>/g;function y(e){return{provider:e.provider?{id:e.provider.id,name:e.provider.name,domain:e.provider.domain,icon:e.provider.icon}:void 0,id:e.id,prefix:e.prefix,title:e.title,url:e.url,type:e.type,description:e.description}}function b(e){return!("prefix"in e)&&!("url"in e)}function C(e){return"prefix"in e&&null!=e.prefix&&"url"in e&&null!=e.url}class Autolinks{constructor(e){this.container=e,this._references=[],this._disposable=r.Disposable.from(o.D.onDidChange(this.onConfigurationChanged,this)),this.onConfigurationChanged()}dispose(){this._disposable?.dispose()}onConfigurationChanged(e){if(o.D.changed(e,"autolinks")){const e=o.D.get("autolinks");this._references=e?.filter((e=>e.prefix&&e.url))?.map((e=>({prefix:e.prefix,url:e.url,title:e.title,alphanumeric:e.alphanumeric,ignoreCase:e.ignoreCase,type:e.type,description:e.description})))??[]}}getAutolinks(e,t){const i=t?.provider;if(null!=t&&null==t.provider)return w;const r=new Map;let s,n;for(const t of i?.autolinks??this._references)if(C(t))for(A(t,"plaintext");;){if(s=t.messageRegex.exec(e),null==s)break;[,,,n]=s,r.set(n,{provider:i,id:n,prefix:t.prefix,url:t.url?.replace(v,n),title:t.title?.replace(v,n),type:t.type,description:t.description?.replace(v,n)})}else b(t)&&t.parse(e,r);return r}async getLinkedIssuesAndPullRequests(e,t,i){if(!t.hasRichProvider())return;const{provider:r}=t;if(!(r.maybeConnected??await r.isConnected()))return;let s=i?.autolinks;if(null==s&&(s=this.getAutolinks(e,t)),0===s.size)return;const n=await(0,d.xu)(s.keys(),(e=>r.getIssueOrPullRequest(e)),i?.timeout);for(const[e,t]of n)null==t&&n.delete(e);return 0!==n.size?n:void 0}linkify(e,t,i,r,n){const o="plaintext"===t&&null==n;o&&(n=new Map);const a=new Map;for(const i of this._references)this.ensureAutolinkCached(i)&&null!=i.tokenize&&(e=i.tokenize(e,t,a,r,n));if(null!=i&&0!==i.length){i=[...i].sort(((e,t)=>{const i=e.provider?.maybeConnected,r=t.provider?.maybeConnected;return i!==r?i?-1:r?1:0:0}));for(const s of i)if(null!=s.provider)for(const i of s.provider.autolinks)this.ensureAutolinkCached(i)&&null!=i.tokenize&&(e=i.tokenize(e,t,a,r,n))}return 0!==a.size&&(e=e.replace(/(\x00\d+\x00)/g,((e,t)=>a.get(t)??t))),o&&n?.size&&(e+=`\n${s.NE.Dash.repeat(2)}\n${(0,h.v_)((0,h.UI)(n,(([e,t])=>`${(0,p.sC)(e)} ${t}`)),"\n")}`),e}ensureAutolinkCached(e){if(b(e))return!0;if(!e.prefix||!e.url)return!1;if(void 0!==e.tokenize||null===e.tokenize)return!0;try{e.tokenize=(t,i,r,o,c)=>{let h;switch(i){case"markdown":return A(e,i),t.replace(e.messageMarkdownRegex,((t,i,u,m)=>{const g=(0,l.M)(e.url.replace(v,m));let f="";if(e.title){f=` "${e.title.replace(v,m)}`;const t=o?.get(m);if(null!=t)if(t instanceof d.PK)f+=`\n${s.NE.Dash.repeat(2)}\nDetails timed out`;else{const e=(0,p.ry)(t.title.trim());null!=c&&(h=c.size+1,c.set(h,`[${(0,n.sy)(t)} **${e}**](${g}${f}")\\\n${s.NE.Space.repeat(5)}${u} ${t.closed?"closed":"opened"} ${(0,a.Zh)(t.closedDate??t.date)}`)),f+=`\n${s.NE.Dash.repeat(2)}\n${e}\n${t.closed?"Closed":"Opened"}, ${(0,a.Zh)(t.closedDate??t.date)}`}f+='"'}const w=`\0${r.size}\0`;return r.set(w,`[${u}](${g}${f})`),`${i}${w}`}));case"html":return A(e,i),t.replace(e.messageHtmlRegex,((t,i,u,m)=>{const g=(0,l.M)(e.url.replace(v,m));let f="";if(e.title){f=`"${(0,p.se)(e.title.replace(v,m))}`;const t=o?.get(m);if(null!=t)if(t instanceof d.PK)f+=`\n${s.NE.Dash.repeat(2)}\nDetails timed out`;else{const e=(0,p.se)(t.title.trim());null!=c&&(h=c.size+1,c.set(h,`<a href="${g}" title=${f}>${(0,n.Ty)(t)} <b>${e}</b></a><br /><span>${s.NE.Space.repeat(5)}${u} ${t.closed?"closed":"opened"} ${(0,a.Zh)(t.closedDate??t.date)}</span>`)),f+=`\n${s.NE.Dash.repeat(2)}\n${e}\n${t.closed?"Closed":"Opened"}, ${(0,a.Zh)(t.closedDate??t.date)}`}f+='"'}const w=`\0${r.size}\0`;return r.set(w,`<a href="${g}" title=${f}>${u}</a>`),`${i}${w}`}));default:return A(e,i),t.replace(e.messageRegex,((e,t,i,n)=>{const l=o?.get(n);if(null==l)return i;null!=c&&(h=c.size+1,c.set(h,`${i}: ${l instanceof d.PK?"Details timed out":`${l.title}  ${s.NE.Dot}  ${l.closed?"Closed":"Opened"}, ${(0,a.Zh)(l.closedDate??l.date)}`}`));const u=`\0${r.size}\0`;return r.set(u,`${i}${(0,p.sC)(h)}`),`${t}${u}`}))}}}catch(t){u.Yd.error(t,`Failed to create autolink generator: prefix=${e.prefix}, url=${e.url}, title=${e.title}`),e.tokenize=null}return!0}}function A(e,t){return"markdown"===t&&null==e.messageMarkdownRegex?e.messageMarkdownRegex=new RegExp(`(^|\\s|\\(|\\[|\\{)(${(0,p.yI)((0,p.se)((0,p.ry)(e.prefix)))}(${e.alphanumeric?"\\w":"\\d"}+))\\b`,e.ignoreCase?"gi":"g"):"html"===t&&null==e.messageHtmlRegex?e.messageHtmlRegex=new RegExp(`(^|\\s|\\(|\\[|\\{)(${(0,p.yI)((0,p.se)(e.prefix))}(${e.alphanumeric?"\\w":"\\d"}+))\\b`,e.ignoreCase?"gi":"g"):null==e.messageRegex&&(e.messageRegex=new RegExp(`(^|\\s|\\(|\\[|\\{)(${(0,p.yI)(e.prefix)}(${e.alphanumeric?"\\w":"\\d"}+))\\b`,e.ignoreCase?"gi":"g")),!0}f([(0,c.fF)({args:{0:"<message>",1:!1}})],Autolinks.prototype,"getAutolinks",1),f([(0,c.fF)({args:{0:"<message>",1:!1,2:e=>`autolinks=${null!=e?.autolinks}, timeout=${e?.timeout}`}})],Autolinks.prototype,"getLinkedIssuesAndPullRequests",1),f([(0,c.fF)({args:{0:"<text>",2:e=>e?.length,3:e=>e?.size,4:e=>e?.size}})],Autolinks.prototype,"linkify",1)},8178:(e,t,i)=>{i.d(t,{d:()=>BlameAnnotationProviderBase});var r=i(9496),s=i(7462),n=i(1062),o=i(5148),a=i(4241),c=i(2022),l=i(248),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor;class BlameAnnotationProviderBase extends c.HU{constructor(e,t,i,r){super(e,t,i),this.container=r,this.blame=this.container.git.getBlame(this.trackedDocument.uri,t.document),t.document.isDirty&&i.setForceDirtyStateChangeOnNextDocumentChange()}clear(){null!=this.hoverProviderDisposable&&(this.hoverProviderDisposable.dispose(),this.hoverProviderDisposable=void 0),super.clear()}async validate(){const e=await this.blame;return null!=e&&0!==e.lines.length}async getBlame(){const e=await this.blame;if(null!=e&&0!==e.lines.length)return e}getComputedHeatmap(e){const t=[];let i,r;for(const s of e.lines)r!==s.sha&&(r=s.sha,i=e.commits.get(s.sha),null!=i&&t.push(i.date));t.sort(((e,t)=>e.getTime()-t.getTime()));const s=new Date;s.setDate(s.getDate()-(o.D.get("heatmap.ageThreshold")||90));const n=s.getTime(),a=[],c=[];for(const e of t)e.getTime()<n?c.push(e):a.push(e);let h;h=a.length&&c.length?{hot:d(a),cold:d(c)}:d(t);const u=(e,t)=>Array.isArray(h)?h:t?h.hot.concat(h.cold):e.getTime()<n?h.cold:h.hot,p=(e,t)=>{const i=e.getTime();let r=0;for(let e=0;e<t.length&&(r=e,!(i>=t[e]));e++);return r};return{coldThresholdTimestamp:n,colors:(0,l.HM)(),computeRelativeAge:e=>p(e,u(e)),computeOpacity:e=>{const t=u(e,!0),i=p(e,t);return Math.max(.2,Math.round(100*(1-i/t.length))/100)}}}registerHoverProviders(e){const t=o.D.get("hovers");t.enabled&&t.annotations.enabled&&(e.details||e.changes)&&(this.hoverProviderDisposable=r.languages.registerHoverProvider({pattern:this.document.uri.fsPath},{provideHover:(t,i,r)=>this.provideHover(e,t,i,r)}))}async provideHover(e,t,i,a){if("line"!==o.D.get("hovers.annotations.over")&&0!==i.character)return;if(this.document.uri.toString()!==t.uri.toString())return;const c=await this.getBlame();if(null==c)return;const l=c.lines[i.line],h=c.commits.get(l.sha);if(null==h)return;const u=(await Promise.all([e.details?this.getDetailsHoverMessage(h,t):void 0,e.changes?(0,n.jw)(h,await s.YY.fromUri(t.uri),i.line,t):void 0])).filter((e=>Boolean(e)));return new r.Hover(u,t.validateRange(new r.Range(i.line,0,i.line,1073741824)))}async getDetailsHoverMessage(e,t){let i=this.editor.selection.active.line;const r=i+1;i=(e.lines.find((e=>e.line===r))??e.lines[0]).originalLine-1;const a=o.D.get("hovers");return(0,n.nN)(e,await s.YY.fromUri(t.uri),i,{autolinks:a.autolinks.enabled,dateFormat:o.D.get("defaultDateFormat"),format:a.detailsMarkdownFormat,pullRequests:{enabled:a.pullRequests.enabled}})}}function d(e){const t=[],i=Math.floor(e.length/2),r=e.length%2?e[i].getTime():(e[i-1].getTime()+e[i].getTime())/2;let s=(e[e.length-1].getTime()-r)/5;for(let e=5;e>0;e--)t.push(r+s*e);t.push(r);s=(r-e[0].getTime())/4;for(let e=1;e<=4;e++)t.push(r-s*e);return t}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&h(t,i,n)})([(0,a.cM)({args:!1})],BlameAnnotationProviderBase.prototype,"getComputedHeatmap",1)},623:(e,t,i)=>{i.d(t,{Iq:()=>m,fK:()=>FileAnnotationController});var r=i(9496),s=i(2540),n=i(5148),o=i(2061),a=i(2185),c=i(9796),l=i(3105),h=i(4336),u=i(3700),d=i(2509),p=i(2022);const m={gutterBlameAnnotation:r.window.createTextEditorDecorationType({rangeBehavior:r.DecorationRangeBehavior.ClosedOpen,textDecoration:"none"}),gutterBlameHighlight:void 0,changesLineChangedAnnotation:void 0,changesLineAddedAnnotation:void 0,changesLineDeletedAnnotation:void 0};class FileAnnotationController{constructor(e){this.container=e,this._onDidToggleAnnotations=new r.EventEmitter,this._annotationProviders=new Map,this._keyboardScope=void 0,this._windowAnnotationType=void 0,this._disposable=r.Disposable.from((0,a.IH)(e.onReady)(this.onReady,this),n.D.onDidChange(this.onConfigurationChanged,this),r.window.onDidChangeActiveColorTheme(this.onThemeChanged,this)),this._toggleModes=new Map}get onDidToggleAnnotations(){return this._onDidToggleAnnotations.event}dispose(){this.clearAll(),m.gutterBlameAnnotation?.dispose(),m.gutterBlameHighlight?.dispose(),m.changesLineChangedAnnotation?.dispose(),m.changesLineAddedAnnotation?.dispose(),m.changesLineDeletedAnnotation?.dispose(),this._annotationsDisposable?.dispose(),this._disposable?.dispose()}onReady(){this.onConfigurationChanged()}onConfigurationChanged(e){const t=null==e;let i;if(n.D.changed(e,["blame.highlight","changes.locations"])&&this.updateDecorations(!1),n.D.changed(e,"blame.toggleMode")&&(i=n.D.get("blame.toggleMode"),this._toggleModes.set(s.VP.Blame,i),t||i!==s.TF.File||this.clearAll()),n.D.changed(e,"changes.toggleMode")&&(i=n.D.get("changes.toggleMode"),this._toggleModes.set(s.VP.Changes,i),t||i!==s.TF.File||this.clearAll()),n.D.changed(e,"heatmap.toggleMode")&&(i=n.D.get("heatmap.toggleMode"),this._toggleModes.set(s.VP.Heatmap,i),t||i!==s.TF.File||this.clearAll()),!t&&n.D.changed(e,["blame","changes","heatmap","hovers","defaultDateFormat","defaultDateSource","defaultDateStyle","defaultGravatarsStyle"]))for(const e of this._annotationProviders.values())null!=e&&this.show(e.editor,e.annotationType??s.VP.Blame)}onThemeChanged(e){this.updateDecorations(!0)}async onActiveTextEditorChanged(e){if(null!=e&&!(0,d.PH)(e))return;if(this._editor=e,this.isInWindowToggle())return void await this.show(e,this._windowAnnotationType);const t=this.getProvider(e);null==t?((0,o.v)("gitlens:annotationStatus",void 0),this.detachKeyboardHook()):((0,o.v)("gitlens:annotationStatus",t.status),this.attachKeyboardHook())}onBlameStateChanged(e){if(e.blameable)return;const t=r.window.activeTextEditor;null!=t&&this.clear(t,"BlameabilityChanged")}onDirtyStateChanged(e){for(const[t,i]of this._annotationProviders)e.document.is(i.document)&&this.clearCore(t,"DocumentChanged")}onTextDocumentClosed(e){if(this.container.git.isTrackable(e.uri))for(const[t,i]of this._annotationProviders)i.document===e&&this.clearCore(t,"DocumentClosed")}onTextEditorViewColumnChanged(e){const t=this.getProvider(e.textEditor);if(null!=t)t.restore(e.textEditor);else{const t=(0,l.sE)(this._annotationProviders.values(),(t=>t.editor.document===e.textEditor.document));if(null==t)return;this.clearCore(t.correlationKey,"ColumnChanged")}}onVisibleTextEditorsChanged(e){for(const t of e)this.getProvider(t)?.restore(t)}isInWindowToggle(){return this.getToggleMode(this._windowAnnotationType)===s.TF.Window}getToggleMode(e){return null==e?s.TF.File:this._toggleModes.get(e)??s.TF.File}clear(e,t="User"){return this.isInWindowToggle()?this.clearAll():this.clearCore((0,p.mc)(e),t)}async clearAll(){this._windowAnnotationType=void 0;for(const[e]of this._annotationProviders)await this.clearCore(e,"Disposing")}async getAnnotationType(e){const t=this.getProvider(e);if(null==t)return;const i=await this.container.tracker.get(e.document);return null!=i&&i.isBlameable?t.annotationType:void 0}getProvider(e){if(null!=e?.document)return this._annotationProviders.get((0,p.mc)(e))}async show(e,t,i){if(this.getToggleMode(t)===s.TF.Window){let i=null==this._windowAnnotationType;const s=!i&&this._windowAnnotationType!==t;if(this._windowAnnotationType=t,s&&(await this.clearAll(),i=!0),i)for(const i of r.window.visibleTextEditors)i!==e&&this.show(i,t)}if(null==e)return!1;this._editor=e;if(!(await this.container.tracker.getOrAdd(e.document)).isBlameable)return!1;const n=this.getProvider(e);if(n?.annotationType===t)return await n.provideAnnotation(i),await n.selection(i?.selection),!0;return null!=await r.window.withProgress({location:r.ProgressLocation.Window},(async r=>{await(0,o.v)("gitlens:annotationStatus",p.jp.Computing);const s=this.showAnnotationsCore(n,e,t,i,r),a=await s;return e===this._editor&&await(0,o.v)("gitlens:annotationStatus",a?.status),s}))}async toggle(e,t,i,r){if(null!=e&&this._toggleModes.get(t)===s.TF.File){const i=await this.container.tracker.getOrAdd(e.document);if(t===s.VP.Changes&&!i.isTracked||!i.isBlameable)return!1}const n=this.getProvider(e);if(null==n)return this.show(e,t,i);const o=n.annotationType!==t||n.mustReopen(i);return!0===r&&!o||(this.isInWindowToggle()?await this.clearAll():await this.clearCore(n.correlationKey,"User"),!!o&&this.show(e,t,i))}async attachKeyboardHook(){null==this._keyboardScope&&(this._keyboardScope=await this.container.keyboard.beginScope({escape:{onDidPressKey:async()=>{const e=this._editor;null!=e&&await this.clear(e,"User")}}}))}async clearCore(e,t){const i=this._annotationProviders.get(e);null!=i&&(h.Yd.log(`${t}:`,`Clear annotations for ${e}`),this._annotationProviders.delete(e),i.dispose(),0!==this._annotationProviders.size&&e!==(0,p.mc)(this._editor)||(await(0,o.v)("gitlens:annotationStatus",void 0),await this.detachKeyboardHook()),0===this._annotationProviders.size&&(h.Yd.log("Remove all listener registrations for annotations"),this._annotationsDisposable?.dispose(),this._annotationsDisposable=void 0),this._onDidToggleAnnotations.fire())}async detachKeyboardHook(){null!=this._keyboardScope&&(await this._keyboardScope.dispose(),this._keyboardScope=void 0)}async showAnnotationsCore(e,t,n,o,a){if(null!=a){let e="annotations";switch(n){case s.VP.Blame:e="blame annotations";break;case s.VP.Changes:e="changes annotations";break;case s.VP.Heatmap:e="heatmap annotations"}a.report({message:`Computing ${e} for ${(0,u.EZ)(t.document.fileName)}`})}await this.attachKeyboardHook();const l=await this.container.tracker.getOrAdd(t.document);let d;switch(n){case s.VP.Blame:{const{GutterBlameAnnotationProvider:e}=await Promise.resolve().then(i.bind(i,4455));d=new e(t,l,this.container);break}case s.VP.Changes:{const{GutterChangesAnnotationProvider:e}=await Promise.resolve().then(i.bind(i,34));d=new e(t,l,this.container);break}case s.VP.Heatmap:{const{GutterHeatmapBlameAnnotationProvider:e}=await Promise.resolve().then(i.bind(i,79));d=new e(t,l,this.container);break}}if(null!=d&&await d.validate()){if(null!=e&&await this.clearCore(e.correlationKey,"User"),null==this._annotationsDisposable&&0===this._annotationProviders.size&&(h.Yd.log("Add listener registrations for annotations"),this._annotationsDisposable=r.Disposable.from(r.window.onDidChangeActiveTextEditor((0,c.Ds)(this.onActiveTextEditorChanged,50),this),r.window.onDidChangeTextEditorViewColumn(this.onTextEditorViewColumnChanged,this),r.window.onDidChangeVisibleTextEditors((0,c.Ds)(this.onVisibleTextEditorsChanged,50),this),r.workspace.onDidCloseTextDocument(this.onTextDocumentClosed,this),this.container.tracker.onDidChangeBlameState(this.onBlameStateChanged,this),this.container.tracker.onDidChangeDirtyState(this.onDirtyStateChanged,this))),this._annotationProviders.set(d.correlationKey,d),await d.provideAnnotation(o))return this._onDidToggleAnnotations.fire(),d;await this.clearCore(d.correlationKey,"Disposing")}}updateDecorations(e){const t=e?Object.entries(m):void 0;if(this.updateHighlightDecoration(),this.updateChangedDecorations(),!e)return;const i=new Map;for(const[e,r]of t){if(null==r)continue;r!==(m[e]??null)&&i.set(r,m[e]??null)}if(0!==i.size)for(const e of r.window.visibleTextEditors)this.getProvider(e)?.refresh(i)}updateChangedDecorations(){m.changesLineAddedAnnotation?.dispose(),m.changesLineChangedAnnotation?.dispose(),m.changesLineDeletedAnnotation?.dispose();const e=n.D.get("changes.locations");let t,i,o;switch(r.window.activeColorTheme.kind){case r.ColorThemeKind.Light:t=[72,152,93],i=[32,144,211],o=[229,20,0];break;case r.ColorThemeKind.HighContrast:default:t=[72,126,2],i=[27,129,168],o=[241,76,76]}m.changesLineAddedAnnotation=r.window.createTextEditorDecorationType({backgroundColor:e.includes(s.hp.Line)?`rgba(${t.join(",")},0.4)`:void 0,isWholeLine:!!e.includes(s.hp.Line)||void 0,gutterIconPath:e.includes(s.hp.Gutter)?r.Uri.parse(`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='rgb(${t.join(",")})' x='15' y='0' width='3' height='18'/></svg>`)}`):void 0,gutterIconSize:"contain",overviewRulerLane:r.OverviewRulerLane.Left,overviewRulerColor:e.includes(s.hp.Scrollbar)?new r.ThemeColor("editorOverviewRuler.addedForeground"):void 0}),m.changesLineChangedAnnotation=r.window.createTextEditorDecorationType({backgroundColor:e.includes(s.hp.Line)?`rgba(${i.join(",")},0.4)`:void 0,isWholeLine:!!e.includes(s.hp.Line)||void 0,gutterIconPath:e.includes(s.hp.Gutter)?r.Uri.parse(`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='rgb(${i.join(",")})' x='15' y='0' width='3' height='18'/></svg>`)}`):void 0,gutterIconSize:"contain",overviewRulerLane:r.OverviewRulerLane.Left,overviewRulerColor:e.includes(s.hp.Scrollbar)?new r.ThemeColor("editorOverviewRuler.modifiedForeground"):void 0}),m.changesLineDeletedAnnotation=r.window.createTextEditorDecorationType({gutterIconPath:e.includes(s.hp.Gutter)?r.Uri.parse(`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><polygon fill='rgb(${o.join(",")})' points='13,10 13,18 17,14'/></svg>`)}`):void 0,gutterIconSize:"contain",overviewRulerLane:r.OverviewRulerLane.Left,overviewRulerColor:e.includes(s.hp.Scrollbar)?new r.ThemeColor("editorOverviewRuler.deletedForeground"):void 0})}updateHighlightDecoration(){m.gutterBlameHighlight?.dispose(),m.gutterBlameHighlight=void 0;const e=n.D.get("blame.highlight");if(e.enabled){const{locations:t}=e,i="#00bcf2",n=t.includes(s.y0.Gutter)?r.Uri.parse(`data:image/svg+xml,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 18 18'><rect fill='${i}' fill-opacity='0.6' x='7' y='0' width='3' height='18'/></svg>`)}`):void 0;m.gutterBlameHighlight=r.window.createTextEditorDecorationType({gutterIconPath:n,gutterIconSize:"contain",isWholeLine:!0,overviewRulerLane:r.OverviewRulerLane.Right,backgroundColor:t.includes(s.y0.Line)?new r.ThemeColor("gitlens.lineHighlightBackgroundColor"):void 0,overviewRulerColor:t.includes(s.y0.Scrollbar)?new r.ThemeColor("gitlens.lineHighlightOverviewRulerColor"):void 0})}}}},4455:(e,t,i)=>{i.d(t,{GutterBlameAnnotationProvider:()=>GutterBlameAnnotationProvider});var r=i(9496),s=i(2540),n=i(5255),o=i(9338),a=i(2800),c=i(5148),l=i(4241),h=i(3105),u=i(6004),d=i(6398),p=i(3620),m=i(248),g=i(8178),f=i(623),w=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?v(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&w(t,i,n),n};class GutterBlameAnnotationProvider extends g.d{constructor(e,t,i){super(s.VP.Blame,e,t,i)}clear(){if(super.clear(),null!=f.Iq.gutterBlameHighlight)try{this.editor.setDecorations(f.Iq.gutterBlameHighlight,[])}catch{}}async onProvideAnnotation(e,t){const i=(0,u.UH)();this.annotationContext=e;const s=await this.getBlame();if(null==s)return!1;const a=new d.u(i),l=c.D.get("blame"),h=(0,p.Gg)(l.format).reduce(((e,t)=>(e[t.key]=t.options,e)),Object.create(null));let g;o.i.has(l.format,"tips")&&(g=await this.container.git.getBranchesAndTagsTipsFn(s.repoPath));const w={dateFormat:null===l.dateFormat?c.D.get("defaultDateFormat"):l.dateFormat,getBranchAndTagTips:g,tokenOptions:h},v=l.avatars,y=c.D.get("defaultGravatarsStyle"),b=l.separateLines,C=(0,m.Vz)(b,l.heatmap,l.avatars,l.format,w),A=[],P=new Map,S=v?new Map:void 0;let R,D,k,_,T=!1;l.heatmap.enabled&&(_=this.getComputedHeatmap(s));for(const e of s.lines){const t=e.line-1;if(k!==e.sha)T=!1,k=e.sha,R=s.commits.get(e.sha),null!=R&&(D=P.get(e.sha),null==D?(D=(0,m.U5)(R,l.format,w,C),null!=_&&(0,m.iF)(D,R.date,_),D.range=new r.Range(t,0,t,0),A.push(D),v&&null!=R.author.email&&await this.applyAvatarDecoration(R,D,y,S),P.set(e.sha,D)):(D={...D,range:new r.Range(t,0,t,0)},A.push(D)));else{if(null==D)continue;D={...D},l.compact&&!T&&(D.renderOptions={before:{...D.renderOptions.before,contentText:n.NE.Space.repeat((0,p.dz)(D.renderOptions.before.contentText))}},b&&(D.renderOptions.before.textDecoration="none;box-sizing: border-box"+(v?";padding: 0 0 0 18px":"")),T=!0),D.range=new r.Range(t,0,t,0),A.push(D)}}return a.restart({suffix:" to compute gutter blame annotations"}),A.length&&(this.setDecorations([{decorationType:f.Iq.gutterBlameAnnotation,rangesOrOptions:A}]),a.stop({suffix:" to apply all gutter blame annotations"})),this.registerHoverProviders(c.D.get("hovers.annotations")),!0}async selection(e,t){if(!1===e||null==f.Iq.gutterBlameHighlight)return;if(null==t&&(t=await this.blame,!t?.lines.length))return;let i;if(null!=e?.sha)i=e.sha;else if(null!=e?.line){if(e.line>=0){const r=t.lines[e.line];i=r?.sha}}else i=(0,h.Ps)(t.commits.values())?.sha;if(!i)return void this.editor.setDecorations(f.Iq.gutterBlameHighlight,[]);const s=(0,a.DZ)(t.lines,(e=>e.sha===i?this.editor.document.validateRange(new r.Range(e.line-1,0,e.line-1,1073741824)):void 0));this.editor.setDecorations(f.Iq.gutterBlameHighlight,s)}async applyAvatarDecoration(e,t,i,r){let s=r.get(e.author.email??"");if(null==s){const t=(await e.getAvatarUri({defaultStyle:i,size:16})).toString(!0);s={contentText:"",height:"16px",width:"16px",textDecoration:`none;position:absolute;top:1px;left:5px;background:url(${encodeURI(t)});background-size:16px 16px;margin-left: 0 !important`},r.set(e.author.email??"",s)}t.renderOptions.after=s}}y([(0,l.cM)()],GutterBlameAnnotationProvider.prototype,"onProvideAnnotation",1),y([(0,l.cM)({args:!1})],GutterBlameAnnotationProvider.prototype,"selection",1)},34:(e,t,i)=>{i.d(t,{GutterChangesAnnotationProvider:()=>GutterChangesAnnotationProvider});var r=i(9496),s=i(2540),n=i(1062),o=i(5148),a=i(4241),c=i(6004),l=i(6398),h=i(2022),u=i(623),d=Object.defineProperty,p=Object.getOwnPropertyDescriptor;const m=2**30;class GutterChangesAnnotationProvider extends h.HU{constructor(e,t,i){super(s.VP.Changes,e,t),this.container=i}mustReopen(e){return this.annotationContext?.sha!==e?.sha||this.annotationContext?.only!==e?.only}clear(){this.state=void 0,null!=this.hoverProviderDisposable&&(this.hoverProviderDisposable.dispose(),this.hoverProviderDisposable=void 0),super.clear()}selection(e){return Promise.resolve()}validate(){return Promise.resolve(!0)}async onProvideAnnotation(e){const t=(0,c.UH)();this.mustReopen(e)&&this.clear(),this.annotationContext=e;let i,s=this.trackedDocument.uri.sha,n=null!=e?.sha&&e.sha!==s?`${e.sha}^`:void 0,o=null==s&&null==n;if(o){let e=await this.container.git.getOldestUnpushedRefForFile(this.trackedDocument.uri.repoPath,this.trackedDocument.uri);if(null!=e)e=`${e}^`,i=await this.container.git.getCommitForFile(this.trackedDocument.uri.repoPath,this.trackedDocument.uri,{ref:e}),null!=i?null!=n?n=e:(s=e,n=""):o=!1;else{const e=await this.container.git.getStatusForFile(this.trackedDocument.uri.repoPath,this.trackedDocument.uri),t=e?.getPseudoCommits(this.container,await this.container.git.getCurrentUser(this.trackedDocument.uri.repoPath));t?.length?(i=await this.container.git.getCommitForFile(this.trackedDocument.uri.repoPath,this.trackedDocument.uri),s="HEAD"):this.trackedDocument.dirty?s="HEAD":o=!1}}if(!o){if(i=await this.container.git.getCommitForFile(this.trackedDocument.uri.repoPath,this.trackedDocument.uri,{ref:n??s}),null==i)return!1;null!=n||(s=`${i.ref}^`),n=i.ref}const a=(await Promise.all(null==n&&this.editor.document.isDirty?[this.container.git.getDiffForFileContents(this.trackedDocument.uri,s,this.editor.document.getText()),this.container.git.getDiffForFile(this.trackedDocument.uri,s,n)]:[this.container.git.getDiffForFile(this.trackedDocument.uri,s,n)])).filter((e=>Boolean(e)));if(!a?.length)return!1;const h=new l.u(t),d=new Map,p=null!=e?.sha&&e?.only?await this.container.git.getBlame(this.trackedDocument.uri,this.editor?.document):void 0;let g;for(const t of a)for(const i of t.hunks){if(null!=p){let t=!0;const r=e.sha;for(let e=i.current.position.start-1;e<i.current.position.end;e++)p.lines[e]?.sha===r&&(t=!1);if(t)continue}let t=Math.max(i.current.position.start-2,-1),s=-1;for(const e of i.lines){if(s++,t++,"unchanged"===e.current?.state)continue;const n=this.editor.document.validateRange(new r.Range(new r.Position(t,0),new r.Position(t,m)));let o;if(null==g&&(g=new r.Selection(n.start,n.end)),null==e.current){const r=i.lines[s-1];if(null==e.previous||null!=r&&null==r.current){t--;continue}if(!(i.previous.count>i.current.count)){t--;continue}o="removed"}else if("added"===e.current?.state)o="removed"===e.previous?.state?"changed":"added";else if("removed"===e?.current.state){if(!(i.previous.count>i.current.count)){t--;continue}o="removed"}else o="changed";let a=d.get(o);null==a?(a={decorationType:"added"===o?u.Iq.changesLineAddedAnnotation:"removed"===o?u.Iq.changesLineDeletedAnnotation:u.Iq.changesLineChangedAnnotation,rangesOrOptions:[{range:n}]},d.set(o,a)):a.rangesOrOptions.push({range:n})}}return h.restart({suffix:" to compute recent changes annotations"}),d.size&&(this.setDecorations([...d.values()]),h.stop({suffix:" to apply all recent changes annotations"}),null!=g&&!1!==e?.selection&&(this.editor.selection=g,this.editor.revealRange(g,r.TextEditorRevealType.InCenterIfOutsideViewport))),this.state={commit:i,diffs:a},this.registerHoverProvider(),!0}registerHoverProvider(){const e=o.D.get("hovers");e.enabled&&e.annotations.enabled&&(this.hoverProviderDisposable=r.languages.registerHoverProvider({pattern:this.document.uri.fsPath},{provideHover:(e,t,i)=>this.provideHover(e,t,i)}))}async provideHover(e,t,i){if(null==this.state)return;if("line"!==o.D.get("hovers.annotations.over")&&0!==t.character)return;const{commit:s,diffs:a}=this.state;for(const i of a)for(const o of i.hunks){const i="changed"===o.state&&o.previous.count>o.current.count;if(t.line>=o.current.position.start-1&&t.line<=o.current.position.end-(i?0:1)){const a=await(0,n.yq)(s,this.trackedDocument.uri,t.line,o);if(null==a)return;return new r.Hover(a,e.validateRange(new r.Range(o.current.position.start-1,0,o.current.position.end-(i?0:1),m)))}}}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?p(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&d(t,i,n)})([(0,a.cM)()],GutterChangesAnnotationProvider.prototype,"onProvideAnnotation",1)},79:(e,t,i)=>{i.d(t,{GutterHeatmapBlameAnnotationProvider:()=>GutterHeatmapBlameAnnotationProvider});var r=i(9496),s=i(2540),n=i(4241),o=i(6004),a=i(6398),c=i(248),l=i(8178),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor;class GutterHeatmapBlameAnnotationProvider extends l.d{constructor(e,t,i){super(s.VP.Heatmap,e,t,i)}async onProvideAnnotation(e,t){const i=(0,o.UH)();this.annotationContext=e;const s=await this.getBlame();if(null==s)return!1;const n=new a.u(i),l=new Map,h=this.getComputedHeatmap(s);let u;for(const e of s.lines){const t=e.line-1;u=s.commits.get(e.sha),null!=u&&(0,c.Lx)(u.date,h,new r.Range(t,0,t,0),l)}return n.restart({suffix:" to compute heatmap annotations"}),l.size&&(this.setDecorations([...l.values()]),n.stop({suffix:" to apply all heatmap annotations"})),!0}selection(e){return Promise.resolve()}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&h(t,i,n)})([(0,n.cM)()],GutterHeatmapBlameAnnotationProvider.prototype,"onProvideAnnotation",1)},8294:(e,t,i)=>{i.d(t,{AR:()=>ActionRunners,vj:()=>u});var r=i(9496),s=i(5255),n=i(9529),o=i(5148),a=i(2061),c=i(3620),l=i(2509);const h=["createPullRequest","openPullRequest","hover.commands"];const u="Built In";class ActionRunnerQuickPickItem{constructor(e,t){this.runner=e,this._label="string"==typeof e.label?e.label:e.label(t)}get label(){return this._label}get detail(){return this.runner.name}}class NoActionRunnersQuickPickItem{get label(){return"No actions were found"}get detail(){}}let d=0;class RegisteredActionRunner{constructor(e,t,i){this.type=e,this.runner=t,this.unregister=i,this.id=(1073741824===d?d=1:d++,d)}dispose(){this.unregister()}get name(){return this.runner.name}get label(){return this.runner.label}get order(){switch(this.type){case 0:return 0;case 1:return 1;case 2:return this.partnerId?1:2;case 3:return 3;default:return 100}}get partnerId(){return this.runner.partnerId}run(e){return this.runner.run(e)}}class ActionRunners{constructor(e){this.container=e,this._onDidChange=new r.EventEmitter,this._actionRunners=new Map;const t=[o.D.onDidChange((e=>{o.D.changed(e,"partners")&&this._updateAllContextKeys()}))];for(const e of h)t.push((0,n.xR)(`${s.Gh.ActionPrefix}${e}`,((e,t)=>this.run(e,t))));this._disposable=r.Disposable.from(...t)}get onDidChange(){return this._onDidChange.event}dispose(){this._disposable.dispose();for(const e of this._actionRunners.values())for(const t of e)t.dispose();this._actionRunners.clear()}count(e){return this.get(e)?.length??0}get(e){return t=o.D.get("partners"),null==(i=this._actionRunners.get(e))||0===i.length?void 0:null==t?i:i.filter((e=>null==e.partnerId||null!=e.partnerId&&!1!==t[e.partnerId]?.enabled));var t,i}has(e){return this.count(e)>0}register(e,t,i=2){let r=this._actionRunners.get(e);null==r&&(r=[],this._actionRunners.set(e,r));const s=e=>{this._updateContextKeys(e),this._onDidChange.fire(e)},n=this._actionRunners,o=new RegisteredActionRunner(i,t,(function(){if(1===r.length)n.delete(e),s(e);else{const e=r.indexOf(this);-1!==e&&r.splice(e,1)}}));return r.push(o),s(e),{dispose:()=>o.dispose()}}registerBuiltIn(e,t){return this.register(e,{...t,partnerId:void 0,name:u},0)}registerBuiltInPartner(e,t,i){return this.register(t,{...i,partnerId:e},1)}registerBuiltInPartnerInstaller(e,t,i){return this.register(t,{...i,partnerId:e,name:`${i.name} (Not Installed)`},3)}async run(e,t){let i,s=this.get(e.type);if(null!=s&&0!==s.length&&(null!=t&&(s=s.filter((e=>e.id===t))),0!==s.length)){if(s.length>1||s.every((e=>0!==e.type))){const t=s.sort(((e,t)=>e.order-t.order||(0,c.dm)(e.name,t.name))).map((t=>new ActionRunnerQuickPickItem(t,e)));0===t.length&&t.push(new NoActionRunnersQuickPickItem);const n=r.window.createQuickPick();n.ignoreFocusOut=(0,l.hE)();const o=[];try{const r=await new Promise((i=>{let r,s;switch(o.push(n.onDidHide((()=>i(void 0))),n.onDidAccept((()=>{0!==n.activeItems.length&&i(n.activeItems[0])}))),e.type){case"createPullRequest":r="Create Pull Request",s="Choose how to create a pull request";break;case"openPullRequest":r="Open Pull Request",s="Choose how to open the pull request";break;case"hover.commands":r="Need Help or Want to Collaborate?",s="Choose what you would like to do"}n.title=r,n.placeholder=s,n.matchOnDetail=!0,n.items=t,n.show()}));if(null==r)return;i=r.runner}finally{n.dispose(),o.forEach((e=>{e.dispose()}))}}else[i]=s;await(i?.run(e))}}async _updateContextKeys(e){await(0,a.v)(`gitlens:action:${e}`,this.count(e))}async _updateAllContextKeys(){for(const e of h)await this._updateContextKeys(e)}}},8388:(e,t,i)=>{i.d(t,{E3:()=>O,GV:()=>T,TU:()=>$,Wr:()=>I,cL:()=>w,oP:()=>P,x4:()=>S});var r=i(9496),s=i(4290),n=i(2540),o=i(5567),a=i(2075),c=i(5148),l=i(2061),h=i(9796),u=i(3105),d=i(3620);const p=2**30;let m;const g=new Map,f=new r.EventEmitter;f.event((0,h.Ds)((()=>{const e=null!=m?[...(0,u.DZ)(m,(([e,t])=>null!=t.uri?[e,{uri:t.uri.toString(),timestamp:t.timestamp}]:void 0))]:void 0;o.W.instance.storage.store("avatars",e)}),1e3));const w=f.event,v="00000000000000000000000000000000",y=new Map,b=6e4,C=864e5,A=[6048e5,b,3e5,6e5,36e5,C,6048e5];function P(e,t,i){return R(e,t,i)}function S(e,t){return R(e,void 0,{...t,cached:!0})}function R(e,t,i){k(m);const n=2*(i?.size??16);if(!e){const e=D(`${v}:${n}`,void 0,n,v,i?.defaultStyle);return e.uri??e.fallback}const a=(0,s.FB)(e.trim().toLowerCase()),c=`${a}:${n}`,h=D(c,e,n,a,i?.defaultStyle);if(null!=h.uri)return h.uri;if(!i?.cached&&null!=t&&(0,l.fw)("gitlens:hasConnectedRemotes")){let i=g.get(c);return null==i&&function(e){return Date.now()>=e.timestamp+A[Math.min(e.retries,A.length-1)]}(h)&&(i=async function(e,t,i,n,{size:a=16}={}){k(m);try{let t;if("string"!=typeof n){const e=await o.W.instance.git.getBestRemoteWithRichProvider(n.repoPath);t=await(e?.provider.getAccountForCommit(n.ref,{avatarSize:a}))}return null==t?.avatarUrl?(e.uri=void 0,e.timestamp=p,void(e.retries=0)):(e.uri=r.Uri.parse(t.avatarUrl),e.timestamp=Date.now(),e.retries=0,null!=t.email&&(0,d.qq)(i,t.email)&&m.set(`${(0,s.FB)(t.email.trim().toLowerCase())}:${a}`,{...e}),f.fire({email:i}),e.uri)}catch{return e.uri=void 0,e.timestamp=Date.now(),void e.retries++}}(h,0,e,t,{size:n}).then((e=>e??h.uri??h.fallback)),g.set(c,i.finally((()=>g.delete(c))))),i??h.fallback}return i?.cached?h.uri:h.uri??h.fallback}function D(e,t,i,r,s){let n=m.get(e);return null==n?(n={uri:null!=t&&0!==t.length?F(t,i):void 0,fallback:_(r,i,s),timestamp:0,retries:0},m.set(e,n)):null==n.fallback&&(n.fallback=_(r,i,s)),n}function k(e){if(null==e){const e=o.W.instance.storage.get("avatars")?.map((([e,t])=>[e,{uri:r.Uri.parse(t.uri),timestamp:t.timestamp,retries:0}]));m=new Map(e)}}function _(e,t,i){return r.Uri.parse(`https://www.gravatar.com/avatar/${e}?s=${t}&d=${i??function(){null==x&&(x=c.D.get("defaultGravatarsStyle",void 0,n.il.Robot));return x}()}`)}function T(e,t,i){return _((0,s.FB)(e.trim().toLowerCase()),t,i)}function F(e,t=16){const i=(0,a.at)(e);if(null!=i&&(0,d.qq)(i.authority,"github.com"))return r.Uri.parse(`https://avatars.githubusercontent.com/${i.userId?`u/${i.userId}`:i.login}?size=${t}`)}const E=new Map([["online","#28ca42"],["away","#cecece"],["busy","#ca5628"],["dnd","#ca5628"],["offline","#cecece"]]);function $(e){let t=y.get(e);if(null==t){const i=(0,d.US)(`<?xml version="1.0" encoding="utf-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="4" height="16" viewBox="0 0 4 16">\n\t<circle cx="2" cy="14" r="2" fill="${E.get(e)}"/>\n</svg>`);t=encodeURI(`data:image/svg+xml;base64,${i}`),y.set(e,t)}return t}function O(e){switch(e){case"all":o.W.instance.storage.delete("avatars"),m?.clear(),g.clear();break;case"failed":for(const e of m?.values()??[])null==e.uri&&(e.timestamp=0,e.retries=0);break;case"fallback":for(const e of m?.values()??[])e.fallback=void 0}}let x;function I(e){x=e,O("fallback")}},5183:(e,t,i)=>{i.d(t,{GitCodeLensProvider:()=>GitCodeLensProvider});var r=i(9496),s=i(2540),n=i(5255),o=i(6503),a=i(9529),c=i(5148),l=i(9796),h=i(3105),u=i(4336),d=i(2509);class GitRecentChangeCodeLens extends r.CodeLens{constructor(e,t,i,r,s,n,o,a,c,l){super(a,l),this.languageId=e,this.symbol=t,this.uri=i,this.dateFormat=r,this.blame=s,this.blameRange=n,this.isFullRange=o,this.desiredCommand=c}getBlame(){return this.blame?.()}}class GitAuthorsCodeLens extends r.CodeLens{constructor(e,t,i,r,s,n,o,a){super(o),this.languageId=e,this.symbol=t,this.uri=i,this.blame=r,this.blameRange=s,this.isFullRange=n,this.desiredCommand=a}getBlame(){return this.blame()}}class GitCodeLensProvider{constructor(e){this.container=e,this._onDidChangeCodeLenses=new r.EventEmitter}get onDidChangeCodeLenses(){return this._onDidChangeCodeLenses.event}reset(e){this._onDidChangeCodeLenses.fire()}async provideCodeLenses(e,t){if(e.isDirty&&(0,d.pt)(e.uri))return[];const i=await this.container.tracker.getOrAdd(e);if(!i.isBlameable)return[];let n=!1;if(e.isDirty)if(i.isDirtyIdle){const t=c.D.get("advanced.blame.sizeThresholdAfterEdit");t>0&&e.lineCount>t&&(n=!0)}else n=!0;const o=c.D.get("codeLens",e);let h=o.scopesByLanguage?.find((t=>t.language?.toLowerCase()===e.languageId));null==h&&(h={language:e.languageId}),null==h.scopes&&(h.scopes=o.scopes),null==h.symbolScopes&&(h.symbolScopes=o.symbolScopes),h.symbolScopes=null!=h.symbolScopes?h.symbolScopes=h.symbolScopes.map((e=>e.toLowerCase())):[];const p=[],m=i.uri;let g,f;if(n){if(1!==h.scopes.length||!h.scopes.includes(s.Uy.Document)){let t;if([t,f]=await Promise.all([this.container.git.isTracked(m),(0,a.dO)("vscode.executeDocumentSymbolProvider",e.uri)]),!t)return p}}else{if(t.isCancellationRequested)return p;if(1===h.scopes.length&&h.scopes.includes(s.Uy.Document)?g=await this.container.git.getBlame(m,e):[g,f]=await Promise.all([this.container.git.getBlame(m,e),(0,a.dO)("vscode.executeDocumentSymbolProvider",e.uri)]),null==g||0===g?.lines.length)return p}if(t.isCancellationRequested)return p;const w=(0,l.IH)((()=>e.validateRange(new r.Range(0,0,1e6,1e6)))),v=n?{command:void 0,title:this.getDirtyTitle(o)}:void 0;if(void 0!==f){u.Yd.log("GitCodeLensProvider.provideCodeLenses:",`${f.length} symbol(s) found`);for(const t of f)this.provideCodeLens(p,e,t,h,w,g,m,o,n,v)}if((h.scopes.includes(s.Uy.Document)||h.symbolScopes.includes("file"))&&!h.symbolScopes.includes("!file")&&null==p.find((e=>0===e.range.start.line&&0===e.range.end.line))){const t=w();let i;if(n||o.recentChange.enabled){n||(i=(0,l.IH)((()=>this.container.git.getBlameRange(g,m,t))));const s=new r.SymbolInformation(m.fileName,r.SymbolKind.File,"",new r.Location(m.documentUri(),new r.Range(0,0,0,t.start.character)));p.push(new GitRecentChangeCodeLens(e.languageId,s,m,o.dateFormat,i,t,!0,D(s),o.recentChange.command,v))}if(!n&&o.authors.enabled){void 0===i&&(i=(0,l.IH)((()=>this.container.git.getBlameRange(g,m,t))));const s=new r.SymbolInformation(m.fileName,r.SymbolKind.File,"",new r.Location(m.documentUri(),new r.Range(0,1,0,t.start.character)));p.push(new GitAuthorsCodeLens(e.languageId,s,m,i,t,!0,D(s),o.authors.command))}}return p}getValidateSymbolRange(e,t,i,n){let o,a=!1;const c=r.SymbolKind[e.kind].toLowerCase();switch(e.kind){case r.SymbolKind.File:(t.scopes.includes(s.Uy.Containers)||t.symbolScopes.includes(c))&&(a=!t.symbolScopes.includes(`!${c}`)),a&&(o=i());break;case r.SymbolKind.Package:(t.scopes.includes(s.Uy.Containers)||t.symbolScopes.includes(c))&&(a=!t.symbolScopes.includes(`!${c}`)),a&&(o=D(e),0===o.start.line&&0===o.end.line&&(o=i()));break;case r.SymbolKind.Class:case r.SymbolKind.Interface:case r.SymbolKind.Module:case r.SymbolKind.Namespace:case r.SymbolKind.Struct:(t.scopes.includes(s.Uy.Containers)||t.symbolScopes.includes(c))&&(o=D(e),a=!t.symbolScopes.includes(`!${c}`)&&(n||!o.isSingleLine));break;case r.SymbolKind.Constructor:case r.SymbolKind.Enum:case r.SymbolKind.Function:case r.SymbolKind.Method:case r.SymbolKind.Property:(t.scopes.includes(s.Uy.Blocks)||t.symbolScopes.includes(c))&&(o=D(e),a=!t.symbolScopes.includes(`!${c}`)&&(n||!o.isSingleLine));break;case r.SymbolKind.String:(t.symbolScopes.includes(c)||"markdown"===t.language&&t.scopes.includes(s.Uy.Containers))&&(o=D(e),a=!t.symbolScopes.includes(`!${c}`)&&(n||!o.isSingleLine));break;default:t.symbolScopes.includes(c)&&(o=D(e),a=!t.symbolScopes.includes(`!${c}`)&&(n||!o.isSingleLine))}return a?o??D(e):void 0}provideCodeLens(e,t,i,s,n,o,a,c,h,u){try{const d=this.getValidateSymbolRange(i,s,n,c.includeSingleLineSymbols);if(void 0===d)return;const p=t.lineAt(D(i).start);if(e.length&&e[e.length-1].range.start.line===p.lineNumber)return;let m,g=0;if((h||c.recentChange.enabled)&&(h||(m=(0,l.IH)((()=>this.container.git.getBlameRange(o,a,d)))),e.push(new GitRecentChangeCodeLens(t.languageId,i,a,c.dateFormat,m,d,!1,p.range.with(new r.Position(p.range.start.line,g)),c.recentChange.command,u)),g++),c.authors.enabled){let s=!d.isSingleLine;if(!s&&"csharp"===t.languageId)switch(i.kind){case r.SymbolKind.File:break;case r.SymbolKind.Package:case r.SymbolKind.Module:case r.SymbolKind.Namespace:case r.SymbolKind.Class:case r.SymbolKind.Interface:case r.SymbolKind.Constructor:case r.SymbolKind.Method:case r.SymbolKind.Function:case r.SymbolKind.Enum:s=!0}s&&!h&&(void 0===m&&(m=(0,l.IH)((()=>this.container.git.getBlameRange(o,a,d)))),e.push(new GitAuthorsCodeLens(t.languageId,i,a,m,d,!1,p.range.with(new r.Position(p.range.start.line,g)),c.authors.command)))}}finally{if(k(i))for(const r of i.children)this.provideCodeLens(e,t,r,s,n,o,a,c,h,u)}}resolveCodeLens(e,t){return e instanceof GitRecentChangeCodeLens?this.resolveGitRecentChangeCodeLens(e,t):e instanceof GitAuthorsCodeLens?this.resolveGitAuthorsCodeLens(e,t):Promise.reject(void 0)}resolveGitRecentChangeCodeLens(e,t){const i=e.getBlame();if(null==i)return e;const n=(0,h.Ps)(i.commits.values());if(null==n)return e;let o=`${n.author.name}, ${null==e.dateFormat?n.formattedDate:n.formatDate(e.dateFormat)}`;if(c.D.get("debug")&&(o+=` [${e.languageId}: ${r.SymbolKind[e.symbol.kind]}(${e.range.start.character}-${e.range.end.character}${e.symbol.containerName?`|${e.symbol.containerName}`:""}), Lines (${e.blameRange.start.line+1}-${e.blameRange.end.line+1}), Commit (${n.shortSha})]`),!1===e.desiredCommand)return R(o,e);switch(e.desiredCommand){case s.N4.CopyRemoteCommitUrl:return m(o,e,n,!0);case s.N4.CopyRemoteFileUrl:return g(o,e,n,!0);case s.N4.DiffWithPrevious:return p(o,e,n);case s.N4.OpenCommitOnRemote:return m(o,e,n);case s.N4.OpenFileOnRemote:return g(o,e,n);case s.N4.RevealCommitInView:return f(o,e,n);case s.N4.ShowCommitsInView:return w(o,e,i,n);case s.N4.ShowQuickCommitDetails:return v(o,e,n);case s.N4.ShowQuickCommitFileDetails:return y(o,e,n);case s.N4.ShowQuickCurrentBranchHistory:return b(o,e);case s.N4.ShowQuickFileHistory:return C(o,e);case s.N4.ToggleFileBlame:return A(o,e);case s.N4.ToggleFileChanges:return P(o,e,n);case s.N4.ToggleFileChangesOnly:return P(o,e,n,!0);case s.N4.ToggleFileHeatmap:return S(o,e);default:return e}}resolveGitAuthorsCodeLens(e,t){const i=e.getBlame();if(null==i)return e;const n=i.authors.size,o=(0,h.Ps)(i.authors.values())?.name??"Unknown";let a=`${n} ${n>1?"authors":"author"} (${o}${n>1?" and others":""})`;if(c.D.get("debug")&&(a+=` [${e.languageId}: ${r.SymbolKind[e.symbol.kind]}(${e.range.start.character}-${e.range.end.character}${e.symbol.containerName?`|${e.symbol.containerName}`:""}), Lines (${e.blameRange.start.line+1}-${e.blameRange.end.line+1}), Authors (${(0,h.v_)((0,h.UI)(i.authors.values(),(e=>e.name)),", ")})]`),!1===e.desiredCommand)return R(a,e);const l=(0,h.sE)(i.commits.values(),(e=>e.author.name===o))??(0,h.Ps)(i.commits.values());if(null==l)return e;switch(e.desiredCommand){case s.N4.CopyRemoteCommitUrl:return m(a,e,l,!0);case s.N4.CopyRemoteFileUrl:return g(a,e,l,!0);case s.N4.DiffWithPrevious:return p(a,e,l);case s.N4.OpenCommitOnRemote:return m(a,e,l);case s.N4.OpenFileOnRemote:return g(a,e,l);case s.N4.RevealCommitInView:return f(a,e,l);case s.N4.ShowCommitsInView:return w(a,e,i);case s.N4.ShowQuickCommitDetails:return v(a,e,l);case s.N4.ShowQuickCommitFileDetails:return y(a,e,l);case s.N4.ShowQuickCurrentBranchHistory:return b(a,e);case s.N4.ShowQuickFileHistory:return C(a,e);case s.N4.ToggleFileBlame:return A(a,e);case s.N4.ToggleFileChanges:return P(a,e,l);case s.N4.ToggleFileChangesOnly:return P(a,e,l,!0);case s.N4.ToggleFileHeatmap:return S(a,e);default:return e}}getDirtyTitle(e){return e.recentChange.enabled&&e.authors.enabled?c.D.get("strings.codeLens.unsavedChanges.recentChangeAndAuthors"):e.recentChange.enabled?c.D.get("strings.codeLens.unsavedChanges.recentChangeOnly"):c.D.get("strings.codeLens.unsavedChanges.authorsOnly")}}function p(e,t,i){return t.command=(0,a._N)({title:e,command:n.Gh.DiffWithPrevious,arguments:[void 0,{commit:i,uri:t.uri.toFileUri()}]}),t}function m(e,t,i,r=!1){return t.command=(0,a._N)({title:e,command:n.Gh.OpenOnRemote,arguments:[{resource:{type:o.J.Commit,sha:i.sha},repoPath:i.repoPath,clipboard:r}]}),t}function g(e,t,i,r=!1){return t.command=(0,a._N)({title:e,command:n.Gh.OpenOnRemote,arguments:[{resource:{type:o.J.Revision,fileName:i.file?.path??"",sha:i.sha},repoPath:i.repoPath,clipboard:r}]}),t}function f(e,t,i){return t.command=(0,a._N)({title:e,command:i?.isUncommitted?"":s.N4.RevealCommitInView,arguments:[t.uri.toFileUri(),{commit:i,sha:void 0===i?void 0:i.sha}]}),t}function w(e,t,i,r){let s;return s=void 0===r?[...(0,h.DZ)(i.commits.values(),(e=>e.isUncommitted?void 0:e.ref))]:[r.ref],t.command=(0,a._N)({title:e,command:0===s.length?"":n.Gh.ShowCommitsInView,arguments:[{repoPath:i.repoPath,refs:s}]}),t}function v(e,t,i){return t.command=(0,a._N)({title:e,command:i?.isUncommitted?"":s.N4.ShowQuickCommitDetails,arguments:[t.uri.toFileUri(),{commit:i,sha:void 0===i?void 0:i.sha}]}),t}function y(e,t,i){return t.command=(0,a._N)({title:e,command:i?.isUncommitted?"":s.N4.ShowQuickCommitFileDetails,arguments:[t.uri.toFileUri(),{commit:i,sha:void 0===i?void 0:i.sha}]}),t}function b(e,t){return t.command=(0,a._N)({title:e,command:s.N4.ShowQuickCurrentBranchHistory,arguments:[t.uri.toFileUri()]}),t}function C(e,t){return t.command=(0,a._N)({title:e,command:s.N4.ShowQuickFileHistory,arguments:[t.uri.toFileUri(),{range:t.isFullRange?void 0:t.blameRange}]}),t}function A(e,t){return t.command=(0,a._N)({title:e,command:n.Gh.ToggleFileBlame,arguments:[t.uri.toFileUri()]}),t}function P(e,t,i,r){return t.command=(0,a._N)({title:e,command:n.Gh.ToggleFileChanges,arguments:[t.uri.toFileUri(),{type:s.VP.Changes,context:{sha:i.sha,only:r,selection:!1}}]}),t}function S(e,t){return t.command=(0,a._N)({title:e,command:n.Gh.ToggleFileHeatmap,arguments:[t.uri.toFileUri()]}),t}function R(e,t){return t.command={title:e,command:""},t}function D(e){return k(e)?e.range:e.location.range}function k(e){return(0,l.is)(e,"children")}GitCodeLensProvider.selector=[{scheme:n.sN.File},{scheme:n.sN.Git},{scheme:n.sN.GitLens},{scheme:n.sN.PRs},{scheme:n.sN.Vsls},{scheme:n.sN.VslsScc},{scheme:n.sN.Virtual},{scheme:n.sN.GitHub}]},9152:(e,t,i)=>{i.d(t,{tM:()=>xi,V:()=>ge,_f:()=>Wt,DA:()=>Jt,CE:()=>nr,oc:()=>mr,MZ:()=>wr});var r=i(5255),s=i(9311),n=i(9529),o=i(7139),a=Object.defineProperty,c=Object.getOwnPropertyDescriptor;let l=class extends o.mY{constructor(e){super(r.Gh.AddAuthors),this.container=e}execute(e){let t;return null!=e?.rootUri&&(t=this.container.git.getRepository(e.rootUri)),(0,s.m)({command:"co-authors",state:{repo:t,contributors:void 0}})}};l=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?c(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&a(t,i,n),n})([(0,n.WD)()],l);var h=i(7462),u=i(7925),d=i(4336),p=i(3700),m=i(2509),g=Object.defineProperty,f=Object.getOwnPropertyDescriptor;let w=class extends o.pu{constructor(e){super([r.Gh.BrowseRepoAtRevision,r.Gh.BrowseRepoAtRevisionInNewWindow,r.Gh.BrowseRepoBeforeRevision,r.Gh.BrowseRepoBeforeRevisionInNewWindow]),this.container=e}preExecute(e,t){switch(e.command){case r.Gh.BrowseRepoAtRevisionInNewWindow:t={...t,before:!1,openInNewWindow:!0};break;case r.Gh.BrowseRepoBeforeRevision:t={...t,before:!0,openInNewWindow:!1};break;case r.Gh.BrowseRepoBeforeRevisionInNewWindow:t={...t,before:!0,openInNewWindow:!0}}return this.execute(e.editor,e.uri,t)}async execute(e,t,i){i={...i};try{if(null==i.uri){if(null==(t=(0,o.SX)(t,e)))return}else t=i.uri;let r=await h.YY.fromUri(t);if(null==r.sha)return;const s=i?.before?await this.container.git.resolveReference(r.repoPath,`${r.sha}^`):r.sha;t=this.container.git.getRevisionUri(s,r.repoPath,r.repoPath),r=h.YY.fromRevisionUri(t),(0,m.ic)(t,{location:i.openInNewWindow?m.Tc.NewWindow:m.Tc.AddToWorkspace,name:`${(0,p.EZ)(r.repoPath)} @ ${r.shortSha}`}),i.openInNewWindow||(0,n.dO)("workbench.files.action.focusFilesExplorer")}catch(e){d.Yd.error(e,"BrowseRepoAtRevisionCommand"),(0,u.W8)("Unable to open the repository at the specified revision")}}};w=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?f(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&g(t,i,n),n})([(0,n.WD)()],w);var v=i(9496),y=i(635),b=i(4298),C=Object.defineProperty,A=Object.getOwnPropertyDescriptor;let P=class extends o.mY{constructor(e){super(r.Gh.CloseUnchangedFiles),this.container=e}async execute(e){e={...e};try{if(null==e.uris){const t=await(0,y.vJ)("Close All Unchanged Files");if(null==t)return;const i=await this.container.git.getStatusForRepo(t.uri);if(null==i)return void v.window.showWarningMessage("Unable to close unchanged files");e.uris=i.files.map((e=>e.uri))}const t=0===e.uris.length;for(const i of v.window.tabGroups.all)for(const r of i.tabs)if(r.input instanceof v.TabInputText||r.input instanceof v.TabInputCustom||r.input instanceof v.TabInputNotebook){const i=r.input.uri;!t&&e.uris.some((e=>b.n.equals(e,i)))||v.window.tabGroups.close(r,!0)}else if(r.input instanceof v.TabInputTextDiff||r.input instanceof v.TabInputNotebookDiff){const i=r.input.modified;!t&&e.uris.some((e=>b.n.equals(e,i)))||v.window.tabGroups.close(r,!0)}}catch(e){d.Yd.error(e,"CloseUnchangedFilesCommand"),(0,u.W8)("Unable to close all unchanged files")}}};P=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?A(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&C(t,i,n),n})([(0,n.WD)()],P);var S=Object.defineProperty,R=Object.getOwnPropertyDescriptor;let D=class extends o.pu{constructor(e){super([r.Gh.CompareWith,r.Gh.CompareHeadWith,r.Gh.CompareWorkingWith,r.Gh.Deprecated_DiffHeadWith,r.Gh.Deprecated_DiffWorkingWith]),this.container=e}preExecute(e,t){switch(e.command){case r.Gh.CompareWith:t={...t};break;case r.Gh.CompareHeadWith:case r.Gh.Deprecated_DiffHeadWith:(t={...t}).ref1="HEAD";break;case r.Gh.CompareWorkingWith:case r.Gh.Deprecated_DiffWorkingWith:(t={...t}).ref1=""}return this.execute(e.editor,e.uri,t)}async execute(e,t,i){t=(0,o.SX)(t,e),i={...i};try{let r;switch(i.ref1){case null:r="Compare";break;case"":r="Compare Working Tree with";break;case"HEAD":r="Compare HEAD with";break;default:r=`Compare ${i.ref1} with`}const s=(await(0,y.hM)(t,e,r))?.path;if(!s)return;null!=i.ref1&&null!=i.ref2?await this.container.searchAndCompareView.compare(s,i.ref1,i.ref2):this.container.searchAndCompareView.selectForCompare(s,i.ref1,{prompt:!0})}catch(e){d.Yd.error(e,"CompareWithCommmand"),(0,u.W8)("Unable to open comparison")}}};D=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?R(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&S(t,i,n),n})([(0,n.WD)()],D);var k=Object.defineProperty,_=Object.getOwnPropertyDescriptor;let T=class extends o.pu{constructor(e){super(r.Gh.CopyCurrentBranch),this.container=e}async execute(e,t){const i=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,r=await(0,y.hM)(i,e,"Copy Current Branch Name");if(null!=r)try{const e=await r.getBranch();e?.name&&await v.env.clipboard.writeText(e.name)}catch(e){d.Yd.error(e,"CopyCurrentBranchCommand"),(0,u.W8)("Unable to copy current branch name")}}};T=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?_(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&k(t,i,n),n})([(0,n.WD)()],T);var F=i(5367),E=i(3016),$=i(1742);var O=i(4043),x=Object.defineProperty,I=Object.getOwnPropertyDescriptor;let B=class extends o.pu{constructor(e){super([r.Gh.CopyDeepLinkToBranch,r.Gh.CopyDeepLinkToCommit,r.Gh.CopyDeepLinkToRepo,r.Gh.CopyDeepLinkToTag,r.Gh.CopyDeepLinkToComparison]),this.container=e}preExecute(e,t){return null==t&&((0,o.en)(e)?t={refOrRepoPath:e.node.commit}:(0,o.Qo)(e)?t={refOrRepoPath:e.node.branch}:(0,o._5)(e)?t={refOrRepoPath:e.node.tag}:(0,o.C$)(e)?t={refOrRepoPath:e.node.remote.repoPath,remote:e.node.remote.name}:(0,o.F4)(e)&&(t={refOrRepoPath:e.node.uri.fsPath,compareRef:e.node.compareRef,compareWithRef:e.node.compareWithRef})),this.execute(e.editor,e.uri,t)}async execute(e,t,i){let r,s;if(i={...i},null==i?.refOrRepoPath){const i=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0;r=O._n.Repository,s=(await(0,y.hM)(i,e,`Copy Link to ${(0,O.$k)(r)}`))?.path}else"string"==typeof i.refOrRepoPath?(r=null==i.compareRef?O._n.Repository:O._n.Comparison,s=i.refOrRepoPath,i.refOrRepoPath=void 0):(r=(0,O.$x)(i.refOrRepoPath.refType),s=i.refOrRepoPath.repoPath);if(s){if(!i.remote&&"branch"===i.refOrRepoPath?.refType&&(i.refOrRepoPath.remote||null!=i.refOrRepoPath.upstream?.name)){const[e,t]=(0,F.g2)(i.refOrRepoPath.remote?i.refOrRepoPath.name:i.refOrRepoPath.upstream.name);null!=e&&(i.remote=t,i.prePickRemote=!0)}try{let e;const t=await this.container.git.getRemotes(s,{sort:!0});if(i.remote&&!i.prePickRemote)e=t.find((e=>e.name===i?.remote));else{const s=await async function(e,t="Choose a remote",i,r){const s=[];let n;if(0===i.length)t="No remotes found";else{if("default"===r?.autoPick&&i.length>1){const e=i.find((e=>e.default));null!=e&&(i=[e])}const e={upstream:!0,buttons:r?.setDefault?[E.ip]:void 0};for(const t of i)s.push((0,$.vl)(t,void 0,e)),t.name===r?.picked&&(n=s[s.length-1])}if(r?.autoPick&&1===i.length)return s[0];const o=v.window.createQuickPick();o.ignoreFocusOut=(0,m.hE)();const a=[];try{const i=await new Promise((i=>{a.push(o.onDidHide((()=>i(void 0))),o.onDidAccept((()=>{0!==o.activeItems.length&&i(o.activeItems[0])})),o.onDidTriggerItemButton((async e=>{e.button===E.ip&&(await e.item.item.setAsDefault(),i(e.item))}))),o.title=e,o.placeholder=t,o.matchOnDetail=!0,o.items=s,null!=n&&(o.activeItems=[n]),o.show()}));if(null==i)return;return i}finally{o.dispose(),a.forEach((e=>{e.dispose()}))}}(`Copy Link to ${(0,O.$k)(r)}`,"Choose which remote to copy the link for",t,{autoPick:!0,picked:i.remote,setDefault:!0});if(null==s)return;e=s.item}if(null==e)return;null==i.refOrRepoPath?await this.container.deepLinks.copyDeepLinkUrl(s,e.url,i.compareRef,i.compareWithRef):await this.container.deepLinks.copyDeepLinkUrl(i.refOrRepoPath,e.url)}catch(e){d.Yd.error(e,"CopyDeepLinkCommand"),(0,u.W8)("Unable to copy link")}}}};B=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?I(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&x(t,i,n),n})([(0,n.WD)()],B);var W=i(6897),L=i(3105),M=Object.defineProperty,U=Object.getOwnPropertyDescriptor;let N=class extends o.pu{constructor(e){super(r.Gh.CopyMessageToClipboard),this.container=e}async preExecute(e,t){return(0,o.en)(e)?((t={...t}).sha=e.node.commit.sha,null!=e.node.commit.message&&await e.node.commit.ensureFullDetails(),t.message=e.node.commit.message,this.execute(e.editor,e.node.commit.file?.uri??e.node.commit.getRepository()?.uri,t)):(0,o.Qo)(e)?((t={...t}).sha=e.node.branch.sha,this.execute(e.editor,e.node.uri,t)):(0,o._5)(e)?((t={...t}).sha=e.node.tag.sha,this.execute(e.editor,e.node.uri,t)):this.execute(e.editor,e.uri,t)}async execute(e,t,i){t=(0,o.SX)(t,e),i={...i};try{if(!i.message){if(null!=i.repoPath&&null!=i.sha)return void await(0,W.SJ)({ref:i.sha,repoPath:i.repoPath});let r;if(null==t){if(r=this.container.git.getBestRepository(e)?.path,!r)return;const t=await this.container.git.getLog(r,{limit:1});if(null==t)return;const s=(0,L.Ps)(t.commits.values());if(null==s?.message)return;i.message=s.message}else if(null==i.message){const s=await h.YY.fromUri(t);if(r=s.repoPath,!r)return;if(null!=i.sha)return void await(0,W.SJ)({ref:i.sha,repoPath:r});{const t=e?.selection.active.line??0;if(t<0)return;try{const i=await this.container.git.getBlameForLine(s,t,e?.document);if(null==i||i.commit.isUncommitted)return;return void await(0,W.SJ)(i.commit)}catch(e){return d.Yd.error(e,"CopyMessageToClipboardCommand",`getBlameForLine(${t})`),void(0,u.W8)("Unable to copy message")}}}}await v.env.clipboard.writeText(i.message)}catch(e){d.Yd.error(e,"CopyMessageToClipboardCommand"),(0,u.W8)("Unable to copy message")}}};N=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?U(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&M(t,i,n),n})([(0,n.WD)()],N);var G=i(4321),H=i(5148),V=Object.defineProperty,q=Object.getOwnPropertyDescriptor;let Q=class extends o.pu{constructor(e){super(r.Gh.CopyShaToClipboard),this.container=e}preExecute(e,t){return(0,o.en)(e)?((t={...t}).sha=e.node.commit.sha,this.execute(e.editor,e.node.commit.file?.uri??e.node.commit.getRepository()?.uri,t)):(0,o.Qo)(e)?((t={...t}).sha=e.node.branch.sha,this.execute(e.editor,e.node.uri,t)):(0,o._5)(e)?((t={...t}).sha=e.node.tag.sha,this.execute(e.editor,e.node.uri,t)):this.execute(e.editor,e.uri,t)}async execute(e,t,i){t=(0,o.SX)(t,e),i={...i};try{if(!i.sha)if(null==t){const t=this.container.git.getBestRepository(e)?.path;if(!t)return;const r=await this.container.git.getLog(t,{limit:1});if(null==r)return;if(i.sha=(0,L.Ps)(r.commits.values())?.sha,null==i.sha)return}else if(null==i.sha){const r=e?.selection.active.line??0;if(r<0)return;try{const s=await h.YY.fromUri(t),n=await this.container.git.getBlameForLine(s,r,e?.document);if(null==n)return;i.sha=n.commit.sha}catch(e){return d.Yd.error(e,"CopyShaToClipboardCommand",`getBlameForLine(${r})`),void(0,u.W8)("Unable to copy commit SHA")}}await v.env.clipboard.writeText(H.D.get("advanced.abbreviateShaOnCopy")?(0,G.zL)(i.sha):i.sha)}catch(e){d.Yd.error(e,"CopyShaToClipboardCommand"),(0,u.W8)("Unable to copy commit SHA")}}};Q=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?q(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&V(t,i,n),n})([(0,n.WD)()],Q);var Y=Object.defineProperty,j=Object.getOwnPropertyDescriptor;let z=class extends o.pu{constructor(e){super(r.Gh.CopyRelativePathToClipboard),this.container=e}preExecute(e){return(0,o.d$)(e)?this.execute(e.editor,e.node.commit.file.uri):this.execute(e.editor,e.uri)}async execute(e,t){let i="";if(null!=(t=(0,o.SX)(t,e))){const r=this.container.git.getBestRepository(e)?.uri;null!=r&&(i=this.container.git.getRelativePath(t,r))}await v.env.clipboard.writeText(i)}};z=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?j(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Y(t,i,n),n})([(0,n.WD)()],z);var K=i(6503),J=Object.defineProperty,X=Object.getOwnPropertyDescriptor;let Z=class extends o.mY{constructor(e){super(r.Gh.CreatePullRequestOnRemote),this.container=e}async execute(e){if(null==e?.repoPath)return;const t=this.container.git.getRepository(e.repoPath);if(null==t)return;const i=await t.getRemote(e.remote);if(null==i?.provider)return;const s=i.provider.id,o=await t.getRemotes({filter:e=>e.provider?.id===s}),a={type:K.J.CreatePullRequest,base:{branch:e.base,remote:void 0},compare:{branch:e.compare,remote:{path:i.path,url:i.url}}};await(0,n.P0)(r.Gh.OpenOnRemote,{resource:a,remotes:o})}};Z=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?X(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&J(t,i,n),n})([(0,n.WD)()],Z);var ee=i(3636),te=i(5538),ie=Object.defineProperty,re=Object.getOwnPropertyDescriptor;let se=class extends o.pu{constructor(e){super([r.Gh.DiffDirectory,r.Gh.DiffDirectoryWithHead,r.Gh.ViewsOpenDirectoryDiff,r.Gh.ViewsOpenDirectoryDiffWithWorking]),this.container=e}async preExecute(e,t){switch(e.command){case r.Gh.DiffDirectoryWithHead:(t={...t}).ref1="HEAD",t.ref2=void 0;break;case r.Gh.ViewsOpenDirectoryDiff:"viewItem"===e.type&&e.node instanceof te.f&&(t={...t},[t.ref1,t.ref2]=await e.node.getDiffRefs());break;case r.Gh.ViewsOpenDirectoryDiffWithWorking:(0,o.DW)(e)&&((t={...t}).ref1=e.node.ref.ref,t.ref2=void 0)}return this.execute(e.editor,e.uri,t)}async execute(e,t,i){t=(0,o.SX)(t,e),i={...i};try{const r=(await(0,y.hM)(t,e,"Directory Compare Working Tree With"))?.path;if(!r)return;if(!i.ref1){const e=await(0,ee.V)(r,"Directory Compare Working Tree with","Choose a branch or tag to compare with",{allowEnteringRefs:!0});if(null==e)return;if(i.ref1=e.ref,null==i.ref1)return}(0,W.iK)(r,i.ref1,i.ref2)}catch(e){d.Yd.error(e,"OpenDirectoryCompareCommand"),(0,u.W8)("Unable to open directory compare")}}};se=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?re(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ie(t,i,n),n})([(0,n.WD)()],se);var ne=Object.defineProperty,oe=Object.getOwnPropertyDescriptor;let ae=class extends o.pu{constructor(e){super(r.Gh.DiffLineWithPrevious),this.container=e}preExecute(e,t){return"editorLine"===e.type&&(t={...t,line:e.line}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;null==(i={...i}).line&&(i.line=e?.selection.active.line??0);const s=i.commit?.getGitUri()??await h.YY.fromUri(t);try{const e=await this.container.git.getPreviousComparisonUrisForLine(s.repoPath,s,i.line,s.sha);if(null==e?.previous)return void(0,u.RR)();await(0,n.P0)(r.Gh.DiffWith,{repoPath:e.current.repoPath,lhs:{sha:e.previous.sha??"",uri:e.previous.documentUri()},rhs:{sha:e.current.sha??"",uri:e.current.documentUri()},line:e.line,showOptions:i.showOptions})}catch(e){d.Yd.error(e,"DiffLineWithPreviousCommand",`getPreviousLineDiffUris(${s.repoPath}, ${s.fsPath}, ${s.sha})`),(0,u.W8)("Unable to open compare")}}};ae=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?oe(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ne(t,i,n),n})([(0,n.WD)()],ae);var ce=i(439),le=Object.defineProperty,he=Object.getOwnPropertyDescriptor;let ue=class extends o.pu{constructor(e){super(r.Gh.DiffLineWithWorking),this.container=e}preExecute(e,t){return"editorLine"===e.type&&(t={...t,line:e.line}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);let a,c;if(null==(i={...i}).line&&(i.line=e?.selection.active.line??0),null==i.commit||i.commit.isUncommitted){const t=i.line;if(t<0)return;try{const r=await this.container.git.getBlameForLine(s,t,e?.document);if(null==r)return void(0,u.zk)("Unable to open compare");if(i.commit=r.commit,i.commit.isUncommitted){const e=await this.container.git.getStatusForFile(s.repoPath,s);null!=e?.indexStatus?(a=ce.pw,c=this.container.git.getAbsoluteUri(e.originalPath||e.path,i.commit.repoPath)):(a=i.commit.unresolvedPreviousSha,c=i.commit.file.originalUri??i.commit.file.uri)}else a=i.commit.sha,c=i.commit.file.uri;i.line=r.line.line-1}catch(e){return d.Yd.error(e,"DiffLineWithWorkingCommand",`getBlameForLine(${t})`),void(0,u.W8)("Unable to open compare")}}else a=i.commit.sha,c=i.commit.file?.uri??s;const l=await(i.commit.file?.getWorkingUri());null!=l?await(0,n.P0)(r.Gh.DiffWith,{repoPath:i.commit.repoPath,lhs:{sha:a,uri:c},rhs:{sha:"",uri:l},line:i.line,showOptions:i.showOptions}):v.window.showWarningMessage("Unable to open compare. File has been deleted from the working tree")}};ue=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?he(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&le(t,i,n),n})([(0,n.WD)()],ue);var de=i(6450),pe=Object.defineProperty,me=Object.getOwnPropertyDescriptor;let ge=class extends o.mY{constructor(e){super(r.Gh.DiffWith),this.container=e}static getMarkdownCommandArgs(e,t){let i;if((0,de.f_)(e)){const r=e;if(null==r.file||null==r.unresolvedPreviousSha)throw new Error("Commit has no file");i=r.isUncommitted?{repoPath:r.repoPath,lhs:{sha:"HEAD",uri:r.file.uri},rhs:{sha:"",uri:r.file.uri},line:t}:{repoPath:r.repoPath,lhs:{sha:r.unresolvedPreviousSha,uri:r.file.originalUri??r.file.uri},rhs:{sha:r.sha,uri:r.file.uri},line:t}}else i=e;return super.getMarkdownCommandArgsCore(r.Gh.DiffWith,i)}async execute(e){if(null!=e?.lhs&&null!=e?.rhs&&null!=(e={...e,lhs:{...e.lhs},rhs:{...e.rhs},showOptions:null==e.showOptions?void 0:{...e.showOptions}}).repoPath)try{let t=e.lhs.sha,i=e.rhs.sha;if([e.lhs.sha,e.rhs.sha]=await Promise.all([await this.container.git.resolveReference(e.repoPath,e.lhs.sha,e.lhs.uri,{timeout:(0,G.yo)(e.lhs.sha)?100:void 0}),await this.container.git.resolveReference(e.repoPath,e.rhs.sha,e.rhs.uri,{timeout:(0,G.yo)(e.rhs.sha)?100:void 0})]),e.lhs.sha!==ce.Ii&&(t=e.lhs.sha),e.rhs.sha&&e.rhs.sha!==ce.Ii){const t=await this.container.git.getFileStatusForCommit(e.repoPath,e.rhs.uri,e.rhs.sha);"D"===t?.status?e.rhs.sha=ce.Ii:i=e.rhs.sha,"A"===t?.status&&e.lhs.sha.endsWith("^")&&(e.lhs.sha=ce.Ii)}const[s,o]=await Promise.all([this.container.git.getBestRevisionUri(e.repoPath,e.lhs.uri.fsPath,e.lhs.sha),this.container.git.getBestRevisionUri(e.repoPath,e.rhs.uri.fsPath,e.rhs.sha)]);let a=(0,G.zL)(i,{strings:{uncommitted:"Working Tree"}});null==o?a=(0,G.l3)(e.rhs.sha)?"deleted":0===a.length&&e.rhs.sha===ce.Ii?"not in Working Tree":"deleted"+(0===a.length?"":` in ${a}`):null==s&&(a="added"+(0===a.length?"":` in ${a}`));let c=e.lhs.sha!==ce.Ii?(0,G.zL)(t):"";null==s&&0===e.rhs.sha.length&&(null!=o?(c=0===c.length?"":`not in ${c}`,a=""):c="deleted"+(0===c.length?"":` in ${c}`)),null!=e.lhs.title||null==s&&0===c.length||(e.lhs.title=`${(0,p.EZ)(e.lhs.uri.fsPath)}${c?` (${c})`:""}`),null==e.rhs.title&&(e.rhs.title=`${(0,p.EZ)(e.rhs.uri.fsPath)}${a?` (${a})`:""}`);const l=null!=e.lhs.title&&null!=e.rhs.title?`${e.lhs.title} ${r.NE.ArrowLeftRightLong} ${e.rhs.title}`:e.lhs.title??e.rhs.title;null==e.showOptions&&(e.showOptions={}),null==e.showOptions.viewColumn&&(e.showOptions.viewColumn=v.ViewColumn.Active),null!=e.line&&0!==e.line&&(e.showOptions.selection=new v.Range(e.line,0,e.line,0)),await(0,n.dO)("vscode.diff",s??this.container.git.getRevisionUri(ce.Ii,e.lhs.uri.fsPath,e.repoPath),o??this.container.git.getRevisionUri(ce.Ii,e.rhs.uri.fsPath,e.repoPath),l,e.showOptions)}catch(e){d.Yd.error(e,"DiffWithCommand","getVersionedFile"),(0,u.W8)("Unable to open compare")}}};ge=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?me(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&pe(t,i,n),n})([(0,n.WD)()],ge);var fe=Object.defineProperty,we=Object.getOwnPropertyDescriptor;let ve=class extends o.pu{constructor(e){super([r.Gh.DiffWithNext,r.Gh.DiffWithNextInDiffLeft,r.Gh.DiffWithNextInDiffRight]),this.container=e}preExecute(e,t){return e.command===r.Gh.DiffWithNextInDiffLeft&&(t={...t,inDiffLeftEditor:!0}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;null==(i={...i}).line&&(i.line=e?.selection.active.line??0);const s=i.commit?.getGitUri()??await h.YY.fromUri(t);try{const e=await this.container.git.getNextComparisonUris(s.repoPath,s,s.sha,i.inDiffLeftEditor?1:0);if(null==e?.next)return;await(0,n.P0)(r.Gh.DiffWith,{repoPath:e.current.repoPath,lhs:{sha:e.current.sha??"",uri:e.current.documentUri()},rhs:{sha:e.next.sha??"",uri:e.next.documentUri()},line:i.line,showOptions:i.showOptions})}catch(e){d.Yd.error(e,"DiffWithNextCommand",`getNextDiffUris(${s.repoPath}, ${s.fsPath}, ${s.sha})`),(0,u.W8)("Unable to open compare")}}};ve=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?we(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&fe(t,i,n),n})([(0,n.WD)()],ve);var ye=Object.defineProperty,be=Object.getOwnPropertyDescriptor;let Ce=class extends o.pu{constructor(e){super([r.Gh.DiffWithPrevious,r.Gh.DiffWithPreviousInDiffLeft,r.Gh.DiffWithPreviousInDiffRight]),this.container=e}preExecute(e,t){return e.command===r.Gh.DiffWithPreviousInDiffRight&&(t={...t,inDiffRightEditor:!0}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(i={...i}).uri){if(null==(t=(0,o.SX)(t,e)))return}else t=i.uri;let s;if(null==i.line&&(i.line=e?.selection.active.line??0),null!=i.commit?.file){if(!i.commit.isUncommitted)return void await(0,n.P0)(r.Gh.DiffWith,{repoPath:i.commit.repoPath,lhs:{sha:`${i.commit.sha}^`,uri:i.commit.file.originalUri??i.commit.file.uri},rhs:{sha:"?"===i.commit.file.status?`${i.commit.sha}^3`:i.commit.sha||"",uri:i.commit.file.uri},line:i.line,showOptions:i.showOptions});s=i.commit?.getGitUri()}else s=await h.YY.fromUri(t);try{const e=await this.container.git.getPreviousComparisonUris(s.repoPath,s,s.sha,i.inDiffRightEditor?1:0);if(null==e?.previous){if(null==e)return void(0,u.RR)();if(null==e.current.sha)return void await(0,m.GR)(e.current,i.showOptions);if(!e.current.isUncommittedStaged)return void(0,u.RR)();e.previous=h.YY.fromFile(e.current.fileName,e.current.repoPath,ce.Ii)}await(0,n.P0)(r.Gh.DiffWith,{repoPath:e.current.repoPath,lhs:{sha:e.previous.sha??"",uri:e.previous.documentUri()},rhs:{sha:e.current.sha??"",uri:e.current.documentUri()},line:i.line,showOptions:i.showOptions})}catch(e){d.Yd.error(e,"DiffWithPreviousCommand",`getPreviousDiffUris(${s.repoPath}, ${s.fsPath}, ${s.sha})`),(0,u.W8)("Unable to open compare")}}};Ce=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?be(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ye(t,i,n),n})([(0,n.WD)()],Ce);var Ae=i(5567),Pe=i(7469),Se=i(9729),Re=i(3599);async function De(e,t,i,r){const s=v.window.createQuickPick();function n(e){return null==e?[(0,Re.fw)(Re.Xe.Cancel)]:[...r?.showOtherReferences??[],...(0,L.UI)(e.commits.values(),(e=>(0,$.YY)(e,r?.picked===e.ref,{compact:!0,icon:!0}))),...e?.hasMore?[(0,Re.fw)(Re.Xe.LoadMore)]:[]]}s.ignoreFocusOut=(0,m.hE)(),s.title=t,s.placeholder=i,s.matchOnDescription=!0,s.matchOnDetail=!0,(0,Pe.tI)(e)&&(s.busy=!0,s.show(),null==(e=await e)&&(s.placeholder="Unable to show commit history")),s.items=n(e),r?.picked&&(s.activeItems=s.items.filter((e=>!Se.$w.is(e)&&e.picked)));const o=[];let a;null!=r?.keys&&0!==r.keys.length&&null!==r?.onDidPressKey&&(a=Ae.W.instance.keyboard.createScope(Object.fromEntries(r.keys.map((e=>[e,{onDidPressKey:e=>{if(0!==s.activeItems.length){const[t]=s.activeItems;null==t||(0,Re.Gy)(t)||Se.$w.is(t)||r.onDidPressKey(e,t)}}}])))),a.start(),o.push(a));try{const t=await new Promise((t=>{o.push(s.onDidHide((()=>t(void 0))),s.onDidAccept((()=>{if(0!==s.activeItems.length){const[i]=s.activeItems;if((0,Re.Gy)(i))return i.directive===Re.Xe.LoadMore?void async function(){s.busy=!0;try{const t=n(e=await((await e)?.more?.(H.D.get("advanced.maxListItems"))));let i=-1;if(0!==s.activeItems.length){const e=s.activeItems[0];i=s.items.indexOf(e),(0,Re.Gy)(e)&&i--}s.items=t,i&&(s.activeItems=[s.items[i]])}finally{s.busy=!1}}():void t(void 0);t(i)}})),s.onDidChangeValue((async e=>{null!=a&&(0!==e.length?await a.pause(["left","right"]):await a.resume())}))),s.busy=!1,s.show()}));if(null==t||(0,Re.Gy)(t))return;return t instanceof Se.$w?void await t.execute():t.item}finally{s.dispose(),o.forEach((e=>{e.dispose()}))}}async function ke(e,t,i,r){const s=v.window.createQuickPick();s.ignoreFocusOut=(0,m.hE)(),s.title=t,s.placeholder=i,s.matchOnDescription=!0,s.matchOnDetail=!0,(0,Pe.tI)(e)&&(s.busy=!0,s.show(),e=await e),null!=e&&(s.items=[...r?.showOtherReferences??[],...(0,L.UI)(null!=r?.filter?(0,L.hX)(e.commits.values(),r.filter):e.commits.values(),(e=>(0,$.YY)(e,r?.picked===e.ref,{compact:!0,icon:!0})))]),(null==e||s.items.length<=(r?.showOtherReferences?.length??0))&&(s.placeholder=null==e?"No stashes found":r?.empty??"No matching stashes found",s.items=[(0,Re.fw)(Re.Xe.Cancel)]),r?.picked&&(s.activeItems=s.items.filter((e=>!Se.$w.is(e)&&e.picked)));const n=[];let o;null!=r?.keys&&0!==r.keys.length&&null!==r?.onDidPressKey&&(o=Ae.W.instance.keyboard.createScope(Object.fromEntries(r.keys.map((e=>[e,{onDidPressKey:e=>{if(0!==s.activeItems.length){const[t]=s.activeItems;null==t||(0,Re.Gy)(t)||Se.$w.is(t)||r.onDidPressKey(e,t)}}}])))),o.start(),n.push(o));try{const e=await new Promise((e=>{n.push(s.onDidHide((()=>e(void 0))),s.onDidAccept((()=>{if(0!==s.activeItems.length){const[t]=s.activeItems;if((0,Re.Gy)(t))return void e(void 0);e(t)}})),s.onDidChangeValue((async e=>{null!=o&&(0!==e.length?await o.pause(["left","right"]):await o.resume())}))),s.busy=!1,s.show()}));if(null==e||(0,Re.Gy)(e))return;return e instanceof Se.$w?void await e.execute():e.item}finally{s.dispose(),n.forEach((e=>{e.dispose()}))}}var _e=i(3620),Te=Object.defineProperty,Fe=Object.getOwnPropertyDescriptor;let Ee=class extends o.pu{constructor(e){super(r.Gh.DiffWithRevision),this.container=e}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);null==(i={...i}).line&&(i.line=e?.selection.active.line??0);try{const e=this.container.git.getLogForFile(s.repoPath,s.fsPath).then((e=>e??(s.sha?this.container.git.getLogForFile(s.repoPath,s.fsPath,{ref:s.sha}):void 0))),t=`Open Changes with Revision${(0,_e.vk)(r.NE.Dot,2,2)}`,o=await De(e,`${t}${s.getFormattedFileName({suffix:s.sha?`:${(0,G.zL)(s.sha)}`:void 0,truncateTo:r.d$-t.length})}`,"Choose a commit to compare with",{picked:s.sha,keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{await(0,n.P0)(r.Gh.DiffWith,{repoPath:s.repoPath,lhs:{sha:t.item.ref,uri:s},rhs:{sha:"",uri:s},line:i.line,showOptions:i.showOptions})},showOtherReferences:[Se.$w.fromCommand("Choose a Branch or Tag...",r.Gh.DiffWithRevisionFrom),Se.$w.fromCommand("Choose a Stash...",r.Gh.DiffWithRevisionFrom,{stash:!0})]});if(null==o)return;await(0,n.P0)(r.Gh.DiffWith,{repoPath:s.repoPath,lhs:{sha:o.ref,uri:s},rhs:{sha:"",uri:s},line:i.line,showOptions:i.showOptions})}catch(e){d.Yd.error(e,"DiffWithRevisionCommand"),(0,u.W8)("Unable to open compare")}}};Ee=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Fe(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Te(t,i,n),n})([(0,n.WD)()],Ee);var $e=Object.defineProperty,Oe=Object.getOwnPropertyDescriptor;let xe=class extends o.pu{constructor(e){super(r.Gh.DiffWithRevisionFrom),this.container=e}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);if(!s.repoPath)return void(0,u.bi)("Unable to open file compare");null==(i={...i}).line&&(i.line=e?.selection.active.line??0);const a=this.container.git.getRelativePath(s,s.repoPath);let c,l,d,m;if(i?.stash){const e=`Open Changes with Stash${(0,_e.vk)(r.NE.Dot,2,2)}`,t=await ke(this.container.git.getStash(s.repoPath),`${e}${s.getFormattedFileName({truncateTo:r.d$-e.length})}`,"Choose a stash to compare with",{empty:`No stashes with '${s.getFormattedFileName()}' found`,filter:e=>e.files?.some((e=>e.path===a||e.originalPath===a))??!0});if(null==t)return;c=t.ref,l=c}else{const e=`Open Changes with Branch or Tag${(0,_e.vk)(r.NE.Dot,2,2)}`,t=await(0,ee.V)(s.repoPath,`${e}${s.getFormattedFileName({truncateTo:r.d$-e.length})}`,"Choose a branch or tag to compare with",{allowEnteringRefs:!0});if(null==t)return;c=t.ref,l=(0,G.UR)(t)&&t.remote?`remotes/${c}`:c}if(null==c)return;const g=await this.container.git.getDiffStatus(s.repoPath,"HEAD",c,{filters:["R","C"]});if(null!=g){const e=g.find((e=>e.path===a));null!=e?.originalPath&&(d=this.container.git.getAbsoluteUri(e.originalPath,s.repoPath),m=`${(0,p.EZ)(e.originalPath)} (${(0,G.zL)(c)})`)}await(0,n.P0)(r.Gh.DiffWith,{repoPath:s.repoPath,lhs:{sha:l,uri:d??s,title:m??`${(0,p.EZ)(s.fsPath)} (${(0,G.zL)(c)})`},rhs:{sha:"",uri:s},line:i.line,showOptions:i.showOptions})}};xe=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Oe(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&$e(t,i,n),n})([(0,n.WD)()],xe);var Ie=Object.defineProperty,Be=Object.getOwnPropertyDescriptor;let We=class extends o.pu{constructor(e){super([r.Gh.DiffWithWorking,r.Gh.DiffWithWorkingInDiffLeft,r.Gh.DiffWithWorkingInDiffRight]),this.container=e}async execute(e,t,i){if(null==(i={...i}).uri){if(null==(t=(0,o.SX)(t,e)))return}else t=i.uri;let s=await h.YY.fromUri(t);if(null==i.line&&(i.line=e?.selection.active.line??0),i.inDiffRightEditor)try{const e=await this.container.git.getPreviousComparisonUris(s.repoPath,s,s.sha);s=e?.previous??s}catch(e){return d.Yd.error(e,"DiffWithWorkingCommand",`getPreviousDiffUris(${s.repoPath}, ${s.fsPath}, ${s.sha})`),void(0,u.W8)("Unable to open compare")}if(null==s.sha)return void v.window.showInformationMessage("File matches the working tree");if(s.sha===ce.Ii)return void v.window.showWarningMessage("Unable to open compare. File has been deleted from the working tree");if(s.isUncommittedStaged){const e=await this.container.git.getStatusForFile(s.repoPath,s);if(null!=e?.indexStatus)return void await(0,n.P0)(r.Gh.DiffWith,{repoPath:s.repoPath,lhs:{sha:ce.pw,uri:s.documentUri()},rhs:{sha:"",uri:s.documentUri()},line:i.line,showOptions:i.showOptions})}t=s.toFileUri();const a=await this.container.git.getWorkingUri(s.repoPath,t);null!=a?await(0,n.P0)(r.Gh.DiffWith,{repoPath:s.repoPath,lhs:{sha:s.sha,uri:t},rhs:{sha:"",uri:a},line:i.line,showOptions:i.showOptions}):v.window.showWarningMessage("Unable to open compare. File has been deleted from the working tree")}};We=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Be(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ie(t,i,n),n})([(0,n.WD)()],We);var Le=i(5640),Me=(e=>(e[e.Merge=0]="Merge",e[e.Index=1]="Index",e[e.WorkingTree=2]="WorkingTree",e))(Me||{}),Ue=i(2800),Ne=Object.defineProperty,Ge=Object.getOwnPropertyDescriptor;let He=class extends o.mY{constructor(e){super([r.Gh.ExternalDiff,r.Gh.ExternalDiffAll]),this.container=e}async preExecute(e,t){if(t={...t},(0,o.d$)(e)){const i=await e.node.commit.getPreviousSha(),r=(0,G.l3)(i)?"":i,s=e.node.commit.isUncommitted?"":e.node.commit.sha;return t.files=[{uri:h.YY.fromFile(e.node.file,e.node.file.repoPath??e.node.repoPath),staged:e.node.commit.isUncommittedStaged||null!=e.node.file.indexStatus,ref1:r,ref2:s}],this.execute(t)}if((0,o.O$)(e))return t.files=[{uri:h.YY.fromFile(e.node.file,e.node.file.repoPath??e.node.repoPath),staged:null!=e.node.file.indexStatus,ref1:e.node.ref1,ref2:e.node.ref2}],this.execute(t);if(null==t.files&&("scm-states"===e.type?t.files=e.scmResourceStates.map((e=>({uri:e.resourceUri,staged:e.resourceGroupType===Me.Index}))):"scm-groups"===e.type&&(t.files=(0,Ue.DZ)(e.scmResourceGroups[0].resourceStates,(e=>this.isModified(e)?{uri:e.resourceUri,staged:e.resourceGroupType===Me.Index}:void 0)))),e.command===r.Gh.ExternalDiffAll&&null==t.files){const e=await(0,y.vJ)("Open All Changes (difftool)");if(null==e)return;const i=await this.container.git.getStatusForRepo(e.uri);if(null==i)return v.window.showInformationMessage("The repository doesn't have any changes");t.files=[];for(const e of i.files)"M"===e.indexStatus&&t.files.push({uri:e.uri,staged:!0}),"M"===e.workingTreeStatus&&t.files.push({uri:e.uri,staged:!1})}return this.execute(t)}isModified(e){const t=e.type;return t===Le.qb.BOTH_MODIFIED||t===Le.qb.INDEX_MODIFIED||t===Le.qb.MODIFIED}async execute(e){e={...e};try{let t;if(null==e.files){const i=v.window.activeTextEditor;if(null==i)return;if(t=this.container.git.getBestRepository(i)?.path,!t)return;const r=i.document.uri,s=await this.container.git.getStatusForFile(t,r);if(null==s)return void v.window.showInformationMessage("The current file doesn't have any changes");e.files=[],"M"===s.indexStatus&&e.files.push({uri:s.uri,staged:!0}),"M"===s.workingTreeStatus&&e.files.push({uri:s.uri,staged:!1})}else if(t=(await this.container.git.getOrOpenRepository(e.files[0].uri))?.path,!t)return;const i=H.D.get("advanced.externalDiffTool")||await this.container.git.getDiffTool(t);if(!i){const e="View Git Docs";return void(await v.window.showWarningMessage("Unable to open changes because no Git diff tool is configured",e)===e&&v.env.openExternal(v.Uri.parse("https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool")))}for(const r of e.files)this.container.git.openDiffTool(t,r.uri,{ref1:r.ref1,ref2:r.ref2,staged:r.staged,tool:i})}catch(e){d.Yd.error(e,"ExternalDiffCommand"),(0,u.W8)("Unable to open changes in diff tool")}}};He=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ge(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ne(t,i,n),n})([(0,n.WD)()],He);var Ve=Object.defineProperty,qe=Object.getOwnPropertyDescriptor,Qe=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?qe(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ve(t,i,n),n};let Ye=class extends o.pu{constructor(e){super(r.Gh.GenerateCommitMessage),this.container=e}async execute(e,t,i){let r;if(null!=(i={...i}).repoPath)r=this.container.git.getRepository(i.repoPath);else{const i=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0;r=await(0,y.hM)(i,e,"Generate Commit Message")}if(null==r)return;const s=await this.container.git.getScmRepository(r.path);if(null!=s)try{const e=s.inputBox.value,t=await this.container.ai.generateCommitMessage(r,{context:e,progress:{location:v.ProgressLocation.Notification,title:"Generating commit message..."}});if(null==t)return;(0,n.dO)("workbench.view.scm"),s.inputBox.value=`${e?`${e}\n\n`:""}${t}`}catch(e){if(d.Yd.error(e,"GenerateCommitMessageCommand"),e instanceof Error&&e.message.startsWith("No staged changes"))return void v.window.showInformationMessage("No staged changes to generate a commit message from.");(0,u.W8)(e.message)}}};Ye=Qe([(0,n.WD)()],Ye);let je=class extends o.mY{constructor(e){super(r.Gh.ResetOpenAIKey),this.container=e}execute(){this.container.storage.deleteSecret("gitlens.openai.key"),this.container.storage.deleteWithPrefix("confirm:ai:tos"),this.container.storage.deleteWorkspaceWithPrefix("confirm:ai:tos"),this.container.storage.delete("confirm:sendToOpenAI"),this.container.storage.deleteWorkspace("confirm:sendToOpenAI")}};je=Qe([(0,n.WD)()],je);var ze=i(4155),Ke=i(5025),Je=i(2674),Xe=i(4794),Ze=Object.defineProperty,et=Object.getOwnPropertyDescriptor;let tt=class extends o.mY{constructor(e){super(r.Gh.OpenOrCreateWorktreeForGHPR),this.container=e}async execute(...e){const[t]=e;let i;i="pullRequestModel"in t?t.pullRequestModel:t;const{base:{repositoryCloneUrl:{url:r,owner:s,repositoryName:n}},githubRepository:{rootUri:o},head:{repositoryCloneUrl:{url:a,owner:c},ref:l},item:{number:h}}=i;let u=this.container.git.getRepository(o);if(null==u)return void v.window.showWarningMessage(`Unable to find repository(${o.toString()}) for PR #${h}`);if(u=await u.getMainRepository(),null==u)return void v.window.showWarningMessage(`Unable to find main repository(${o.toString()}) for PR #${h}`);const p=a.toString(),[,m,g]=(0,Xe.Sk)(p);let f;if([f]=await u.getRemotes({filter:e=>e.matches(m,g)}),null!=f)await this.container.git.fetch(u.path,{remote:f.name});else{const e=await v.window.showInformationMessage(`Unable to find a remote for '${p}'. Would you like to add a new remote?`,{modal:!0},{title:"Yes"},{title:"No",isCloseAffordance:!0});if("Yes"!==e?.title)return;if(await(0,ze.IH)(u,c,p,{confirm:!1,fetch:!0,reveal:!1}),[f]=await u.getRemotes({filter:e=>e.url===p}),null==f)return}const w=`${f.name}/${l}`,y=`pr/${r.toString()===a.toString()?l:w}`,b=`remotes/${w}`,C=await(0,Je.K)(u,y,w);if(null!=C)return void(0,Ke.bA)(C);let A,P;const S=await(0,F.fb)(u,y,w);null!=S?A=(0,G.LB)(S):(A=(0,G.xB)(b,u.path,{refType:"branch",name:b,remote:!0}),P=y),await(0,Pe.ag)();try{await(0,Ke.Ue)(u,void 0,A,{createBranch:P});if(null==await this.container.git.getWorktree(u.path,(e=>e.branch===y)))return;this.container.git.setConfig(u.path,`branch.${y}.github-pr-owner-number`,`${s}#${n}#${h}`)}catch(e){d.Yd.error(e,"CreateWorktreeCommand","Unable to create worktree"),v.window.showErrorMessage(`Unable to create worktree for ${c}:${l}`)}}};tt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?et(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ze(t,i,n),n})([(0,n.WD)()],tt);var it=i(4241),rt=i(2967),st=i(6270),nt=Object.defineProperty,ot=Object.getOwnPropertyDescriptor,at=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?ot(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&nt(t,i,n),n};const ct=/\$\(.+?\)|\s/g,lt=Symbol("ShowLoading");let ht=class extends o.mY{constructor(e){super([r.Gh.GitCommands,r.Gh.GitCommandsBranch,r.Gh.GitCommandsCherryPick,r.Gh.GitCommandsMerge,r.Gh.GitCommandsRebase,r.Gh.GitCommandsReset,r.Gh.GitCommandsRevert,r.Gh.GitCommandsSwitch,r.Gh.GitCommandsTag,r.Gh.GitCommandsWorktree,r.Gh.GitCommandsWorktreeOpen]),this.container=e,this.startedWith="menu"}preExecute(e,t){switch(e.command){case r.Gh.GitCommandsBranch:t={command:"branch"};break;case r.Gh.GitCommandsCherryPick:t={command:"cherry-pick"};break;case r.Gh.GitCommandsMerge:t={command:"merge"};break;case r.Gh.GitCommandsRebase:t={command:"rebase"};break;case r.Gh.GitCommandsReset:t={command:"reset"};break;case r.Gh.GitCommandsRevert:t={command:"revert"};break;case r.Gh.GitCommandsSwitch:t={command:"switch"};break;case r.Gh.GitCommandsTag:t={command:"tag"};break;case r.Gh.GitCommandsWorktree:t={command:"worktree"};break;case r.Gh.GitCommandsWorktreeOpen:t={command:"worktree",state:{subcommand:"open"}}}return this.execute(t)}async execute(e){const t=new rt.K(this.container,e),i=null!=e?.command?t.find(e.command):void 0;let r,s;for(this.startedWith=null!=i?"command":"menu",s=null==i?t:await this.showLoadingIfNeeded(i,this.getCommandStep(i,t)),!0===s?.ignoreFocusOut&&(s.ignoreFocusOut=void 0);null!=s;)if(s!==t||null==i)if(r&&null==s.ignoreFocusOut&&(s.ignoreFocusOut=!0),(0,st.Dr)(s))s=await this.showPickStep(s,t),!0===s?.ignoreFocusOut&&(r=!0);else if((0,st.Gj)(s))s=await this.showInputStep(s,t),!0===s?.ignoreFocusOut&&(r=!0);else{if(!(0,st.a)(s))break;s=await this.showCustomStep(s,t),!0===s?.ignoreFocusOut&&(r=!0)}else s=await this.getCommandStep(i,t);e?.completion?.fulfill()}async showLoadingIfNeeded(e,t){const i=await Promise.race([t,new Promise((e=>setTimeout(e,250,lt)))]);if(i!==lt)return i;const r=v.window.createQuickPick();r.ignoreFocusOut=!1;const s=[];let n;try{return await new Promise((async i=>{s.push(r.onDidHide((()=>i(n)))),r.title=e.title,r.placeholder="Loading...",r.busy=!0,r.enabled=!1,r.show(),n=await t,r.hide()}))}finally{r.dispose(),s.forEach((e=>{e.dispose()}))}}getButtons(e,t){const i=[];if(null!=e){if(null!=e.buttons)return i.push(...e.buttons),i;i.push(v.QuickInputButtons.Back),null!=e.additionalButtons&&i.push(...e.additionalButtons)}if(t?.canConfirm)if(t.canSkipConfirm){const e=new E.Lp(t.confirm(),(async()=>{if(null==t?.skipConfirmKey)return;const e=H.D.get("gitCommands.skipConfirmations")??[],i=e.indexOf(t.skipConfirmKey);-1!==i?e.splice(i,1):e.push(t.skipConfirmKey),await H.D.updateEffective("gitCommands.skipConfirmations",e)}));i.push(e)}else i.push(E.zY);return i}async getCommandStep(e,t){t.setCommand(e,"command");const i=await e.next();if(!i.done)return i.value}async nextStep(e,t,i){null!=i&&(i.busy=!0);const r=await e.next(t);if(!r.done)return null!=i&&(i.value=""),r.value}async showCustomStep(e,t){const i=await e.show(e);if(i!==st.Vd){if(!(0,Re.wX)(i))return this.nextStep(t.command,i);switch(i){case Re.Xe.Back:return await(t?.command?.previous())??t;case Re.Xe.Noop:return t.command?.retry();case Re.Xe.Cancel:default:return}}}async showInputStep(e,t){const i=v.window.createInputBox();i.ignoreFocusOut=!H.D.get("gitCommands.closeOnFocusOut")||(e.ignoreFocusOut??!1);const r=[];try{return await new Promise((async s=>{const n={};if(null!=e.onDidPressKey&&null!=e.keys&&0!==e.keys.length)for(const t of e.keys)n[t]={onDidPressKey:t=>e.onDidPressKey(i,t)};const o=this.container.keyboard.createScope(n);if(o.start(),r.push(o,i.onDidHide((()=>s(void 0))),i.onDidTriggerButton((async r=>{if(r!==v.QuickInputButtons.Back){if(r!==E.zY){if(r instanceof E.jQ&&null!=r.onDidClick){const n=r.onDidClick(i);return i.buttons=this.getButtons(e,t.command),!0===await n?void s(t.command?.retry()):void((0,Pe.tI)(n)&&(i.buttons=this.getButtons(e,t.command)))}if(null!=e.onDidClickButton){const n=e.onDidClickButton(i,r);i.buttons=this.getButtons(e,t.command),!0===await n&&s(t.command?.retry())}}}else(async()=>{i.value="",null!=t.command&&(i.busy=!0,s(await t.command.previous()??t))})()})),i.onDidChangeValue((async t=>{if(null!=o&&(0!==t.length?await o.pause(["left","right"]):await o.resume()),null==e.validate)return;const[,r]=await e.validate(t);i.validationMessage=r})),i.onDidAccept((async()=>{s(await this.nextStep(t.command,i.value,i))}))),i.buttons=this.getButtons(e,t.command),i.title=e.title,i.placeholder=e.placeholder,i.prompt=e.prompt,null!=e.value&&(i.value=e.value,null!=e.validate)){const[t,r]=await e.validate(e.value);t||null==r||(i.validationMessage={severity:v.InputBoxValidationSeverity.Error,message:r})}if(null!=t.command&&e===t&&t.setCommand(void 0,"menu"),i.show(),null!=e.value)try{i._onDidChangeValueEmitter?.fire(i.value)}catch{}}))}finally{i.dispose(),r.forEach((e=>{e.dispose()}))}}async showPickStep(e,t){const i=!H.D.get("gitCommands.closeOnFocusOut")||(e.ignoreFocusOut??!1),r=e.ignoreFocusOut,s=v.window.createQuickPick();s.ignoreFocusOut=i;const n=[];try{return await new Promise((o=>{async function a(){s.value="",null!=t.command&&(s.busy=!0,o(await t.command.previous()??t))}async function c(){if(null!=e.onDidLoadMore){s.busy=!0;try{const t=await(e.onDidLoadMore?.(s));let i=-1;if(0!==s.activeItems.length){const e=s.activeItems[0];i=s.items.indexOf(e),(0,Re.Gy)(e)&&i--}s.items=e.items=t,i&&(s.activeItems=[s.items[i]])}finally{s.busy=!1}}}const l={left:{onDidPressKey:a}};if(null!=e.onDidPressKey&&null!=e.keys&&0!==e.keys.length)for(const t of e.keys)l[t]={onDidPressKey:t=>e.onDidPressKey(s,t)};const h=this.container.keyboard.createScope(l);h.start();let u=!1;n.push(h,s.onDidHide((()=>o(void 0))),s.onDidTriggerItemButton((async i=>{!0===await(e.onDidClickItemButton?.(s,i.button,i.item))&&o(await this.nextStep(t.command,[i.item],s))})),s.onDidTriggerButton((async i=>{if(i!==v.QuickInputButtons.Back){if(i!==E.zY)if(i!==E.Q0){if(i instanceof E.jQ&&null!=i.onDidClick){let r;if(null==t.command&&0!==s.activeItems.length){const e=s.activeItems[0];(0,st.YB)(e)&&(r=e)}const n=i.onDidClick(s);return s.buttons=this.getButtons(null!=r?r.value:e,r??t.command),!0===await n?void o(t.command?.retry()):void((0,Pe.tI)(n)&&(s.buttons=this.getButtons(null!=r?r.value:e,r??t.command)))}if(null!=e.onDidClickButton){const r=e.onDidClickButton(s,i);s.buttons=this.getButtons(e,t.command),!0===await r&&o(t.command?.retry())}}else c()}else a()})),s.onDidChangeValue((async n=>{if(null!=h&&(0!==n.length?await h.pause(["left","right"]):await h.resume()),null!=e.onDidChangeValue){if(await e.onDidChangeValue(s))return}if(0===n.length||s.ignoreFocusOut?0===n.length&&s.ignoreFocusOut&&!i&&(s.ignoreFocusOut=i,e.ignoreFocusOut=r):(s.ignoreFocusOut=!0,e.ignoreFocusOut=!0),!u){if(s.canSelectMany&&" "===n)return s.value="",void(s.selectedItems=s.selectedItems.length===s.items.length?[]:s.items);if(n.endsWith(" ")){if(s.canSelectMany&&0!==s.selectedItems.length)return;let i;if(null==t.command){const e=t.find(s.value.trim(),!0);if(null==e)return;t.setCommand(e,this.startedWith)}else{const t=s.value.trim().toLowerCase(),r=e.items.find((e=>e.label.replace(ct,"").toLowerCase()===t));if(null==r)return;i=[r]}return void o(await this.nextStep(t.command,i,s))}}if(s.canSelectMany||null==t.command||0===n.trim().length||!u&&0!==s.activeItems.length)u=!1;else{if(null==e.onValidateValue)return;u=await e.onValidateValue(s,n.trim(),e.items)}u||s.items.length===e.items.length||(s.items=e.items)})),s.onDidChangeActive((()=>{if(null!=t.command||0===s.activeItems.length)return;const e=s.activeItems[0];(0,st.YB)(e)&&(s.buttons=this.getButtons(void 0,e))})),s.onDidChangeSelection((t=>{s.canSelectMany&&(0===t.length||s.ignoreFocusOut?0===t?.length&&s.ignoreFocusOut&&!i&&(s.ignoreFocusOut=i,e.ignoreFocusOut=r):(s.ignoreFocusOut=!0,e.ignoreFocusOut=!0))})),s.onDidAccept((async()=>{let i=s.selectedItems;if(0===i.length){if(!s.canSelectMany||0===s.activeItems.length){const i=s.value.trim();if(0===i.length&&!e.allowEmpty)return;return null==e.onDidAccept?void(e.allowEmpty&&o(await this.nextStep(t.command,[],s))):(s.busy=!0,await e.onDidAccept(s)&&o(await this.nextStep(t.command,i,s)),void(s.busy=!1))}i=s.activeItems}if(1===i.length){const[e]=i;if((0,Re.Gy)(e))switch(e.directive){case Re.Xe.Cancel:return void o(void 0);case Re.Xe.Back:return void a();case Re.Xe.LoadMore:return void c();case Re.Xe.StartPreviewTrial:return Ae.W.instance.subscription.startPreviewTrial(),void o(void 0);case Re.Xe.RequiresVerification:return Ae.W.instance.subscription.resendVerification(),void o(void 0);case Re.Xe.ExtendTrial:return Ae.W.instance.subscription.loginOrSignUp(),void o(void 0);case Re.Xe.RequiresPaidSubscription:return Ae.W.instance.subscription.purchase(),void o(void 0)}}if(null==t.command){const[e]=i;if(!(0,st.YB)(e))return;t.setCommand(e,this.startedWith)}if(!s.canSelectMany&&null!=e.onDidAccept){s.busy=!0;const t=await e.onDidAccept(s);if(s.busy=!1,!t)return}o(await this.nextStep(t.command,i,s))}))),s.title=e.title,s.placeholder=e.placeholder,s.matchOnDescription=Boolean(e.matchOnDescription),s.matchOnDetail=Boolean(e.matchOnDetail),s.canSelectMany=Boolean(e.multiselect),s.items=e.items,s.canSelectMany?(s.selectedItems=e.selectedItems??s.items.filter((e=>e.picked)),s.activeItems=s.selectedItems):s.activeItems=e.selectedItems??s.items.filter((e=>e.picked)),null!=t.command&&e===t&&t.setCommand(void 0,"menu"),s.buttons=this.getButtons(e,t.command);const d=e.selectValueWhenShown??!0;if(null!=e.value&&d&&(s.value=e.value),s.show(),null==e.value||d||(s.value=e.value),null!=e.value&&d)try{s._onDidChangeValueEmitter?.fire(s.value)}catch{}}))}finally{s.dispose(),n.forEach((e=>{e.dispose()}))}}};at([(0,it.cM)({args:!1,scoped:!0,singleLine:!0,timed:!1})],ht.prototype,"execute",1),ht=at([(0,n.WD)()],ht);var ut=Object.defineProperty,dt=Object.getOwnPropertyDescriptor;let pt=class extends o.mY{constructor(e){super(r.Gh.InviteToLiveShare),this.container=e}static getMarkdownCommandArgs(e){const t=void 0===e||"string"==typeof e?{email:e}:e;return super.getMarkdownCommandArgsCore(r.Gh.InviteToLiveShare,t)}preExecute(e,t){return(0,o.Mg)(e)?((t={...t}).email=e.node.contributor.email,this.execute(t)):this.execute(t)}async execute(e){if(e?.email){const t=await this.container.vsls.getContact(e.email);if(null!=t)return t.invite()}return this.container.vsls.startSession()}};pt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?dt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ut(t,i,n),n})([(0,n.WD)()],pt);var mt=i(2540),gt=Object.defineProperty,ft=Object.getOwnPropertyDescriptor,wt=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?ft(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&gt(t,i,n),n};let vt=class extends o.mY{constructor(e){super(r.Gh.EnableDebugLogging),this.container=e}async execute(){await H.D.updateEffective("outputLevel",mt.M7.Debug)}};vt=wt([(0,n.WD)()],vt);let yt=class extends o.mY{constructor(e){super(r.Gh.DisableDebugLogging),this.container=e}async execute(){await H.D.updateEffective("outputLevel",mt.M7.Errors)}};yt=wt([(0,n.WD)()],yt);var bt=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor;let At=class extends o.pu{constructor(e){super(r.Gh.OpenAssociatedPullRequestOnRemote),this.container=e}async execute(e,t){const i=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0;if(null==e||null==i)try{const e=await(0,y.vJ)("Open Pull Request Associated",void 0,{filter:async e=>null!=(await this.container.git.getBestRemoteWithRichProvider(e.uri))?.provider});if(null==e)return;const t=await this.container.git.getBestRemoteWithRichProvider(e.uri);if(null==t?.provider)return;const i=await e.getBranch();if(null==i)return;let s=await this.container.git.getPullRequestForBranch(i.ref,t.provider);if(null==s){const i=await e.getCommit("HEAD");if(null==i)return;if(s=await this.container.git.getPullRequestForCommit(i.ref,t.provider),null==s)return}await(0,n.P0)(r.Gh.OpenPullRequestOnRemote,{pr:{url:s.url}})}catch(e){d.Yd.error(e,"OpenAssociatedPullRequestOnRemoteCommand","No editor opened")}else{const t=e.selection.active.line;if(t<0)return;try{const e=await this.container.git.getBlameForLine(i,t);if(null==e)return;await(0,n.P0)(r.Gh.OpenPullRequestOnRemote,{clipboard:!1,ref:e.commit.sha,repoPath:e.commit.repoPath})}catch(e){d.Yd.error(e,"OpenAssociatedPullRequestOnRemoteCommand",`getBlameForLine(${t})`)}}}};At=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ct(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&bt(t,i,n),n})([(0,n.WD)()],At);var Pt=Object.defineProperty,St=Object.getOwnPropertyDescriptor;let Rt=class extends o.pu{constructor(e){super([r.Gh.OpenBranchesOnRemote,r.Gh.Deprecated_OpenBranchesInRemote,r.Gh.CopyRemoteBranchesUrl]),this.container=e}preExecute(e,t){return(0,o.C$)(e)&&(t={...t,remote:e.node.remote.name}),e.command===r.Gh.CopyRemoteBranchesUrl&&(t={...t,clipboard:!0}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){const s=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,a=(await(0,y.hM)(s,e,i?.clipboard?"Copy Remote Branches URL":"Open Branches on Remote"))?.path;if(a)try{await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Branches},repoPath:a,remote:i?.remote,clipboard:i?.clipboard})}catch(e){d.Yd.error(e,"OpenBranchesOnRemoteCommand"),(0,u.W8)("Unable to open branches on remote provider")}}};Rt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?St(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Pt(t,i,n),n})([(0,n.WD)()],Rt);var Dt=Object.defineProperty,kt=Object.getOwnPropertyDescriptor;let _t=class extends o.pu{constructor(e){super([r.Gh.OpenBranchOnRemote,r.Gh.Deprecated_OpenBranchInRemote,r.Gh.CopyRemoteBranchUrl]),this.container=e}preExecute(e,t){return(0,o.Qo)(e)&&(t={...t,branch:e.node.branch.name,remote:e.node.branch.getRemoteName()}),e.command===r.Gh.CopyRemoteBranchUrl&&(t={...t,clipboard:!0}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){const s=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,a=(await(0,y.hM)(s,e,i?.clipboard?"Copy Remote Branch URL":"Open Branch On Remote"))?.path;if(a){i={...i};try{if(null==i.branch){const e=await(0,ee.V)(a,i.clipboard?"Copy Remote Branch URL":"Open Branch On Remote",i.clipboard?"Choose a branch to copy the URL from":"Choose a branch to open",{autoPick:!0,filter:{branches:e=>null!=e.upstream},include:ee.H.Branches,sort:{branches:{current:!0},tags:{}}});if(null==e||e instanceof Se.$w)return;i.branch=e.ref}await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Branch,branch:i.branch||"HEAD"},repoPath:a,remote:i.remote,clipboard:i.clipboard})}catch(e){d.Yd.error(e,"OpenBranchOnRemoteCommand"),(0,u.W8)("Unable to open branch on remote provider")}}}};_t=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?kt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Dt(t,i,n),n})([(0,n.WD)()],_t);var Tt=Object.defineProperty,Ft=Object.getOwnPropertyDescriptor;let Et=class extends o.pu{constructor(e){super(r.Gh.OpenCurrentBranchOnRemote),this.container=e}async execute(e,t){const i=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,s=await(0,y.hM)(i,e,"Open Current Branch Name");if(null!=s)try{const e=await s.getBranch();e?.name&&await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Branch,branch:e.name||"HEAD"},repoPath:s.path})}catch(e){d.Yd.error(e,"OpenCurrentBranchOnRemoteCommand"),(0,u.W8)("Unable to open branch on remote provider")}}};Et=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ft(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Tt(t,i,n),n})([(0,n.WD)()],Et);var $t=Object.defineProperty,Ot=Object.getOwnPropertyDescriptor;let xt=class extends o.mY{constructor(e){super(r.Gh.OpenChangedFiles),this.container=e}async execute(e){e={...e};try{if(null==e.uris){const t=await(0,y.vJ)("Open All Changed Files");if(null==t)return;const i=await this.container.git.getStatusForRepo(t.uri);if(null==i)return void v.window.showWarningMessage("Unable to open changed files");e.uris=(0,Ue.DZ)(i.files,(e=>"D"!==e.status?e.uri:void 0))}(0,m.$_)(e.uris)}catch(e){d.Yd.error(e,"OpenChangedFilesCommand"),(0,u.W8)("Unable to open all changed files")}}};xt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ot(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&$t(t,i,n),n})([(0,n.WD)()],xt);var It=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor;let Wt=class extends o.pu{constructor(e){super([r.Gh.OpenCommitOnRemote,r.Gh.Deprecated_OpenCommitInRemote,r.Gh.CopyRemoteCommitUrl]),this.container=e}static getMarkdownCommandArgs(e){const t="string"==typeof e?{sha:e}:e;return super.getMarkdownCommandArgsCore(r.Gh.OpenCommitOnRemote,t)}preExecute(e,t){let i=e.uri;if("editorLine"===e.type&&(t={...t,line:e.line}),(0,o.en)(e)){if(e.node.commit.isUncommitted)return Promise.resolve(void 0);t={...t,sha:e.node.commit.sha},i=e.node.uri}return(0,o.jT)(e)&&(t={sha:e.item.ref},i=e.uri),e.command===r.Gh.CopyRemoteCommitUrl&&(t={...t,clipboard:!0}),this.execute(e.editor,i,t)}async execute(e,t,i){let s=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0;const a=(await(0,y.hM)(s,e,i?.clipboard?"Copy Remote Commit URL":"Open Commit On Remote"))?.path;if(a){null==s&&(s=h.YY.fromRepoPath(a)),i={...i};try{if(null==i.sha){const t=i.line??e?.selection.active.line;if(null==t)return;const r=await this.container.git.getBlameForLine(s,t,e?.document);if(null==r)return void(0,u.zk)("Unable to open commit on remote provider");i.sha=r.commit.isUncommitted?await r.commit.getPreviousSha()??ce.Ii:r.commit.sha}await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Commit,sha:i.sha},repoPath:a,clipboard:i.clipboard})}catch(e){d.Yd.error(e,"OpenCommitOnRemoteCommand"),(0,u.W8)("Unable to open commit on remote provider")}}}};Wt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Bt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&It(t,i,n),n})([(0,n.WD)()],Wt);var Lt=i(5988),Mt=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor;let Nt=class extends o.mY{constructor(e){super([r.Gh.OpenComparisonOnRemote,r.Gh.CopyRemoteComparisonUrl]),this.container=e}preExecute(e,t){return"viewItem"===e.type&&e.node instanceof Lt.J&&(t={...t,repoPath:e.node.repoPath,ref1:e.node.ref1,ref2:e.node.ref2}),e.command===r.Gh.CopyRemoteBranchesUrl&&(t={...t,clipboard:!0}),this.execute(t)}async execute(e){if(null!=e?.repoPath&&null!=e.ref1&&null!=e.ref2)try{await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Comparison,base:e.ref1,compare:e.ref2,notation:e.notation},repoPath:e.repoPath,clipboard:e?.clipboard})}catch(e){d.Yd.error(e,"OpenComparisonOnRemoteCommand"),(0,u.W8)("Unable to open comparison on remote provider")}}};Nt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ut(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Mt(t,i,n),n})([(0,n.WD)()],Nt);var Gt=Object.defineProperty,Ht=Object.getOwnPropertyDescriptor;let Vt=class extends o.mY{constructor(e){super(r.Gh.OpenFileFromRemote),this.container=e}async execute(){let e=await v.env.clipboard.readText();try{v.Uri.parse(e,!0)}catch{e=void 0}const t=await v.window.showInputBox({prompt:"Enter a remote file url to open",placeHolder:"Remote file url",value:e,ignoreFocusOut:!0});if(null==t||0===t.length)return;let i,r=await this.container.git.getLocalInfoFromRemoteUri(v.Uri.parse(t));if(null==r){if(r=await this.container.git.getLocalInfoFromRemoteUri(v.Uri.parse(t),{validate:!1}),null==r)return void v.window.showWarningMessage("Unable to parse the provided remote url.");const e="Open File...";if(await v.window.showWarningMessage("Unable to find a workspace folder that matches the provided remote url.",e)!==e)return}r.startLine&&(i=r.endLine?new v.Range(r.startLine-1,0,r.endLine,0):new v.Range(r.startLine-1,0,r.startLine-1,0));try{await(0,m.bM)(r.uri,{selection:i,rethrow:!0})}catch{const e=await v.window.showOpenDialog({title:"Open local file",defaultUri:r.uri,canSelectMany:!1,canSelectFolders:!1});if(null==e||0===e.length)return;await(0,m.bM)(e[0])}}};Vt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ht(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Gt(t,i,n),n})([(0,n.WD)()],Vt);var qt=i(6586),Qt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor;let jt=class extends o.pu{constructor(e){super([r.Gh.OpenFileOnRemote,r.Gh.Deprecated_OpenFileInRemote,r.Gh.CopyRemoteFileUrl,r.Gh.CopyRemoteFileUrlWithoutRange,r.Gh.OpenFileOnRemoteFrom,r.Gh.CopyRemoteFileUrlFrom]),this.container=e}async preExecute(e,t){let i=e.uri;if("editorLine"===e.type&&(t={...t,line:e.line,range:!0}),e.command===r.Gh.CopyRemoteFileUrlWithoutRange&&(t={...t,range:!1}),(0,o.en)(e)?(t={...t,range:!1},e.command===r.Gh.CopyRemoteFileUrl||e.command===r.Gh.CopyRemoteFileUrlWithoutRange||e.command===r.Gh.CopyRemoteFileUrlFrom?t.sha=e.node instanceof qt.q?void 0:e.node.commit.sha:(0,o.Qo)(e)&&(t.branchOrTag=e.node.branch?.name),i=e.node.uri):"viewItem"===e.type&&(t={...t,range:!1},i=e.node.uri??e.uri),(e.command===r.Gh.CopyRemoteFileUrl||e.command===r.Gh.CopyRemoteFileUrlWithoutRange||e.command===r.Gh.CopyRemoteFileUrlFrom)&&null==(t={...t,clipboard:!0}).sha){const i=(0,o.SX)(e.uri,e.editor);if(null!=i){const e=await h.YY.fromUri(i);if(e.repoPath)if(null==e.sha){const i=await this.container.git.getCommitForFile(e.repoPath,e,{firstIfNotFound:!0});null!=i&&(t.sha=i.sha)}else t.sha=e.sha}}return e.command!==r.Gh.OpenFileOnRemoteFrom&&e.command!==r.Gh.CopyRemoteFileUrlFrom||(t={...t,pickBranchOrTag:!0,range:!1}),this.execute(e.editor,i,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);if(s.repoPath){i={range:!0,...i};try{let o,a=await this.container.git.getRemotesWithProviders(s.repoPath);i.range&&(null!=e&&b.n.equals(e.document.uri,t)?o=new v.Range(e.selection.start.with({line:e.selection.start.line+1}),e.selection.end.with({line:e.selection.end.line+(0===e.selection.end.character?0:1)})):null!=i.line&&(o=new v.Range(i.line+1,0,i.line+1,0)));let c=i.sha??s.sha;if(null==i.branchOrTag&&null!=c&&!(0,G.D3)(c)&&0!==a.length){const[e,t]=(0,_e.pW)(c,"/");if(null!=t){const r=a.find((t=>t.name===e));null!=r&&(i.branchOrTag=t,c=void 0,a=[r])}}if(null==i.sha&&null==i.branchOrTag||i.pickBranchOrTag){let e;if(i.pickBranchOrTag||(e=await this.container.git.getBranch(s.repoPath)),null==e?.upstream){const e=await(0,ee.V)(s.repoPath,i.clipboard?`Copy Remote File URL From${(0,_e.vk)(r.NE.Dot,2,2)}${s.relativePath}`:`Open File on Remote From${(0,_e.vk)(r.NE.Dot,2,2)}${s.relativePath}`,`Choose a branch or tag to ${i.clipboard?"copy":"open"} the file revision from`,{allowEnteringRefs:!0,autoPick:!0,filter:{branches:e=>e.remote||null!=e.upstream},picked:i.branchOrTag,sort:{branches:{current:!0,orderBy:mt.Vz.DateDesc},tags:{orderBy:mt.RV.DateDesc}}});if(null==e)return;if("branch"===e.refType){if(e.remote){i.branchOrTag=(0,F.S3)(e.name);const t=(0,F.Lo)(e.name),r=a.find((e=>e.name===t));null!=r&&(a=[r])}else i.branchOrTag=e.name;c=void 0}else"tag"===e.refType?(i.branchOrTag=e.ref,c=void 0):(i.branchOrTag=void 0,c=e.ref)}else i.branchOrTag=e.name}await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:null==c?K.J.File:K.J.Revision,branchOrTag:i.branchOrTag??"HEAD",fileName:s.relativePath,range:o,sha:c??void 0},repoPath:s.repoPath,remotes:a,clipboard:i.clipboard})}catch(e){d.Yd.error(e,"OpenFileOnRemoteCommand"),(0,u.W8)("Unable to open file on remote provider")}}}};jt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Yt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Qt(t,i,n),n})([(0,n.WD)()],jt);var zt=Object.defineProperty,Kt=Object.getOwnPropertyDescriptor;let Jt=class extends o.pu{constructor(e){super([r.Gh.OpenFileAtRevision,r.Gh.OpenBlamePriorToChange]),this.container=e}static getMarkdownCommandArgs(e,t,i){let s;if(e instanceof v.Uri){s={revisionUri:e,line:i,annotationType:t}}else s=e;return super.getMarkdownCommandArgsCore(r.Gh.OpenFileAtRevision,s)}async preExecute(e,t){if(e.command===r.Gh.OpenBlamePriorToChange){if(null==(t={...t,annotationType:mt.VP.Blame}).revisionUri&&null!=e.editor){const i=e.editor.selection.active.line;if(i>=0)try{const r=await h.YY.fromUri(e.editor.document.uri),s=await this.container.git.getBlameForLine(r,i);if(null!=s)if(s.commit.isUncommitted){const e=await s.commit.getPreviousComparisonUrisForLine(i);if(null==e?.previous)return void(0,u.RR)(s.commit);t.revisionUri=this.container.git.getRevisionUri(e.previous)}else{if(null==(null!=s?await(s?.commit.getPreviousSha()):void 0))return void(0,u.RR)(s.commit);t.revisionUri=this.container.git.getRevisionUri(s.commit.getGitUri(!0))}}catch(e){d.Yd.error(e,"OpenBlamePriorToChangeCommand")}}if(null==t.revisionUri)return void(0,u.W8)("Unable to open blame")}return this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);null==(i={...i}).line&&(i.line=e?.selection.active.line??0);try{if(null==i.revisionUri){const e=this.container.git.getLogForFile(s.repoPath,s.fsPath).then((e=>e??(s.sha?this.container.git.getLogForFile(s.repoPath,s.fsPath,{ref:s.sha}):void 0))),t=`Open ${i.annotationType===mt.VP.Blame?"Blame":"File"} at Revision${(0,_e.vk)(r.NE.Dot,2,2)}`,n=await De(e,`${t}${s.getFormattedFileName({suffix:s.sha?`:${(0,G.zL)(s.sha)}`:void 0,truncateTo:r.d$-t.length})}`,`Choose a commit to ${i.annotationType===mt.VP.Blame?"blame":"open"} the file revision from`,{picked:s.sha,keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{await(0,W.YS)(t.item.file,t.item,{annotationType:i.annotationType,line:i.line,preserveFocus:!0,preview:!1})},showOtherReferences:[Se.$w.fromCommand("Choose a Branch or Tag...",r.Gh.OpenFileAtRevisionFrom),Se.$w.fromCommand("Choose a Stash...",r.Gh.OpenFileAtRevisionFrom,{stash:!0})]});if(null==n?.file)return;return void await(0,W.YS)(n.file,n,{annotationType:i.annotationType,line:i.line,...i.showOptions})}await(0,W.YS)(i.revisionUri,{annotationType:i.annotationType,line:i.line,...i.showOptions})}catch(e){d.Yd.error(e,"OpenFileAtRevisionCommand"),(0,u.W8)("Unable to open file at revision")}}};Jt=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Kt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&zt(t,i,n),n})([(0,n.WD)()],Jt);var Xt=Object.defineProperty,Zt=Object.getOwnPropertyDescriptor;let ei=class extends o.pu{constructor(e){super(r.Gh.OpenFileAtRevisionFrom),this.container=e}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const s=await h.YY.fromUri(t);if(s.repoPath){if(null==(i={...i}).line&&(i.line=e?.selection.active.line??0),null==i.reference)if(i?.stash){const e=this.container.git.getRelativePath(s,s.repoPath),t=`Open Changes with Stash${(0,_e.vk)(r.NE.Dot,2,2)}`,n=await ke(this.container.git.getStash(s.repoPath),`${t}${s.getFormattedFileName({truncateTo:r.d$-t.length})}`,"Choose a stash to compare with",{filter:t=>t.files?.some((t=>t.path===e||t.originalPath===e))??!0});if(null==n)return;i.reference=n}else{const e=`Open File at Branch or Tag${(0,_e.vk)(r.NE.Dot,2,2)}`,t=await(0,ee.V)(s.repoPath,`${e}${s.getFormattedFileName({truncateTo:r.d$-e.length})}`,"Choose a branch or tag to open the file revision from",{allowEnteringRefs:!0,keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{const[r]=t.activeItems;null!=r&&await(0,W.YS)(this.container.git.getRevisionUri(r.ref,s.fsPath,s.repoPath),{annotationType:i.annotationType,line:i.line,preserveFocus:!0,preview:!1})}});if(null==t)return;i.reference=t}await(0,W.YS)(this.container.git.getRevisionUri(i.reference.ref,s.fsPath,s.repoPath),{annotationType:i.annotationType,line:i.line,...i.showOptions})}else(0,u.bi)("Unable to open file revision")}};ei=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Zt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Xt(t,i,n),n})([(0,n.WD)()],ei);var ti=i(3050),ii=i(5009),ri=Object.defineProperty,si=Object.getOwnPropertyDescriptor;let ni=class extends o.mY{constructor(e){super([r.Gh.OpenOnRemote,r.Gh.Deprecated_OpenInRemote]),this.container=e}async execute(e){if(null==e?.resource)return;let t="remotes"in e?e.remotes:await this.container.git.getRemotesWithProviders(e.repoPath);if(null!=e.remote){const i=t.filter((t=>t.name===e.remote));t.length>0&&(t=i)}try{let i=function(t){return e?.clipboard?`Copy Link to ${t} for ${n}`:`Open ${t} on ${n}`};if(e.resource.type===K.J.Branch){const[i,r]=(0,_e.pW)(e.resource.branch,"/");if(null!=r){const s=t.find((e=>e.name===i));null!=s&&(e.resource.branch=r,t=[s])}}else if(e.resource.type===K.J.Revision){const{commit:t,fileName:i}=e.resource;if(null!=t){const r=await t.findFile(i);e.resource.sha="D"===r?.status?await this.container.git.resolveReference(t.repoPath,`${t.sha}^`,i):t.sha}}const s=ti.ss.getHighlanderProviders(t),n=s?.length?s[0].name:"Remote",o={autoPick:"default",clipboard:e.clipboard,setDefault:!0};let a,c="Choose which remote to "+(e.clipboard?"copy the link for":"open on");switch(e.resource.type){case K.J.Branch:a=`${i("Branch")}${(0,_e.vk)(r.NE.Dot,2,2)}${e.resource.branch}`;break;case K.J.Branches:a=i("Branches");break;case K.J.Commit:a=`${i("Commit")}${(0,_e.vk)(r.NE.Dot,2,2)}${(0,G.zL)(e.resource.sha)}`;break;case K.J.Comparison:a=`${i("Comparison")}${(0,_e.vk)(r.NE.Dot,2,2)}${(0,G.oI)(e.resource.base,e.resource.compare,e.resource.notation??"...")}`;break;case K.J.CreatePullRequest:o.autoPick=!0,o.setDefault=!1,a=`${e.clipboard?`Copy Create Pull Request Link for ${n}`:`Create Pull Request on ${n}`}${(0,_e.vk)(r.NE.Dot,2,2)}${e.resource.base?.branch?(0,G.oI)(e.resource.base.branch,e.resource.compare.branch,"..."):e.resource.compare.branch}`,c="Choose which remote to "+(e.clipboard?"copy the create pull request link for":"create the pull request on");break;case K.J.File:a=`${i("File")}${(0,_e.vk)(r.NE.Dot,2,2)}${e.resource.fileName}`;break;case K.J.Repo:a=i("Repository");break;case K.J.Revision:a=`${i("File")}${(0,_e.vk)(r.NE.Dot,2,2)}${(0,G.zL)(e.resource.sha)}${(0,_e.vk)(r.NE.Dot,1,1)}${e.resource.fileName}`}const l=await(0,ii.cY)(a,c,e.resource,t,o);await(l?.execute())}catch(e){d.Yd.error(e,"OpenOnRemoteCommand"),(0,u.W8)("Unable to open in remote provider")}}};ni=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?si(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ri(t,i,n),n})([(0,n.WD)()],ni);var oi=i(2610),ai=Object.defineProperty,ci=Object.getOwnPropertyDescriptor;let li=class extends o.mY{constructor(e){super([r.Gh.OpenIssueOnRemote,r.Gh.CopyRemoteIssueUrl,r.Gh.OpenAutolinkUrl,r.Gh.CopyAutolinkUrl]),this.container=e}preExecute(e,t){return"viewItem"===e.type&&e.node instanceof oi.Z&&(t={...t,issue:{url:e.node.item.url},clipboard:e.command===r.Gh.CopyRemoteIssueUrl||e.command===r.Gh.CopyAutolinkUrl}),this.execute(t)}async execute(e){e.clipboard?await v.env.clipboard.writeText(e.issue.url):v.env.openExternal(v.Uri.parse(e.issue.url))}};li=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?ci(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ai(t,i,n),n})([(0,n.WD)()],li);var hi=i(2060),ui=Object.defineProperty,di=Object.getOwnPropertyDescriptor;let pi=class extends o.mY{constructor(e){super([r.Gh.OpenPullRequestOnRemote,r.Gh.CopyRemotePullRequestUrl]),this.container=e}preExecute(e,t){return"viewItem"===e.type&&e.node instanceof hi.Z&&(t={...t,pr:{url:e.node.pullRequest.url},clipboard:e.command===r.Gh.CopyRemotePullRequestUrl}),this.execute(t)}async execute(e){if(null==e?.pr){if(null==e?.repoPath||null==e?.ref)return;const t=await this.container.git.getBestRemoteWithRichProvider(e.repoPath);if(null==t?.provider)return;const i=await this.container.git.getPullRequestForCommit(e.ref,t.provider);if(null==i)return;(e={...e}).pr=i}e.clipboard?await v.env.clipboard.writeText(e.pr.url):v.env.openExternal(v.Uri.parse(e.pr.url))}};pi=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?di(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ui(t,i,n),n})([(0,n.WD)()],pi);var mi=Object.defineProperty,gi=Object.getOwnPropertyDescriptor;let fi=class extends o.pu{constructor(e){super([r.Gh.OpenRepoOnRemote,r.Gh.Deprecated_OpenRepoInRemote,r.Gh.CopyRemoteRepositoryUrl]),this.container=e}preExecute(e,t){return(0,o.C$)(e)&&(t={...t,remote:e.node.remote.name}),e.command===r.Gh.CopyRemoteRepositoryUrl&&(t={...t,clipboard:!0}),this.execute(e.editor,e.uri,t)}async execute(e,t,i){const s=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,a=(await(0,y.hM)(s,e,i?.clipboard?"Choose which repository to copy the url from":"Choose which repository to open on remote"))?.path;if(a)try{await(0,n.P0)(r.Gh.OpenOnRemote,{resource:{type:K.J.Repo},repoPath:a,remote:i?.remote,clipboard:i?.clipboard})}catch(e){d.Yd.error(e,"OpenRepoOnRemoteCommand"),(0,u.W8)("Unable to open repository on remote provider")}}};fi=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?gi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&mi(t,i,n),n})([(0,n.WD)()],fi);var wi=Object.defineProperty,vi=Object.getOwnPropertyDescriptor;let yi=class extends o.pu{constructor(e){super([r.Gh.OpenRevisionFile,r.Gh.OpenRevisionFileInDiffLeft,r.Gh.OpenRevisionFileInDiffRight]),this.container=e}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const r=await h.YY.fromUri(t);null==(i={...i}).line&&(i.line=e?.selection.active.line??0);try{if(null==i.revisionUri)if(r?.sha){const e=await this.container.git.getCommit(r.repoPath,r.sha);i.revisionUri="D"===e?.file?.status?this.container.git.getRevisionUri(await e.getPreviousSha()??ce.Ii,e.file,e.repoPath):this.container.git.getRevisionUri(r)}else i.revisionUri=this.container.git.getRevisionUri(r);await(0,W.YS)(i.revisionUri,{annotationType:i.annotationType,line:i.line,...i.showOptions})}catch(e){d.Yd.error(e,"OpenRevisionFileCommand"),(0,u.W8)("Unable to open file revision")}}};yi=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?vi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&wi(t,i,n),n})([(0,n.WD)()],yi);var bi=Object.defineProperty,Ci=Object.getOwnPropertyDescriptor;let Ai=class extends o.pu{constructor(e){super([r.Gh.OpenWorkingFile,r.Gh.OpenWorkingFileInDiffLeft,r.Gh.OpenWorkingFileInDiffRight]),this.container=e}async execute(e,t,i){null==(i={...i}).line&&(i.line=e?.selection.active.line);try{if(null==i.uri){if(null==(t=(0,o.SX)(t,e)))return}else t=i.uri;if(i.uri=await h.YY.fromUri(t),(0,h.uy)(i.uri)&&i.uri.sha){const e=await this.container.git.getWorkingUri(i.uri.repoPath,i.uri);if(void 0===e)return void v.window.showWarningMessage("Unable to open working file. File could not be found in the working tree");i.uri=new h.YY(e,i.uri.repoPath)}void 0!==i.line&&0!==i.line&&(void 0===i.showOptions&&(i.showOptions={}),i.showOptions.selection=new v.Range(i.line,0,i.line,0));const r=await(0,m.GR)(i.uri,{...i.showOptions,throwOnError:!0});if(void 0===i.annotationType)return;await this.container.fileAnnotations.show(r,i.annotationType,{selection:{line:i.line}})}catch(e){d.Yd.error(e,"OpenWorkingFileCommand"),(0,u.W8)("Unable to open working file")}}};Ai=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ci(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&bi(t,i,n),n})([(0,n.WD)()],Ai);var Pi=Object.defineProperty,Si=Object.getOwnPropertyDescriptor,Ri=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Si(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Pi(t,i,n),n};let Di=class extends o.mY{constructor(e){super(r.Gh.DisableRebaseEditor),this.container=e}execute(){return this.container.rebaseEditor.setEnabled(!1)}};Di=Ri([(0,n.WD)()],Di);let ki=class extends o.mY{constructor(e){super(r.Gh.EnableRebaseEditor),this.container=e}execute(){return this.container.rebaseEditor.setEnabled(!0)}};ki=Ri([(0,n.WD)()],ki);var _i=Object.defineProperty,Ti=Object.getOwnPropertyDescriptor;let Fi=class extends o.mY{constructor(e){super(r.Gh.RefreshHover),this.container=e}async execute(){await(0,n.dO)("editor.action.showHover")}};Fi=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ti(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&_i(t,i,n),n})([(0,n.WD)()],Fi);var Ei=Object.defineProperty,$i=Object.getOwnPropertyDescriptor,Oi=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?$i(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ei(t,i,n),n};let xi=class extends o.mY{constructor(e){super(r.Gh.ConnectRemoteProvider),this.container=e}static getMarkdownCommandArgs(e){let t;return t=ti.ss.is(e)?{remote:e.id,repoPath:e.repoPath}:e,super.getMarkdownCommandArgsCore(r.Gh.ConnectRemoteProvider,t)}preExecute(e,t){return(0,o.C$)(e)&&(t={...t,remote:e.node.remote.id,repoPath:e.node.remote.repoPath}),this.execute(t)}async execute(e){let t,i,r;if(null==e?.repoPath){const e=new Map;for(const t of this.container.git.openRepositories){const i=await t.getRichRemote();null==i?.provider||await i.provider.isConnected()||e.set(t,i)}if(0===e.size)return!1;if(1===e.size){let i;[i,t]=(0,L.Ps)(e),r=i.path}else{const i=await(0,y.E2)(void 0,"Choose which repository to connect to the remote provider",[...e.keys()]);if(null==i?.item)return;r=i.repoPath,t=e.get(i.item)}}else if(null==e?.remote){if(r=e.repoPath,t=await this.container.git.getBestRemoteWithRichProvider(r,{includeDisconnected:!0}),null==t)return!1}else if(r=e.repoPath,i=await this.container.git.getRemotesWithProviders(r),t=i.find((t=>t.id===e.remote)),!t?.hasRichProvider())return!1;const s=await t.provider.connect();return s&&!(i??await this.container.git.getRemotesWithProviders(r)).some((e=>e.default))&&await t.setAsDefault(!0),s}};xi=Oi([(0,n.WD)()],xi);let Ii=class extends o.mY{constructor(e){super(r.Gh.DisconnectRemoteProvider),this.container=e}static getMarkdownCommandArgs(e){let t;return t=ti.ss.is(e)?{remote:e.id,repoPath:e.repoPath}:e,super.getMarkdownCommandArgsCore(r.Gh.DisconnectRemoteProvider,t)}preExecute(e,t){return(0,o.C$)(e)&&(t={...t,remote:e.node.remote.id,repoPath:e.node.remote.repoPath}),this.execute(t)}async execute(e){let t,i;if(null==e?.repoPath){const e=new Map;for(const t of this.container.git.openRepositories){const i=await t.getRichRemote(!0);null!=i&&e.set(t,i)}if(0===e.size)return;if(1===e.size){let r;[r,t]=(0,L.Ps)(e),i=r.path}else{const r=await(0,y.E2)(void 0,"Choose which repository to disconnect from the remote provider",[...e.keys()]);if(null==r?.item)return;i=r.repoPath,t=e.get(r.item)}}else if(null==e?.remote){if(i=e.repoPath,t=await this.container.git.getBestRemoteWithRichProvider(i,{includeDisconnected:!1}),null==t)return}else if(i=e.repoPath,t=(await this.container.git.getRemotesWithProviders(i)).find((t=>t.id===e.remote)),!t?.hasRichProvider())return;return t.provider.disconnect()}};Ii=Oi([(0,n.WD)()],Ii);var Bi=Object.defineProperty,Wi=Object.getOwnPropertyDescriptor,Li=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Wi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Bi(t,i,n),n};let Mi=class extends o.mY{constructor(e){super(r.Gh.FetchRepositories),this.container=e}async execute(){return(0,s.m)({command:"fetch",state:{repos:this.container.git.openRepositories}})}};Mi=Li([(0,n.WD)()],Mi);let Ui=class extends o.mY{constructor(e){super(r.Gh.PullRepositories),this.container=e}async execute(){return(0,s.m)({command:"pull",state:{repos:this.container.git.openRepositories}})}};Ui=Li([(0,n.WD)()],Ui);let Ni=class extends o.mY{constructor(e){super(r.Gh.PushRepositories),this.container=e}async execute(){return(0,s.m)({command:"push",state:{repos:this.container.git.openRepositories}})}};Ni=Li([(0,n.WD)()],Ni);var Gi=i(8388),Hi=Object.defineProperty,Vi=Object.getOwnPropertyDescriptor,qi=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Vi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Hi(t,i,n),n};let Qi=class extends o.mY{constructor(e){super(r.Gh.ResetAvatarCache),this.container=e}execute(){(0,Gi.E3)("all")}};Qi=qi([(0,n.WD)()],Qi);let Yi=class extends o.mY{constructor(e){super(r.Gh.ResetSuppressedWarnings),this.container=e}async execute(){await H.D.update("advanced.messages",void 0,v.ConfigurationTarget.Global)}};Yi=qi([(0,n.WD)()],Yi);let ji=class extends o.mY{constructor(e){super(r.Gh.ResetTrackedUsage),this.container=e}async execute(){await this.container.usage.reset()}};ji=qi([(0,n.WD)()],ji);var zi=Object.defineProperty,Ki=Object.getOwnPropertyDescriptor;let Ji=class extends o.mY{constructor(e){super(r.Gh.ResetViewsLayout),this.container=e}async execute(){for(const[e,t]of r._h){try{await(0,n.dO)("vscode.moveViews",{viewIds:t.map((e=>`gitlens.views.${e}`)),destinationId:e})}catch{}e.includes("gitlens")&&await(0,n.dO)(`${e}.resetViewContainerLocation`)}}};Ji=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ki(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&zi(t,i,n),n})([(0,n.WD)()],Ji);var Xi=i(4655),Zi=Object.defineProperty,er=Object.getOwnPropertyDescriptor;let tr=class extends o.mY{constructor(e){super([r.Gh.SearchCommits,r.Gh.SearchCommitsInView]),this.container=e}preExecute(e,t){return e.command===r.Gh.SearchCommitsInView?(t={...t}).showResultsInSideBar=!0:"viewItem"===e.type&&((t={...t}).showResultsInSideBar=!0,e.node instanceof Xi.V&&(t.repoPath=e.node.repoPath,t.search=e.node.search,t.prefillOnly=!0),(0,o.pT)(e)&&(t.repoPath=e.node.repo.path)),this.execute(t)}async execute(e){await(0,s.m)({command:"search",prefillOnly:e?.prefillOnly,state:{repo:e?.repoPath,...e?.search,showResultsInSideBar:H.D.get("gitCommands.search.showResultsInSideBar")??e?.showResultsInSideBar,openPickInView:e?.openPickInView??!1}})}};tr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?er(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Zi(t,i,n),n})([(0,n.WD)()],tr);var ir=i(6934),rr=Object.defineProperty,sr=Object.getOwnPropertyDescriptor;let nr=class extends o.pu{constructor(e){super([r.Gh.ShowCommitInView,r.Gh.ShowInDetailsView,r.Gh.ShowCommitsInView]),this.container=e}static getMarkdownCommandArgs(e,t){const i="string"==typeof e?{refs:[e],repoPath:t}:e;return super.getMarkdownCommandArgsCore(r.Gh.ShowCommitInView,i)}preExecute(e,t){return"viewItem"===e.type&&(t={...t},(0,o.en)(e)&&(t.refs=[e.node.commit.sha],t.repoPath=e.node.commit.repoPath)),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(void 0===(i={...i}).refs){if(null==(t=(0,o.SX)(t,e)))return;const r=await h.YY.fromUri(t);if(i.repoPath=r.repoPath,null!=e)try{const t=e.document.isDirty?await this.container.git.getBlameForRangeContents(r,e.selection,e.document.getText()):await this.container.git.getBlameForRange(r,e.selection);if(void 0===t)return(0,u.zk)("Unable to find commits");i.refs=[...(0,L.DZ)(t.commits.values(),(e=>e.isUncommitted?void 0:e.ref))]}catch(e){return d.Yd.error(e,"ShowCommitsInViewCommand","getBlameForRange"),(0,u.W8)("Unable to find commits")}else{if(null==r.sha)return;i.refs=[r.sha]}}return 1===i.refs.length?(0,W.Fw)((0,G.xB)(i.refs[0],i.repoPath,{refType:"revision"})):(0,s.m)({command:"search",state:{repo:i?.repoPath,query:(0,ir.pU)(i.refs),showResultsInSideBar:!0}})}};nr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?sr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&rr(t,i,n),n})([(0,n.WD)()],nr);var or=Object.defineProperty,ar=Object.getOwnPropertyDescriptor;let cr=class extends o.mY{constructor(e){super(r.Gh.ShowLastQuickPick),this.container=e}execute(){const e=(0,o.l8)();if(void 0===e)return Promise.resolve(void 0);try{return v.commands.executeCommand(e.command,...e.args)}catch(e){return d.Yd.error(e,"ShowLastQuickPickCommand"),(0,u.W8)("Unable to show last quick pick")}}};cr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?ar(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&or(t,i,n),n})([(0,n.WD)()],cr);var lr=Object.defineProperty,hr=Object.getOwnPropertyDescriptor;let ur=class extends o.Lk{constructor(e){super([r.Gh.ShowQuickBranchHistory,r.Gh.ShowQuickCurrentBranchHistory]),this.container=e}preExecute(e,t){return e.command===r.Gh.ShowQuickCurrentBranchHistory&&((t={...t}).branch="HEAD"),this.execute(e.editor,e.uri,t)}async execute(e,t,i){const r=null!=(t=(0,o.SX)(t,e))?await h.YY.fromUri(t):void 0,n=i?.repoPath??r?.repoPath??this.container.git.highlander?.path;let a;return null!=n&&(null!=i?.branch?a="HEAD"===i.branch?"HEAD":(0,G.xB)(i.branch,n,{refType:"branch",name:i.branch,remote:!1}):null!=i?.tag&&(a=(0,G.xB)(i.tag,n,{refType:"tag",name:i.tag}))),(0,s.m)({command:"log",state:null!=n?{repo:n,reference:a}:{}})}};ur=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?hr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&lr(t,i,n),n})([(0,n.WD)()],ur);var dr=Object.defineProperty,pr=Object.getOwnPropertyDescriptor;let mr=class extends o.Lk{constructor(e){super([r.Gh.RevealCommitInView,r.Gh.ShowQuickCommit]),this.container=e}static getMarkdownCommandArgs(e,t){const i="string"==typeof e?{sha:e,repoPath:t}:e;return super.getMarkdownCommandArgsCore(r.Gh.ShowQuickCommit,i)}preExecute(e,t){return e.command===r.Gh.RevealCommitInView&&((t={...t}).revealInView=!0),"viewItem"===e.type&&((t={...t}).sha=e.node.uri.sha,(0,o.en)(e)&&(t.commit=e.node.commit)),this.execute(e.editor,e.uri,t)}async execute(e,t,i){let r,n;if(null==i?.commit)if(null!=i?.repoPath&&null!=i.sha)n=i.repoPath,r=h.YY.fromRepoPath(n);else{if(null==(t=(0,o.SX)(t,e)))return;r=await h.YY.fromUri(t),n=r.repoPath}else null==i.sha&&(i.sha=i.commit.sha),r=i.commit.getGitUri(),n=i.commit.repoPath,null==t&&(t=i.commit.file?.uri);if(null==(i={...i}).sha){if(null==e)return;const t=e.selection.active.line;if(t<0)return;try{const e=await this.container.git.getBlameForLine(r,t);if(null==e)return void(0,u.zk)("Unable to show commit");if(e.commit.isUncommitted)return void(0,u.f3)("Unable to show commit");i.sha=e.commit.sha,n=e.commit.repoPath,i.commit=e.commit}catch(e){return d.Yd.error(e,"ShowQuickCommitCommand",`getBlameForLine(${t})`),void(0,u.W8)("Unable to show commit")}}try{if(null!=i.commit&&null==i.commit.file||(null!=i.repoLog&&(i.commit=i.repoLog.commits.get(i.sha),null==i.commit&&(i.repoLog=void 0)),null==i.repoLog&&(i.commit=await this.container.git.getCommit(n,i.sha))),null==i.commit)return void(0,u.G)("Unable to show commit");if(i.revealInView)return void await(0,W.ay)(i.commit,{select:!0,focus:!0,expand:!0});await(0,s.m)({command:"show",state:{repo:n,reference:i.commit}})}catch(e){d.Yd.error(e,"ShowQuickCommitCommand"),(0,u.W8)("Unable to show commit")}}};mr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?pr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&dr(t,i,n),n})([(0,n.WD)()],mr);var gr=Object.defineProperty,fr=Object.getOwnPropertyDescriptor;let wr=class extends o.Lk{constructor(e){super([r.Gh.ShowQuickCommitFile,r.Gh.ShowQuickCommitRevision,r.Gh.ShowQuickCommitRevisionInDiffLeft,r.Gh.ShowQuickCommitRevisionInDiffRight,r.Gh.ShowLineCommitInView]),this.container=e}static getMarkdownCommandArgs(e){return super.getMarkdownCommandArgsCore(r.Gh.ShowQuickCommitFile,e)}async preExecute(e,t){if("editorLine"===e.type&&(t={...t,line:e.line}),e.command===r.Gh.ShowLineCommitInView&&(t={...t,inView:!0}),null!=e.editor&&e.command.startsWith(r.Gh.ShowQuickCommitRevision)){const i=await h.YY.fromUri(e.editor.document.uri);t={...t,sha:i.sha}}return"viewItem"===e.type&&(t={...t,sha:e.node.uri.sha},(0,o.en)(e)&&(t.commit=e.node.commit)),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;let a;if(null!=(i={...i}).revisionUri?(a=h.YY.fromRevisionUri(v.Uri.parse(i.revisionUri,!0)),i.sha=a.sha):a=await h.YY.fromUri(t),null==i.sha){const t=i.line??e?.selection.active.line;if(null==t)return;try{const e=await this.container.git.getBlameForLine(a,t);if(null==e)return void(0,u.zk)("Unable to show commit file details");if(e.commit.isUncommitted)return void(0,u.f3)("Unable to show commit file details");i.sha=e.commit.sha,i.commit=e.commit}catch(e){return d.Yd.error(e,"ShowQuickCommitFileDetailsCommand",`getBlameForLine(${t})`),void(0,u.W8)("Unable to show commit file details")}}try{if(null==i.commit&&(null!=i.fileLog&&(i.commit=i.fileLog.commits.get(i.sha),null==i.commit&&(i.fileLog=void 0)),null==i.fileLog)){const e=i.commit?.repoPath??a.repoPath;if(i.commit=await this.container.git.getCommitForFile(e,a,{ref:i.sha}),null==i.commit)return void(0,u.G)("Unable to show commit file details")}if(null==i.commit)return void(0,u.G)("Unable to show commit file details");const e=i.commit?.file?.path??a.fsPath;(0,de.f_)(i.commit)&&null==i.commit.files&&await i.commit.ensureFullDetails(),i.inView?await(0,n.P0)(r.Gh.ShowCommitsInView,{refs:[i.commit.sha],repoPath:i.commit.repoPath}):await(0,s.m)({command:"show",state:{repo:i.commit.repoPath,reference:i.commit,fileName:e}})}catch(e){d.Yd.error(e,"ShowQuickCommitFileDetailsCommand"),(0,u.W8)("Unable to show commit file details")}}};wr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?fr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&gr(t,i,n),n})([(0,n.WD)()],wr);var vr=Object.defineProperty,yr=Object.getOwnPropertyDescriptor;let br=class extends o.Lk{constructor(e){super([r.Gh.OpenFileHistory,r.Gh.OpenFolderHistory,r.Gh.ShowQuickFileHistory,r.Gh.QuickOpenFileHistory,r.Gh.Deprecated_ShowFileHistoryInView]),this.container=e}preExecute(e,t){return e.command!==r.Gh.OpenFileHistory&&e.command!==r.Gh.OpenFolderHistory&&e.command!==r.Gh.Deprecated_ShowFileHistoryInView||((t={...t}).showInSideBar=!0),this.execute(e.editor,e.uri,t)}async execute(e,t,i){if(null==(t=(0,o.SX)(t,e)))return;const r=await h.YY.fromUri(t);i?.showInSideBar?await this.container.fileHistoryView.showHistoryForUri(r):await(0,s.m)({command:"log",state:null!=r?.repoPath?{repo:r.repoPath,reference:i?.reference??"HEAD",fileName:r.relativePath}:{}})}};br=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?yr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&vr(t,i,n),n})([(0,n.WD)()],br);var Cr=Object.defineProperty,Ar=Object.getOwnPropertyDescriptor;let Pr=class extends o.mY{constructor(e){super(r.Gh.ShowQuickRepoStatus),this.container=e}async execute(e){return(0,s.m)({command:"status",state:{repo:e?.repoPath}})}};Pr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ar(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Cr(t,i,n),n})([(0,n.WD)()],Pr);var Sr=Object.defineProperty,Rr=Object.getOwnPropertyDescriptor;let Dr=class extends o.mY{constructor(e){super(r.Gh.ShowQuickStashList),this.container=e}execute(e){return(0,s.m)({command:"stash",state:{subcommand:"list",repo:e?.repoPath}})}};Dr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Rr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Sr(t,i,n),n})([(0,n.WD)()],Dr);var kr=Object.defineProperty,_r=Object.getOwnPropertyDescriptor;let Tr=class extends o.mY{constructor(e){super([r.Gh.ShowBranchesView,r.Gh.ShowCommitDetailsView,r.Gh.ShowCommitsView,r.Gh.ShowContributorsView,r.Gh.ShowFileHistoryView,r.Gh.ShowGraphView,r.Gh.ShowHomeView,r.Gh.ShowLineHistoryView,r.Gh.ShowRemotesView,r.Gh.ShowRepositoriesView,r.Gh.ShowSearchAndCompareView,r.Gh.ShowStashesView,r.Gh.ShowTagsView,r.Gh.ShowTimelineView,r.Gh.ShowWorktreesView,r.Gh.ShowWorkspacesView]),this.container=e}preExecute(e,...t){return this.execute(e,...t)}async execute(e,...t){switch(e.command){case r.Gh.ShowBranchesView:return this.container.branchesView.show();case r.Gh.ShowCommitDetailsView:return this.container.commitDetailsView.show();case r.Gh.ShowCommitsView:return this.container.commitsView.show();case r.Gh.ShowContributorsView:return this.container.contributorsView.show();case r.Gh.ShowFileHistoryView:return this.container.fileHistoryView.show();case r.Gh.ShowHomeView:return this.container.homeView.show();case r.Gh.ShowAccountView:return this.container.accountView.show();case r.Gh.ShowGraphView:{let i=t;if("scm"===e.type&&null!=e.scm?.rootUri){const r=this.container.git.getRepository(e.scm.rootUri);i=null!=r?[r,...t]:t}return this.container.graphView.show(void 0,...i)}case r.Gh.ShowLineHistoryView:return this.container.lineHistoryView.show();case r.Gh.ShowRemotesView:return this.container.remotesView.show();case r.Gh.ShowRepositoriesView:return this.container.repositoriesView.show();case r.Gh.ShowSearchAndCompareView:return this.container.searchAndCompareView.show();case r.Gh.ShowStashesView:return this.container.stashesView.show();case r.Gh.ShowTagsView:return this.container.tagsView.show();case r.Gh.ShowTimelineView:return this.container.timelineView.show();case r.Gh.ShowWorktreesView:return this.container.worktreesView.show();case r.Gh.ShowWorkspacesView:return this.container.workspacesView.show()}return Promise.resolve(void 0)}};Tr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?_r(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&kr(t,i,n),n})([(0,n.WD)()],Tr);var Fr=i(252),Er=Object.defineProperty,$r=Object.getOwnPropertyDescriptor;let Or=class extends o.mY{constructor(e){super(r.Gh.StashApply),this.container=e}async preExecute(e,t){return(0,o.en)(e)?(null==e.node.commit.message&&await e.node.commit.ensureFullDetails(),t={...t,stashItem:e.node.commit}):(0,o.pT)(e)&&(t={...t,repoPath:e.node.repo.path}),this.execute(t)}async execute(e){return e?.deleteAfter?(0,Fr.Sw)(e?.repoPath??e?.stashItem?.repoPath,e?.stashItem):(0,Fr.nn)(e?.repoPath??e?.stashItem?.repoPath,e?.stashItem)}};Or=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?$r(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Er(t,i,n),n})([(0,n.WD)()],Or);var xr=i(8887),Ir=Object.defineProperty,Br=Object.getOwnPropertyDescriptor;let Wr=class extends o.mY{constructor(e){super([r.Gh.StashSave,r.Gh.StashSaveFiles]),this.container=e}async preExecute(e,t){if((0,o.E9)(e))(t={...t}).repoPath=e.node.file.repoPath??e.node.repoPath,t.uris=[h.YY.fromFile(e.node.file,t.repoPath)];else if((0,o.pT)(e))(t={...t}).repoPath=e.node.repo.path;else if((0,o.l7)(e))(t={...t}).repoPath=e.node.repoPath;else if("scm-states"===e.type)(t={...t}).uris=e.scmResourceStates.map((e=>e.resourceUri)),t.repoPath=(await this.container.git.getOrOpenRepository(t.uris[0]))?.path,e.scmResourceStates.some((e=>e.resourceGroupType===Me.Index))||(t.keepStaged=!0);else if("scm-groups"===e.type){t={...t};let i=!0,r=!1;const s=e.scmResourceGroups.reduce(((e,t)=>{const s="index"===t.id;return i&&!s&&(i=!1),s&&(r=!0),e.concat(t.resourceStates.map((e=>e.resourceUri)))}),[]),n=await this.container.git.getOrOpenRepository(s[0]);let o=!1;i&&null!=n&&(o=await n.supports(xr.A.StashOnlyStaged)),o?(t.onlyStaged=!0,t.onlyStagedUris=s):(t.uris=s,t.repoPath=n?.path,r||(t.keepStaged=!0))}return this.execute(t)}execute(e){return(0,Fr.VF)(e?.repoPath,e?.uris,e?.message,e?.keepStaged,e?.onlyStaged,e?.onlyStagedUris)}};Wr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Br(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ir(t,i,n),n})([(0,n.WD)()],Wr);var Lr=Object.defineProperty,Mr=Object.getOwnPropertyDescriptor;let Ur=class extends o.mY{constructor(e){super(r.Gh.SwitchAIModel),this.container=e}async execute(){const e=await async function(){const e=H.D.get("ai.experimental.provider")??"openai";let t=H.D.get(`ai.experimental.${e}.model`);null==t&&(t="anthropic"===e?"claude-v1":"gpt-3.5-turbo");const i=[{label:"OpenAI",kind:v.QuickPickItemKind.Separator},{label:"OpenAI",description:"GPT 3.5 Turbo",provider:"openai",model:"gpt-3.5-turbo"},{label:"OpenAI",description:"GPT 3.5 Turbo 16k",provider:"openai",model:"gpt-3.5-turbo-16k"},{label:"OpenAI",description:"GPT 4",provider:"openai",model:"gpt-4"},{label:"OpenAI",description:"GPT 4 32k",provider:"openai",model:"gpt-4-32k"},{label:"Anthropic",kind:v.QuickPickItemKind.Separator},{label:"Anthropic",description:"Claude v1",provider:"anthropic",model:"claude-v1"},{label:"Anthropic",description:"Claude v1 100k",provider:"anthropic",model:"claude-v1-100k"},{label:"Anthropic",description:"Claude Instant v1",provider:"anthropic",model:"claude-instant-v1"},{label:"Anthropic",description:"Claude Instant v1 100k",provider:"anthropic",model:"claude-instant-v1-100k"},{label:"Anthropic",description:"Claude 2",provider:"anthropic",model:"claude-2"}];for(const e of i)if(e.kind!==v.QuickPickItemKind.Separator&&e.model===t){e.picked=!0;break}return await v.window.showQuickPick(i,{title:"Switch AI Model",placeHolder:"select an AI model to use for experimental AI features",matchOnDescription:!0})}();null!=e&&(await H.D.updateEffective("ai.experimental.provider",e.provider),await H.D.updateEffective(`ai.experimental.${e.provider}.model`,e.model))}};Ur=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Mr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Lr(t,i,n),n})([(0,n.WD)()],Ur);var Nr=i(6004),Gr=Object.defineProperty,Hr=Object.getOwnPropertyDescriptor,Vr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Hr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Gr(t,i,n),n};let qr=class extends o.mY{constructor(e){super(r.Gh.SwitchMode),this.container=e}async execute(){const e=(0,Nr.UH)(),t=await async function(){const e=H.D.get("modes");if(null==e)return;const t=Object.keys(e);if(0===t.length)return;const i=H.D.get("mode.active"),s=t.map((t=>{const s=e[t];return{label:`${i===t?"$(check)  ":"     "}${s.name} mode`,description:s.description?` ${r.NE.Dash}  ${s.description}`:"",key:t}}));return i&&null!=e[i]&&s.unshift({label:`Exit ${e[i].name} mode`,key:void 0}),await v.window.showQuickPick(s,{placeHolder:"select a GitLens mode to enter"})}();if(void 0===t)return;(0,Nr.lH)(e,` — mode=${t.key??""}`);const i=H.D.get("mode.active");if(i!==t.key){if(null!=i&&0!==i.length){const e=H.D.get("modes"),r=e?.[i].annotations;if(null!=r){r!==(null!=t.key?e?.[t.key].annotations:void 0)&&await this.container.fileAnnotations.clearAll()}}await H.D.update("mode.active",t.key,v.ConfigurationTarget.Global)}}};Vr([(0,it.cM)({args:!1,scoped:!0,singleLine:!0,timed:!1})],qr.prototype,"execute",1),qr=Vr([(0,n.WD)()],qr);let Qr=class extends o.mY{constructor(e){super(r.Gh.ToggleReviewMode),this.container=e}async execute(){const e=H.D.get("modes");if(null==e||!Object.keys(e).includes("review"))return;const t="review"===H.D.get("mode.active")?void 0:"review";await H.D.update("mode.active",t,v.ConfigurationTarget.Global)}};Vr([(0,it.cM)({args:!1,singleLine:!0,timed:!1})],Qr.prototype,"execute",1),Qr=Vr([(0,n.WD)()],Qr);let Yr=class extends o.mY{constructor(e){super(r.Gh.ToggleZenMode),this.container=e}async execute(){const e=H.D.get("modes");if(null==e||!Object.keys(e).includes("zen"))return;const t="zen"===H.D.get("mode.active")?void 0:"zen";await H.D.update("mode.active",t,v.ConfigurationTarget.Global)}};Vr([(0,it.cM)({args:!1,singleLine:!0,timed:!1})],Yr.prototype,"execute",1),Yr=Vr([(0,n.WD)()],Yr);var jr=Object.defineProperty,zr=Object.getOwnPropertyDescriptor;let Kr=class extends o.mY{constructor(e){super(r.Gh.ToggleCodeLens),this.container=e}execute(){this.container.codeLens.toggleCodeLens()}};Kr=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?zr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&jr(t,i,n),n})([(0,n.WD)()],Kr);var Jr=Object.defineProperty,Xr=Object.getOwnPropertyDescriptor,Zr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Xr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Jr(t,i,n),n};let es=class extends o._l{constructor(e){super([r.Gh.ClearFileAnnotations,r.Gh.ComputingFileAnnotations]),this.container=e}async execute(e,t,i){if(null!=e&&!(0,m.PH)(e)&&null!=i&&!b.n.equals(i,e.document.uri)){const t=v.window.visibleTextEditors.find((e=>b.n.equals(i,e.document.uri)));null!=t&&(e=t)}try{await this.container.fileAnnotations.clear(e)}catch(e){d.Yd.error(e,"ClearFileAnnotationsCommand"),(0,u.W8)("Unable to clear file annotations")}}};es=Zr([(0,n.WD)()],es);let ts=class extends o.pu{constructor(e){super([r.Gh.ToggleFileBlame,r.Gh.ToggleFileBlameInDiffLeft,r.Gh.ToggleFileBlameInDiffRight]),this.container=e}execute(e,t,i){return ss(this.container,e,t,{...i,type:mt.VP.Blame})}};ts=Zr([(0,n.WD)()],ts);let is=class extends o.pu{constructor(e){super(r.Gh.ToggleFileChanges),this.container=e}execute(e,t,i){return ss(this.container,e,t,{...i,type:mt.VP.Changes})}};is=Zr([(0,n.WD)()],is);let rs=class extends o.pu{constructor(e){super([r.Gh.ToggleFileHeatmap,r.Gh.ToggleFileHeatmapInDiffLeft,r.Gh.ToggleFileHeatmapInDiffRight]),this.container=e}execute(e,t,i){return ss(this.container,e,t,{...i,type:mt.VP.Heatmap})}};async function ss(e,t,i,r){if(null!=t&&!(0,m.PH)(t)&&null!=i&&!b.n.equals(i,t.document.uri)){const e=v.window.visibleTextEditors.find((e=>b.n.equals(i,e.document.uri)));null!=e&&(t=e)}try{r={type:mt.VP.Blame,...r},await e.fileAnnotations.toggle(t,r.type,{selection:r.context?.selection??{line:t?.selection.active.line},...r.context},r.on)}catch(e){d.Yd.error(e,"ToggleFileAnnotationsCommand"),(0,u.W8)(`Unable to toggle file ${r.type} annotations`)}}rs=Zr([(0,n.WD)()],rs);var ns=Object.defineProperty,os=Object.getOwnPropertyDescriptor;let as=class extends o.pu{constructor(e){super(r.Gh.ToggleLineBlame),this.container=e}async execute(e,t){try{await this.container.lineAnnotations.toggle(e)}catch(e){d.Yd.error(e,"ToggleLineBlameCommand"),(0,u.W8)("Unable to toggle line blame annotations")}}};as=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?os(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ns(t,i,n),n})([(0,n.WD)()],as);var cs=Object.defineProperty,ls=Object.getOwnPropertyDescriptor;let hs=class extends o.mY{constructor(e){super(r.Gh.GetStarted),this.container=e}execute(e){const t=this.container.context.extension.id;e===t&&(e=void 0),(0,m.lN)(t,e??"gitlens.welcome",void 0,!1)}};hs=((e,t,i,r)=>{for(var s,n=r>1?void 0:r?ls(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&cs(t,i,n),n})([(0,n.WD)()],hs)},7139:(e,t,i)=>{i.d(t,{C$:()=>P,DW:()=>A,E9:()=>v,F4:()=>C,Lk:()=>ActiveEditorCachedCommand,Mg:()=>w,O$:()=>b,P:()=>T,Qo:()=>g,SX:()=>p,_5:()=>D,_l:()=>EditorCommand,d$:()=>y,en:()=>f,jT:()=>m,l7:()=>R,l8:()=>E,mY:()=>Command,pT:()=>S,pu:()=>ActiveEditorCommand});var r=i(9496),s=i(5367),n=i(6450),o=i(1719),a=i(3050),c=i(3646),l=i(9502),h=i(9529),u=i(9796),d=i(6922);function p(e,t){return t?.document?.uri??e}function m(e){return"timeline-item:git"===e.type}function g(e){return"viewItem"===e.type&&(0,s.BF)(e.node.branch)}function f(e){return"viewItem"===e.type&&(0,n.f_)(e.node.commit)}function w(e){return"viewItem"===e.type&&o.V.is(e.node.contributor)}function v(e){if("viewItem"!==e.type)return!1;const t=e.node;return null!=t.file&&(null!=t.file.repoPath||null!=t.repoPath)}function y(e){if("viewItem"!==e.type)return!1;const t=e.node;return null!=t.file&&(0,n.f_)(t.commit)&&(null!=t.file.repoPath||null!=t.repoPath)}function b(e){if("viewItem"!==e.type)return!1;const t=e.node;return null!=t.file&&null!=t.ref1&&null!=t.ref2&&(null!=t.file.repoPath||null!=t.repoPath)}function C(e){return"viewItem"===e.type&&("string"==typeof e.node.compareRef?.ref&&"string"==typeof e.node.compareWithRef?.ref)}function A(e){return"viewItem"===e.type&&e.node instanceof d.bT&&e.node instanceof d.RW}function P(e){return"viewItem"===e.type&&a.ss.is(e.node.remote)}function S(e){return"viewItem"===e.type&&e.node.repo instanceof c._j}function R(e){return"viewItem"===e.type&&"string"==typeof e.node.repoPath}function D(e){return"viewItem"===e.type&&(0,l.YR)(e.node.tag)}function k(e){return null!=e&&(null!=e.id&&null!=e.label&&null!=e.resourceStates&&Array.isArray(e.resourceStates))}function _(e){return null!=e&&null!=e.resourceUri}class Command{constructor(e){if(this.contextParsingOptions={expectsEditor:!1},"string"==typeof e)return void(this._disposable=(0,h.xR)(e,((...t)=>this._execute(e,...t)),this));const t=e.map((e=>(0,h.xR)(e,((...t)=>this._execute(e,...t)),this)));this._disposable=r.Disposable.from(...t)}static getMarkdownCommandArgsCore(e,t){return`command:${e}?${encodeURIComponent(JSON.stringify(t))}`}dispose(){this._disposable.dispose()}preExecute(e,...t){return this.execute(...t)}_execute(e,...t){const[i,r]=T(e,{...this.contextParsingOptions},...t);return Array.isArray(i)?(0,u.df)(this.preExecute,i.map((e=>[e,...r])),this):this.preExecute(i,...r)}}function T(e,t,...i){let s,n=i[0];if(t?.expectsEditor)if((null==n||null!=n.id&&null!=n.document?.uri)&&(s=n,n=(i=i.slice(1))[0]),i.length>0&&(null==n||n instanceof r.Uri)){const[t,...n]=i;if(null!=t){null!=s||t.toString()!==r.window.activeTextEditor?.document.uri.toString()&&!e.endsWith("InDiffLeft")||(s=r.window.activeTextEditor);const i=n[0];return null!=i&&Array.isArray(i)&&0!==i.length&&i[0]instanceof r.Uri?[{command:e,type:"uris",editor:s,uri:t,uris:i},n.slice(1)]:[{command:e,type:"uri",editor:s,uri:t},n]}i=i.slice(1)}else if(null==s){if(null!=n&&"object"==typeof n&&"lineNumber"in n&&"uri"in n){const[,...t]=i;return[{command:e,type:"editorLine",editor:void 0,line:n.lineNumber-1,uri:n.uri},t]}s=r.window.activeTextEditor}if(n instanceof d.Re){let[t,...r]=i;if(n=r[0],Array.isArray(n)&&n[0]instanceof d.Re){let i;[i,...r]=r;const s=[];for(const r of i)r?.constructor===t.constructor&&s.push({command:e,type:"viewItem",node:r,uri:r.uri});return[s,r]}return[{command:e,type:"viewItem",node:t,uri:t.uri},r]}if(_(n)){const t=[];let r=0;for(const e of i){if(!_(e))break;r++,t.push(e)}return[{command:e,type:"scm-states",scmResourceStates:t,uri:t[0].resourceUri},i.slice(r)]}if(k(n)){const t=[];let r=0;for(const e of i){if(!k(e))break;r++,t.push(e)}return[{command:e,type:"scm-groups",scmResourceGroups:t},i.slice(r)]}if(null!=(o=n)&&function(e){return null!=e&&null!=e.timestamp&&null!=e.label}(o)&&null!=o.ref&&null!=o.previousRef&&null!=o.message){const[t,r,...s]=i;return[{command:e,type:"timeline-item:git",item:t,uri:r},s]}var o,a;if(null!=(a=n)&&null!=a.id&&null!=a.rootUri&&null!=a.inputBox&&null!=a.statusBarCommands){const[t,...r]=i;return[{command:e,type:"scm",scm:t},r]}return[{command:e,type:"unknown",editor:s,uri:s?.document.uri},i]}class ActiveEditorCommand extends Command{constructor(){super(...arguments),this.contextParsingOptions={expectsEditor:!0}}preExecute(e,...t){return this.execute(e.editor,e.uri,...t)}_execute(e,...t){return super._execute(e,void 0,...t)}}let F;function E(){return F}class ActiveEditorCachedCommand extends ActiveEditorCommand{_execute(e,...t){return F={command:e,args:t},super._execute(e,...t)}}class EditorCommand{constructor(e){Array.isArray(e)||(e=[e]);const t=[];for(const i of e)t.push(r.commands.registerTextEditorCommand(i,((e,t,...r)=>this.executeCore(i,e,t,...r)),this));this._disposable=r.Disposable.from(...t)}dispose(){this._disposable.dispose()}executeCore(e,t,i,...r){return this.execute(t,i,...r)}}},2967:(e,t,i)=>{i.d(t,{K:()=>PickCommandStep,I:()=>ce});var r=i(2540),s=i(5148),n=i(2061),o=i(9496),a=i(4321),c=i(3646);function l(e,t,i,r){return{...i,item:t,picked:h(e,t),context:r}}function h(e,t){return void 0===t?0===e.length:Array.isArray(t)?0===t.length?0===e.length:t.every((t=>e.includes(t))):e.includes(t)}var u=i(3620),d=i(6270);function p(e){if(!(e.repo instanceof c._j&&"create"===e.subcommand))throw new Error("Missing repository")}function m(e){if(!(e.repo instanceof c._j&&"delete"===e.subcommand))throw new Error("Missing repository")}function g(e){if(!(e.repo instanceof c._j&&"rename"===e.subcommand))throw new Error("Missing repository")}function f(e){if(!Array.isArray(e.references))throw new Error("Missing branches")}const w=new Map([["create","Create"],["delete","Delete"],["rename","Rename"]]);function v(e,t){return null==t?e:`${w.get(t)} ${e}`}class BranchGitCommand extends d.tR{constructor(e,t){super(e,"branch","branch","Branch",{description:"create, rename, or delete branches"});let i=0;if(null!=t?.state?.subcommand)switch(i++,t?.state.subcommand){case"create":case"rename":null!=t.state.reference&&i++,null!=t.state.name&&i++;break;case"delete":null==t.state.references||Array.isArray(t.state.references)&&0===t.state.references.length||i++}null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}get canConfirm(){return null!=this.subcommand}get canSkipConfirm(){return"delete"!==this.subcommand&&"rename"!==this.subcommand&&super.canSkipConfirm}get skipConfirmKey(){return`${this.key}${null==this.subcommand?"":`-${this.subcommand}`}:${this.pickedVia}`}async*steps(e){const t={associatedView:this.container.branchesView,repos:this.container.git.openRepositories,showTags:!1,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.subcommand){this.subcommand=void 0;const t=yield*this.pickSubcommandStep(e);if(t===d.Vd)break;e.subcommand=t}if(this.subcommand=e.subcommand,t.title=v("delete"===e.subcommand?"Branches":this.title,e.subcommand),e.counter<2||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)continue;e.repo=i}switch(e.subcommand){case"create":p(e),yield*this.createCommandSteps(e,t),e.name=void 0;break;case"delete":m(e),yield*this.deleteCommandSteps(e,t);break;case"rename":g(e),yield*this.renameCommandSteps(e,t),e.name=void 0;break;default:(0,d.uZ)(e)}i&&e.counter--}return e.counter<0?d.Vd:void 0}*pickSubcommandStep(e){const t=(0,d.xf)({title:this.title,placeholder:`Choose a ${this.label} command`,items:[{label:"create",description:"creates a new branch",picked:"create"===e.subcommand,item:"create"},{label:"delete",description:"deletes the specified branches",picked:"delete"===e.subcommand,item:"delete"},{label:"rename",description:"renames the specified branch",picked:"rename"===e.subcommand,item:"rename"}],buttons:[o.QuickInputButtons.Back]}),i=yield t;return(0,d.i9)(t,e,i)?i[0].item:d.Vd}async*createCommandSteps(e,t){for(null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Yv)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to create the new branch from`,picked:e.reference?.ref??(await e.repo.getBranch())?.ref,titleContext:" from",value:(0,a.FT)(e.reference)?e.reference.ref:void 0});if(i===d.Vd)break;e.reference=i}if(e.counter<4||null==e.name){const i=yield*(0,d.f6)(e,t,{placeholder:"Please provide a name for the new branch",titleContext:` from ${(0,a.Wh)(e.reference,{capitalize:!0,icon:!1,label:"branch"!==e.reference.refType})}`,value:e.name??(0,a.Av)(e.reference)});if(i===d.Vd)continue;e.name=i}if(this.confirm(e.confirm)){const i=yield*this.createCommandConfirmStep(e,t);if(i===d.Vd)continue;e.flags=i}(0,d.uZ)(e),e.flags.includes("--switch")?await e.repo.switch(e.reference.ref,{createBranch:e.name}):e.repo.branch(...e.flags,e.name,e.reference.ref)}}*createCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:t.title,detail:`Will create a new branch named ${e.name} from ${(0,a.Wh)(e.reference)}`}),l(e.flags,["--switch"],{label:`${t.title} and Switch`,description:"--switch",detail:`Will create and switch to a new branch named ${e.name} from ${(0,a.Wh)(e.reference)}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*deleteCommandSteps(e,t){for(null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(null==e.references||Array.isArray(e.references)||(e.references=[e.references]),e.counter<3||null==e.references||Array.isArray(e.references)&&0===e.references.length){t.title=v("Branches",e.subcommand);const i=yield*(0,d.FO)(e,t,{filter:e=>!e.current,picked:e.references?.map((e=>e.ref)),placeholder:"Choose branches to delete",sort:{current:!1,missingUpstream:!0}});if(i===d.Vd)break;e.references=i}t.title=v((0,u._6)("Branch",e.references.length,{only:!0,plural:"Branches"}),e.subcommand),f(e);const i=yield*this.deleteCommandConfirmStep(e,t);i!==d.Vd&&(e.flags=i,(0,d.uZ)(e),e.repo.branchDelete(e.references,{force:e.flags.includes("--force"),remote:e.flags.includes("--remotes")}))}}*deleteCommandConfirmStep(e,t){const i=[l(e.flags,[],{label:t.title,detail:`Will delete ${(0,a.Wh)(e.references)}`})];e.references.every((e=>e.remote))||(i.push(l(e.flags,["--force"],{label:`Force ${t.title}`,description:"--force",detail:`Will forcibly delete ${(0,a.Wh)(e.references)}`})),e.references.some((e=>null!=e.upstream))&&i.push(l(e.flags,["--remotes"],{label:`${t.title} & Remote${e.references.filter((e=>!e.remote)).length>1?"s":""}`,description:"--remotes",detail:`Will delete ${(0,a.Wh)(e.references)} and any remote tracking branches`}),l(e.flags,["--force","--remotes"],{label:`Force ${t.title} & Remote${e.references.filter((e=>!e.remote)).length>1?"s":""}`,description:"--force --remotes",detail:`Will forcibly delete ${(0,a.Wh)(e.references)} and any remote tracking branches`})));const r=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),i,t),s=yield r;return(0,d.i9)(r,e,s)?s[0].item:d.Vd}async*renameCommandSteps(e,t){for(null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.sd)(e,t,{filter:e=>!e.remote,picked:e.reference?.ref,placeholder:"Choose a branch to rename"});if(i===d.Vd)break;e.reference=i}if(e.counter<4||null==e.name){const i=yield*(0,d.f6)(e,t,{placeholder:`Please provide a new name for ${(0,a.Wh)(e.reference,{icon:!1})}`,titleContext:` ${(0,a.Wh)(e.reference,!1)}`,value:e.name??e.reference.name});if(i===d.Vd)continue;e.name=i}const i=yield*this.renameCommandConfirmStep(e,t);i!==d.Vd&&(e.flags=i,(0,d.uZ)(e),e.repo.branch(...e.flags,e.reference.ref,e.name))}}*renameCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,["-m"],{label:t.title,detail:`Will rename ${(0,a.Wh)(e.reference)} to ${e.name}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}class CherryPickGitCommand extends d.tR{constructor(e,t){super(e,"cherry-pick","cherry-pick","Cherry Pick",{description:"integrates changes from specified commits into the current branch"});let i=0;null!=t?.state?.repo&&i++,null==t?.state?.references||Array.isArray(t.state.references)&&0===t.state.references.length||i++,this.initialState={counter:i,confirm:!0,...t?.state}}get canSkipConfirm(){return!1}execute(e){e.repo.cherryPick(...e.flags,...e.references.map((e=>e.ref)).reverse())}isFuzzyMatch(e){return super.isFuzzyMatch(e)||"cherry"===e}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,destination:void 0,selectedBranchOrTag:void 0,showTags:!0,title:this.title};null==e.flags&&(e.flags=[]),null==e.references||Array.isArray(e.references)||(e.references=[e.references]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(null==t.destination){const i=await e.repo.getBranch();if(null==i)break;t.destination=i}if(t.title=`${this.title} into ${(0,a.Wh)(t.destination,{icon:!1})}`,e.counter<2||null==e.references||0===e.references.length){const r=yield*(0,d.Yv)(e,t,{filter:{branches:e=>e.id!==t.destination.id},placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to cherry-pick from`,picked:t.selectedBranchOrTag?.ref,value:null==t.selectedBranchOrTag?e.references?.[0]?.ref:void 0});if(r===d.Vd){i&&e.counter--;continue}(0,a.FT)(r)?(e.references=[r],t.selectedBranchOrTag=void 0):t.selectedBranchOrTag=r}if(e.counter<3&&null!=t.selectedBranchOrTag){const i=(0,a.oI)(t.destination.ref,t.selectedBranchOrTag.ref);let r=t.cache.get(i);null==r&&(r=this.container.git.getLog(e.repo.path,{ref:i,merges:!1}),t.cache.set(i,r));const s=yield*(0,d.Rj)(e,t,{log:await r,onDidLoadMore:e=>t.cache.set(i,Promise.resolve(e)),picked:e.references?.map((e=>e.ref)),placeholder:(e,t)=>null==t?`No pickable commits found on ${(0,a.Wh)(e.selectedBranchOrTag,{icon:!1})}`:`Choose commits to cherry-pick into ${(0,a.Wh)(e.destination,{icon:!1})}`});if(s===d.Vd)continue;e.references=s}if(this.confirm(e.confirm)){const i=yield*this.confirmStep(e,t);if(i===d.Vd)continue;e.flags=i}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}*confirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will apply ${(0,a.Wh)(e.references)} to ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--edit"],{label:`${this.title} & Edit`,description:"--edit",detail:`Will edit and apply ${(0,a.Wh)(e.references)} to ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--no-commit"],{label:`${this.title} without Committing`,description:"--no-commit",detail:`Will apply ${(0,a.Wh)(e.references)} to ${(0,a.Wh)(t.destination)} without Committing`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}var y=i(9529),b=i(3700);class CoAuthorsGitCommand extends d.tR{constructor(e,t){super(e,"co-authors","co-authors","Add Co-Authors",{description:"adds co-authors to a commit message"});let i=0;null!=t?.state?.repo&&i++,null==t?.state?.contributors||Array.isArray(t.state.contributors)&&0===t.state.contributors.length||i++,this.initialState={counter:i,confirm:!1,...t?.state}}get canConfirm(){return!1}async execute(e){const t=await this.container.git.getOrOpenScmRepository(e.repo.path);if(null==t)return;let i=t.inputBox.value;const r=i.indexOf("Co-authored-by: ");-1!==r&&(i=i.substring(0,r-1).trimRight()),null==e.contributors||Array.isArray(e.contributors)||(e.contributors=[e.contributors]);for(const t of e.contributors){let e;e=i.includes("Co-authored-by: ")?"\n":0!==i.length&&i.endsWith("\n")?"\n\n":"\n\n\n",i+=`${e}Co-authored-by: ${t.getCoauthor()}`}t.inputBox.value=i,await(0,y.dO)("workbench.view.scm")}async*steps(e){const t={repos:this.container.git.openRepositories,activeRepo:void 0,associatedView:this.container.contributorsView,title:this.title},i=await this.container.git.getOpenScmRepositories();i.length&&(t.repos=t.repos.filter((e=>i.find((t=>(0,b.AH)(t.rootUri.fsPath)===e.path)))),t.activeRepo=await this.container.git.getOrOpenRepositoryForEditor(),null==t.activeRepo||i.some((e=>e.rootUri.fsPath===t.activeRepo.path))||(t.activeRepo=void 0));let r=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(r=!1,1===t.repos.length)r=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(e.counter<2||null==e.contributors){const i=yield*(0,d.bR)(e,t,"Choose contributors to add as co-authors");if(i===d.Vd){r&&e.counter--;continue}e.contributors=i}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}}var C=i(5255),A=i(2800),P=i(7512);class FetchGitCommand extends d.tR{constructor(e,t){super(e,"fetch","fetch","Fetch",{description:"fetches changes from one or more remotes"});let i=0;null==t?.state?.repos||Array.isArray(t.state.repos)&&0===t.state.repos.length||i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}execute(e){return(0,a.UR)(e.reference)?e.repos[0].fetch({branch:e.reference}):this.container.git.fetchAll(e.repos,{all:e.flags.includes("--all"),prune:e.flags.includes("--prune")})}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,title:this.title};null==e.flags&&(e.flags=[]),null==e.repos||Array.isArray(e.repos)||(e.repos=[e.repos]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repos||0===e.repos.length||(0,A.GI)(e.repos))if(i=!1,1===t.repos.length)i=!0,null==e.repos&&e.counter++,e.repos=[t.repos[0]];else{const i=yield*(0,d.j8)(e,t,{skipIfPossible:e.counter>=1});if(i===d.Vd)break;e.repos=i}if(this.confirm(e.confirm)){const r=yield*this.confirmStep(e,t);if(r===d.Vd){i&&e.counter--;continue}e.flags=r}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}async*confirmStep(e,t){let i,r="";if(1===e.repos.length){const t=await e.repos[0].getLastFetched();0!==t&&(r=`${(0,u.vk)(C.NE.Dot,2,2)}Last fetched ${(0,P.Zh)(new Date(t))}`)}if(1===e.repos.length&&(0,a.UR)(e.reference))i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t,r),[l(e.flags,[],{label:this.title,detail:`Will fetch ${(0,a.Wh)(e.reference)}`})]);else{const s=1===e.repos.length?`$(repo) ${e.repos[0].formattedName}`:`${e.repos.length} repositories`;i=(0,d.Tv)((0,d.C8)(`Confirm ${this.title}`,e,t,r),[l(e.flags,[],{label:this.title,detail:`Will fetch ${s}`}),l(e.flags,["--prune"],{label:`${this.title} & Prune`,description:"--prune",detail:`Will fetch and prune ${s}`}),l(e.flags,["--all"],{label:`${this.title} All`,description:"--all",detail:`Will fetch all remotes of ${s}`}),l(e.flags,["--all","--prune"],{label:`${this.title} All & Prune`,description:"--all --prune",detail:`Will fetch and prune all remotes of ${s}`})],t)}const s=yield i;return(0,d.i9)(i,e,s)?s[0].item:d.Vd}}var S=i(6897),R=i(6450),D=i(1774);function k(e){if(!(e.repo instanceof c._j))throw new Error("Missing repository")}class LogGitCommand extends d.tR{constructor(e,t){super(e,"log","history","Commits",{description:"aka log, shows commit history"});let i=0;null!=t?.state?.repo&&i++,null!=t?.state?.reference&&(i++,"HEAD"!==t.state.reference&&(0,a.FT)(t.state.reference)&&!(0,a.Nn)(t.state.reference)&&i++),this.initialState={counter:i,confirm:!1,...t?.state}}get canConfirm(){return!1}isFuzzyMatch(e){return super.isFuzzyMatch(e)||"log"===e}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,selectedBranchOrTag:void 0,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(k(e),"HEAD"===e.reference){const t=await e.repo.getBranch();e.reference=t}if(e.counter<2||null==e.reference){const r=yield*(0,d.Yv)(e,t,{placeholder:"Choose a branch or tag to show its commit history",picked:t.selectedBranchOrTag?.ref,value:null==t.selectedBranchOrTag?e.reference?.ref:void 0,ranges:!0});if(r===d.Vd){i&&e.counter--;continue}e.reference=r,t.selectedBranchOrTag=void 0}if((0,a.FT)(e.reference)&&!(0,a.Nn)(e.reference)||(t.selectedBranchOrTag=e.reference),t.title=`${this.title}${(0,u.vk)(C.NE.Dot,2,2)}${(0,a.Wh)(t.selectedBranchOrTag,{icon:!1})}`,e.fileName&&(t.title+=`${(0,u.vk)(C.NE.Dot,2,2)}${(0,D.d)(e.fileName,{fileOnly:!0,truncateTo:C.d$-t.title.length-3})}`),e.counter<3&&null!=t.selectedBranchOrTag){const i=t.selectedBranchOrTag.ref;let r=t.cache.get(i);null==r&&(r=null!=e.fileName?this.container.git.getLogForFile(e.repo.path,e.fileName,{ref:i}):this.container.git.getLog(e.repo.path,{ref:i}),t.cache.set(i,r));const s=yield*(0,d.s4)(e,t,{ignoreFocusOut:!0,log:await r,onDidLoadMore:e=>t.cache.set(i,Promise.resolve(e)),placeholder:(e,t)=>null==t?`No commits found in ${(0,a.Wh)(e.selectedBranchOrTag,{icon:!1})}`:"Choose a commit",picked:e.reference?.ref});if(s===d.Vd)continue;e.reference=s}let r;e.reference instanceof R.aM&&null==e.reference.file||(e.reference=await this.container.git.getCommit(e.repo.path,e.reference.ref)),e.openPickInView?((0,S.Fw)(e.reference,{pin:!1,preserveFocus:!1}),r=d.Vd):r=yield*ce(this.container,{command:"show",state:{repo:e.repo,reference:e.reference,fileName:e.fileName}},this.pickedVia),e.counter--,r===d.Vd&&(0,d.uZ)(e)}return e.counter<0?d.Vd:void 0}}var _=i(3599);class MergeGitCommand extends d.tR{constructor(e,t){super(e,"merge","merge","Merge",{description:"integrates changes from a specified branch into the current branch"});let i=0;null!=t?.state?.repo&&i++,null!=t?.state?.reference&&i++,this.initialState={counter:i,confirm:!0,...t?.state}}get canSkipConfirm(){return!1}execute(e){e.repo.merge(...e.flags,e.reference.ref)}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,destination:void 0,pickCommit:!1,pickCommitForItem:!1,selectedBranchOrTag:void 0,showTags:!0,title:this.title};null==e.flags&&(e.flags=[]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(null==t.destination){const i=await e.repo.getBranch();if(null==i)break;t.destination=i}if(t.title=`${this.title} into ${(0,a.Wh)(t.destination,{icon:!1})}`,t.pickCommitForItem=!1,e.counter<2||null==e.reference){const r=new d.v_(t.pickCommit,t,(()=>{t.pickCommit=!t.pickCommit,r.on=t.pickCommit})),s=yield*(0,d.Yv)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to merge`,picked:t.selectedBranchOrTag?.ref,value:null==t.selectedBranchOrTag?e.reference?.ref:void 0,additionalButtons:[r]});if(s===d.Vd){i&&e.counter--;continue}e.reference=s,t.selectedBranchOrTag=void 0}if((0,a.FT)(e.reference)||(t.selectedBranchOrTag=e.reference),e.counter<3&&null!=t.selectedBranchOrTag&&(t.pickCommit||t.pickCommitForItem||e.reference.ref===t.destination.ref)){const i=t.selectedBranchOrTag.ref;let r=t.cache.get(i);null==r&&(r=this.container.git.getLog(e.repo.path,{ref:i,merges:!1}),t.cache.set(i,r));const s=yield*(0,d.s4)(e,t,{ignoreFocusOut:!0,log:await r,onDidLoadMore:e=>t.cache.set(i,Promise.resolve(e)),placeholder:(e,t)=>null==t?`No commits found on ${(0,a.Wh)(e.selectedBranchOrTag,{icon:!1})}`:`Choose a commit to merge into ${(0,a.Wh)(e.destination,{icon:!1})}`,picked:e.reference?.ref});if(s===d.Vd)continue;e.reference=s}const r=yield*this.confirmStep(e,t);r!==d.Vd&&(e.flags=r,(0,d.uZ)(e),this.execute(e))}return e.counter<0?d.Vd:void 0}async*confirmStep(e,t){const i=await this.container.git.getAheadBehindCommitCount(e.repo.path,[(0,a.oI)(t.destination.name,e.reference.name)]),r=null!=i?i.ahead+i.behind:0;if(0===r){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:`${(0,a.Wh)(t.destination,{capitalize:!0})} is up to date with ${(0,a.Wh)(e.reference)}`})),r=yield i;return(0,d.i9)(i,e,r),d.Vd}const s=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will merge ${(0,u._6)("commit",r)} from ${(0,a.Wh)(e.reference)} into ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--ff-only"],{label:`Fast-forward ${this.title}`,description:"--ff-only",detail:`Will fast-forward merge ${(0,u._6)("commit",r)} from ${(0,a.Wh)(e.reference)} into ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--squash"],{label:`Squash ${this.title}`,description:"--squash",detail:`Will squash ${(0,u._6)("commit",r)} from ${(0,a.Wh)(e.reference)} into one when merging into ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--no-ff"],{label:`${this.title} without Fast-Forwarding`,description:"--no-ff",detail:`Will create a merge commit when merging ${(0,u._6)("commit",r)} from ${(0,a.Wh)(e.reference)} into ${(0,a.Wh)(t.destination)}`}),l(e.flags,["--no-ff","--no-commit"],{label:`${this.title} without Fast-Forwarding or Committing`,description:"--no-ff --no-commit",detail:`Will merge ${(0,u._6)("commit",r)} from ${(0,a.Wh)(e.reference)} into ${(0,a.Wh)(t.destination)} without Committing`})]),n=yield s;return(0,d.i9)(s,e,n)?n[0].item:d.Vd}}var T=i(5367);class PullGitCommand extends d.tR{constructor(e,t){super(e,"pull","pull","Pull",{description:"fetches and integrates changes from a remote into the current branch"});let i=0;null==t?.state?.repos||Array.isArray(t.state.repos)&&0===t.state.repos.length||i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}async execute(e){if((0,a.UR)(e.reference)&&(!(0,T.BF)(e.reference)||!e.reference.current)){const t=await e.repos[0].getBranch();if(t?.name!==e.reference.name)return e.repos[0].fetch({branch:e.reference,pull:!0})}return this.container.git.pullAll(e.repos,{rebase:e.flags.includes("--rebase")})}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,title:this.title};null==e.flags&&(e.flags=[]),null==e.repos||Array.isArray(e.repos)||(e.repos=[e.repos]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repos||0===e.repos.length||(0,A.GI)(e.repos))if(i=!1,1===t.repos.length)i=!0,null==e.repos&&e.counter++,e.repos=[t.repos[0]];else{const i=yield*(0,d.j8)(e,t,{skipIfPossible:e.counter>=1});if(i===d.Vd)break;e.repos=i}if(this.confirm(e.confirm)){const r=yield*this.confirmStep(e,t);if(r===d.Vd){i&&e.counter--;continue}e.flags=r}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}async*confirmStep(e,t){let i;if(e.repos.length>1)i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will pull ${e.repos.length} repositories`}),l(e.flags,["--rebase"],{label:`${this.title} with Rebase`,description:"--rebase",detail:`Will pull ${e.repos.length} repositories by rebasing`})]);else if((0,a.UR)(e.reference))if(e.reference.remote)i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:"Cannot pull a remote branch"}));else{const[r]=e.repos,s=await r.getBranch(e.reference.name);i=null==s?.upstream?this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:"Cannot pull a branch until it has been published"})):this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:"Will pull"+(s.state.behind?` ${(0,u._6)("commit",s.state.behind)} into ${(0,a.Wh)(s)}`:` into ${(0,a.Wh)(s)}`)})])}else{const[r]=e.repos,[s,n]=await Promise.all([r.getStatus(),r.getLastFetched()]);let o="";0!==n&&(o=`${(0,u.vk)(C.NE.Dot,2,2)}Last fetched ${(0,P.Zh)(new Date(n))}`);const a=null!=s?.state.behind?` ${(0,u._6)("commit",s.state.behind)} into $(repo) ${r.formattedName}`:` into $(repo) ${r.formattedName}`;i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t,o),[l(e.flags,[],{label:this.title,detail:`Will pull${a}`}),l(e.flags,["--rebase"],{label:`${this.title} with Rebase`,description:"--rebase",detail:`Will pull and rebase${a}`})],void 0,{additionalButtons:[d.My],onDidClickButton:async(e,i)=>{if(i!==d.My||e.busy)return!1;e.title=`Confirm ${t.title}${(0,u.vk)(C.NE.Dot,2,2)}Fetching${C.NE.Ellipsis}`,e.busy=!0;try{return await r.fetch({progress:!0}),!0}finally{e.busy=!1}}})}const r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}class PushGitCommand extends d.tR{constructor(e,t){super(e,"push","push","Push",{description:"pushes changes from the current branch to a remote"});let i=0;null==t?.state?.repos||Array.isArray(t.state.repos)&&0===t.state.repos.length||i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}execute(e){const t=e.flags.indexOf("--set-upstream");return-1!==t?(0,a.UR)(e.reference)?this.container.git.pushAll(e.repos,{force:!1,publish:{remote:e.flags[t+1]},reference:e.reference}):Promise.resolve():this.container.git.pushAll(e.repos,{force:e.flags.includes("--force"),reference:e.reference})}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,title:this.title};null==e.flags&&(e.flags=[]),null==e.repos||Array.isArray(e.repos)||(e.repos=[e.repos]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repos||0===e.repos.length||(0,A.GI)(e.repos))if(i=!1,1===t.repos.length)i=!0,null==e.repos&&e.counter++,e.repos=[t.repos[0]];else if(null!=e.reference){const i=yield*(0,d.lA)({...e,repos:void 0,repo:e.reference.repoPath},t);if(i===d.Vd)break;e.repos=[i]}else{const i=yield*(0,d.j8)(e,t,{skipIfPossible:e.counter>=1});if(i===d.Vd)break;e.repos=i}if(this.confirm(e.confirm)){const r=yield*this.confirmStep(e,t);if(r===d.Vd){i&&e.counter--;continue}e.flags=r}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}async*confirmStep(e,t){const i=s.D.getAny("git.useForcePushWithLease")??!1;let r;if(e.repos.length>1)r=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will push ${e.repos.length} repositories`}),l(e.flags,["--force"],{label:`Force ${this.title}${i?" (with lease)":""}`,description:"--force"+(i?"-with-lease":""),detail:`Will force push${i?" (with lease)":""} ${e.repos.length} repositories`})]);else{const[s]=e.repos,n=[];if((0,a.UR)(e.reference))if(e.reference.remote)r=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:"Cannot push remote branch"}));else{const o=await s.getBranch(e.reference.name);if(null!=o&&null==o?.upstream){for(const t of await s.getRemotes())n.push(l(e.flags,["--set-upstream",t.name,o.name],{label:`Publish ${o.name} to ${t.name}`,detail:`Will publish ${(0,a.Wh)(o)} to ${t.name}`}));r=n.length?this.createConfirmStep((0,d.C8)("Confirm Publish",e,t),n,void 0,{placeholder:"Confirm Publish"}):this.createConfirmStep((0,d.C8)("Confirm Publish",e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:"Cancel Publish",detail:"Cannot publish; No remotes found"}),{placeholder:"Confirm Publish"})}else r=null!=o&&o?.state.behind>0?this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,["--force"],{label:`Force ${this.title}${i?" (with lease)":""}`,description:"--force"+(i?"-with-lease":""),detail:`Will force push${i?" (with lease)":""} ${o?.state.ahead?` ${(0,u._6)("commit",o.state.ahead)}`:""}${o.getRemoteName()?` to ${o.getRemoteName()}`:""}${null!=o&&o.state.behind>0?`, overwriting ${(0,u._6)("commit",o.state.behind)}${o?.getRemoteName()?` on ${o.getRemoteName()}`:""}`:""}`})],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:`Cannot push; ${(0,a.Wh)(o)} is behind ${o.getRemoteName()} by ${(0,u._6)("commit",o.state.behind)}`})):null!=o&&o?.state.ahead>0?this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[o.getRemoteName()],{label:this.title,detail:`Will push ${(0,u._6)("commit",o.state.ahead)} from ${(0,a.Wh)(o)} to ${o.getRemoteName()}`})]):this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:"No commits found to push"}))}else{const o=await s.getStatus(),c={refType:"branch",name:o?.branch??"HEAD",ref:o?.branch??"HEAD",remote:!1,repoPath:s.path};if(0===o?.state.ahead){if(null==e.reference&&null==o.upstream){e.reference=c;for(const t of await s.getRemotes())n.push(l(e.flags,["--set-upstream",t.name,o.branch],{label:`Publish ${c.name} to ${t.name}`,detail:`Will publish ${(0,a.Wh)(c)} to ${t.name}`}))}r=n.length?this.createConfirmStep((0,d.C8)("Confirm Publish",e,t),n,void 0,{placeholder:"Confirm Publish"}):null==o.upstream?this.createConfirmStep((0,d.C8)("Confirm Publish",e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:"Cancel Publish",detail:"Cannot publish; No remotes found"}),{placeholder:"Confirm Publish"}):this.createConfirmStep((0,d.C8)("Confirm Push",e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:`Cannot push; No commits ahead of ${(0,T.Lo)(o.upstream)}`}))}else{let n="";const h=await s.getLastFetched();let p;0!==h&&(n=`${(0,u.vk)(C.NE.Dot,2,2)}Last fetched ${(0,P.Zh)(new Date(h))}`),p=null!=e.reference?`${o?.state.ahead?` commits up to and including ${(0,a.Wh)(e.reference,{label:!1})}`:""}${o?.upstream?` to ${(0,T.Lo)(o.upstream)}`:""}`:`${o?.state.ahead?` ${(0,u._6)("commit",o.state.ahead)}`:""}${o?.upstream?` to ${(0,T.Lo)(o.upstream)}`:""}`,r=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t,n),[...o?.state.behind?[]:[l(e.flags,[],{label:this.title,detail:`Will push${p}`})],l(e.flags,["--force"],{label:`Force ${this.title}${i?" (with lease)":""}`,description:"--force"+(i?"-with-lease":""),detail:`Will force push${i?" (with lease)":""} ${p}${null!=o&&o.state.behind>0?`, overwriting ${(0,u._6)("commit",o.state.behind)}${o?.upstream?` on ${(0,T.Lo)(o.upstream)}`:""}`:""}`})],o?.state.behind?(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:`Cannot push; ${(0,a.Wh)(c)} is behind${o?.upstream?` ${(0,T.Lo)(o.upstream)}`:""} by ${(0,u._6)("commit",o.state.behind)}`}):void 0),r.additionalButtons=[d.My],r.onDidClickButton=async(e,i)=>{if(i!==d.My||e.busy)return!1;e.title=`Confirm ${t.title}${(0,u.vk)(C.NE.Dot,2,2)}Fetching${C.NE.Ellipsis}`,e.busy=!0;try{return await s.fetch({progress:!0}),!0}finally{e.busy=!1}}}}}const n=yield r;return(0,d.i9)(r,e,n)?n[0].item:d.Vd}}var F=i(2509);class RebaseGitCommand extends d.tR{constructor(e,t){super(e,"rebase","rebase","Rebase",{description:"integrates changes from a specified branch into the current branch, by changing the base of the branch and reapplying the commits on top"});let i=0;null!=t?.state?.repo&&i++,null!=t?.state?.reference&&i++,this.initialState={counter:i,confirm:!0,...t?.state}}get canSkipConfirm(){return!1}async execute(e){let t;if(e.flags.includes("--interactive")){await this.container.rebaseEditor.enableForNextUse();t=["-c",`"sequence.editor=${(0,F._L)()}"`]}e.repo.rebase(t,...e.flags,e.reference.ref)}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,destination:void 0,pickCommit:!1,pickCommitForItem:!1,selectedBranchOrTag:void 0,showTags:!0,title:this.title};null==e.flags&&(e.flags=[]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(null==t.destination){const i=await e.repo.getBranch();if(null==i)break;t.destination=i}if(t.title=`${this.title} ${(0,a.Wh)(t.destination,{icon:!1})}`,t.pickCommitForItem=!1,e.counter<2||null==e.reference){const r=new d.v_(t.pickCommit,t,(()=>{t.pickCommit=!t.pickCommit,r.on=t.pickCommit})),s=yield*(0,d.Yv)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to rebase`,picked:t.selectedBranchOrTag?.ref,value:null==t.selectedBranchOrTag?e.reference?.ref:void 0,additionalButtons:[r]});if(s===d.Vd){i&&e.counter--;continue}e.reference=s,t.selectedBranchOrTag=void 0}if((0,a.FT)(e.reference)||(t.selectedBranchOrTag=e.reference),e.counter<3&&null!=t.selectedBranchOrTag&&(t.pickCommit||t.pickCommitForItem||e.reference.ref===t.destination.ref)){const i=t.selectedBranchOrTag.ref;let r=t.cache.get(i);null==r&&(r=this.container.git.getLog(e.repo.path,{ref:i,merges:!1}),t.cache.set(i,r));const s=yield*(0,d.s4)(e,t,{ignoreFocusOut:!0,log:await r,onDidLoadMore:e=>t.cache.set(i,Promise.resolve(e)),placeholder:(e,t)=>null==t?`No commits found on ${(0,a.Wh)(e.selectedBranchOrTag,{icon:!1})}`:`Choose a commit to rebase ${(0,a.Wh)(e.destination,{icon:!1})} onto`,picked:e.reference?.ref});if(s===d.Vd)continue;e.reference=s}const r=yield*this.confirmStep(e,t);r!==d.Vd&&(e.flags=r,(0,d.uZ)(e),this.execute(e))}return e.counter<0?d.Vd:void 0}async*confirmStep(e,t){const i=await this.container.git.getAheadBehindCommitCount(e.repo.path,["revision"===e.reference.refType?(0,a.oI)(e.reference.ref,t.destination.ref):(0,a.oI)(t.destination.name,e.reference.name)]),r=null!=i?i.ahead+i.behind:0;if(0===r){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[],(0,_.fw)(_.Xe.Cancel,!0,{label:`Cancel ${this.title}`,detail:`${(0,a.Wh)(t.destination,{capitalize:!0})} is up to date with ${(0,a.Wh)(e.reference)}`})),r=yield i;return(0,d.i9)(i,e,r),d.Vd}const s=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will update ${(0,a.Wh)(t.destination)} by applying ${(0,u._6)("commit",r)} on top of ${(0,a.Wh)(e.reference)}`}),l(e.flags,["--interactive"],{label:`Interactive ${this.title}`,description:"--interactive",detail:`Will interactively update ${(0,a.Wh)(t.destination)} by applying ${(0,u._6)("commit",r)} on top of ${(0,a.Wh)(e.reference)}`})]),n=yield s;return(0,d.i9)(s,e,n)?n[0].item:d.Vd}}var E=i(4155),$=i(7925),O=i(4336);function x(e){if(!(e.repo instanceof c._j&&"add"===e.subcommand))throw new Error("Missing repository")}function I(e){if(!(e.repo instanceof c._j&&"remove"===e.subcommand))throw new Error("Missing repository")}function B(e){if(!(e.repo instanceof c._j&&"prune"===e.subcommand))throw new Error("Missing repository")}function W(e){if("string"==typeof e.remote)throw new Error("Missing remote")}function L(e){if("string"==typeof e.remote)throw new Error("Missing remote")}const M=new Map([["add","Add"],["prune","Prune"],["remove","Remove"]]);function U(e,t){return null==t?e:`${M.get(t)} ${e}`}class RemoteGitCommand extends d.tR{constructor(e,t){super(e,"remote","remote","Remote",{description:"add, prune, or remove remotes"});let i=0;if(null!=t?.state?.subcommand)switch(i++,t?.state.subcommand){case"add":null!=t.state.name&&i++,null!=t.state.url&&i++;break;case"prune":case"remove":null!=t.state.remote&&i++}null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}get canConfirm(){return null!=this.subcommand}get canSkipConfirm(){return"remove"!==this.subcommand&&"prune"!==this.subcommand&&super.canSkipConfirm}get skipConfirmKey(){return`${this.key}${null==this.subcommand?"":`-${this.subcommand}`}:${this.pickedVia}`}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.remotesView,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.subcommand){this.subcommand=void 0;const t=yield*this.pickSubcommandStep(e);if(t===d.Vd)break;e.subcommand=t}if(this.subcommand=e.subcommand,t.title=U(this.title,e.subcommand),e.counter<2||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)continue;e.repo=i}switch(e.subcommand){case"add":x(e),yield*this.addCommandSteps(e,t),e.name=void 0,e.url=void 0;break;case"prune":B(e),yield*this.pruneCommandSteps(e,t);break;case"remove":I(e),yield*this.removeCommandSteps(e,t);break;default:(0,d.uZ)(e)}i&&e.counter--}return e.counter<0?d.Vd:void 0}*pickSubcommandStep(e){const t=(0,d.xf)({title:this.title,placeholder:`Choose a ${this.label} command`,items:[{label:"add",description:"adds a new remote",picked:"add"===e.subcommand,item:"add"},{label:"prune",description:"prunes remote branches on the specified remote",picked:"prune"===e.subcommand,item:"prune"},{label:"remove",description:"removes the specified remote",picked:"remove"===e.subcommand,item:"remove"}],buttons:[o.QuickInputButtons.Back]}),i=yield t;return(0,d.i9)(t,e,i)?i[0].item:d.Vd}async*addCommandSteps(e,t){null==e.flags&&(e.flags=["-f"]);let i=0!==(await e.repo.getRemotes({filter:t=>t.name===e.name})).length;for(;this.canStepsContinue(e);){if(e.counter<3||null==e.name||i){const r=yield*(0,d.NQ)(e,t,{placeholder:"Please provide a name for the remote",value:e.name});if(r===d.Vd)continue;if(i=0!==(await e.repo.getRemotes({filter:e=>e.name===r})).length,i){e.counter--;continue}e.name=r}if(e.counter<4||null==e.url){const i=yield*(0,d.Kf)(e,t,{placeholder:"Please provide a URL for the remote",value:e.url});if(i===d.Vd)continue;e.url=i}if(this.confirm(e.confirm)){const i=yield*this.addCommandConfirmStep(e,t);if(i===d.Vd)continue;e.flags=i}(0,d.uZ)(e),await e.repo.addRemote(e.name,e.url,e.flags.includes("-f")?{fetch:!0}:void 0),!1!==e.reveal&&(0,E.ay)(void 0,{focus:!0,select:!0})}}*addCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:t.title,detail:`Will add remote '${e.name}' for ${e.url}`}),l(e.flags,["-f"],{label:`${t.title} and Fetch`,description:"-f",detail:`Will add and fetch remote '${e.name}' for ${e.url}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*removeCommandSteps(e,t){for(;this.canStepsContinue(e);){if(null!=e.remote&&"string"==typeof e.remote){const[t]=await e.repo.getRemotes({filter:t=>t.name===e.remote});e.remote=null!=t?t:void 0}if(e.counter<3||null==e.remote){t.title=U("Remotes",e.subcommand);const i=yield*(0,d.Lt)(e,t,{picked:e.remote?.name,placeholder:"Choose remote to remove"});if(i===d.Vd)break;e.remote=i}W(e);if((yield*this.removeCommandConfirmStep(e,t))!==d.Vd){(0,d.uZ)(e);try{await e.repo.removeRemote(e.remote.name)}catch(e){O.Yd.error(e),(0,$.W8)("Unable to remove remote")}}}}*removeCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:`Will remove remote '${e.remote.name}'`}],t),r=yield i;return(0,d.i9)(i,e,r)?void 0:d.Vd}async*pruneCommandSteps(e,t){for(;this.canStepsContinue(e);){if(null!=e.remote&&"string"==typeof e.remote){const[t]=await e.repo.getRemotes({filter:t=>t.name===e.remote});e.remote=null!=t?t:void 0}if(e.counter<3||null==e.remote){const i=yield*(0,d.Lt)(e,t,{picked:e.remote?.name,placeholder:"Choose a remote to prune"});if(i===d.Vd)break;e.remote=i}L(e);(yield*this.pruneCommandConfirmStep(e,t))!==d.Vd&&((0,d.uZ)(e),e.repo.pruneRemote(e.remote.name))}}*pruneCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:`Will prune remote '${e.remote.name}'`}],t),r=yield i;return(0,d.i9)(i,e,r)?void 0:d.Vd}}class ResetGitCommand extends d.tR{constructor(e,t){super(e,"reset","reset","Reset",{description:"resets the current branch to a specified commit"}),this._canSkipConfirm=!1;let i=0;null!=t?.state?.repo&&i++,null!=t?.state?.reference&&i++,this.initialState={counter:i,confirm:t?.confirm??!0,...t?.state},this._canSkipConfirm=!this.initialState.confirm}get canSkipConfirm(){return this._canSkipConfirm}execute(e){e.repo.reset(...e.flags,e.reference.ref)}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,destination:void 0,title:this.title};null==e.flags&&(e.flags=[]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(null==t.destination){const i=await e.repo.getBranch();if(null==i)break;t.destination=i}if(t.title=`${this.title} ${(0,a.Wh)(t.destination,{icon:!1})}`,e.counter<2||null==e.reference){const r=t.destination.ref;let s=t.cache.get(r);null==s&&(s=this.container.git.getLog(e.repo.path,{ref:r,merges:!1}),t.cache.set(r,s));const n=yield*(0,d.s4)(e,t,{log:await s,onDidLoadMore:e=>t.cache.set(r,Promise.resolve(e)),placeholder:(e,t)=>null==t?`${e.destination.name} has no commits`:`Choose a commit to reset ${e.destination.name} to`,picked:e.reference?.ref});if(n===d.Vd){i&&e.counter--;continue}e.reference=n}if(this.confirm(e.confirm)){const i=yield*this.confirmStep(e,t);if(i===d.Vd)continue;e.flags=i}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}*confirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:this.title,detail:`Will reset (leaves changes in the working tree) ${(0,a.Wh)(t.destination)} to ${(0,a.Wh)(e.reference)}`}),l(e.flags,["--soft"],{label:`Soft ${this.title}`,description:"--soft",detail:`Will soft reset (leaves changes in the index and working tree) ${(0,a.Wh)(t.destination)} to ${(0,a.Wh)(e.reference)}`}),l(e.flags,["--hard"],{label:`Hard ${this.title}`,description:"--hard",detail:`Will hard reset (discards all changes) ${(0,a.Wh)(t.destination)} to ${(0,a.Wh)(e.reference)}`})]),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}class RevertGitCommand extends d.tR{constructor(e,t){super(e,"revert","revert","Revert",{description:"undoes the changes of specified commits, by creating new commits with inverted changes"});let i=0;null!=t?.state?.repo&&i++,null==t?.state?.references||Array.isArray(t.state.references)&&0===t.state.references.length||i++,this.initialState={counter:i,confirm:!0,...t?.state}}get canSkipConfirm(){return!1}execute(e){e.repo.revert(...e.flags,...e.references.map((e=>e.ref)).reverse())}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,cache:new Map,destination:void 0,title:this.title};null==e.flags&&(e.flags=[]),null==e.references||Array.isArray(e.references)||(e.references=[e.references]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(null==t.destination){const i=await e.repo.getBranch();if(null==i)break;t.destination=i}if(e.counter<2||null==e.references||0===e.references.length){const r=t.destination.ref;let s=t.cache.get(r);null==s&&(s=this.container.git.getLog(e.repo.path,{ref:r,merges:!1}),t.cache.set(r,s));const n=yield*(0,d.Rj)(e,t,{log:await s,onDidLoadMore:e=>t.cache.set(r,Promise.resolve(e)),placeholder:(e,t)=>null==t?`${e.destination.name} has no commits`:"Choose commits to revert",picked:e.references?.map((e=>e.ref))});if(n===d.Vd){i&&e.counter--;continue}e.references=n}const r=yield*this.confirmStep(e,t);r!==d.Vd&&(e.flags=r,(0,d.uZ)(e),this.execute(e))}return e.counter<0?d.Vd:void 0}*confirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,["--no-edit"],{label:this.title,description:"--no-edit",detail:`Will revert ${(0,a.Wh)(e.references)}`}),l(e.flags,["--edit"],{label:`${this.title} & Edit`,description:"--edit",detail:`Will revert and edit ${(0,a.Wh)(e.references)}`})]),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}var N=i(6934),G=i(9729),H=i(4655);const V=new Map([["","Search by Message"],["=:","Search by Message"],["message:","Search by Message"],["@:","Search by Author"],["author:","Search by Author"],["#:","Search by Commit SHA"],["commit:","Search by Commit SHA"],["?:","Search by File"],["file:","Search by File"],["~:","Search by Changes"],["change:","Search by Changes"]]);class SearchGitCommand extends d.tR{constructor(e,t){super(e,"search","search","Commit Search",{description:"aka grep, searches for commits"});let i=0;null!=t?.state?.repo&&i++,null==t?.state?.query||t.prefillOnly||i++,this.initialState={counter:i,confirm:!1,...t?.state}}get canConfirm(){return!1}isMatch(e){return super.isMatch(e)||"grep"===e}isFuzzyMatch(e){return super.isFuzzyMatch(e)||"grep"===e}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.searchAndCompareView,commit:void 0,hasVirtualFolders:(0,n.fw)("gitlens:hasVirtualFolders",!1),resultsKey:void 0,resultsPromise:void 0,title:this.title},i=s.D.get("gitCommands.search");null==e.matchAll&&(e.matchAll=i.matchAll),null==e.matchCase&&(e.matchCase=i.matchCase),null==e.matchRegex&&(e.matchRegex=i.matchRegex),null==e.showResultsInSideBar&&(e.showResultsInSideBar=i.showResultsInSideBar??void 0);let r=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(r=!1,1===t.repos.length)r=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(e.counter<2||null==e.query){const i=yield*this.pickSearchOperatorStep(e,t);if(i===d.Vd){r&&e.counter--,e.query=void 0;continue}e.query=i}const i={query:e.query,matchAll:e.matchAll,matchCase:e.matchCase,matchRegex:e.matchRegex},s=(0,N.FL)(i);if(null!=t.resultsPromise&&t.resultsKey===s||(t.resultsPromise=e.repo.richSearchCommits(i),t.resultsKey=s),e.showResultsInSideBar){this.container.searchAndCompareView.search(e.repo.path,i,{label:{label:`for ${e.query}`}},t.resultsPromise,e.showResultsInSideBar instanceof H.V?e.showResultsInSideBar:void 0);break}if(e.counter<3||null==t.commit){const r=e.repo.path,s=yield*(0,d.s4)(e,t,{ignoreFocusOut:!0,log:await t.resultsPromise,onDidLoadMore:e=>t.resultsPromise=Promise.resolve(e),placeholder:(t,i)=>null==i?`No results for ${e.query}`:`${(0,u._6)("result",i.count,{format:e=>i.hasMore?`${e}+`:void 0})} for ${e.query}`,picked:t.commit?.ref,showInSideBarCommand:new G.qv("$(link-external)  Show Results in Side Bar",(()=>{this.container.searchAndCompareView.search(r,i,{label:{label:`for ${e.query}`},reveal:{select:!0,focus:!1,expand:!0}},t.resultsPromise)})),showInSideBarButton:{button:d.vU,onDidClick:()=>{this.container.searchAndCompareView.search(r,i,{label:{label:`for ${e.query}`},reveal:{select:!0,focus:!1,expand:!0}},t.resultsPromise)}}});if(s===d.Vd){e.counter--;continue}t.commit=s}let n;e.openPickInView?((0,S.Fw)(t.commit,{pin:!1,preserveFocus:!1}),n=d.Vd):n=yield*ce(this.container,{command:"show",state:{repo:e.repo,reference:t.commit}},this.pickedVia),e.counter--,n===d.Vd&&(0,d.uZ)(e)}return e.counter<0?d.Vd:void 0}*pickSearchOperatorStep(e,t){const i=[{label:V.get(""),description:`pattern or message: pattern or =: pattern ${C.NE.Dash} use quotes to search for phrases`,item:"message:"},{label:V.get("author:"),description:"author: pattern or @: pattern",item:"author:"},{label:V.get("commit:"),description:"commit: sha or #: sha",item:"commit:"},t.hasVirtualFolders?void 0:{label:V.get("file:"),description:"file: glob or ?: glob",item:"file:"},t.hasVirtualFolders?void 0:{label:V.get("change:"),description:"change: pattern or ~: pattern",item:"change:"}].filter((e=>null!=e)),r=new d.I4(e.matchCase),s=new d.eY(e.matchAll),n=new d.Mn(e.matchRegex),o=(0,d.xf)({title:(0,d.C8)(t.title,e,t),placeholder:'e.g. "Updates dependencies" author:eamodio',matchOnDescription:!0,matchOnDetail:!0,additionalButtons:[r,s,n],items:i,value:e.query,selectValueWhenShown:!1,onDidAccept:e=>{const t=e.selectedItems[0];if(!N.WY.has(t.item))return!0;const i=e.value.trim();return 0===i.length||N.WY.has(i)?e.value=t.item:e.value=`${i} ${t.item}`,o.onDidChangeValue(e),!1},onDidClickButton:(t,i)=>{i===r?(e.matchCase=!e.matchCase,r.on=e.matchCase):i===s?(e.matchAll=!e.matchAll,s.on=e.matchAll):i===n&&(e.matchRegex=!e.matchRegex,n.on=e.matchRegex)},onDidChangeValue:r=>{const s=r.value.trim();e.counter=s?3:2;const n=(0,N.pD)({query:s,matchCase:e.matchCase,matchAll:e.matchAll,matchRegex:e.matchRegex});return r.title=(0,d.C8)(0===n.size||n.size>1?t.title:`Commit ${V.get(n.keys().next().value)}`,e,t),0===r.value.length?r.items=i:(r.ignoreFocusOut=!0,o.ignoreFocusOut=!0,r.items=[{label:"Search for",description:r.value,item:r.value}]),!0}}),a=yield o;return(0,d.i9)(o,e,a)?(e.counter--,a[0].item.trim()):(e.counter--,d.Vd)}}var q=i(3931),Q=i(1742);function Y(e){if(!(e.repo instanceof c._j))throw new Error("Missing repository")}function j(e){if(!(0,R.f_)(e.reference))throw new Error("Missing reference")}function z(e){if(!e.fileName)throw new Error("Missing filename")}class ShowGitCommand extends d.tR{constructor(e,t){super(e,"show","show","Show",{description:"shows information about a git reference"});let i=0;null!=t?.state?.repo&&i++,null!=t?.state?.reference&&i++,null!=t?.state?.fileName&&(i+=2),this.initialState={counter:i,confirm:!1,...t?.state}}get canConfirm(){return!1}getStepState(e){const t=super.getStepState(e);return{...t,startingStep:e?Math.min(t.startingStep??0,1):0}}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(Y(e),(e.counter<2||null==e.reference||!(0,R.f_)(e.reference)||null!=e.reference.file)&&(null==e.reference||(0,R.f_)(e.reference)||(e.reference=await this.container.git.getCommit(e.reference.repoPath,e.reference.ref)),e.counter<2||null==e.reference)){const r=yield*(0,d.s4)(e,t,{log:{repoPath:e.repo.path,commits:new Map,sha:void 0,range:void 0,count:0,limit:void 0,hasMore:!1},placeholder:"Enter a reference or commit SHA",picked:e.reference?.ref});if(r===d.Vd){i&&e.counter--;continue}e.reference=r}if(j(e),e.counter<3){null==e.reference.files&&await e.reference.ensureFullDetails();const i=yield*(0,d.KT)(e,t);if(i===d.Vd)continue;if(i instanceof Q.Wv){const t=yield*i.executeSteps(this.pickedVia);e.counter--,t===d.Vd&&(0,d.uZ)(e);continue}if(i instanceof G.$w&&!(i instanceof q.PF)){(0,d.uZ)(e),i.execute();break}}if(e.counter<4||null==e.fileName){const i=yield*(0,d.fD)(e,t,{picked:e.fileName});if(i===d.Vd)continue;if(i instanceof q.PF){e.counter-=2;continue}e.fileName=i.file.path}z(e);const r=yield*(0,d.nI)(e,t);if(r!==d.Vd)if(r instanceof q.PF)e.counter-=2;else if(r instanceof Q.Wv)yield*r.executeSteps(this.pickedVia),e.counter--;else if(r instanceof G.$w){(0,d.uZ)(e),r.execute();break}}return e.counter<0?d.Vd:void 0}}var K=i(252),J=i(6592);const X=new Map([["apply","Apply"],["drop","Drop"],["list","List"],["pop","Pop"],["push","Push"],["rename","Rename"]]);function Z(e,t){return null==t?e:`${X.get(t)} ${e}`}class StashGitCommand extends d.tR{constructor(e,t){super(e,"stash","stash","Stash",{description:"shelves (stashes) local changes to be reapplied later"});let i=0;if(null!=t?.state?.subcommand)switch(i++,t.state.subcommand){case"apply":case"drop":case"pop":null!=t.state.reference&&i++;break;case"push":null!=t.state.message&&i++;break;case"rename":null!=t.state.reference&&i++,null!=t.state.message&&i++}null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}get canConfirm(){return null!=this.subcommand&&"list"!==this.subcommand}get canSkipConfirm(){return"drop"!==this.subcommand&&super.canSkipConfirm}get skipConfirmKey(){return`${this.key}${null==this.subcommand?"":`-${this.subcommand}`}:${this.pickedVia}`}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.stashesView,readonly:(0,n.fw)("gitlens:readonly",!1)||(0,n.fw)("gitlens:untrusted",!1)||(0,n.fw)("gitlens:hasVirtualFolders",!1),title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,t.readonly&&(e.subcommand="list"),e.counter<1||null==e.subcommand){this.subcommand=void 0;const t=yield*this.pickSubcommandStep(e);if(t===d.Vd)break;e.subcommand=t}if(this.subcommand=e.subcommand,t.title=Z(this.title,e.subcommand),e.counter<2||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)continue;e.repo=i}switch(e.subcommand){case"apply":case"pop":yield*this.applyOrPopCommandSteps(e,t);break;case"drop":yield*this.dropCommandSteps(e,t);break;case"list":yield*this.listCommandSteps(e,t);break;case"push":yield*this.pushCommandSteps(e,t);break;case"rename":yield*this.renameCommandSteps(e,t),e.message=void 0;break;default:(0,d.uZ)(e)}i&&e.counter--}return e.counter<0?d.Vd:void 0}*pickSubcommandStep(e){const t=(0,d.xf)({title:this.title,placeholder:`Choose a ${this.label} command`,items:[{label:"apply",description:"integrates changes from the specified stash into the current branch",picked:"apply"===e.subcommand,item:"apply"},{label:"drop",description:"deletes the specified stash",picked:"drop"===e.subcommand,item:"drop"},{label:"list",description:"lists the saved stashes",picked:"list"===e.subcommand,item:"list"},{label:"pop",description:"integrates changes from the specified stash into the current branch and deletes the stash",picked:"pop"===e.subcommand,item:"pop"},{label:"push",description:"saves your local changes to a new stash and discards them from the working tree and index",picked:"push"===e.subcommand,item:"push"},{label:"rename",description:"renames the specified stash",picked:"rename"===e.subcommand,item:"rename"}],buttons:[o.QuickInputButtons.Back]}),i=yield t;return(0,d.i9)(t,e,i)?i[0].item:d.Vd}async*applyOrPopCommandSteps(e,t){for(;this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Qp)(e,t,{stash:await this.container.git.getStash(e.repo.path),placeholder:(t,i)=>null==i?`No stashes found in ${e.repo.formattedName}`:"Choose a stash to apply to your working tree",picked:e.reference?.ref});if(i===d.Vd)break;e.reference=i}if(this.confirm(e.confirm)){const i=yield*this.applyOrPopCommandConfirmStep(e,t);if(i===d.Vd)continue;e.subcommand=i}(0,d.uZ)(e);try{if(await e.repo.stashApply("pop"===e.subcommand?`stash@{${e.reference.number}}`:e.reference.ref,{deleteAfter:"pop"===e.subcommand}),e.reference.message){const t=await this.container.git.getScmRepository(e.repo.path);null==t||t.inputBox.value||(t.inputBox.value=e.reference.message)}}catch(e){O.Yd.error(e,t.title),J.ef.is(e,J.bk.WorkingChanges)?o.window.showWarningMessage("Unable to apply stash. Your working tree changes would be overwritten. Please commit or stash your changes before trying again"):(0,$.W8)(e.message)}}}*applyOrPopCommandConfirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:"pop"===e.subcommand?`Will delete ${(0,a.Wh)(e.reference)} and apply the changes to the working tree`:`Will apply the changes from ${(0,a.Wh)(e.reference)} to the working tree`,item:e.subcommand},{label:Z(this.title,"pop"===e.subcommand?"apply":"pop"),detail:"pop"===e.subcommand?`Will apply the changes from ${(0,a.Wh)(e.reference)} to the working tree`:`Will delete ${(0,a.Wh)(e.reference)} and apply the changes to the working tree`,item:"pop"===e.subcommand?"apply":"pop"}],void 0,{placeholder:`Confirm ${t.title}`,additionalButtons:[d._9,d.Nv],onDidClickButton:(t,i)=>{i===d._9?(0,K.Fw)(e.reference,{pin:!1,preserveFocus:!0}):i===d.Nv&&(0,K.ay)(e.reference,{select:!0,expand:!0})}}),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*dropCommandSteps(e,t){for(;this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Qp)(e,t,{stash:await this.container.git.getStash(e.repo.path),placeholder:(t,i)=>null==i?`No stashes found in ${e.repo.formattedName}`:"Choose a stash to delete",picked:e.reference?.ref});if(i===d.Vd)break;e.reference=i}if((yield*this.dropCommandConfirmStep(e,t))!==d.Vd){(0,d.uZ)(e);try{await e.repo.stashDelete(`stash@{${e.reference.number}}`,e.reference.ref)}catch(e){return O.Yd.error(e,t.title),void(0,$.W8)("Unable to delete stash")}}}}*dropCommandConfirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:`Will delete ${(0,a.Wh)(e.reference)}`}],void 0,{placeholder:`Confirm ${t.title}`,additionalButtons:[d._9,d.Nv],onDidClickButton:(t,i)=>{i===d._9?(0,K.Fw)(e.reference,{pin:!1,preserveFocus:!0}):i===d.Nv&&(0,K.ay)(e.reference,{select:!0,expand:!0})}}),r=yield i;return(0,d.i9)(i,e,r)?void 0:d.Vd}async*listCommandSteps(e,t){for(t.title="Stashes";this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Qp)(e,t,{stash:await this.container.git.getStash(e.repo.path),placeholder:(t,i)=>null==i?`No stashes found in ${e.repo.formattedName}`:"Choose a stash",picked:e.reference?.ref});if(i===d.Vd)break;e.reference=i}const i=yield*ce(this.container,{command:"show",state:{repo:e.repo,reference:e.reference}},this.pickedVia);e.counter--,i===d.Vd&&(0,d.uZ)(e)}}async*pushCommandSteps(e,t){for(null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.message){if(null==e.message){const t=await this.container.git.getScmRepository(e.repo.path);e.message=t?.inputBox.value}const i=yield*this.pushCommandInputMessageStep(e,t);if(i===d.Vd)break;e.message=i}if(this.confirm(e.confirm)){const i=yield*this.pushCommandConfirmStep(e,t);if(i===d.Vd)continue;e.flags=i}try{await e.repo.stashSave(e.message,e.uris,{includeUntracked:e.flags.includes("--include-untracked"),keepIndex:e.flags.includes("--keep-index"),onlyStaged:e.flags.includes("--staged")}),(0,d.uZ)(e)}catch(i){if(O.Yd.error(i,t.title),i instanceof J.s8&&i.reason===J.g1.ConflictingStagedAndUnstagedLines&&e.flags.includes("--staged")){const t={title:"Yes"},r={title:"No",isCloseAffordance:!0};if(await o.window.showErrorMessage(i.message,{modal:!0},t,r)===t){e.uris=e.onlyStagedUris,e.flags.splice(e.flags.indexOf("--staged"),1);continue}return}const r=i?.message??i?.toString()??"";return r.includes("newer version of Git")?void o.window.showErrorMessage(`Unable to stash changes. ${r}`):void(0,$.W8)("Unable to stash changes")}}}async*pushCommandInputMessageStep(e,t){const i=(0,d.Ke)({title:(0,d.C8)(t.title,e,t,null!=e.uris?`${(0,u.vk)(C.NE.Dot,2,2)}${1===e.uris.length?(0,D.d)(e.uris[0],{fileOnly:!0}):`${e.uris.length} files`}`:void 0),placeholder:"Please provide a stash message",value:e.message,prompt:"Enter stash message"}),r=yield i;return(0,d.$V)(i,e,r)&&await(0,d.Wm)(i,e,r)?r:d.Vd}*pushCommandConfirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),null==e.uris||0===e.uris.length?[l(e.flags,[],{label:t.title,detail:"Will stash uncommitted changes"}),l(e.flags,["--include-untracked"],{label:`${t.title} & Include Untracked`,description:"--include-untracked",detail:"Will stash uncommitted changes, including untracked files"}),l(e.flags,["--keep-index"],{label:`${t.title} & Keep Staged`,description:"--keep-index",detail:"Will stash uncommitted changes, but will keep staged files intact"})]:[l(e.flags,[],{label:t.title,detail:`Will stash changes from ${1===e.uris.length?(0,D.d)(e.uris[0],{fileOnly:!0}):`${e.uris.length} files`}`}),l(e.flags,["--keep-index"],{label:`${t.title} & Keep Staged`,detail:`Will stash changes from ${1===e.uris.length?(0,D.d)(e.uris[0],{fileOnly:!0}):`${e.uris.length} files`}, but will keep staged files intact`})],void 0,{placeholder:`Confirm ${t.title}`}),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*renameCommandSteps(e,t){for(;this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Qp)(e,t,{stash:await this.container.git.getStash(e.repo.path),placeholder:(t,i)=>null==i?`No stashes found in ${e.repo.formattedName}`:"Choose a stash to rename",picked:e.reference?.ref});if(i===d.Vd)break;e.reference=i}if(e.counter<4||null==e.message){const i=yield*this.renameCommandInputMessageStep(e,t);if(i===d.Vd)continue;e.message=i}if(this.confirm(e.confirm)){if((yield*this.renameCommandConfirmStep(e,t))===d.Vd)continue}(0,d.uZ)(e);try{await e.repo.stashRename(e.reference.name,e.reference.ref,e.message,e.reference.stashOnRef)}catch(e){O.Yd.error(e,t.title),(0,$.W8)(e.message)}}}async*renameCommandInputMessageStep(e,t){const i=(0,d.Ke)({title:(0,d.C8)(t.title,e,t),placeholder:`Please provide a new message for ${(0,a.Wh)(e.reference,{icon:!1})}`,value:e.message??e.reference?.message,prompt:"Enter new stash message"}),r=yield i;return(0,d.$V)(i,e,r)&&await(0,d.Wm)(i,e,r)?r:d.Vd}*renameCommandConfirmStep(e,t){const i=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:`Will rename ${(0,a.Wh)(e.reference)}`,item:e.subcommand}],void 0,{placeholder:`Confirm ${t.title}`,additionalButtons:[d._9,d.Nv],onDidClickButton:(t,i)=>{i===d._9?(0,K.Fw)(e.reference,{pin:!1,preserveFocus:!0}):i===d.Nv&&(0,K.ay)(e.reference,{select:!0,expand:!0})}}),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}class StatusGitCommand extends d.tR{constructor(e,t){super(e,"status","status","Status",{description:"shows status information about a repository"});let i=0;null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:!1,...t?.state}}get canConfirm(){return!1}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,status:void 0,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)break;e.repo=i}if(t.status=await e.repo.getStatus(),null==t.status)return;t.title=`${this.title}${(0,u.vk)(C.NE.Dot,2,2)}${(0,a.Wh)((0,a.xB)(t.status.branch,e.repo.path,{refType:"branch",name:t.status.branch,remote:!1,upstream:null!=t.status.upstream?{name:t.status.upstream,missing:!1}:void 0}),{icon:!1})}`;const r=yield*(0,d.up)(e,t);if(r!==d.Vd){if(r instanceof Q.Wv){const t=yield*r.executeSteps(this.pickedVia);e.counter--,t===d.Vd&&(0,d.uZ)(e)}else if(r instanceof G.$w){(0,d.uZ)(e),r.execute();break}}else i&&e.counter--}}}class SwitchGitCommand extends d.tR{constructor(e,t){super(e,"switch","switch","Switch Branch",{description:"aka checkout, switches the current branch to a specified branch"});let i=0;null==t?.state?.repos||Array.isArray(t.state.repos)&&0===t.state.repos.length||i++,null!=t?.state?.reference&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}async execute(e){await o.window.withProgress({location:o.ProgressLocation.Notification,title:`Switching ${1===e.repos.length?e.repos[0].formattedName:`${e.repos.length} repositories`} to ${e.reference.name}`},(()=>Promise.all(e.repos.map((t=>t.switch(e.reference.ref,{createBranch:e.createBranch,progress:!1})))))),null!=e.fastForwardTo&&e.repos[0].merge("--ff-only",e.fastForwardTo.ref)}isMatch(e){return super.isMatch(e)||"checkout"===e}isFuzzyMatch(e){return super.isFuzzyMatch(e)||"checkout"===e}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.commitsView,showTags:!1,switchToLocalFrom:void 0,title:this.title};null==e.repos||Array.isArray(e.repos)||(e.repos=[e.repos]);let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.repos||0===e.repos.length||(0,A.GI)(e.repos))if(i=!1,1===t.repos.length)i=!0,null==e.repos&&e.counter++,e.repos=[t.repos[0]];else{const i=yield*(0,d.j8)(e,t,{skipIfPossible:e.counter>=1});if(i===d.Vd)break;e.repos=i}if(e.counter<2||null==e.reference){const r=yield*(0,d.xC)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to switch to`});if(r===d.Vd){i&&e.counter--;continue}e.reference=r}if((0,a.UR)(e.reference)&&e.reference.remote){t.title=`Create Branch and ${this.title}`;const{values:i}=await this.container.git.getBranches(e.reference.repoPath,{filter:t=>t.upstream?.name===e.reference.name,sort:{orderBy:r.Vz.DateDesc}});if(0===i.length){const i=yield*(0,d.f6)(e,t,{placeholder:"Please provide a name for the new branch",titleContext:` based on ${(0,a.Wh)(e.reference,{icon:!1})}`,value:e.createBranch??(0,a.Av)(e.reference)});if(i===d.Vd)continue;e.createBranch=i}else t.title=`${this.title} to Local Branch`,t.switchToLocalFrom=e.reference,e.reference=i[0],e.createBranch=void 0}else e.createBranch=void 0;if(this.confirm(e.confirm||null!=t.switchToLocalFrom)){const i=yield*this.confirmStep(e,t);if(i===d.Vd)continue;"switch+fast-forward"===i&&(e.fastForwardTo=t.switchToLocalFrom)}(0,d.uZ)(e),this.execute(e)}return e.counter<0?d.Vd:void 0}*confirmStep(e,t){let i;i=null!=t.switchToLocalFrom&&1===e.repos.length?[{label:`${t.title} and Fast-Forward`,description:"",detail:`Will switch to and fast-forward local ${(0,a.Wh)(e.reference)} in $(repo) ${e.repos[0].formattedName}`,item:"switch+fast-forward"}]:[];const r=this.createConfirmStep((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,description:e.createBranch?"-b":"",detail:`Will ${e.createBranch?`create and switch to a new branch named ${e.createBranch} from ${(0,a.Wh)(e.reference)}`:`switch to ${null!=t.switchToLocalFrom?"local ":""}${(0,a.Wh)(e.reference)}`} in ${1===e.repos.length?`$(repo) ${e.repos[0].formattedName}`:`${e.repos.length} repositories`}`,item:"switch"},...i],void 0,{placeholder:`Confirm ${t.title}`}),s=yield r;return(0,d.i9)(r,e,s)?s[0].item:d.Vd}}const ee=new Map([["create","Create"],["delete","Delete"]]);function te(e,t){return null==t?e:`${ee.get(t)} ${e}`}class TagGitCommand extends d.tR{constructor(e,t){super(e,"tag","tag","Tag",{description:"create, or delete tags"});let i=0;if(null!=t?.state?.subcommand)switch(i++,t.state.subcommand){case"create":null!=t.state.reference&&i++,null!=t.state.name&&i++,null!=t.state.message&&i++;break;case"delete":null==t.state.references||Array.isArray(t.state.references)&&0===t.state.references.length||i++}null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}get canConfirm(){return null!=this.subcommand}get canSkipConfirm(){return"delete"!==this.subcommand&&super.canSkipConfirm}get skipConfirmKey(){return`${this.key}${null==this.subcommand?"":`-${this.subcommand}`}:${this.pickedVia}`}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.tagsView,showTags:!1,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.subcommand){this.subcommand=void 0;const t=yield*this.pickSubcommandStep(e);if(t===d.Vd)break;e.subcommand=t}if(this.subcommand=e.subcommand,e.counter<2||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)continue;e.repo=i}switch(t.title=te("delete"===e.subcommand?"Tags":this.title,e.subcommand),e.subcommand){case"create":yield*this.createCommandSteps(e,t),e.name=void 0;break;case"delete":yield*this.deleteCommandSteps(e,t);break;default:(0,d.uZ)(e)}i&&e.counter--}return e.counter<0?d.Vd:void 0}*pickSubcommandStep(e){const t=(0,d.xf)({title:this.title,placeholder:`Choose a ${this.label} command`,items:[{label:"create",description:"creates a new tag",picked:"create"===e.subcommand,item:"create"},{label:"delete",description:"deletes the specified tags",picked:"delete"===e.subcommand,item:"delete"}],buttons:[o.QuickInputButtons.Back]}),i=yield t;return(0,d.i9)(t,e,i)?i[0].item:d.Vd}async*createCommandSteps(e,t){for(null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Yv)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to create the new tag from`,picked:e.reference?.ref??(await e.repo.getBranch())?.ref,titleContext:" from",value:(0,a.FT)(e.reference)?e.reference.ref:void 0});if(i===d.Vd)break;e.reference=i}if(e.counter<4||null==e.name){const i=yield*(0,d.fG)(e,t,{placeholder:"Please provide a name for the new tag",titleContext:` at ${(0,a.Wh)(e.reference,{capitalize:!0,icon:!1})}`,value:e.name??(0,a.Av)(e.reference)});if(i===d.Vd)continue;e.name=i}if(e.counter<5||null==e.message){const i=yield*this.createCommandInputMessageStep(e,t);if(i===d.Vd)continue;e.message=i}if(0===e.message.length||e.flags.includes("-m")||e.flags.push("-m"),this.confirm(e.confirm)){const i=yield*this.createCommandConfirmStep(e,t);if(i===d.Vd)continue;e.flags=i}(0,d.uZ)(e),e.repo.tag(...e.flags,...0!==e.message.length?[`"${e.message}"`]:[],e.name,e.reference.ref)}}async*createCommandInputMessageStep(e,t){const i=(0,d.Ke)({title:(0,d.C8)(`${t.title} at ${(0,a.Wh)(e.reference,{capitalize:!0,icon:!1})}`,e,t),placeholder:"Please provide an optional message to annotate the tag",value:e.message,prompt:"Enter optional message"}),r=yield i;return(0,d.$V)(i,e,r)&&await(0,d.Wm)(i,e,r)?r:d.Vd}*createCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,0!==e.message.length?["-m"]:[],{label:t.title,description:0!==e.message.length?"-m":"",detail:`Will create a new tag named ${e.name} at ${(0,a.Wh)(e.reference)}`}),l(e.flags,0!==e.message.length?["--force","-m"]:["--force"],{label:`Force ${t.title}`,description:"--force"+(0!==e.message.length?" -m":""),detail:`Will forcibly create a new tag named ${e.name} at ${(0,a.Wh)(e.reference)}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*deleteCommandSteps(e,t){for(;this.canStepsContinue(e);){if(null==e.references||Array.isArray(e.references)||(e.references=[e.references]),e.counter<3||null==e.references||0===e.references.length){t.title=te("Tags",e.subcommand);const i=yield*(0,d.yY)(e,t,{picked:e.references?.map((e=>e.ref)),placeholder:"Choose tags to delete"});if(i===d.Vd)break;e.references=i}t.title=te((0,u._6)("Tag",e.references.length,{only:!0}),e.subcommand);(yield*this.deleteCommandConfirmStep(e,t))!==d.Vd&&((0,d.uZ)(e),e.repo.tagDelete(e.references))}}*deleteCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[{label:t.title,detail:`Will delete ${(0,a.Wh)(e.references)}`}],t),r=yield i;return(0,d.i9)(i,e,r)?void 0:d.Vd}}var ie=i(8887),re=i(5025),se=i(2674);function ne(e){if(null==e.repo||"string"==typeof e.repo)throw new Error("Missing repository")}const oe=new Map([["create","Create"],["delete","Delete"],["open","Open"]]);function ae(e,t){return null==t?e:`${oe.get(t)} ${e}`}class WorktreeGitCommand extends d.tR{constructor(e,t){super(e,"worktree","worktree","Worktree",{description:"open, create, or delete worktrees"});let i=0;if(null!=t?.state?.subcommand)switch(i++,t.state.subcommand){case"create":null!=t.state.uri&&i++,null!=t.state.reference&&i++;break;case"delete":null==t.state.uris||Array.isArray(t.state.uris)&&0===t.state.uris.length||i++;break;case"open":null!=t.state.uri&&i++}null!=t?.state?.repo&&i++,this.initialState={counter:i,confirm:t?.confirm,...t?.state}}get canConfirm(){return null!=this.subcommand}get canSkipConfirm(){return this.canSkipConfirmOverride??!1}get skipConfirmKey(){return`${this.key}${null==this.subcommand?"":`-${this.subcommand}`}:${this.pickedVia}`}async*steps(e){const t={repos:this.container.git.openRepositories,associatedView:this.container.worktreesView,showTags:!1,title:this.title};let i=!1;for(;this.canStepsContinue(e);){if(t.title=this.title,e.counter<1||null==e.subcommand){this.subcommand=void 0;const t=yield*this.pickSubcommandStep(e);if(t===d.Vd)break;e.subcommand=t}if(this.subcommand=e.subcommand,e.counter<2||null==e.repo||"string"==typeof e.repo)if(i=!1,1===t.repos.length)i=!0,null==e.repo&&e.counter++,e.repo=t.repos[0];else{const i=yield*(0,d.lA)(e,t);if(i===d.Vd)continue;e.repo=i}e.repo=await e.repo.getMainRepository()??e.repo,ne(e);if((yield*(0,d.Oz)(e,t,ie.x.Worktrees))===d.Vd)break;switch(t.title=ae("delete"===e.subcommand?"Worktrees":this.title,e.subcommand),e.subcommand){case"create":yield*this.createCommandSteps(e,t),e.uri=void 0;break;case"delete":null==e.uris||Array.isArray(e.uris)||(e.uris=[e.uris]),yield*this.deleteCommandSteps(e,t);break;case"open":yield*this.openCommandSteps(e,t);break;default:(0,d.uZ)(e)}i&&e.counter--}return e.counter<0?d.Vd:void 0}*pickSubcommandStep(e){const t=(0,d.xf)({title:this.title,placeholder:`Choose a ${this.label} command`,items:[{label:"open",description:"opens the specified worktree",picked:"open"===e.subcommand,item:"open"},{label:"create",description:"creates a new worktree",picked:"create"===e.subcommand,item:"create"},{label:"delete",description:"deletes the specified worktrees",picked:"delete"===e.subcommand,item:"delete"}],buttons:[o.QuickInputButtons.Back]}),i=yield t;return(0,d.i9)(t,e,i)?i[0].item:d.Vd}async*createCommandSteps(e,t){for(null==t.defaultUri&&(t.defaultUri=await e.repo.getWorktreesDefaultUri()),null==e.flags&&(e.flags=[]),t.pickedUri=void 0,e.confirm=!0,this.canSkipConfirmOverride=void 0;this.canStepsContinue(e);){if(e.counter<3||null==e.reference){const i=yield*(0,d.Yv)(e,t,{placeholder:e=>`Choose a branch${e.showTags?" or tag":""} to create the new worktree for`,picked:e.reference?.ref??(await e.repo.getBranch())?.ref,titleContext:" for",value:(0,a.FT)(e.reference)?e.reference.ref:void 0});if(i===d.Vd)break;e.reference=i}if(e.counter<4||null==e.uri)if(null==e.reference||s.D.get("worktrees.promptForLocation",e.repo.folder)||null==t.defaultUri){const i=yield*this.createCommandChoosePathStep(e,t,{titleContext:` for ${(0,a.Wh)(e.reference,{capitalize:!0,icon:!1,label:"branch"!==e.reference.refType})}`,defaultUri:t.defaultUri});if(i===d.Vd)continue;e.uri=i,t.pickedUri=e.uri}else e.uri=t.defaultUri;if(this.confirm(e.confirm)){const i=yield*this.createCommandConfirmStep(e,t);if(i===d.Vd)continue;[e.uri,e.flags]=i}e.confirm=!0,this.canSkipConfirmOverride=void 0;if("branch"===e.reference?.refType&&e.reference?.remote&&!e.flags.includes("-b")){e.flags.push("-b"),e.createBranch=(0,a.Av)(e.reference);null!=await e.repo.getBranch(e.createBranch)&&(e.createBranch=e.reference.name)}if(e.flags.includes("-b")){let i;if(null!=e.createBranch){let t=await this.container.git.validateBranchOrTagName(e.repo.path,e.createBranch);if(t){t=null==await e.repo.getBranch(e.createBranch)}t||(i=e.createBranch,e.createBranch=void 0)}if(null==e.createBranch){const r=yield*(0,d.f6)(e,t,{placeholder:"Please provide a name for the new branch",titleContext:` from ${(0,a.Wh)(e.reference,{capitalize:!0,icon:!1,label:"branch"!==e.reference.refType})}`,value:i??e.createBranch??(0,a.Av)(e.reference)});if(r===d.Vd){e.flags=[];continue}e.createBranch=r}}const i=e.flags.includes("--direct")?e.uri:o.Uri.joinPath(e.uri,...(e.createBranch??e.reference.name).replace(/\\/g,"/").split("/"));let r;try{r=await e.repo.createWorktree(i,{commitish:e.reference?.name,createBranch:e.flags.includes("-b")?e.createBranch:void 0,detach:e.flags.includes("--detach"),force:e.flags.includes("--force")}),!1!==e.reveal&&(0,re.ay)(void 0,{select:!0,focus:!0})}catch(t){if(J.P6.is(t,J.hK.AlreadyCheckedOut)&&!e.flags.includes("--force")){const t={title:"Create New Branch"},i={title:"Create Anyway"},r={title:"Cancel",isCloseAffordance:!0},s=await o.window.showWarningMessage(`Unable to create the new worktree because ${(0,a.Wh)(e.reference,{icon:!1,quoted:!0})} is already checked out.\n\nWould you like to create a new branch for this worktree or forcibly create it anyway?`,{modal:!0},t,i,r);if(s===t){e.flags.push("-b"),this.canSkipConfirmOverride=!0,e.confirm=!1;continue}if(s===i){e.flags.push("--force"),this.canSkipConfirmOverride=!0,e.confirm=!1;continue}}else J.P6.is(t,J.hK.AlreadyExists)?o.window.showErrorMessage(`Unable to create a new worktree in '${se.e.getFriendlyPath(i)}' because the folder already exists and is not empty.`,"OK"):(0,$.W8)(`Unable to create a new worktree in '${se.e.getFriendlyPath(i)}.`)}if((0,d.uZ)(e),null==r)break;const n=s.D.get("worktrees.openAfterCreate");if("never"===n)break;if("prompt"===n){yield*this.openCommandSteps({subcommand:"open",repo:e.repo,uri:r.uri,counter:3,confirm:!0},t);break}queueMicrotask((()=>{switch(n){case"always":(0,F.ic)(r.uri,{location:F.Tc.CurrentWindow});break;case"alwaysNewWindow":(0,F.ic)(r.uri,{location:F.Tc.NewWindow});break;case"onlyWhenEmpty":(0,F.ic)(r.uri,{location:o.workspace.workspaceFolders?.length?F.Tc.CurrentWindow:F.Tc.NewWindow})}}))}}async*createCommandChoosePathStep(e,t,i){const r=(0,d.jf)({show:async r=>{const s=null!=i?.defaultUri,n=await o.window.showInformationMessage(`Choose a location in which to create the worktree${i.titleContext}.`,{modal:!0},{title:"Choose Location"},...s?[{title:"Use Default Location"}]:[]);if(null==n)return _.Xe.Back;if("Use Default Location"===n.title)return i.defaultUri;const a=await o.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.pickedUri??e.uri??t.defaultUri,openLabel:"Select Worktree Location",title:`${(0,d.C8)(`Choose a Worktree Location${i.titleContext}`,e,t)}`});return null==a||0===a.length?_.Xe.Back:a[0]}}),s=yield r;return(0,d.$V)(r,e,s)&&await(0,d.Wm)(r,e,s)?s:d.Vd}*createCommandConfirmStep(e,t){const i=t.pickedUri??e.uri,r=(0,u.AO)(se.e.getFriendlyPath(i),60);let s,n=!0;const c=e.repo.uri,h=`${(0,b.EZ)(c.path)}.worktrees`;c.toString()!==i.toString()?s=(0,b.$d)(i,c)?o.Uri.joinPath(c,"..",h):(0,b.EZ)(i.path)===h?i:o.Uri.joinPath(i,h):(s=o.Uri.joinPath(c,"..",h),n=!1);const p=e.createBranch??(null!=e.reference?(0,a.Av)(e.reference):void 0),m=p?o.Uri.joinPath(s,...p.replace(/\\/g,"/").split("/")):s,g=(0,u.AO)(se.e.getFriendlyPath(m),65),f=(0,u.AO)(se.e.getFriendlyPath(o.Uri.joinPath(s,"<new-branch-name>")),60),w="branch"===e.reference?.refType&&e.reference?.remote,v=(0,d.Tv)((0,d.C8)(`Confirm ${t.title} • ${(0,a.Wh)(e.reference,{icon:!1,label:!1})}`,e,t),[l(e.flags,w?["-b"]:[],{label:w?"Create Local Branch and Worktree":t.title,description:" in subfolder",detail:`Will create worktree in $(folder) ${g}`},s),l(e.flags,["-b"],{label:w?"Create New Local Branch and Worktree":"Create New Branch and Worktree",description:" in subfolder",detail:`Will create worktree in $(folder) ${f}`},s),...n?[(0,G.fz)(),l(e.flags,["--direct"],{label:w?"Create Local Branch and Worktree":t.title,description:" directly in folder",detail:`Will create worktree directly in $(folder) ${r}`},i),l(e.flags,["-b","--direct"],{label:w?"Create New Local Branch and Worktree":"Create New Branch and Worktree",description:" directly in folder",detail:`Will create worktree directly in $(folder) ${r}`},i)]:[]],t),y=yield v;return(0,d.i9)(v,e,y)?[y[0].context,y[0].item]:d.Vd}async*deleteCommandSteps(e,t){for(t.worktrees=await e.repo.getWorktrees(),null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.uris||0===e.uris.length){t.title=ae("Worktrees",e.subcommand);const i=yield*(0,d.Mb)(e,t,{filter:e=>e.main||!e.opened,includeStatus:!0,picked:e.uris?.map((e=>e.toString())),placeholder:"Choose worktrees to delete"});if(i===d.Vd)break;e.uris=i.map((e=>e.uri))}t.title=ae((0,u._6)("Worktree",e.uris.length,{only:!0}),e.subcommand);const i=yield*this.deleteCommandConfirmStep(e,t);if(i!==d.Vd){e.flags=i,(0,d.uZ)(e);for(const i of e.uris){let r=!1;do{r=!1;const s=e.flags.includes("--force");try{if(s){const e=t.worktrees.find((e=>e.uri.toString()===i.toString())),r=await(e?.getStatus());if(r?.hasChanges){const e={title:"Force Delete"},t={title:"Cancel",isCloseAffordance:!0};if(await o.window.showWarningMessage(`The worktree in '${i.fsPath}' has uncommitted changes.\n\nDeleting it will cause those changes to be FOREVER LOST.\nThis is IRREVERSIBLE!\n\nAre you sure you still want to delete it?`,{modal:!0},e,t)!==e)return}}await e.repo.deleteWorktree(i,{force:s})}catch(t){if(J.Nk.is(t)){if(t.reason===J.xe.MainWorkingTree)o.window.showErrorMessage("Unable to delete the main worktree");else if(!s){const s={title:"Force Delete"},n={title:"Cancel",isCloseAffordance:!0};await o.window.showErrorMessage(t.reason===J.xe.HasChanges?`Unable to delete worktree because there are UNCOMMITTED changes in '${i.fsPath}'.\n\nForcibly deleting it will cause those changes to be FOREVER LOST.\nThis is IRREVERSIBLE!\n\nWould you like to forcibly delete it?`:`Unable to delete worktree in '${i.fsPath}'.\n\nWould you like to try to forcibly delete it?`,{modal:!0},s,n)===s&&(e.flags.push("--force"),r=!0)}}else(0,$.W8)(`Unable to delete worktree in '${i.fsPath}.`)}}while(r)}}}}*deleteCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:t.title,detail:`Will delete ${(0,u._6)("worktree",e.uris.length,{only:1===e.uris.length})}${1===e.uris.length?` in $(folder) ${se.e.getFriendlyPath(e.uris[0])}`:""}`}),l(e.flags,["--force"],{label:`Force ${t.title}`,description:"including ANY UNCOMMITTED changes",detail:`Will forcibly delete ${(0,u._6)("worktree",e.uris.length,{only:1===e.uris.length})} ${1===e.uris.length?` in $(folder) ${se.e.getFriendlyPath(e.uris[0])}`:""}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}async*openCommandSteps(e,t){for(t.worktrees=await e.repo.getWorktrees(),null==e.flags&&(e.flags=[]);this.canStepsContinue(e);){if(e.counter<3||null==e.uri){t.title=ae("Worktree",e.subcommand);const i=yield*(0,d.UP)(e,t,{includeStatus:!0,picked:e.uri?.toString(),placeholder:"Choose worktree to open"});if(i===d.Vd)break;e.uri=i.uri}t.title=ae("Worktree",e.subcommand);const i=yield*this.openCommandConfirmStep(e,t);if(i===d.Vd)continue;e.flags=i,(0,d.uZ)(e);const r=t.worktrees.find((t=>t.uri.toString()===e.uri.toString()));if(null==r)break;e.flags.includes("--reveal-explorer")?(0,re.qM)(r):(0,F.ic)(r.uri,{location:(0,re.BC)(e.flags)})}}*openCommandConfirmStep(e,t){const i=(0,d.Tv)((0,d.C8)(`Confirm ${t.title}`,e,t),[l(e.flags,[],{label:t.title,detail:`Will open in the current window, the worktree in $(folder) ${se.e.getFriendlyPath(e.uri)}`}),l(e.flags,["--new-window"],{label:`${t.title} in a New Window`,detail:`Will open in a new window, the worktree in $(folder) ${se.e.getFriendlyPath(e.uri)}`}),l(e.flags,["--add-to-workspace"],{label:"Add Worktree to Workspace",detail:`Will add into the current workspace, the worktree in $(folder) ${se.e.getFriendlyPath(e.uri)}`}),l(e.flags,["--reveal-explorer"],{label:"Reveal in File Explorer",detail:`Will open in the File Explorer, the worktree in $(folder) ${se.e.getFriendlyPath(e.uri)}`})],t),r=yield i;return(0,d.i9)(i,e,r)?r[0].item:d.Vd}}function ce(e,t,i){const r=new PickCommandStep(e,t),s=r.find(t.command);return null==s?function*(){}():(r.setCommand(s,i),s.executeSteps())}class PickCommandStep{constructor(e,t){this.container=e,this.buttons=[],this.ignoreFocusOut=!1,this.matchOnDescription=!0,this.placeholder="Choose a git command",this.title="GitLens";const i=(0,n.fw)("gitlens:hasVirtualFolders",!1),o=i||(0,n.fw)("gitlens:readonly",!1)||(0,n.fw)("gitlens:untrusted",!1);if(this.items=[o?void 0:new BranchGitCommand(e,"branch"===t?.command?t:void 0),o?void 0:new CherryPickGitCommand(e,"cherry-pick"===t?.command?t:void 0),i?void 0:new CoAuthorsGitCommand(e,"co-authors"===t?.command?t:void 0),o?void 0:new FetchGitCommand(e,"fetch"===t?.command?t:void 0),new LogGitCommand(e,"log"===t?.command?t:void 0),o?void 0:new MergeGitCommand(e,"merge"===t?.command?t:void 0),o?void 0:new PullGitCommand(e,"pull"===t?.command?t:void 0),o?void 0:new PushGitCommand(e,"push"===t?.command?t:void 0),o?void 0:new RebaseGitCommand(e,"rebase"===t?.command?t:void 0),o?void 0:new RemoteGitCommand(e,"remote"===t?.command?t:void 0),o?void 0:new ResetGitCommand(e,"reset"===t?.command?t:void 0),o?void 0:new RevertGitCommand(e,"revert"===t?.command?t:void 0),new SearchGitCommand(e,"search"===t?.command||"grep"===t?.command?t:void 0),new ShowGitCommand(e,"show"===t?.command?t:void 0),i?void 0:new StashGitCommand(e,"stash"===t?.command?t:void 0),i?void 0:new StatusGitCommand(e,"status"===t?.command?t:void 0),o?void 0:new SwitchGitCommand(e,"switch"===t?.command||"checkout"===t?.command?t:void 0),o?void 0:new TagGitCommand(e,"tag"===t?.command?t:void 0),i?void 0:new WorktreeGitCommand(e,"worktree"===t?.command?t:void 0)].filter((e=>null!=e)),s.D.get("gitCommands.sortBy")===r.zL.Usage){const e=this.container.storage.getWorkspace("gitComandPalette:usage");null!=e&&this.items.sort(((t,i)=>(e[i.key]??0)-(e[t.key]??0)))}this.hiddenItems=[]}get command(){return this._command}find(e,t=!1){if(t){const t=e.toLowerCase();return this.items.find((e=>e.isFuzzyMatch(t)))??this.hiddenItems.find((e=>e.isFuzzyMatch(t)))}return this.items.find((t=>t.isMatch(e)))??this.hiddenItems.find((t=>t.isMatch(e)))}setCommand(e,t){null!=this._command&&(this._command.picked=!1),null!=e&&(e.picked=!0,e.pickedVia=t),this._command=e,null!=e&&this.updateCommandUsage(e.key,Date.now())}async updateCommandUsage(e,t){let i=this.container.storage.getWorkspace("gitComandPalette:usage");void 0===i&&(i=Object.create(null)),i[e]=t,await this.container.storage.storeWorkspace("gitComandPalette:usage",i)}}},3016:(e,t,i)=>{i.d(t,{Ft:()=>h,I4:()=>a,Lp:()=>y,Mn:()=>l,My:()=>n,Nv:()=>p,Q0:()=>o,_9:()=>g,_r:()=>d,cq:()=>w,eY:()=>c,ip:()=>m,jQ:()=>ToggleQuickInputButton,vU:()=>f,v_:()=>u,zY:()=>v});var r=i(9496),s=i(5567);class ToggleQuickInputButton{constructor(e,t=!1){this.state=e,this._on=t}get iconPath(){const e=this.getToggledState().icon;return"string"==typeof e?{dark:r.Uri.file(s.W.instance.context.asAbsolutePath(`images/dark/${e}.svg`)),light:r.Uri.file(s.W.instance.context.asAbsolutePath(`images/light/${e}.svg`))}:e}get tooltip(){return this.getToggledState().tooltip}get on(){return this._on}set on(e){this._on=e}getState(){return"function"==typeof this.state?this.state():this.state}getToggledState(){return this.on?this.getState().on:this.getState().off}}class SelectableQuickInputButton extends ToggleQuickInputButton{constructor(e,t,i=!1){super({off:{tooltip:e,icon:t.off},on:{tooltip:e,icon:t.on}},i)}}const n={iconPath:new r.ThemeIcon("sync"),tooltip:"Fetch"},o={iconPath:new r.ThemeIcon("refresh"),tooltip:"Load More"},a=class extends SelectableQuickInputButton{constructor(e=!1){super("Match Case",{off:"icon-match-case",on:"icon-match-case-selected"},e)}},c=class extends SelectableQuickInputButton{constructor(e=!1){super("Match All",{off:"icon-match-all",on:"icon-match-all-selected"},e)}},l=class extends SelectableQuickInputButton{constructor(e=!1){super("Match using Regular Expressions",{off:"icon-match-regex",on:"icon-match-regex-selected"},e)}},h={iconPath:new r.ThemeIcon("git-commit"),tooltip:"Choose a Specific Commit"},u=class extends ToggleQuickInputButton{constructor(e=!1,t,i){super((()=>({on:{tooltip:"Choose a Specific Commit",icon:new r.ThemeIcon("git-commit")},off:{tooltip:"Choose a Branch"+(t.showTags?" or Tag":""),icon:new r.ThemeIcon("git-branch")}})),e),this.onDidClick=i}},d={iconPath:new r.ThemeIcon("empty-window"),tooltip:"Open in New Window"},p={iconPath:new r.ThemeIcon("search"),tooltip:"Reveal in Side Bar"},m={iconPath:new r.ThemeIcon("settings-gear"),tooltip:"Set as Default Remote"},g={iconPath:new r.ThemeIcon("eye"),tooltip:"Open Details"},f={iconPath:new r.ThemeIcon("link-external"),tooltip:"Show Results in Side Bar"},w=class extends SelectableQuickInputButton{constructor(e=!1){super("Show Tags",{off:new r.ThemeIcon("tag"),on:"icon-tag-selected"},e)}},v={iconPath:new r.ThemeIcon("check"),tooltip:"Will always confirm"},y=class extends ToggleQuickInputButton{constructor(e=!1,t){super((()=>({on:{tooltip:"Will confirm",icon:{dark:r.Uri.file(s.W.instance.context.asAbsolutePath("images/dark/icon-check.svg")),light:r.Uri.file(s.W.instance.context.asAbsolutePath("images/light/icon-check.svg"))}},off:{tooltip:"Skips confirm",icon:{dark:r.Uri.file(s.W.instance.context.asAbsolutePath("images/dark/icon-no-check.svg")),light:r.Uri.file(s.W.instance.context.asAbsolutePath("images/light/icon-no-check.svg"))}}})),e),this.onDidClick=t}}},6270:(e,t,i)=>{i.d(t,{My:()=>n.My,Q0:()=>n.Q0,eY:()=>n.eY,I4:()=>n.I4,Mn:()=>n.Mn,_r:()=>n._r,Ft:()=>n.Ft,v_:()=>n.v_,tR:()=>QuickCommand,Nv:()=>n.Nv,_9:()=>n._9,vU:()=>n.vU,cq:()=>n.cq,Vd:()=>we,C8:()=>B,Wm:()=>ye,i9:()=>be,$V:()=>Ce,Tv:()=>Ae,jf:()=>Re,Ke:()=>Pe,xf:()=>Se,uZ:()=>De,Oz:()=>pe,B$:()=>U,v$:()=>N,f6:()=>G,NQ:()=>H,Kf:()=>V,fG:()=>q,a:()=>me,YB:()=>ve,Gj:()=>ge,Dr:()=>fe,Yv:()=>j,xC:()=>z,sd:()=>Q,FO:()=>Y,s4:()=>K,Rj:()=>J,bR:()=>X,Lt:()=>Z,j8:()=>te,lA:()=>ee,Qp:()=>ie,yY:()=>re,UP:()=>se,Mb:()=>ne,nI:()=>le,fD:()=>ce,KT:()=>oe,up:()=>ue});var r=i(3599),s=i(5148),n=i(3016),o=i(2540),a=i(5255),c=i(5567),l=i(3401),h=i(6897),u=i(7445),d=i(4155),p=i(8834),m=i(252),g=i(6713),f=i(5025),w=i(5367),v=i(6450),y=i(4321),b=i(3050),C=i(6503),A=i(3646),P=i(9502),S=i(4794),R=i(3931),D=i(9729),k=i(1742),_=i(5009),T=i(4968),F=i(2800),E=i(1774),$=i(3105),O=i(7469),x=i(3620),I=i(2509);function B(e,t,i,r){if(1===i.repos.length)return r?`${e}${(0,x.$G)(r,a.d$-e.length)}`:e;let s;return s=null!=t.repo?`${r??""}${(0,x.vk)(a.NE.Dot,2,2)}${t.repo.formattedName}`:1===t.repos.length?`${r??""}${(0,x.vk)(a.NE.Dot,2,2)}${t.repos[0].formattedName}`:`${(0,x.vk)(a.NE.Dot,2,2)}${t.repos.length} repositories`,`${e}${(0,x.$G)(s,a.d$-e.length)}`}async function W(e,t){return U(e,["branches"],{buttons:t?.buttons,filter:null!=t?.filter?{branches:t.filter}:void 0,picked:t?.picked,sort:null==t?.sort||{branches:t.sort}})}async function L(e,t){if(null==e)return[];return(await e.getRemotes(null!=t?.filter?{filter:t.filter}:void 0)).map((e=>(0,k.vl)(e,null!=t?.picked&&("string"==typeof t.picked?e.name===t.picked:t.picked.includes(e.name)),{buttons:t?.buttons,upstream:!0})))}async function M(e,{buttons:t,filter:i,includeStatus:r,picked:s}){const n=e instanceof A._j?await e.getWorktrees():e;return Promise.all([...n.filter((e=>null==i||i(e))).map((async e=>(0,k.E0)(e,null!=s&&("string"==typeof s?e.uri.toString()===s:s.includes(e.uri.toString())),{buttons:t,path:!0,status:r?await e.getStatus():void 0})))])}async function U(e,t,{buttons:i,filter:r,picked:s,sort:n}={}){if(null==e)return[];let o,a,c=!1;if(e instanceof A._j||1===e.length){c=!0;const i=e instanceof A._j?e:e[0],[s,l]=await Promise.allSettled([t.includes("branches")?i.getBranches({filter:r?.branches,sort:"boolean"==typeof n?n:n?.branches}):void 0,t.includes("tags")?i.getTags({filter:r?.tags,sort:!0}):void 0]);o=(0,O.Sb)(s)?.values??[],a=(0,O.Sb)(l)?.values??[]}else{const[i,s]=await Promise.allSettled([t.includes("branches")?Promise.allSettled(e.map((e=>e.getBranches({filter:r?.branches,sort:"boolean"==typeof n?n:n?.branches})))):void 0,t.includes("tags")?Promise.allSettled(e.map((e=>e.getTags({filter:r?.tags,sort:"boolean"==typeof n?n:n?.tags})))):void 0]),c="fulfilled"===i.status?i.value?.filter((e=>"fulfilled"===e.status))?.map((e=>e.value.values)):void 0,l="fulfilled"===s.status?s.value?.filter((e=>"fulfilled"===e.status))?.map((e=>e.value.values)):void 0;t.includes("branches")&&null!=c&&(o=(0,w.YF)((0,F.jV)(c,((e,t)=>e.name===t.name)))),t.includes("tags")&&null!=l&&(a=(0,P.Pj)((0,F.jV)(l,((e,t)=>e.name===t.name))))}return null!=o&&0!==o.length||null!=a&&0!==a.length?null==o||0===o.length||null!=a&&0!==a.length?null==a||0===a.length||null!=o&&0!==o.length?[(0,D.fz)("Branches"),...await Promise.all(o.filter((e=>!e.remote)).map((e=>(0,k.RE)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,current:!!c&&"checkmark",ref:c,status:c})))),(0,D.fz)("Tags"),...a.map((e=>(0,k.MH)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,message:!1,ref:c,type:!0}))),(0,D.fz)("Remote Branches"),...await Promise.all(o.filter((e=>e.remote)).map((e=>(0,k.RE)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,current:!!c&&"checkmark",ref:c,status:c,type:"remote"}))))]:a.map((e=>(0,k.MH)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,message:!1,ref:c}))):[(0,D.fz)("Branches"),...await Promise.all(o.filter((e=>!e.remote)).map((e=>(0,k.RE)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,current:!!c&&"checkmark",ref:c,status:c,type:"remote"})))),(0,D.fz)("Remote Branches"),...await Promise.all(o.filter((e=>e.remote)).map((e=>(0,k.RE)(e,null!=s&&("string"==typeof s?e.ref===s:s.includes(e.ref)),{buttons:i,current:!!c&&"checkmark",ref:c,status:c,type:"remote"}))))]:[]}function N(e,t){return async(i,s)=>{let n=!1;if(s.startsWith("#")&&(n=!0,s=s.substring(1)),null==e)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}if(n&&t?.ranges&&(0,y.yk)(s))return i.items=[(0,k.RP)(s,e.path,!0,{alwaysShow:!0,buttons:t?.buttons,ref:!1,icon:!1})],!0;if(!await c.W.instance.git.validateReference(e.path,s))return!!n&&(i.items=[(0,r.fw)(r.Xe.Back,!0,{label:"Enter a reference or commit SHA"})],!0);if(!n&&await c.W.instance.git.hasBranchOrTag(e.path,{filter:{branches:e=>e.name.includes(s),tags:e=>e.name.includes(s)}}))return!1;const o=await c.W.instance.git.getCommit(e.path,s);return i.items=[(0,k.YY)(o,!0,{alwaysShow:!0,buttons:t?.buttons,compact:!0,icon:!0})],!0}}async function*G(e,t,i){const r=Pe({title:B(`${t.title}${i.titleContext??""}`,e,t),placeholder:i.placeholder,value:i.value,prompt:"Enter branch name",validate:async t=>{if(null==t)return[!1,void 0];if(0===(t=t.trim()).length)return[!1,"Please enter a valid branch name"];if("repo"in e){if(!await c.W.instance.git.validateBranchOrTagName(e.repo.path,t))return[!1,`'${t}' isn't a valid branch name`];return await e.repo.getBranch(t)?[!1,`A branch named '${t}' already exists`]:[!0,void 0]}let i=!0;for(const r of e.repos){if(i=await c.W.instance.git.validateBranchOrTagName(r.path,t),!i)return[!1,`'${t}' isn't a valid branch name`];if(await r.getBranch(t))return[!1,`A branch named '${t}' already exists`]}return[!0,void 0]}}),s=yield r;return Ce(r,e,s)&&await ye(r,e,s)?s:we}async function*H(e,t,i){const r=Pe({title:B(`${t.title}${i.titleContext??""}`,e,t),placeholder:i.placeholder,value:i.value,prompt:"Enter remote name",validate:async t=>{if(null==t)return[!1,void 0];if(0===(t=t.trim()).length)return[!1,"Please enter a valid remote name"];if(!!/[^a-zA-Z0-9-_.]/.test(t))return[!1,`'${t}' isn't a valid remote name`];if("repo"in e){if(0!==(await e.repo.getRemotes({filter:e=>e.name===t})).length)return[!1,`A remote named '${t}' already exists`]}return[!0,void 0]}}),s=yield r;return Ce(r,e,s)&&await ye(r,e,s)?s:we}async function*V(e,t,i){const r=Pe({title:B(`${t.title}${i.titleContext??""}`,e,t),placeholder:i.placeholder,value:i.value,prompt:"Enter remote URL",validate:e=>{if(null==e)return[!1,void 0];if(0===(e=e.trim()).length)return[!1,"Please enter a valid remote URL"];const t=S.gK.test(e);return[t,t?void 0:`'${e}' isn't a valid remote URL`]}}),s=yield r;return Ce(r,e,s)&&await ye(r,e,s)?s:we}async function*q(e,t,i){const r=Pe({title:B(`${t.title}${i.titleContext??""}`,e,t),placeholder:i.placeholder,value:i.value,prompt:"Enter tag name",validate:async t=>{if(null==t)return[!1,void 0];if(0===(t=t.trim()).length)return[!1,"Please enter a valid tag name"];if("repo"in e){const i=await c.W.instance.git.validateBranchOrTagName(e.repo.path,t);return[i,i?void 0:`'${t}' isn't a valid tag name`]}let i=!0;for(const r of e.repos)if(i=await c.W.instance.git.validateBranchOrTagName(r.path,t),!i)return[!1,`'${t}' isn't a valid branch name`];return[!0,void 0]}}),s=yield r;return Ce(r,e,s)&&await ye(r,e,s)?s:we}async function*Q(e,t,{filter:i,picked:s,placeholder:o,titleContext:a}){const c=await W(e.repo,{buttons:[n.Nv],filter:i,picked:s}),h={title:B(`${t.title}${a??""}`,e,t),placeholder:0===c.length?`No branches found in ${e.repo.formattedName}`:o,matchOnDetail:!0,items:0===c.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:c,onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&l.ay(i,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await l.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},u=yield h;return be(h,e,u)?u[0].item:we}async function*Y(e,t,{filter:i,picked:s,placeholder:o,sort:a,titleContext:c}){const h=await W(e.repo,{buttons:[n.Nv],filter:i,picked:s,sort:a}),u={multiselect:0!==h.length,title:B(`${t.title}${c??""}`,e,t),placeholder:0===h.length?`No branches found in ${e.repo.formattedName}`:o,matchOnDetail:!0,items:0===h.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:h,onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&l.ay(i,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await l.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},d=yield u;return be(u,e,d)?d.map((e=>e.item)):we}async function*j(e,t,{filter:i,picked:s,placeholder:o,titleContext:c,value:u,additionalButtons:d,ranges:p}){t.showTags=!0;const m=new n.cq(t.showTags),f=async()=>U(e.repo,t.showTags?["branches","tags"]:["branches"],{buttons:"boolean"==typeof t.pickCommitForItem?[n.Ft,n.Nv]:[n.Nv],filter:i,picked:s,sort:!0}),w=await f(),v={title:B(`${t.title}${c??""}`,e,t),placeholder:0===w.length?`No branches${t.showTags?" or tags":""} found in ${e.repo.formattedName}`:`${"string"==typeof o?o:o(t)}${a.NE.Space.repeat(3)}(or enter a reference using #)`,matchOnDescription:!0,matchOnDetail:!0,value:u,selectValueWhenShown:!0,items:0===w.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:w,additionalButtons:[...d??[],m],onDidClickItemButton:(e,i,{item:r})=>i===n.Ft?(t.pickCommitForItem=!0,!0):(i===n.Nv&&((0,y.UR)(r)?l.ay(r,{select:!0,focus:!1,expand:!0}):(0,y.gA)(r)?g.ay(r,{select:!0,focus:!1,expand:!0}):(0,y.FT)(r)&&h.Fw(r,{pin:!1,preserveFocus:!0})),!1),onDidClickButton:async(i,r)=>{if(r===m){i.busy=!0;try{t.showTags=!t.showTags,m.on=t.showTags;const r=await f();i.placeholder=0===r.length?`${e.repo.formattedName} has no branches${t.showTags?" or tags":""}`:`${"string"==typeof o?o:o(t)}${a.NE.Space.repeat(3)}(or enter a reference using #)`,i.items=r}finally{i.busy=!1}}},keys:["right","alt+right","ctrl+right"],onDidPressKey:e=>{if(0===e.activeItems.length)return;const t=e.activeItems[0].item;(0,y.UR)(t)?l.ay(t,{select:!0,focus:!1,expand:!0}):(0,y.gA)(t)?g.ay(t,{select:!0,focus:!1,expand:!0}):(0,y.FT)(t)&&h.Fw(t,{pin:!1,preserveFocus:!0})},onValidateValue:N(e.repo,{ranges:p})},b=yield v;return be(v,e,b)?b[0].item:we}async function*z(e,t,{filter:i,picked:s,placeholder:c,titleContext:u,value:d}){t.showTags=1===e.repos.length;const p=new n.cq(t.showTags),m=()=>U(e.repos,t.showTags?["branches","tags"]:["branches"],{buttons:[n.Nv],filter:{branches:1===e.repos.length?void 0:e=>!e.remote,...i},picked:s??e.reference?.ref,sort:{branches:{orderBy:o.Vz.DateDesc},tags:{orderBy:o.RV.DateDesc}}}),f=await m(),w={title:B(`${t.title}${u??""}`,e,t),placeholder:0===f.length?`No ${1===e.repos.length?"":"common "}branches${t.showTags?" or tags":""} found in ${1===e.repos.length?e.repos[0].formattedName:`${e.repos.length} repositories`}`:`${"string"==typeof c?c:c(t)}${a.NE.Space.repeat(3)}(or enter a reference using #)`,matchOnDescription:!0,matchOnDetail:!0,value:d??((0,y.FT)(e.reference)?e.reference.ref:void 0),selectValueWhenShown:!0,items:0===f.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:f,additionalButtons:[p],onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&((0,y.UR)(i)?l.ay(i,{select:!0,focus:!1,expand:!0}):(0,y.gA)(i)?g.ay(i,{select:!0,focus:!1,expand:!0}):(0,y.FT)(i)&&h.Fw(i,{pin:!1,preserveFocus:!0}))},onDidClickButton:async(i,r)=>{if(r===p){i.busy=!0;try{t.showTags=!t.showTags,p.on=t.showTags;const r=await m();i.placeholder=0===r.length?`No ${1===e.repos.length?"":"common "}branches${t.showTags?" or tags":""} found in ${1===e.repos.length?e.repos[0].formattedName:`${e.repos.length} repositories`}`:`${"string"==typeof c?c:c(t)}${a.NE.Space.repeat(3)}(or enter a reference using #)`,i.items=r}finally{i.busy=!1}}},keys:["right","alt+right","ctrl+right"],onDidPressKey:e=>{if(0===e.activeItems.length)return;const t=e.activeItems[0].item;(0,y.UR)(t)?l.ay(t,{select:!0,focus:!1,expand:!0}):(0,y.gA)(t)?g.ay(t,{select:!0,focus:!1,expand:!0}):(0,y.FT)(t)&&h.Fw(t,{pin:!1,preserveFocus:!0})},onValidateValue:N(e.repos)},v=yield w;return be(w,e,v)?v[0].item:we}async function*K(e,t,{ignoreFocusOut:i,log:o,onDidLoadMore:a,picked:c,placeholder:l,showInSideBarCommand:u,showInSideBarButton:d,titleContext:p}){function m(e){return null==e?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:[...(0,$.UI)(e.commits.values(),(e=>(0,k.YY)(e,null!=c&&("string"==typeof c?e.ref===c:c.includes(e.ref)),{buttons:[n._9,n.Nv],compact:!0,icon:!0}))),...e?.hasMore?[(0,r.fw)(r.Xe.LoadMore)]:[]]}const g={title:B(`${t.title}${p??""}`,e,t),placeholder:"string"==typeof l?l:l(t,o),ignoreFocusOut:i,matchOnDescription:!0,matchOnDetail:!0,value:"string"==typeof c&&0===o?.count?c:void 0,selectValueWhenShown:!0,items:null!=u?[u,...m(o)]:m(o),onDidLoadMore:async e=>(e.keepScrollPosition=!0,o=await(o?.more?.(s.D.get("advanced.maxListItems"))),a?.(o),"string"!=typeof l&&(e.placeholder=l(t,o)),m(o)),additionalButtons:[...null!=d?.button?[d?.button]:[],...o?.hasMore?[n.Q0]:[]],onDidClickItemButton:(e,t,i)=>{if(!D.$w.is(i))switch(t){case n._9:h.Fw(i.item,{pin:!1,preserveFocus:!0});break;case n.Nv:h.ay(i.item,{select:!0,focus:!1,expand:!0})}},onDidClickButton:(e,t)=>{if(null==o)return;const i=e.activeItems.filter((e=>!D.$w.is(e)));t===d?.button&&d.onDidClick(i)},keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{if(0===e.activeItems.length)return;const i=e.activeItems.filter((e=>!D.$w.is(e)));"ctrl+right"===t?h.Fw(i[0].item,{pin:!1,preserveFocus:!0}):await h.ay(i[0].item,{select:!0,focus:!1,expand:!0})},onValidateValue:N(e.repo,{buttons:[n._9,n.Nv]})},f=yield g;return be(g,e,f)?D.$w.is(f[0])?(De(e),await f[0].execute(),we):f[0].item:we}function*J(e,t,{log:i,onDidLoadMore:o,picked:a,placeholder:c,titleContext:l}){function u(e){return null==e?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:[...(0,$.UI)(e.commits.values(),(e=>(0,k.YY)(e,null!=a&&("string"==typeof a?e.ref===a:a.includes(e.ref)),{buttons:[n._9,n.Nv],compact:!0,icon:!0})))]}const d={title:B(`${t.title}${l??""}`,e,t),multiselect:null!=i,placeholder:"string"==typeof c?c:c(t,i),matchOnDescription:!0,matchOnDetail:!0,items:u(i),onDidLoadMore:async e=>(e.keepScrollPosition=!0,i=await(i?.more?.(s.D.get("advanced.maxListItems"))),o?.(i),"string"!=typeof c&&(e.placeholder=c(t,i)),u(i)),additionalButtons:[...i?.hasMore?[n.Q0]:[]],onDidClickItemButton:(e,t,{item:i})=>{switch(t){case n._9:h.Fw(i,{pin:!1,preserveFocus:!0});break;case n.Nv:h.ay(i,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{0!==e.activeItems.length&&("ctrl+right"===t?h.Fw(e.activeItems[0].item,{pin:!1,preserveFocus:!0}):await h.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0}))}},p=yield d;return be(d,e,p)?p.map((e=>e.item)):we}async function*X(e,t,i="Choose contributors"){const r=(await c.W.instance.git.getOrOpenScmRepository(e.repo.path))?.inputBox.value,s={title:B(t.title,e,t),allowEmpty:!0,multiselect:!0,placeholder:i,matchOnDescription:!0,items:(await c.W.instance.git.getContributors(e.repo.path)).map((e=>(0,k.RI)(e,r?.includes(e.getCoauthor()),{buttons:[n.Nv]}))),onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&u.a(i,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:e=>{0!==e.activeItems.length&&u.a(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},o=yield s;return be(s,e,o)?o.map((e=>e.item)):we}async function*Z(e,t,{filter:i,picked:s,placeholder:o,titleContext:a}){const c=await L(e.repo,{buttons:[n.Nv],filter:i,picked:s}),l={title:B(`${t.title}${a??""}`,e,t),placeholder:0===c.length?`No remotes found in ${e.repo.formattedName}`:o,matchOnDetail:!0,items:0===c.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:c,onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&d.ay(i,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await d.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},h=yield l;return be(l,e,h)?h[0].item:we}async function*ee(e,t,i="Choose a repository"){if("string"==typeof e.repo&&(e.repo=c.W.instance.git.getRepository(e.repo),null!=e.repo))return e.repo;const s=e.repo??await c.W.instance.git.getOrOpenRepositoryForEditor(),o={title:t.title,placeholder:i,items:0===t.repos.length?[(0,r.fw)(r.Xe.Cancel)]:await Promise.all(t.repos.map((e=>(0,k.FO)(e,e.id===s?.id,{branch:!0,buttons:[n.Nv],fetched:!0,status:!0})))),onDidClickItemButton:(e,i,{item:r})=>{i===n.Nv&&p.ay(r.path,t.associatedView,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:e=>{0!==e.activeItems.length&&p.ay(e.activeItems[0].item.path,t.associatedView,{select:!0,focus:!1,expand:!0})}},a=yield o;return be(o,e,a)?a[0].item:we}async function*te(e,t,i){let s;if(i={placeholder:"Choose repositories",skipIfPossible:!1,...i},null!=e.repos)if((0,F.GI)(e.repos)){if(s=(0,F.DZ)(e.repos,(e=>t.repos.find((t=>t.path===e)))),i.skipIfPossible&&0!==s.length&&e.repos.length===s.length)return s}else s=e.repos;else{const e=await c.W.instance.git.getOrOpenRepositoryForEditor();s=null!=e?[e]:[]}const o={multiselect:!0,title:t.title,placeholder:i.placeholder,items:0===t.repos.length?[(0,r.fw)(r.Xe.Cancel)]:await Promise.all(t.repos.map((e=>(0,k.FO)(e,s.some((t=>t.id===e.id)),{branch:!0,buttons:[n.Nv],fetched:!0,status:!0})))),onDidClickItemButton:(e,i,{item:r})=>{i===n.Nv&&p.ay(r.path,t.associatedView,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:e=>{0!==e.activeItems.length&&p.ay(e.activeItems[0].item.path,t.associatedView,{select:!0,focus:!1,expand:!0})}},a=yield o;return be(o,e,a)?a.map((e=>e.item)):we}function*ie(e,t,{ignoreFocusOut:i,stash:s,picked:o,placeholder:a,titleContext:c}){const l={title:B(`${t.title}${c??""}`,e,t),placeholder:"string"==typeof a?a:a(t,s),ignoreFocusOut:i,matchOnDescription:!0,matchOnDetail:!0,items:null==s?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:[...(0,$.UI)(s.commits.values(),(e=>(0,k.YY)(e,null!=o&&("string"==typeof o?e.ref===o:o.includes(e.ref)),{buttons:[n._9],compact:!0,icon:!0})))],onDidClickItemButton:(e,t,{item:i})=>{t===n._9&&m.Fw(i,{pin:!1,preserveFocus:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await m.Fw(e.activeItems[0].item,{pin:!1,preserveFocus:!0})}},h=yield l;return be(l,e,h)?h[0].item:we}async function*re(e,t,{filter:i,picked:s,placeholder:o,titleContext:a}){const c=await async function(e,t){return U(e,["tags"],{buttons:t?.buttons,filter:null!=t?.filter?{tags:t.filter}:void 0,picked:t?.picked,sort:null==t?.sort||{tags:t.sort}})}(e.repo,{buttons:[n.Nv],filter:i,picked:s}),l={multiselect:0!==c.length,title:B(`${t.title}${a??""}`,e,t),placeholder:0===c.length?`No tags found in ${e.repo.formattedName}`:o,matchOnDetail:!0,items:0===c.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:c,onDidClickItemButton:(e,t,{item:i})=>{t===n.Nv&&g.ay(i,{select:!0,focus:!1,expand:!0})},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await g.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},h=yield l;return be(l,e,h)?h.map((e=>e.item)):we}async function*se(e,t,{filter:i,includeStatus:s,picked:o,placeholder:a,titleContext:c}){const l=await M(t.worktrees??e.repo,{buttons:[n._r,n.Nv],filter:i,includeStatus:s,picked:o}),h={title:B(`${t.title}${c??""}`,e,t),placeholder:0===l.length?`No worktrees found in ${e.repo.formattedName}`:a,matchOnDetail:!0,items:0===l.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:l,onDidClickItemButton:(e,t,{item:i})=>{switch(t){case n._r:(0,I.ic)(i.uri,{location:I.Tc.NewWindow});break;case n.Nv:f.ay(i,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await f.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},u=yield h;return be(h,e,u)?u[0].item:we}async function*ne(e,t,{filter:i,includeStatus:s,picked:o,placeholder:a,titleContext:c}){const l=await M(t.worktrees??e.repo,{buttons:[n._r,n.Nv],filter:i,includeStatus:s,picked:o}),h={multiselect:0!==l.length,title:B(`${t.title}${c??""}`,e,t),placeholder:0===l.length?`No worktrees found in ${e.repo.formattedName}`:a,matchOnDetail:!0,items:0===l.length?[(0,r.fw)(r.Xe.Back,!0),(0,r.fw)(r.Xe.Cancel)]:l,onDidClickItemButton:(e,t,{item:i})=>{switch(t){case n._r:(0,I.ic)(i.uri,{location:I.Tc.NewWindow});break;case n.Nv:f.ay(i,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async e=>{0!==e.activeItems.length&&await f.ay(e.activeItems[0].item,{select:!0,focus:!1,expand:!0})}},u=yield h;return be(h,e,u)?u.map((e=>e.item)):we}async function*oe(e,t){const i={title:B((0,y.Wh)(e.reference,{capitalize:!0,icon:!1}),e,t),placeholder:(0,y.Wh)(e.reference,{capitalize:!0,icon:!1}),ignoreFocusOut:!0,items:await ae(e),onDidClickItemButton:(t,i,r)=>{switch(i){case n._9:(0,y.pZ)(e.reference)?m.Fw(e.reference,{pin:!1,preserveFocus:!0}):h.Fw(e.reference,{pin:!1,preserveFocus:!0});break;case n.Nv:(0,y.pZ)(e.reference)?m.ay(e.reference,{select:!0,focus:!1,expand:!0}):h.ay(e.reference,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{0!==e.activeItems.length&&await e.activeItems[0].onDidPressKey(t)}},r=yield i;return be(i,e,r)?r[0]:we}async function ae(e){const t=[new R.EE(e.reference),new R.sQ(e.reference)];let i;if((0,v.G2)(e.reference))t.push((0,D.fz)("Actions"),new k.Wv("Apply Stash...",{command:"stash",state:{subcommand:"apply",repo:e.repo,reference:e.reference}}),new k.Wv("Delete Stash...",{command:"stash",state:{subcommand:"drop",repo:e.repo,reference:e.reference}}),(0,D.fz)(),new R.NC(e.reference));else{const r=await c.W.instance.git.getRemotesWithProviders(e.repo.path,{sort:!0});r?.length&&t.push((0,D.fz)(b.ss.getHighlanderProviderName(r)??"Remote"),new _.az(r,{type:C.J.Commit,sha:e.reference.sha}),new _.eO(r,{type:C.J.Commit,sha:e.reference.sha})),t.push((0,D.fz)("Actions"));const s=await c.W.instance.git.getBranch(e.repo.path),[n,o]=await Promise.all([null!=s?c.W.instance.git.getCommitBranches(e.repo.path,e.reference.ref,{branch:s.name,commitDate:(0,v.f_)(e.reference)?e.reference.committer.date:void 0}):void 0,s?.remote||null==s?.upstream?void 0:e.reference.isPushed()]);Boolean(n?.length)?(i=!o,i&&t.push(new k.Wv("Push to Commit...",{command:"push",state:{repos:e.repo,reference:e.reference}})),t.push(new k.Wv("Revert Commit...",{command:"revert",state:{repo:e.repo,references:[e.reference]}}),new k.Wv(`Reset ${s?.name??"Current Branch"} to Commit...`,{command:"reset",state:{repo:e.repo,reference:e.reference}}),new k.Wv(`Reset ${s?.name??"Current Branch"} to Previous Commit...`,{command:"reset",state:{repo:e.repo,reference:(0,y.xB)(`${e.reference.ref}^`,e.reference.repoPath,{refType:"revision",name:`${e.reference.name}^`,message:e.reference.message})}}))):t.push(new k.Wv("Cherry Pick Commit...",{command:"cherry-pick",state:{repo:e.repo,references:[e.reference]}})),t.push(new k.Wv(`Rebase ${s?.name??"Current Branch"} onto Commit...`,{command:"rebase",state:{repo:e.repo,reference:e.reference}}),new k.Wv("Switch to Commit...",{command:"switch",state:{repos:[e.repo],reference:e.reference}}),(0,D.fz)(),new k.Wv("Create Branch at Commit...",{command:"branch",state:{subcommand:"create",repo:e.repo,reference:e.reference}}),new k.Wv("Create Tag at Commit...",{command:"tag",state:{subcommand:"create",repo:e.repo,reference:e.reference}}),(0,D.fz)("Copy"),new R.OT(e.reference),new R.NC(e.reference))}return t.push((0,D.fz)("Open"),new R.CV(e.reference),new R.Y4(e.reference),new R.o$(e.reference),(0,D.fz)(),new R.lN(e.reference),new R.A1(e.reference)),t.push((0,D.fz)("Compare"),new R.Jw(e.reference),new R.m5(e.reference)),t.push((0,D.fz)(),new R.eG(e.reference),new R.nl(e.reference)),t.push((0,D.fz)("Browse"),new R.Lf(e.reference,{openInNewWindow:!1}),new R.Lf(e.reference,{before:!0,openInNewWindow:!1}),new R.Lf(e.reference,{openInNewWindow:!0}),new R.Lf(e.reference,{before:!0,openInNewWindow:!0})),t.unshift(new R.PF(e.reference,{unpublished:i,hint:"Click to see all changed files"})),t}function*ce(e,t,i){e.reference.files;const r={title:B((0,y.Wh)(e.reference,{capitalize:!0,icon:!1}),e,t),placeholder:(0,y.Wh)(e.reference,{capitalize:!0,icon:!1}),ignoreFocusOut:!0,items:[new R.PF(e.reference,{picked:null==e.fileName,hint:`Click to see ${(0,v.G2)(e.reference)?"stash":"commit"} actions`}),(0,D.fz)("Files"),...e.reference.files?.map((t=>new R.zr(e.reference,t,i?.picked===t.path)))??[]],matchOnDescription:!0,onDidClickItemButton:(t,i,r)=>{switch(i){case n._9:(0,y.pZ)(e.reference)?m.Fw(e.reference,{pin:!1,preserveFocus:!0}):h.Fw(e.reference,{pin:!1,preserveFocus:!0});break;case n.Nv:(0,y.pZ)(e.reference)?m.ay(e.reference,{select:!0,focus:!1,expand:!0}):h.ay(e.reference,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{0!==e.activeItems.length&&await e.activeItems[0].onDidPressKey(t)}},s=yield r;return be(r,e,s)?s[0]:we}async function*le(e,t){const i={title:B((0,y.Wh)(e.reference,{capitalize:!0,icon:!1}),e,t,`${(0,x.vk)(a.NE.Dot,2,2)}${(0,E.d)(e.fileName,{fileOnly:!0})}`),placeholder:`${(0,E.d)(e.fileName,{relativeTo:e.repo.path})} in ${(0,y.Wh)(e.reference,{icon:!1})}`,ignoreFocusOut:!0,items:await he(e),matchOnDescription:!0,onDidClickItemButton:(t,i,r)=>{switch(i){case n._9:(0,y.pZ)(e.reference)?m.Fw(e.reference,{pin:!1,preserveFocus:!0}):h.Fw(e.reference,{pin:!1,preserveFocus:!0});break;case n.Nv:(0,y.pZ)(e.reference)?m.ay(e.reference,{select:!0,focus:!1,expand:!0}):h.ay(e.reference,{select:!0,focus:!1,expand:!0})}},keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{0!==e.activeItems.length&&await e.activeItems[0].onDidPressKey(t)}},r=yield i;return be(i,e,r)?r[0]:we}async function he(e){const t=await e.reference.findFile(e.fileName);if(null==t)return[];const i=[new R.EE(e.reference),new R.sQ(e.reference)];if((0,v.G2)(e.reference))i.push((0,D.fz)(),new R.NC(e.reference),(0,D.fz)("Actions"),new R.do(e.reference,t),new R.QP(e.reference,t),(0,D.fz)(),new R.NC(e.reference));else{const r=await c.W.instance.git.getRemotesWithProviders(e.repo.path,{sort:!0});r?.length&&i.push((0,D.fz)(b.ss.getHighlanderProviderName(r)??"Remote"),new _.az(r,{type:C.J.Revision,fileName:e.fileName,commit:e.reference}),new _.eO(r,{type:C.J.Revision,fileName:e.fileName,commit:e.reference}),(0,D.fz)(),new _.az(r,{type:C.J.Commit,sha:e.reference.ref}),new _.eO(r,{type:C.J.Commit,sha:e.reference.sha})),i.push((0,D.fz)("Actions"),new R.do(e.reference,t),new R.QP(e.reference,t),(0,D.fz)("Copy"),new R.OT(e.reference),new R.NC(e.reference))}return i.push((0,D.fz)("Open"),new R.lp(e.reference,e.fileName),new R.aU(e.reference,e.fileName),new R.xL(e.reference,e.fileName),(0,D.fz)()),"D"!==t.status&&i.push(new R.ZO(e.reference,t)),i.push(new R.Wt(e.reference,t)),i.push((0,D.fz)("Compare"),new R.Jw(e.reference),new R.m5(e.reference)),i.push((0,D.fz)("Browse"),new R.Lf(e.reference,{openInNewWindow:!1}),new R.Lf(e.reference,{before:!0,openInNewWindow:!1}),new R.Lf(e.reference,{openInNewWindow:!0}),new R.Lf(e.reference,{before:!0,openInNewWindow:!0})),i.unshift(new R.PF(e.reference,{file:t,hint:"Click to see all changed files"})),i}function*ue(e,t){const i=t.status.getUpstreamStatus({expand:!0,separator:", "}),r=t.status.getFormattedDiffStatus({expand:!0,separator:", "}),s={title:B(t.title,e,t),placeholder:`${i?`${i}, ${r}`:r}`,ignoreFocusOut:!0,items:de(e,t),keys:["right","alt+right","ctrl+right"],onDidPressKey:async(e,t)=>{0!==e.activeItems.length&&await e.activeItems[0].onDidPressKey(t)}},n=yield s;return be(s,e,n)?n[0]:we}function de(e,t){const i=[],s=t.status.computeWorkingTreeStatus();let n;return n=0===s.staged&&0===s.unstaged?"No working tree changes":`$(files) ${s.staged?`${(0,x._6)("staged file",s.staged)} (${s.stagedStatus})`:""}${s.unstaged?`${s.staged?", ":""}${(0,x._6)("unstaged file",s.unstaged)} (${s.unstagedStatus})`:""}`,t.status.upstream?(0===t.status.state.ahead&&0===t.status.state.behind?i.push((0,r.fw)(r.Xe.Noop,!0,{label:`$(git-branch) ${t.status.branch} is up to date with $(git-branch) ${t.status.upstream}`,detail:n})):0!==t.status.state.ahead&&0!==t.status.state.behind?i.push((0,r.fw)(r.Xe.Noop,!0,{label:`$(git-branch) ${t.status.branch} has diverged from $(git-branch) ${t.status.upstream}`,detail:n})):0!==t.status.state.ahead?i.push((0,r.fw)(r.Xe.Noop,!0,{label:`$(git-branch) ${t.status.branch} is ahead of $(git-branch) ${t.status.upstream}`,detail:n})):0!==t.status.state.behind&&i.push((0,r.fw)(r.Xe.Noop,!0,{label:`$(git-branch) ${t.status.branch} is behind $(git-branch) ${t.status.upstream}`,detail:n})),0!==t.status.state.behind&&i.push(new k.Wv(`$(cloud-download) ${(0,x._6)("commit",t.status.state.behind)} behind`,{command:"log",state:{repo:e.repo,reference:(0,y.xB)((0,y.oI)(t.status.ref,t.status.upstream),e.repo.path)}})),0!==t.status.state.ahead&&i.push(new k.Wv(`$(cloud-upload) ${(0,x._6)("commit",t.status.state.ahead)} ahead`,{command:"log",state:{repo:e.repo,reference:(0,y.xB)((0,y.oI)(t.status.upstream,t.status.ref),e.repo.path)}}))):i.push((0,r.fw)(r.Xe.Noop,!0,{label:`$(git-branch) ${t.status.branch} has no upstream`,detail:n})),t.status.files.length&&i.push(new R.K6(s.stagedAddsAndChanges.concat(s.unstagedAddsAndChanges))),s.staged>0&&i.push(new R.K6(s.stagedAddsAndChanges,{label:"$(files) Open Staged Files"})),s.unstaged>0&&i.push(new R.K6(s.unstagedAddsAndChanges,{label:"$(files) Open Unstaged Files"})),t.status.files.length&&i.push(new D.$w("$(x) Close Unchanged Files",a.Gh.CloseUnchangedFiles)),i}async function*pe(e,t,i){const s=await c.W.instance.git.access(i,e.repo.path);if(s.allowed)return;const n=[];let o;if(!1===s.subscription.current.account?.verified)n.push((0,r.fw)(r.Xe.RequiresVerification,!0)),o="You must verify your email before you can continue";else{if(null==s.subscription.required)return;o="✨ Requires a trial or paid plan for use on privately hosted repos",(0,T.aG)(s.subscription.required)&&null!=s.subscription.current.account?(o="✨ Requires a paid plan for use on privately hosted repos",n.push((0,r.fw)(r.Xe.RequiresPaidSubscription,!0))):null!=s.subscription.current.account||(0,T.gA)(s.subscription.current)?n.push((0,r.fw)(r.Xe.ExtendTrial)):n.push((0,r.fw)(r.Xe.StartPreviewTrial,!0))}const a={title:B(t.title,e,t),placeholder:o,items:[...n,(0,r.fw)(r.Xe.Cancel)]};return be(a,e,yield a)?void 0:we}function me(e){return"object"==typeof e&&null!=e.show}function ge(e){return"object"==typeof e&&null==e.items&&null==e.show}function fe(e){return"object"==typeof e&&null!=e.items}const we=Symbol("BreakStep");class QuickCommand{constructor(e,t,i,r,s={}){this.container=e,this.key=t,this.label=i,this.title=r,this._picked=!1,this._pickedVia="menu",this.description=s.description,this.detail=s.detail}get canConfirm(){return!0}get canSkipConfirm(){return!0}get picked(){return this._picked}set picked(e){this._picked=e,e||(this._pickedVia="menu")}get pickedVia(){return this._pickedVia}set pickedVia(e){this._pickedVia=e}get skipConfirmKey(){return`${this.key}:${this.pickedVia}`}get value(){return this._currentStep}confirm(e){return!this.canConfirm||!this.canSkipConfirm||(null!=e?e:!s.D.get("gitCommands.skipConfirmations").includes(this.skipConfirmKey))}isMatch(e){return this.key===e}isFuzzyMatch(e){return this.label===e}executeSteps(){return this.steps(this.getStepState(!0))}async previous(){return(await this.next(r.Xe.Back)).value}async next(e){null==this._stepsIterator&&(this._stepsIterator=this.steps(this.getStepState(!1)));const t=await this._stepsIterator.next(e);return t.done&&(this.initialState=void 0,this._stepsIterator=void 0),t.value===we?(this._currentStep=void 0,{...t,value:void 0}):(this._currentStep=t.value,t)}async retry(){return await this.next(r.Xe.Noop),this.value}canStepsContinue(e){return e.counter>=(e.startingStep??0)}createConfirmStep(e,t,i,r={}){return Ae(e,t,{title:this.title},i,r)}getStepState(e){return{counter:0,...this.initialState,startingStep:e?this.initialState?.counter??0:0}}}function ve(e){return e instanceof QuickCommand}async function ye(e,t,i){if(!Ce(e,t,i))return!1;const[r]=await(e.validate?.(i))??[!0];return!!r&&(t.counter++,!0)}function be(e,t,i){return!!Ce(e,t,i)&&(!!(e.validate?.(i)??1)&&(t.counter++,!0))}function Ce(e,t,i){if(null==i)return!1;if((0,r.wX)(i)){switch(i){case r.Xe.Back:t.counter--,t.counter<=(t.startingStep??0)&&(t.counter=0);break;case r.Xe.Cancel:De(t)}return!1}return!0}function Ae(e,t,i,s,n={}){return{placeholder:`Confirm ${i.title}`,title:e,ignoreFocusOut:!0,items:[...t,s??(0,r.fw)(r.Xe.Cancel)],selectedItems:[t.find((e=>e.picked))??t[0]],...n}}function Pe(e){return e.ignoreFocusOut=!0,e}function Se(e){return e}function Re(e){return e}function De(e){e.counter=-1}},2540:(e,t,i)=>{i.d(t,{CZ:()=>A,DH:()=>S,Dn:()=>m,M7:()=>y,N4:()=>l,RV:()=>C,S4:()=>k,TA:()=>D,TF:()=>s,Uy:()=>h,VP:()=>g,Vc:()=>P,Vn:()=>p,Vz:()=>a,ef:()=>b,fH:()=>n,hp:()=>c,iP:()=>u,il:()=>w,kl:()=>R,o9:()=>v,oE:()=>_,y0:()=>o,zL:()=>f,zW:()=>d});var r=i(8227),s=(e=>(e.File="file",e.Window="window",e))(s||{}),n=(e=>(e.Issue="Issue",e.PullRequest="PullRequest",e))(n||{}),o=(e=>(e.Gutter="gutter",e.Line="line",e.Scrollbar="overview",e))(o||{}),a=(e=>(e.DateDesc="date:desc",e.DateAsc="date:asc",e.NameAsc="name:asc",e.NameDesc="name:desc",e))(a||{}),c=(e=>(e.Gutter="gutter",e.Line="line",e.Scrollbar="overview",e))(c||{}),l=(e=>(e.CopyRemoteCommitUrl="gitlens.copyRemoteCommitUrl",e.CopyRemoteFileUrl="gitlens.copyRemoteFileUrl",e.DiffWithPrevious="gitlens.diffWithPrevious",e.OpenCommitOnRemote="gitlens.openCommitOnRemote",e.OpenFileOnRemote="gitlens.openFileOnRemote",e.RevealCommitInView="gitlens.revealCommitInView",e.ShowCommitsInView="gitlens.showCommitsInView",e.ShowQuickCommitDetails="gitlens.showQuickCommitDetails",e.ShowQuickCommitFileDetails="gitlens.showQuickCommitFileDetails",e.ShowQuickCurrentBranchHistory="gitlens.showQuickRepoHistory",e.ShowQuickFileHistory="gitlens.showQuickFileHistory",e.ToggleFileBlame="gitlens.toggleFileBlame",e.ToggleFileChanges="gitlens.toggleFileChanges",e.ToggleFileChangesOnly="gitlens.toggleFileChangesOnly",e.ToggleFileHeatmap="gitlens.toggleFileHeatmap",e))(l||{}),h=(e=>(e.Document="document",e.Containers="containers",e.Blocks="blocks",e))(h||{}),u=(e=>(e.CountDesc="count:desc",e.CountAsc="count:asc",e.DateDesc="date:desc",e.DateAsc="date:asc",e.NameAsc="name:asc",e.NameDesc="name:desc",e))(u||{}),d=(e=>(e.AzureDevOps="AzureDevOps",e.Bitbucket="Bitbucket",e.BitbucketServer="BitbucketServer",e.Custom="Custom",e.Gerrit="Gerrit",e.GoogleSource="GoogleSource",e.Gitea="Gitea",e.GitHub="GitHub",e.GitLab="GitLab",e))(d||{}),p=(e=>(e.Authored="authored",e.Committed="committed",e))(p||{}),m=(e=>(e.Absolute="absolute",e.Relative="relative",e))(m||{}),g=(e=>(e.Blame="blame",e.Changes="changes",e.Heatmap="heatmap",e))(g||{}),f=(e=>(e.Name="name",e.Usage="usage",e))(f||{}),w=(e=>(e.Faces="wavatar",e.Geometric="identicon",e.Monster="monsterid",e.MysteryPerson="mp",e.Retro="retro",e.Robot="robohash",e))(w||{}),v=(e=>(e.Gutter="gutter",e.Line="line",e.Scrollbar="overview",e))(v||{}),y=(e=>(e.Silent="silent",e.Errors="errors",e.Verbose="verbose",e.Debug="debug",e))(y||{}),b=(e=>(e.CopyRemoteCommitUrl="gitlens.copyRemoteCommitUrl",e.CopyRemoteFileUrl="gitlens.copyRemoteFileUrl",e.DiffWithPrevious="gitlens.diffWithPrevious",e.DiffWithWorking="gitlens.diffWithWorking",e.OpenCommitOnRemote="gitlens.openCommitOnRemote",e.OpenFileOnRemote="gitlens.openFileOnRemote",e.RevealCommitInView="gitlens.revealCommitInView",e.ShowCommitsInView="gitlens.showCommitsInView",e.ShowQuickCommitDetails="gitlens.showQuickCommitDetails",e.ShowQuickCommitFileDetails="gitlens.showQuickCommitFileDetails",e.ShowQuickCurrentBranchHistory="gitlens.showQuickRepoHistory",e.ShowQuickFileHistory="gitlens.showQuickFileHistory",e.ToggleCodeLens="gitlens.toggleCodeLens",e.ToggleFileBlame="gitlens.toggleFileBlame",e.ToggleFileChanges="gitlens.toggleFileChanges",e.ToggleFileChangesOnly="gitlens.toggleFileChangesOnly",e.ToggleFileHeatmap="gitlens.toggleFileHeatmap",e))(b||{}),C=(e=>(e.DateDesc="date:desc",e.DateAsc="date:asc",e.NameAsc="name:asc",e.NameDesc="name:desc",e))(C||{}),A=(e=>(e.List="list",e.Tree="tree",e))(A||{}),P=(e=>(e.Auto="auto",e.List="list",e.Tree="tree",e))(P||{}),S=(e=>(e.Branch="branch",e.Working="working",e))(S||{}),R=(e=>(e.CommitHasNoPreviousCommitWarning="suppressCommitHasNoPreviousCommitWarning",e.CommitNotFoundWarning="suppressCommitNotFoundWarning",e.CreatePullRequestPrompt="suppressCreatePullRequestPrompt",e.SuppressDebugLoggingWarning="suppressDebugLoggingWarning",e.FileNotUnderSourceControlWarning="suppressFileNotUnderSourceControlWarning",e.GitDisabledWarning="suppressGitDisabledWarning",e.GitMissingWarning="suppressGitMissingWarning",e.GitVersionWarning="suppressGitVersionWarning",e.LineUncommittedWarning="suppressLineUncommittedWarning",e.NoRepositoryWarning="suppressNoRepositoryWarning",e.RebaseSwitchToTextWarning="suppressRebaseSwitchToTextWarning",e.IntegrationDisconnectedTooManyFailedRequestsWarning="suppressIntegrationDisconnectedTooManyFailedRequestsWarning",e.IntegrationRequestFailed500Warning="suppressIntegrationRequestFailed500Warning",e.IntegrationRequestTimedOutWarning="suppressIntegrationRequestTimedOutWarning",e))(R||{});const D=["defaultItemLimit","formats","pageItemLimit","showRelativeDateMarkers"],k=["branches","commits","commitDetails","contributors","fileHistory","lineHistory","remotes","repositories","searchAndCompare","stashes","tags","worktrees"];function _(e){switch(e){case"silent":return r.i.Off;case"errors":return r.i.Error;case"verbose":return r.i.Info;case"debug":return r.i.Debug;default:return e}}},5255:(e,t,i)=>{i.d(t,{Gh:()=>a,NE:()=>l,XP:()=>h,ZY:()=>n,_h:()=>c,d$:()=>s,lw:()=>d,m1:()=>r,mN:()=>o,sN:()=>u});const r="gitlens",s=80,n={".png":"image/png",".gif":"image/gif",".jpg":"image/jpeg",".jpeg":"image/jpeg",".jpe":"image/jpeg",".webp":"image/webp",".tif":"image/tiff",".tiff":"image/tiff",".bmp":"image/bmp"};var o=(e=>(e[e.Hash=35]="Hash",e[e.Slash=47]="Slash",e[e.Digit0=48]="Digit0",e[e.Digit1=49]="Digit1",e[e.Digit2=50]="Digit2",e[e.Digit3=51]="Digit3",e[e.Digit4=52]="Digit4",e[e.Digit5=53]="Digit5",e[e.Digit6=54]="Digit6",e[e.Digit7=55]="Digit7",e[e.Digit8=56]="Digit8",e[e.Digit9=57]="Digit9",e[e.Backslash=92]="Backslash",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.Z=90]="Z",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.z=122]="z",e))(o||{}),a=(e=>(e.ActionPrefix="gitlens.action.",e.AddAuthors="gitlens.addAuthors",e.BrowseRepoAtRevision="gitlens.browseRepoAtRevision",e.BrowseRepoAtRevisionInNewWindow="gitlens.browseRepoAtRevisionInNewWindow",e.BrowseRepoBeforeRevision="gitlens.browseRepoBeforeRevision",e.BrowseRepoBeforeRevisionInNewWindow="gitlens.browseRepoBeforeRevisionInNewWindow",e.ClearFileAnnotations="gitlens.clearFileAnnotations",e.CloseUnchangedFiles="gitlens.closeUnchangedFiles",e.CloseWelcomeView="gitlens.closeWelcomeView",e.CompareWith="gitlens.compareWith",e.CompareHeadWith="gitlens.compareHeadWith",e.CompareWorkingWith="gitlens.compareWorkingWith",e.ComputingFileAnnotations="gitlens.computingFileAnnotations",e.ConnectRemoteProvider="gitlens.connectRemoteProvider",e.CopyAutolinkUrl="gitlens.copyAutolinkUrl",e.CopyCurrentBranch="gitlens.copyCurrentBranch",e.CopyDeepLinkToBranch="gitlens.copyDeepLinkToBranch",e.CopyDeepLinkToCommit="gitlens.copyDeepLinkToCommit",e.CopyDeepLinkToComparison="gitlens.copyDeepLinkToComparison",e.CopyDeepLinkToRepo="gitlens.copyDeepLinkToRepo",e.CopyDeepLinkToTag="gitlens.copyDeepLinkToTag",e.CopyMessageToClipboard="gitlens.copyMessageToClipboard",e.CopyRemoteBranchesUrl="gitlens.copyRemoteBranchesUrl",e.CopyRemoteBranchUrl="gitlens.copyRemoteBranchUrl",e.CopyRemoteCommitUrl="gitlens.copyRemoteCommitUrl",e.CopyRemoteComparisonUrl="gitlens.copyRemoteComparisonUrl",e.CopyRemoteFileUrl="gitlens.copyRemoteFileUrlToClipboard",e.CopyRemoteFileUrlWithoutRange="gitlens.copyRemoteFileUrlWithoutRange",e.CopyRemoteFileUrlFrom="gitlens.copyRemoteFileUrlFrom",e.CopyRemoteIssueUrl="gitlens.copyRemoteIssueUrl",e.CopyRemotePullRequestUrl="gitlens.copyRemotePullRequestUrl",e.CopyRemoteRepositoryUrl="gitlens.copyRemoteRepositoryUrl",e.CopyShaToClipboard="gitlens.copyShaToClipboard",e.CopyRelativePathToClipboard="gitlens.copyRelativePathToClipboard",e.CreatePullRequestOnRemote="gitlens.createPullRequestOnRemote",e.DiffDirectory="gitlens.diffDirectory",e.DiffDirectoryWithHead="gitlens.diffDirectoryWithHead",e.DiffWith="gitlens.diffWith",e.DiffWithNext="gitlens.diffWithNext",e.DiffWithNextInDiffLeft="gitlens.diffWithNextInDiffLeft",e.DiffWithNextInDiffRight="gitlens.diffWithNextInDiffRight",e.DiffWithPrevious="gitlens.diffWithPrevious",e.DiffWithPreviousInDiffLeft="gitlens.diffWithPreviousInDiffLeft",e.DiffWithPreviousInDiffRight="gitlens.diffWithPreviousInDiffRight",e.DiffLineWithPrevious="gitlens.diffLineWithPrevious",e.DiffWithRevision="gitlens.diffWithRevision",e.DiffWithRevisionFrom="gitlens.diffWithRevisionFrom",e.DiffWithWorking="gitlens.diffWithWorking",e.DiffWithWorkingInDiffLeft="gitlens.diffWithWorkingInDiffLeft",e.DiffWithWorkingInDiffRight="gitlens.diffWithWorkingInDiffRight",e.DiffLineWithWorking="gitlens.diffLineWithWorking",e.DisconnectRemoteProvider="gitlens.disconnectRemoteProvider",e.DisableDebugLogging="gitlens.disableDebugLogging",e.EnableDebugLogging="gitlens.enableDebugLogging",e.DisableRebaseEditor="gitlens.disableRebaseEditor",e.EnableRebaseEditor="gitlens.enableRebaseEditor",e.ExternalDiff="gitlens.externalDiff",e.ExternalDiffAll="gitlens.externalDiffAll",e.FetchRepositories="gitlens.fetchRepositories",e.GenerateCommitMessage="gitlens.generateCommitMessage",e.GetStarted="gitlens.getStarted",e.InviteToLiveShare="gitlens.inviteToLiveShare",e.OpenAutolinkUrl="gitlens.openAutolinkUrl",e.OpenBlamePriorToChange="gitlens.openBlamePriorToChange",e.OpenBranchesOnRemote="gitlens.openBranchesOnRemote",e.OpenBranchOnRemote="gitlens.openBranchOnRemote",e.OpenCurrentBranchOnRemote="gitlens.openCurrentBranchOnRemote",e.OpenChangedFiles="gitlens.openChangedFiles",e.OpenCommitOnRemote="gitlens.openCommitOnRemote",e.OpenComparisonOnRemote="gitlens.openComparisonOnRemote",e.OpenFileHistory="gitlens.openFileHistory",e.OpenFileFromRemote="gitlens.openFileFromRemote",e.OpenFileOnRemote="gitlens.openFileOnRemote",e.OpenFileOnRemoteFrom="gitlens.openFileOnRemoteFrom",e.OpenFileAtRevision="gitlens.openFileRevision",e.OpenFileAtRevisionFrom="gitlens.openFileRevisionFrom",e.OpenFolderHistory="gitlens.openFolderHistory",e.OpenOnRemote="gitlens.openOnRemote",e.OpenIssueOnRemote="gitlens.openIssueOnRemote",e.OpenPullRequestOnRemote="gitlens.openPullRequestOnRemote",e.OpenAssociatedPullRequestOnRemote="gitlens.openAssociatedPullRequestOnRemote",e.OpenRepoOnRemote="gitlens.openRepoOnRemote",e.OpenRevisionFile="gitlens.openRevisionFile",e.OpenRevisionFileInDiffLeft="gitlens.openRevisionFileInDiffLeft",e.OpenRevisionFileInDiffRight="gitlens.openRevisionFileInDiffRight",e.OpenWalkthrough="gitlens.openWalkthrough",e.OpenWorkingFile="gitlens.openWorkingFile",e.OpenWorkingFileInDiffLeft="gitlens.openWorkingFileInDiffLeft",e.OpenWorkingFileInDiffRight="gitlens.openWorkingFileInDiffRight",e.PullRepositories="gitlens.pullRepositories",e.PushRepositories="gitlens.pushRepositories",e.GitCommands="gitlens.gitCommands",e.GitCommandsBranch="gitlens.gitCommands.branch",e.GitCommandsCherryPick="gitlens.gitCommands.cherryPick",e.GitCommandsMerge="gitlens.gitCommands.merge",e.GitCommandsRebase="gitlens.gitCommands.rebase",e.GitCommandsReset="gitlens.gitCommands.reset",e.GitCommandsRevert="gitlens.gitCommands.revert",e.GitCommandsSwitch="gitlens.gitCommands.switch",e.GitCommandsTag="gitlens.gitCommands.tag",e.GitCommandsWorktree="gitlens.gitCommands.worktree",e.GitCommandsWorktreeOpen="gitlens.gitCommands.worktree.open",e.OpenOrCreateWorktreeForGHPR="gitlens.ghpr.views.openOrCreateWorktree",e.PlusHide="gitlens.plus.hide",e.PlusLoginOrSignUp="gitlens.plus.loginOrSignUp",e.PlusLogout="gitlens.plus.logout",e.PlusManage="gitlens.plus.manage",e.PlusPurchase="gitlens.plus.purchase",e.PlusResendVerification="gitlens.plus.resendVerification",e.PlusRestore="gitlens.plus.restore",e.PlusShowPlans="gitlens.plus.showPlans",e.PlusStartPreviewTrial="gitlens.plus.startPreviewTrial",e.PlusValidate="gitlens.plus.validate",e.QuickOpenFileHistory="gitlens.quickOpenFileHistory",e.RefreshFocus="gitlens.focus.refresh",e.RefreshGraph="gitlens.graph.refresh",e.RefreshHover="gitlens.refreshHover",e.RefreshTimelinePage="gitlens.timeline.refresh",e.ResetAvatarCache="gitlens.resetAvatarCache",e.ResetOpenAIKey="gitlens.resetOpenAIKey",e.ResetSuppressedWarnings="gitlens.resetSuppressedWarnings",e.ResetTrackedUsage="gitlens.resetTrackedUsage",e.ResetViewsLayout="gitlens.resetViewsLayout",e.RevealCommitInView="gitlens.revealCommitInView",e.SearchCommits="gitlens.showCommitSearch",e.SearchCommitsInView="gitlens.views.searchAndCompare.searchCommits",e.ShowBranchesView="gitlens.showBranchesView",e.ShowCommitDetailsView="gitlens.showCommitDetailsView",e.ShowCommitInView="gitlens.showCommitInView",e.ShowCommitsInView="gitlens.showCommitsInView",e.ShowCommitsView="gitlens.showCommitsView",e.ShowContributorsView="gitlens.showContributorsView",e.ShowFileHistoryView="gitlens.showFileHistoryView",e.ShowFocusPage="gitlens.showFocusPage",e.ShowGraph="gitlens.showGraph",e.ShowGraphPage="gitlens.showGraphPage",e.ShowGraphView="gitlens.showGraphView",e.ShowHomeView="gitlens.showHomeView",e.ShowAccountView="gitlens.showAccountView",e.ShowInCommitGraph="gitlens.showInCommitGraph",e.ShowInDetailsView="gitlens.showInDetailsView",e.ShowLastQuickPick="gitlens.showLastQuickPick",e.ShowLineCommitInView="gitlens.showLineCommitInView",e.ShowLineHistoryView="gitlens.showLineHistoryView",e.ShowQuickBranchHistory="gitlens.showQuickBranchHistory",e.ShowQuickCommit="gitlens.showQuickCommitDetails",e.ShowQuickCommitFile="gitlens.showQuickCommitFileDetails",e.ShowQuickCurrentBranchHistory="gitlens.showQuickRepoHistory",e.ShowQuickFileHistory="gitlens.showQuickFileHistory",e.ShowQuickRepoStatus="gitlens.showQuickRepoStatus",e.ShowQuickCommitRevision="gitlens.showQuickRevisionDetails",e.ShowQuickCommitRevisionInDiffLeft="gitlens.showQuickRevisionDetailsInDiffLeft",e.ShowQuickCommitRevisionInDiffRight="gitlens.showQuickRevisionDetailsInDiffRight",e.ShowQuickStashList="gitlens.showQuickStashList",e.ShowRemotesView="gitlens.showRemotesView",e.ShowRepositoriesView="gitlens.showRepositoriesView",e.ShowSearchAndCompareView="gitlens.showSearchAndCompareView",e.ShowSettingsPage="gitlens.showSettingsPage",e.ShowSettingsPageAndJumpToBranchesView="gitlens.showSettingsPage#branches-view",e.ShowSettingsPageAndJumpToCommitsView="gitlens.showSettingsPage#commits-view",e.ShowSettingsPageAndJumpToContributorsView="gitlens.showSettingsPage#contributors-view",e.ShowSettingsPageAndJumpToFileHistoryView="gitlens.showSettingsPage#file-history-view",e.ShowSettingsPageAndJumpToLineHistoryView="gitlens.showSettingsPage#line-history-view",e.ShowSettingsPageAndJumpToRemotesView="gitlens.showSettingsPage#remotes-view",e.ShowSettingsPageAndJumpToRepositoriesView="gitlens.showSettingsPage#repositories-view",e.ShowSettingsPageAndJumpToSearchAndCompareView="gitlens.showSettingsPage#search-compare-view",e.ShowSettingsPageAndJumpToStashesView="gitlens.showSettingsPage#stashes-view",e.ShowSettingsPageAndJumpToTagsView="gitlens.showSettingsPage#tags-view",e.ShowSettingsPageAndJumpToWorkTreesView="gitlens.showSettingsPage#worktrees-view",e.ShowSettingsPageAndJumpToViews="gitlens.showSettingsPage#views",e.ShowSettingsPageAndJumpToCommitGraph="gitlens.showSettingsPage#commit-graph",e.ShowSettingsPageAndJumpToAutolinks="gitlens.showSettingsPage#autolinks",e.ShowStashesView="gitlens.showStashesView",e.ShowTagsView="gitlens.showTagsView",e.ShowTimelinePage="gitlens.showTimelinePage",e.ShowTimelineView="gitlens.showTimelineView",e.ShowWelcomePage="gitlens.showWelcomePage",e.ShowWorktreesView="gitlens.showWorktreesView",e.ShowWorkspacesView="gitlens.showWorkspacesView",e.StashApply="gitlens.stashApply",e.StashSave="gitlens.stashSave",e.StashSaveFiles="gitlens.stashSaveFiles",e.SwitchAIModel="gitlens.switchAIModel",e.SwitchMode="gitlens.switchMode",e.ToggleCodeLens="gitlens.toggleCodeLens",e.ToggleFileBlame="gitlens.toggleFileBlame",e.ToggleFileBlameInDiffLeft="gitlens.toggleFileBlameInDiffLeft",e.ToggleFileBlameInDiffRight="gitlens.toggleFileBlameInDiffRight",e.ToggleFileChanges="gitlens.toggleFileChanges",e.ToggleFileChangesOnly="gitlens.toggleFileChangesOnly",e.ToggleFileHeatmap="gitlens.toggleFileHeatmap",e.ToggleFileHeatmapInDiffLeft="gitlens.toggleFileHeatmapInDiffLeft",e.ToggleFileHeatmapInDiffRight="gitlens.toggleFileHeatmapInDiffRight",e.ToggleGraph="gitlens.toggleGraph",e.ToggleMaximizedGraph="gitlens.toggleMaximizedGraph",e.ToggleLineBlame="gitlens.toggleLineBlame",e.ToggleReviewMode="gitlens.toggleReviewMode",e.ToggleZenMode="gitlens.toggleZenMode",e.ViewsCopy="gitlens.views.copy",e.ViewsOpenDirectoryDiff="gitlens.views.openDirectoryDiff",e.ViewsOpenDirectoryDiffWithWorking="gitlens.views.openDirectoryDiffWithWorking",e.Deprecated_DiffHeadWith="gitlens.diffHeadWith",e.Deprecated_DiffWorkingWith="gitlens.diffWorkingWith",e.Deprecated_OpenBranchesInRemote="gitlens.openBranchesInRemote",e.Deprecated_OpenBranchInRemote="gitlens.openBranchInRemote",e.Deprecated_OpenCommitInRemote="gitlens.openCommitInRemote",e.Deprecated_OpenFileInRemote="gitlens.openFileInRemote",e.Deprecated_OpenInRemote="gitlens.openInRemote",e.Deprecated_OpenRepoInRemote="gitlens.openRepoInRemote",e.Deprecated_ShowFileHistoryInView="gitlens.showFileHistoryInView",e))(a||{});const c=new Map([["workbench.view.scm",["branches","commits","remotes","repositories","stashes","tags","worktrees","contributors"]],["workbench.view.extension.gitlensPanel",["graph","graphDetails"]],["workbench.view.extension.gitlensInspect",["commitDetails","fileHistory","lineHistory","timeline","searchAndCompare"]],["workbench.view.extension.gitlens",["home","workspaces","account"]]]);var l=(e=>(e.AngleBracketLeftHeavy="❰",e.AngleBracketRightHeavy="❱",e.ArrowBack="↩",e.ArrowDown="↓",e.ArrowDownUp="⇵",e.ArrowDropRight="⤷",e.ArrowHeadRight="➤",e.ArrowLeft="←",e.ArrowLeftDouble="⇐",e.ArrowLeftRight="↔",e.ArrowLeftRightDouble="⇔",e.ArrowLeftRightDoubleStrike="⇎",e.ArrowLeftRightLong="⟷",e.ArrowRight="→",e.ArrowRightDouble="⇒",e.ArrowRightHollow="⇨",e.ArrowUp="↑",e.ArrowUpDown="⇅",e.ArrowUpRight="↗",e.ArrowsHalfLeftRight="⇋",e.ArrowsHalfRightLeft="⇌",e.ArrowsLeftRight="⇆",e.ArrowsRightLeft="⇄",e.Asterisk="∗",e.Check="✔",e.Dash="—",e.Dot="•",e.Ellipsis="…",e.EnDash="–",e.Envelope="✉",e.EqualsTriple="≡",e.Flag="⚑",e.FlagHollow="⚐",e.MiddleEllipsis="⋯",e.MuchLessThan="≪",e.MuchGreaterThan="≫",e.Pencil="✎",e.Space=" ",e.SpaceThin=" ",e.SpaceThinnest=" ",e.SquareWithBottomShadow="❏",e.SquareWithTopShadow="❐",e.Warning="⚠",e.ZeroWidthSpace="​",e))(l||{});const h=["left","alt+left","ctrl+left","right","alt+right","ctrl+right","alt+,","alt+.","alt+enter","ctrl+enter","escape"];var u=(e=>(e.DebugConsole="debug",e.File="file",e.Git="git",e.GitHub="github",e.GitLens="gitlens",e.Output="output",e.PRs="pr",e.Terminal="vscode-terminal",e.Vsls="vsls",e.VslsScc="vsls-scc",e.Virtual="vscode-vfs",e))(u||{}),d=(e=>(e.Version="gitlens:synced:version",e.PreReleaseVersion="gitlens:synced:preVersion",e.HomeViewWelcomeVisible="gitlens:views:welcome:visible",e))(d||{})},5567:(e,t,i)=>{i.d(t,{W:()=>Qr,N:()=>Yr});var r=i(9496),s=i(185),n=i(5255),o=i(3148),a=i(4575),c=i(8887),l=i(6592),h=i(2380),u=i(7462),d=i(5367),p=i(6450),m=i(439),g=i(1719),f=i(7881),w=i(5069),v=i(4321),y=i(3050),b=i(3646),C=i(827),A=i(9502);var P=i(7552),S=i(6934),R=i(5148),D=i(2061),k=i(5432),_=i(4241),T=i(3105),F=i(4336),E=i(6004),$=i(3700),O=i(7469),x=i(9701),I=i(2185),B=i(9796),W=i(2509);class TrackedDocument{constructor(e,t,i,s){this.document=e,this.dirty=t,this._eventDelegates=i,this.container=s,this._onDidBlameStateChange=new r.EventEmitter,this._disposed=!1,this.initializing=!0,this._forceDirtyStateChangeOnNextDocumentChange=!1,this._hasRemotes=!1,this._isDirtyIdle=!1,this._isTracked=!1,this._blameFailed=!1,this._requiresUpdate=!0}static async create(e,t,i,r){const s=new TrackedDocument(e,t,i,r);return await s.initialize(),s}get onDidBlameStateChange(){return this._onDidBlameStateChange.event}dispose(){this.state=void 0,this._disposed=!0,this._disposable?.dispose()}async initialize(){const e=this.document.uri;this._uri=await u.YY.fromUri(e),this._disposed||await this.update(),this.initializing=!1}get forceDirtyStateChangeOnNextDocumentChange(){return this._forceDirtyStateChangeOnNextDocumentChange}get hasRemotes(){return this._hasRemotes}get isBlameable(){return!this._blameFailed&&this._isTracked}get isDirtyIdle(){return this._isDirtyIdle}set isDirtyIdle(e){this._isDirtyIdle=e}get isRevision(){return null!=this._uri&&(Boolean(this._uri.sha)&&this._uri.sha!==m.Ii)}get isTracked(){return this._isTracked}get lineCount(){return this.document.lineCount}get uri(){return this._uri}async activate(){this._requiresUpdate&&await this.update(),(0,D.v)("gitlens:activeFileStatus",this.getStatus())}is(e){return e===this.document}reset(e){this._requiresUpdate=!0,this._blameFailed=!1,this._isDirtyIdle=!1,null!=this.state&&(this.state=void 0,F.Yd.log(`Reset state for '${this.document.uri.toString(!0)}', reason=${e}`)),"repository"===e&&(0,W.$S)(this.document)&&(null==this._updateDebounced&&(this._updateDebounced=(0,B.Ds)(this.update.bind(this),250)),this._updateDebounced())}setBlameFailure(){const e=this.isBlameable;this._blameFailed=!0,e&&(0,W.$S)(this.document)&&this.update({forceBlameChange:!0})}resetForceDirtyStateChangeOnNextDocumentChange(){this._forceDirtyStateChangeOnNextDocumentChange=!1}setForceDirtyStateChangeOnNextDocumentChange(){this._forceDirtyStateChangeOnNextDocumentChange=!0}async update({forceBlameChange:e}={}){if(this._requiresUpdate=!1,this._disposed||null==this._uri)return this._hasRemotes=!1,void(this._isTracked=!1);this._isDirtyIdle=!1;const t=(0,W.aW)(this.document),i=e?void 0:this.isBlameable,r=this.container.git.getRepository(this._uri);if(null==r?(this._isTracked=!1,this._hasRemotes=!1):[this._isTracked,this._hasRemotes]=await Promise.all([this.container.git.isTracked(this._uri),r.hasRemotes()]),null!=t){const e=this.isBlameable;if((0,D.v)("gitlens:activeFileStatus",this.getStatus()),!this.initializing&&i!==e){const i={editor:t,document:this,blameable:e};this._onDidBlameStateChange.fire(i),this._eventDelegates.onDidBlameStateChange(i)}}}getStatus(){let e="";return this.isTracked&&(e+="tracked|"),this.isBlameable&&(e+="blameable|"),this.isRevision&&(e+="revision|"),this.hasRemotes&&(e+="remotes|"),e||void 0}}var L=Object.defineProperty,M=Object.getOwnPropertyDescriptor;class DocumentTracker{constructor(e){this.container=e,this._onDidChangeBlameState=new r.EventEmitter,this._onDidChangeContent=new r.EventEmitter,this._onDidChangeDirtyState=new r.EventEmitter,this._onDidTriggerDirtyIdle=new r.EventEmitter,this._documentMap=new Map,this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this),R.D.onDidChange(this.onConfigurationChanged,this),r.window.onDidChangeActiveTextEditor(this.onActiveTextEditorChanged,this),r.workspace.onDidChangeTextDocument((0,B.Ds)(this.onTextDocumentChanged,50),this),r.workspace.onDidCloseTextDocument(this.onTextDocumentClosed,this),r.workspace.onDidSaveTextDocument(this.onTextDocumentSaved,this),this.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this),this.container.git.onDidChangeRepository(this.onRepositoryChanged,this)),this._dirtyIdleTriggerDelay=R.D.get("advanced.blame.delayAfterEdit")}get onDidChangeBlameState(){return this._onDidChangeBlameState.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidChangeDirtyState(){return this._onDidChangeDirtyState.event}get onDidTriggerDirtyIdle(){return this._onDidTriggerDirtyIdle.event}dispose(){this._disposable.dispose(),this.clear()}onReady(){this.onConfigurationChanged(),this.onActiveTextEditorChanged(r.window.activeTextEditor)}onActiveTextEditorChanged(e){if(null!=e&&!(0,W.PH)(e))return;if(null!=this._timer&&(clearTimeout(this._timer),this._timer=void 0),null==e)return void(this._timer=setTimeout((()=>{this._timer=void 0,(0,D.v)("gitlens:activeFileStatus",void 0)}),250));const t=this._documentMap.get(e.document);null==t?this.addCore(e.document):t.then((e=>e.activate()),(()=>{}))}onConfigurationChanged(e){null!=e&&(R.D.changed(e,"blame.ignoreWhitespace")||R.D.changed(e,"advanced.caching.enabled"))&&this.reset("config"),R.D.changed(e,"advanced.blame.delayAfterEdit")&&(this._dirtyIdleTriggerDelay=R.D.get("advanced.blame.delayAfterEdit"),this._dirtyIdleTriggeredDebounced=void 0)}onRepositoriesChanged(e){this.reset("repository",e.added.length?new Set(e.added.map((e=>e.path))):void 0,e.removed.length?new Set(e.removed.map((e=>e.path))):void 0)}onRepositoryChanged(e){e.changed(b.I6.Index,b.I6.Heads,b.I6.Status,b.I6.Unknown,b.du.Any)&&this.reset("repository",new Set([e.repository.path]))}async onTextDocumentChanged(e){const{scheme:t}=e.document.uri;if(!this.container.git.supportedSchemes.has(t))return;const i=await(this._documentMap.get(e.document)??this.addCore(e.document));i.reset("document");const s=e.document.isDirty,n=r.window.activeTextEditor;null!=this._dirtyIdleTriggeredDebounced&&(s?this._dirtyIdleTriggeredDebounced({editor:n,document:i}):this._dirtyIdleTriggeredDebounced.cancel()),n?.document===e.document&&this._onDidChangeContent.fire({editor:n,document:i,contentChanges:e.contentChanges}),(i.forceDirtyStateChangeOnNextDocumentChange||i.dirty!==s)&&(i.resetForceDirtyStateChangeOnNextDocumentChange(),i.dirty=s,null!=n&&n.document===e.document&&this.fireDocumentDirtyStateChanged({editor:n,document:i,dirty:i.dirty}))}onTextDocumentClosed(e){this.remove(e)}async onTextDocumentSaved(e){const t=this._documentMap.get(e);null==t?(0,W.$S)(e)&&this.addCore(e):(await t).update({forceBlameChange:!0})}async add(e){let t;if((0,u.uy)(e))try{t=await r.workspace.openTextDocument(e.documentUri())}catch(i){const s=i?.toString()??"";if(r.env.language.startsWith("en"))if(s.includes("File seems to be binary and cannot be opened as text"))t=new BinaryTextDocument(e);else{if(!(s.includes("File not found")||s.includes("Unable to read file")||s.includes("Unable to resolve non-existing file")))throw i;t=new MissingRevisionTextDocument(e)}else{if(!s.includes("cannot open"))throw i;t=new MissingRevisionTextDocument(e)}}else t=e instanceof r.Uri?await r.workspace.openTextDocument(e):e;return this.addCore(t)}async addCore(e){const t=TrackedDocument.create(e,!1,{onDidBlameStateChange:e=>this._onDidChangeBlameState.fire(e)},this.container);return this._documentMap.set(e,t),t}async clear(){for(const e of this._documentMap.values())(await e).dispose();this._documentMap.clear()}get(e){if(e instanceof r.Uri){const t=(0,W.s5)(e);if(null==t)return;e=t}return this._documentMap.get(e)}async getOrAdd(e){e instanceof r.Uri&&(e=(0,W.s5)(e)??e);return this.get(e)??this.add(e)}has(e){if(e instanceof r.Uri){const t=(0,W.s5)(e);if(null==t)return!1;e=t}return this._documentMap.has(e)}async remove(e,t){let i;null!=t&&(i=this._documentMap.get(e)),this._documentMap.delete(e),(t??await i)?.dispose()}fireDocumentDirtyStateChanged(e){if(e.dirty)return queueMicrotask((()=>{this._dirtyStateChangedDebounced?.cancel(),r.window.activeTextEditor===e.editor&&this._onDidChangeDirtyState.fire(e)})),void(this._dirtyIdleTriggerDelay>0&&(null==this._dirtyIdleTriggeredDebounced&&(this._dirtyIdleTriggeredDebounced=(0,B.Ds)((e=>{this._dirtyIdleTriggeredDebounced?.pending()||(e.document.isDirtyIdle=!0,this._onDidTriggerDirtyIdle.fire(e))}),this._dirtyIdleTriggerDelay)),this._dirtyIdleTriggeredDebounced({editor:e.editor,document:e.document})));null==this._dirtyStateChangedDebounced&&(this._dirtyStateChangedDebounced=(0,B.Ds)((e=>{r.window.activeTextEditor===e.editor&&this._onDidChangeDirtyState.fire(e)}),250)),this._dirtyStateChangedDebounced(e)}reset(e,t,i){Promise.allSettled((0,T.UI)((0,T.hX)(this._documentMap,(([e])=>"string"==typeof e)),(async([,r])=>{const s=await r;i?.has(s.uri.repoPath)?this.remove(s.document,s):(null==t||t.has(s.uri.repoPath))&&s.reset(e)})))}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?M(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&L(t,i,n)})([(0,_.fF)({args:{1:e=>null!=e?(0,T.v_)(e,","):"",2:e=>null!=e?(0,T.v_)(e,","):""}})],DocumentTracker.prototype,"reset",1);class EmptyTextDocument{constructor(e){this.gitUri=e,this.uri=e.documentUri(),this.eol=r.EndOfLine.LF,this.fileName=this.uri.fsPath,this.isClosed=!1,this.isDirty=!1,this.isUntitled=!1,this.languageId="",this.lineCount=0,this.version=0}getText(e){throw new Error("Method not supported.")}getWordRangeAtPosition(e,t){throw new Error("Method not supported.")}lineAt(e){throw new Error("Method not supported.")}offsetAt(e){throw new Error("Method not supported.")}positionAt(e){throw new Error("Method not supported.")}save(){throw new Error("Method not supported.")}validatePosition(e){throw new Error("Method not supported.")}validateRange(e){throw new Error("Method not supported.")}}class BinaryTextDocument extends EmptyTextDocument{}class MissingRevisionTextDocument extends EmptyTextDocument{}class GitDocumentState{constructor(){this.blameCache=new Map,this.diffCache=new Map,this.logCache=new Map}clearBlame(e){null!=e?this.blameCache.delete(e):this.blameCache.clear()}clearDiff(e){null!=e?this.diffCache.delete(e):this.diffCache.clear()}clearLog(e){null!=e?this.logCache.delete(e):this.logCache.clear()}getBlame(e){return this.blameCache.get(e)}getDiff(e){return this.diffCache.get(e)}getLog(e){return this.logCache.get(e)}setBlame(e,t){null!=t?this.blameCache.set(e,t):this.blameCache.delete(e)}setDiff(e,t){null!=t?this.diffCache.set(e,t):this.diffCache.delete(e)}setLog(e,t){null!=t?this.logCache.set(e,t):this.logCache.delete(e)}}class GitDocumentTracker extends DocumentTracker{async resetCache(e,t){const i=this.get(e);if(null!=i)switch(t){case"blame":(await i).state?.clearBlame();break;case"diff":(await i).state?.clearDiff();break;case"log":(await i).state?.clearLog()}}}async function U(e){try{const e=r.extensions.getExtension("ms-vscode.remote-repositories")??r.extensions.getExtension("GitHub.remotehub");if(null==e)throw F.Yd.log("GitHub Repositories extension is not installed or enabled"),new a.R5("GitHub Repositories","GitHub.remotehub");return e.isActive?e.exports:await e.activate()}catch(t){if(F.Yd.error(t,"Unable to get required api from the GitHub Repositories extension"),a.R5,e)return;throw t}}var N=(e=>(e[e.Branch=0]="Branch",e[e.RemoteBranch=1]="RemoteBranch",e[e.Tag=2]="Tag",e[e.Commit=3]="Commit",e))(N||{}),G=i(3878),H=Object.defineProperty,V=Object.getOwnPropertyDescriptor,q=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?V(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&H(t,i,n),n};const Q=/"/g,Y=Object.freeze([]),j=Object.freeze({values:[]}),z=Promise.resolve(void 0),K=["repo","read:user","user:email"],J=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;class GitHubGitProvider{constructor(e){this.container=e,this.descriptor={id:h.pq.GitHub,name:"GitHub",virtual:!0},this.supportedSchemes=new Set([n.sN.Virtual,n.sN.GitHub,n.sN.PRs]),this._onDidChange=new r.EventEmitter,this._onDidChangeRepository=new r.EventEmitter,this._onDidCloseRepository=new r.EventEmitter,this._onDidOpenRepository=new r.EventEmitter,this._branchesCache=new Map,this._repoInfoCache=new Map,this._tagsCache=new Map,this._disposables=[],this._pendingDiscovery=new Set,this._disposables.push(this.container.events.on("git:cache:reset",(e=>e.data.repoPath?this.resetCache(e.data.repoPath,...e.data.caches??Y):this.resetCaches(...e.data.caches??Y)),r.authentication.onDidChangeSessions(this.onAuthenticationSessionsChanged,this)))}get onDidChange(){return this._onDidChange.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}dispose(){this._disposables.forEach((e=>{e.dispose()}))}onAuthenticationSessionsChanged(e){"github"===e.provider.id&&(this._sessionPromise=void 0,this.ensureSession(!1,!0))}onRepositoryChanged(e,t){this._branchesCache.delete(e.path),this._tagsCache.delete(e.path),this._repoInfoCache.delete(e.path),this._onDidChangeRepository.fire(t)}async discoverRepositories(e,t){if(!this.supportedSchemes.has(e.scheme))return[];try{const{remotehub:i}=await this.ensureRepositoryContext(e.toString(),!0),r=i.getVirtualWorkspaceUri(e);return null==r?[]:this.openRepository(void 0,r,!0,void 0,t?.silent)}catch(t){return t.message.startsWith("No provider registered with")&&(F.Yd.error(t,"No GitHub provider registered with Remote Repositories (yet); queuing pending discovery"),this._pendingDiscovery.add(e),this.ensurePendingRepositoryDiscovery()),[]}}ensurePendingRepositoryDiscovery(){null==this._pendingTimer&&0!==this._pendingDiscovery.size&&(this._pendingTimer=setTimeout((async()=>{try{const e=await U();for(const t of this._pendingDiscovery){if(null==e.getProvider(t))return this._pendingTimer=void 0,void this.ensurePendingRepositoryDiscovery();this._pendingDiscovery.delete(t)}this._pendingTimer=void 0,setTimeout((()=>this._onDidChange.fire()),1),0!==this._pendingDiscovery.size&&this.ensurePendingRepositoryDiscovery()}catch{this._pendingTimer=void 0,this.ensurePendingRepositoryDiscovery()}}),250))}updateContext(){(0,D.v)("gitlens:hasVirtualFolders",this.container.git.hasOpenRepositories(this.descriptor.id))}openRepository(e,t,i,s,n){return[new b._j(this.container,this.onRepositoryChanged.bind(this),this.descriptor,e,t,i,s??!r.window.state.focused,n)]}async supports(e){switch(e){case c.A.Stashes:case c.A.Worktrees:case c.A.StashOnlyStaged:return!1;default:return!0}}async visibility(e){const t=await this.getRemotes(e,{sort:!0});if(0===t.length)return[h.q4.Local,void 0];for await(const e of(0,O.rX)(t.map((e=>this.getRemoteVisibility(e)))))if("fulfilled"===e.status&&e.value[0]===h.q4.Public)return[h.q4.Public,(0,y.Ym)(e.value[1])];return[h.q4.Private,(0,y.Ym)(t)]}async getRemoteVisibility(e){if("github"===e.provider?.id){const{github:t,metadata:i,session:r}=await this.ensureRepositoryContext(e.repoPath);return[await t.getRepositoryVisibility(r.accessToken,i.repo.owner,i.repo.name)??h.q4.Private,e]}return[h.q4.Private,e]}async getOpenScmRepositories(){return[]}async getScmRepository(e){}async getOrOpenScmRepository(e){}canHandlePathOrUri(e,t){if(this.supportedSchemes.has(e))return"string"==typeof t?t:t.toString()}getAbsoluteUri(e,t){if("string"==typeof t){if(!(0,$.tE)(t))throw r.window.showErrorMessage(`Unable to get absolute uri between ${"string"==typeof e?e:e.toString(!0)} and ${t}; Base path '${t}' must be a uri`),new Error(`Base path '${t}' must be a uri`);t=r.Uri.parse(t,!0)}if("string"==typeof e&&!(0,$.tE)(e)){const i=(0,$.AH)(e);if(!(0,$.YP)(i))return r.Uri.joinPath(t,i)}const i=this.getRelativePath(e,t);return r.Uri.joinPath(t,i)}async getBestRevisionUri(e,t,i){return i?this.createProviderUri(e,i,t):this.createVirtualUri(e,i,t)}getRelativePath(e,t){if("string"==typeof t){if(!(0,$.tE)(t))throw r.window.showErrorMessage(`Unable to get relative path between ${"string"==typeof e?e:e.toString(!0)} and ${t}; Base path '${t}' must be a uri`),new Error(`Base path '${t}' must be a uri`);t=r.Uri.parse(t,!0)}let i;if("string"==typeof e){if(!(0,$.tE)(e))return e=(0,$.AH)(e),i=(0,$.YP)(e)&&e.startsWith(t.path)?e.slice(t.path.length):e,i.charCodeAt(0)===n.mN.Slash&&(i=i.slice(1)),i;e=r.Uri.parse(e,!0)}return i=(0,$.AH)((0,$.Gf)(t.path.slice(1),e.path.slice(1))),i}getRevisionUri(e,t,i){const r=this.createProviderUri(e,i,t);return i===m.Ii?r.with({query:"~"}):r}async getWorkingUri(e,t){return this.createVirtualUri(e,void 0,t.path)}async addRemote(e,t,i,r){}async pruneRemote(e,t){}async removeRemote(e,t){}async applyChangesToWorkingFile(e,t,i){}async branchContainsCommit(e,t,i){return!1}async checkout(e,t,i){}resetCache(e,...t){(0===t.length||t.includes("branches"))&&this._branchesCache.delete(e),(0===t.length||t.includes("tags"))&&this._tagsCache.delete(e),0===t.length&&this._repoInfoCache.delete(e)}resetCaches(...e){(0===e.length||e.includes("branches"))&&this._branchesCache.clear(),(0===e.length||e.includes("tags"))&&this._tagsCache.clear(),0===e.length&&this._repoInfoCache.clear()}async excludeIgnoredUris(e,t){return t}async fetch(e,t){}async findRepositoryUri(e,t){const i=(0,E.UH)();try{const t=await this.ensureRemoteHubApi();return t.getProviderRootUri(e).with({scheme:n.sN.Virtual})}catch(e){return a.R5,void F.Yd.error(e,i)}}async getAheadBehindCommitCount(e,t){}async getBlame(e,t){const i=(0,E.UH)();if(t?.isDirty)return;let r="blame";null!=e.sha&&(r+=`:${e.sha}`);const s=await this.container.tracker.getOrAdd(e);if(null!=s.state){const e=s.state.getBlame(r);if(null!=e)return F.Yd.debug(i,`Cache hit: '${r}'`),e.item}F.Yd.debug(i,`Cache miss: '${r}'`),null==s.state&&(s.state=new GitDocumentState);const n=this.getBlameCore(e,s,r,i);if(null!=s.state){F.Yd.debug(i,`Cache add: '${r}'`);const e={item:n};s.state.setBlame(r,e)}return n}async getBlameCore(e,t,i,s){try{const t=await this.ensureRepositoryContext(e.repoPath);if(null==t)return;const{metadata:i,github:s,remotehub:o,session:a}=t,c=o.getVirtualUri(o.getProviderRootUri(e)),l=this.getRelativePath(e,c);if(e.scheme===n.sN.Virtual){const[t,i]=await Promise.allSettled([r.workspace.fs.stat(e),r.workspace.fs.stat(e.with({scheme:n.sN.GitHub}))]);if("fulfilled"!==t.status||"fulfilled"!==i.status||t.value.mtime!==i.value.mtime)return}const h=e.sha&&"HEAD"!==e.sha?e.sha:(await i.getRevision()).revision,u=await s.getBlame(a.accessToken,i.repo.owner,i.repo.name,h,l),d=new Map,m=new Map,g=[];for(const t of u.ranges){const i=t.commit,{viewer:r=a.account.label}=u,s=null!=r&&i.author.name===r?"You":i.author.name,n=null!=r&&i.committer.name===r?"You":i.committer.name;let o=d.get(s);null==o&&(o={name:s,lineCount:0},d.set(s,o)),o.lineCount+=t.endingLine-t.startingLine+1;let h=m.get(i.oid);null==h&&(h=new p.aM(this.container,e.repoPath,i.oid,new p._j(s,i.author.email,new Date(i.author.date),i.author.avatarUrl),new p._j(n,i.committer.email,new Date(i.author.date)),i.message.split("\n",1)[0],i.parents.nodes[0]?.oid?[i.parents.nodes[0]?.oid]:[],i.message,new f.K8(c.toString(),l,f.NV.Modified),{changedFiles:i.changedFiles??0,additions:i.additions??0,deletions:i.deletions??0},[]),m.set(i.oid,h));for(let e=t.startingLine;e<=t.endingLine;e++){const t={sha:i.oid,originalLine:e,line:e};h.lines.push(t),g[e-1]=t}}const w=new Map([...d.entries()].sort(((e,t)=>t[1].lineCount-e[1].lineCount)));return{repoPath:e.repoPath,authors:w,commits:m,lines:g}}catch(e){if(null!=t.state&&!String(e).includes("No provider registered with")){const r=e?.toString()??"";F.Yd.debug(s,`Cache replace (with empty promise): '${i}'`);const n={item:z,errorMessage:r};return t.state.setBlame(i,n),t.setBlameFailure(),z}return}}async getBlameContents(e,t){}async getBlameForLine(e,t,i,r){const s=(0,E.UH)();if(!i?.isDirty){if(!r?.forceSingleLine){const i=await this.getBlame(e);if(null==i)return;let r=i.lines[t];if(null==r){if(i.lines.length!==t)return;r=i.lines[t-1]}const s=i.commits.get(r.sha);if(null==s)return;return{author:{...i.authors.get(s.author.name),lineCount:s.lines.length},commit:s,line:r}}try{const i=await this.ensureRepositoryContext(e.repoPath);if(null==i)return;const{metadata:r,github:s,remotehub:n,session:o}=i,a=n.getVirtualUri(n.getProviderRootUri(e)),c=this.getRelativePath(e,a),l=e.sha&&"HEAD"!==e.sha?e.sha:(await r.getRevision()).revision,h=await s.getBlame(o.accessToken,r.repo.owner,r.repo.name,l,c),u=t+1,d=h.ranges.find((e=>e.startingLine===u));if(null==d)return;const m=d.commit,{viewer:g=o.account.label}=h,w=null!=g&&m.author.name===g?"You":m.author.name,v=null!=g&&m.committer.name===g?"You":m.committer.name,y=new p.aM(this.container,e.repoPath,m.oid,new p._j(w,m.author.email,new Date(m.author.date),m.author.avatarUrl),new p._j(v,m.committer.email,new Date(m.author.date)),m.message.split("\n",1)[0],m.parents.nodes[0]?.oid?[m.parents.nodes[0]?.oid]:[],m.message,new f.K8(a.toString(),c,f.NV.Modified),{changedFiles:m.changedFiles??0,additions:m.additions??0,deletions:m.deletions??0},[]);for(let e=d.startingLine;e<=d.endingLine;e++){const t={sha:m.oid,originalLine:e,line:e};y.lines.push(t)}return{author:{name:w,lineCount:d.endingLine-d.startingLine+1},commit:y,line:{sha:m.oid,originalLine:d.startingLine,line:d.startingLine}}}catch(e){return void F.Yd.error(s,e)}}}async getBlameForLineContents(e,t,i,r){}async getBlameForRange(e,t){const i=await this.getBlame(e);if(null!=i)return this.getBlameRange(i,e,t)}async getBlameForRangeContents(e,t,i){const r=await this.getBlameContents(e,i);if(null!=r)return this.getBlameRange(r,e,t)}getBlameRange(e,t,i){if(0===e.lines.length)return{allLines:e.lines,...e};if(0===i.start.line&&i.end.line===e.lines.length-1)return{allLines:e.lines,...e};const r=e.lines.slice(i.start.line,i.end.line+1),s=new Set(r.map((e=>e.sha))),n=i.start.line+1,o=i.end.line+1,a=new Map,c=new Map;for(const t of e.commits.values()){if(!s.has(t.sha))continue;const e=t.with({lines:t.lines.filter((e=>e.line>=n&&e.line<=o))});c.set(t.sha,e);let i=a.get(e.author.name);null==i&&(i={name:e.author.name,lineCount:0},a.set(i.name,i)),i.lineCount+=e.lines.length}const l=new Map([...a.entries()].sort(((e,t)=>t[1].lineCount-e[1].lineCount)));return{repoPath:t.repoPath,authors:l,commits:c,lines:r,allLines:e.lines}}async getBranch(e){const{values:[t]}=await this.getBranches(e,{filter:e=>e.current});return t}async getBranches(e,t){if(null==e)return j;const i=(0,E.UH)();let r=t?.cursor?void 0:this._branchesCache.get(e);if(null==r){async function n(){try{const{metadata:i,github:r,session:s}=await this.ensureRepositoryContext(e),n=await i.getRevision(),o=0===n.type?n.name:void 0,a=[];let c=t?.cursor;const l=null==c;for(;;){const t=await r.getBranches(s.accessToken,i.repo.owner,i.repo.name,{cursor:c});for(const i of t.values){const t=new Date("author-date"===R.D.get("advanced.commitOrdering")?i.target.authoredDate:i.target.committedDate),r=i.target.oid;a.push(new d.XI(e,i.name,!1,i.name===o,t,r,{name:`origin/${i.name}`,missing:!1}),new d.XI(e,`origin/${i.name}`,!0,!1,t,r))}if(!t.paging?.more||!l)return{...t,values:a};c=t.paging.cursor}}catch(t){return F.Yd.error(t,i),this._branchesCache.delete(e),j}}r=n.call(this),null==t?.cursor&&this._branchesCache.set(e,r)}let s=await r;return null!=t?.filter&&(s={...s,values:s.values.filter(t.filter)}),null!=t?.sort&&(0,d.YF)(s.values,"boolean"==typeof t.sort?void 0:t.sort),s}async getChangedFilesCount(e,t){if(!t)return;const i=await this.getCommit(e,t);if(null==i?.stats)return;const{stats:r}=i,s=(0,p.By)(r.changedFiles);return{additions:r.additions,deletions:r.deletions,changedFiles:s}}async getCommit(e,t){if(null==e)return;const i=(0,E.UH)();try{const{metadata:i,github:r,session:s}=await this.ensureRepositoryContext(e),n=await r.getCommit(s.accessToken,i.repo.owner,i.repo.name,t);if(null==n)return;const{viewer:o=s.account.label}=n,a=null!=o&&n.author.name===o?"You":n.author.name,c=null!=o&&n.committer.name===o?"You":n.committer.name;return new p.aM(this.container,e,n.oid,new p._j(a,n.author.email,new Date(n.author.date),n.author.avatarUrl),new p._j(c,n.committer.email,new Date(n.committer.date)),n.message.split("\n",1)[0],n.parents.nodes.map((e=>e.oid)),n.message,n.files?.map((t=>new f.K8(e,t.filename??"",(0,G.fromCommitFileStatus)(t.status)??f.NV.Modified,t.previous_filename,void 0,{additions:t.additions??0,deletions:t.deletions??0,changes:t.changes??0})))??[],{changedFiles:n.changedFiles??0,additions:n.additions??0,deletions:n.deletions??0},[])}catch(e){return void F.Yd.error(e,i)}}async getCommitBranches(e,t,i){if(null==e||null==i?.commitDate)return[];const r=(0,E.UH)();try{const{metadata:r,github:s,session:n}=await this.ensureRepositoryContext(e);let o;return o=i?.branch?await s.getCommitOnBranch(n.accessToken,r.repo.owner,r.repo.name,i?.branch,t,i?.commitDate):await s.getCommitBranches(n.accessToken,r.repo.owner,r.repo.name,t,i?.commitDate),o}catch(e){return F.Yd.error(e,r),[]}}async getCommitCount(e,t){if(null==e)return;const i=(0,E.UH)();try{const{metadata:i,github:r,session:s}=await this.ensureRepositoryContext(e);return await r.getCommitCount(s?.accessToken,i.repo.owner,i.repo.name,t)}catch(e){return void F.Yd.error(e,i)}}async getCommitForFile(e,t,i){if(null==e)return;const r=(0,E.UH)();try{const{metadata:r,github:s,remotehub:n,session:o}=await this.ensureRepositoryContext(e),a=this.getRelativePath(t,n.getProviderRootUri(t)),c=i?.ref&&"HEAD"!==i.ref?i.ref:(await r.getRevision()).revision,l=await s.getCommitForFile(o.accessToken,r.repo.owner,r.repo.name,c,a);if(null==l)return;const{viewer:h=o.account.label}=l,u=null!=h&&l.author.name===h?"You":l.author.name,d=null!=h&&l.committer.name===h?"You":l.committer.name,m=l.files?.map((t=>new f.K8(e,t.filename??"",(0,G.fromCommitFileStatus)(t.status)??f.NV.Modified,t.previous_filename,void 0,{additions:t.additions??0,deletions:t.deletions??0,changes:t.changes??0}))),g=m?.find((e=>e.path===a));return new p.aM(this.container,e,l.oid,new p._j(u,l.author.email,new Date(l.author.date),l.author.avatarUrl),new p._j(d,l.committer.email,new Date(l.committer.date)),l.message.split("\n",1)[0],l.parents.nodes.map((e=>e.oid)),l.message,{file:g,files:m},{changedFiles:l.changedFiles??0,additions:l.additions??0,deletions:l.deletions??0},[])}catch(e){return void F.Yd.error(e,r)}}async getCommitsForGraph(e,t,i){const r=i?.limit??R.D.get("graph.defaultItemLimit")??5e3,s=R.D.get("graph.commitOrdering",void 0,"date"),n=R.D.get("graph.avatars",void 0,!0),[o,a,c,l,h,u]=await Promise.allSettled([this.getLog(e,{all:!0,ordering:s,limit:r}),this.getBranch(e),this.getBranches(e,{filter:e=>e.remote}),this.getRemotes(e),this.getTags(e),this.getCurrentUser(e)]),d=new Map,p=(0,O.Sb)(a),m=new Map,g=new Map;null!=p&&(m.set(p.name,p),null!=p.sha&&g.set(p.sha,[p.name]));const f=(0,O.Sb)(c)?.values;if(null!=f)for(const e of f){if(m.set(e.name,e),null==e.sha)continue;const t=g.get(e.sha);null==t?g.set(e.sha,[e.name]):t.push(e.name)}const w=new Set,v=(0,O.Sb)(l)[0],y=null!=v?new Map([[v.name,v]]):new Map,b=new Map,C=(0,O.Sb)(h)?.values;if(null!=C)for(const e of C){if(null==e.sha)continue;const t=b.get(e.sha);null==t?b.set(e.sha,[e.name]):t.push(e.name)}return this.getCommitsForGraphCore(e,t,(0,O.Sb)(o),p,m,g,v,y,b,(0,O.Sb)(u),d,w,{...i,useAvatars:n})}async getCommitsForGraphCore(e,t,i,r,s,n,a,c,l,h,u,m,g){const f={...g?.include,stats:!0},b=new Map;if(null==i)return{repoPath:e,avatars:u,ids:m,includes:f,branches:s,remotes:c,downstreams:b,rows:[]};const C=(i.pagedCommits?.()??i.commits)?.values();if(null==C)return{repoPath:e,avatars:u,ids:m,includes:f,branches:s,remotes:c,downstreams:b,rows:[]};const P=[];let S,R,D,k,_,F,E,$,O,I,B=!1,W=!1;const L=r.upstream?.name;for(const i of C){if(m.add(i.sha),B=i.sha===r.sha,B)if(D={webviewItem:`gitlens:branch${B?"+current":""}${null!=r?.upstream?"+tracking":""}`,webviewItemValue:{type:"branch",ref:(0,v.xB)(r.name,e,{id:r.id,refType:"branch",name:r.name,remote:!1,upstream:r.upstream})}},_=[{id:r.id,name:r.name,isCurrentHead:!0,context:(0,x.BH)(D),upstream:null!=r.upstream?{name:r.upstream.name,id:(0,d.Vx)(e,!0,r.upstream.name)}:void 0}],null!=r.upstream){if($=(0,d.Vx)(e,!0,r.name),S=((g?.useAvatars?a.provider?.avatarUri:void 0)??(0,y.dM)(this.container,a,t))?.toString(!0),D={webviewItem:"gitlens:branch+remote",webviewItemValue:{type:"branch",ref:(0,v.xB)(r.name,e,{id:$,refType:"branch",name:r.name,remote:!0,upstream:{name:a.name,missing:!1}})}},F=[{id:$,name:r.name,owner:a.name,url:a.url,avatarUrl:S,context:(0,x.BH)(D),current:!0}],null!=L){let e=b.get(L);null==e&&(e=[],b.set(L,e)),e.push(r.name)}}else F=[];else{_=[],F=[];const r=n.get(i.sha);if(null!=r)for(const i of r)$=(0,d.Vx)(e,!0,i),R=(0,d.S3)(i),S=((g?.useAvatars?a.provider?.avatarUri:void 0)??(0,y.dM)(this.container,a,t))?.toString(!0),D={webviewItem:"gitlens:branch+remote",webviewItemValue:{type:"branch",ref:(0,v.xB)(i,e,{id:$,refType:"branch",name:i,remote:!0,upstream:{name:a.name,missing:!1}})}},F.push({id:$,name:R,owner:a.name,url:a.url,avatarUrl:S,context:(0,x.BH)(D)})}E=[];const s=l.get(i.sha);if(null!=s)for(const t of s)I=(0,A.YU)(e,t),D={webviewItem:"gitlens:tag",webviewItemValue:{type:"tag",ref:(0,v.xB)(t,e,{id:I,refType:"tag",name:t})}},E.push({id:I,name:t,annotated:!0,context:(0,x.BH)(D)});if(i.author.email&&!u.has(i.author.email)){const e=i.getCachedAvatarUri();null!=e&&u.set(i.author.email,e.toString(!0))}W="You"===i.author.name,k={row:(0,x.BH)({webviewItem:`gitlens:commit${B?"+HEAD":""}+current`,webviewItemValue:{type:"commit",ref:(0,v.xB)(i.sha,e,{refType:"revision",message:i.message})}}),avatar:(0,x.BH)({webviewItem:"gitlens:contributor"+(W?"+current":""),webviewItemValue:{type:"contributor",repoPath:e,name:W&&null!=h?.name?h.name:i.author.name,email:i.author.email,current:W}})},P.push({sha:i.sha,parents:i.parents,author:i.author.name,email:i.author.email??"",date:i.committer.date.getTime(),message:(0,o.X)(i.message&&String(i.message).length?i.message:i.summary),type:i.parents.length>1?w.e.MergeCommit:w.e.Commit,heads:_,remotes:F,tags:E,contexts:k}),null!=i.stats&&(null==O&&(O=new Map),O.set(i.sha,{files:(0,p.By)(i.stats.changedFiles),additions:i.stats.additions,deletions:i.stats.deletions}))}return"HEAD"===g?.ref?g.ref=(0,T.Ps)(i.commits.values())?.sha:null!=g?.ref&&(g.ref=void 0),{repoPath:e,avatars:u,ids:m,includes:f,branches:s,remotes:c,downstreams:b,rows:P,id:g?.ref,paging:{limit:i.limit,startingCursor:i.startingCursor,hasMore:i.hasMore},more:async o=>{const d=await(i.more?.(o));return this.getCommitsForGraphCore(e,t,d,r,s,n,a,c,l,h,u,m,g)}}}async getContributors(e,t){if(null==e)return[];const i=(0,E.UH)();try{const{metadata:t,github:i,session:a}=await this.ensureRepositoryContext(e),c=await i.getContributors(a.accessToken,t.repo.owner,t.repo.name),l=await this.getCurrentUser(e),h=[];for(const t of c)"User"===t.type&&h.push(new g.V(e,t.name,t.email,t.contributions,void 0,(r=l,s=t.name,n=t.email,o=t.login,!(null==r||null==r.name&&null==r.email&&null==r.username||null!=r.name&&r.name!==s||null!=r.email&&r.email!==n||null!=r.username&&r.username!==o)),void 0,t.login,t.avatar_url,t.node_id));return h}catch(e){return F.Yd.error(e,i),[]}var r,s,n,o}async getCurrentUser(e){if(!e)return;const t=(0,E.UH)(),i=this._repoInfoCache.get(e);let r=i?.user;if(null!=r)return r;if(null!==r)try{const{metadata:t,github:s,session:n}=await this.ensureRepositoryContext(e);return r=await s.getCurrentUser(n.accessToken,t.repo.owner,t.repo.name),this._repoInfoCache.set(e,{...i,user:r??null}),r}catch(r){return F.Yd.error(r,t),void this._repoInfoCache.set(e,{...i,user:null})}}async getDefaultBranchName(e,t){if(null==e)return;const i=(0,E.UH)();try{const{metadata:t,github:i,session:r}=await this.ensureRepositoryContext(e);return await i.getDefaultBranchName(r.accessToken,t.repo.owner,t.repo.name)}catch(e){return void F.Yd.error(e,i)}}async getDiffForFile(e,t,i){}async getDiffForFileContents(e,t,i){}async getDiffForLine(e,t,i,r){}async getDiffStatus(e,t,i,r){}async getFileStatusForCommit(e,t,i){if(i===m.Ii||(0,v.l3)(i))return;const r=await this.getCommitForFile(e,t,{ref:i});return null!=r?r.findFile(t):void 0}async getLastFetchedTimestamp(e){}async getLog(e,t){if(null==e)return;const i=(0,E.UH)(),r=this.getPagingLimit(t?.limit);try{const{metadata:i,github:s,session:n}=await this.ensureRepositoryContext(e),o=t?.ref&&"HEAD"!==t.ref?t.ref:(await i.getRevision()).revision,a=await s.getCommits(n.accessToken,i.repo.owner,i.repo.name,o,{all:t?.all,authors:t?.authors,after:t?.cursor,limit:r,since:t?.since?new Date(t.since):void 0}),c=new Map,{viewer:l=n.account.label}=a;for(const t of a.values){const i=null!=l&&t.author.name===l?"You":t.author.name,r=null!=l&&t.committer.name===l?"You":t.committer.name;let s=c.get(t.oid);null==s&&(s=new p.aM(this.container,e,t.oid,new p._j(i,t.author.email,new Date(t.author.date),t.author.avatarUrl),new p._j(r,t.committer.email,new Date(t.committer.date)),t.message.split("\n",1)[0],t.parents.nodes.map((e=>e.oid)),t.message,t.files?.map((t=>new f.K8(e,t.filename??"",(0,G.fromCommitFileStatus)(t.status)??f.NV.Modified,t.previous_filename,void 0,{additions:t.additions??0,deletions:t.deletions??0,changes:t.changes??0}))),{changedFiles:t.changedFiles??0,additions:t.additions??0,deletions:t.deletions??0},[]),c.set(t.oid,s))}const h={repoPath:e,commits:c,sha:o,range:void 0,count:c.size,limit:r,hasMore:a.paging?.more??!1,endingCursor:a.paging?.cursor,query:i=>this.getLog(e,{...t,limit:i})};return h.hasMore&&(h.more=this.getLogMoreFn(h,t)),h}catch(e){return void F.Yd.error(e,i)}}async getLogRefsOnly(e,t){const i=await this.getLog(e,t);if(null!=i)return new Set([...i.commits.values()].map((e=>e.ref)))}getLogMoreFn(e,t){return async i=>{const r=null!=i&&"object"==typeof i?i.until:void 0;let s="number"==typeof i?i:void 0;if(r&&(0,T.G)(e.commits.values(),(e=>e.ref===r)))return e;s=this.getPagingLimit(s);const n=await this.getLog(e.repoPath,{...t,limit:s,cursor:e.endingCursor});if(null==n)return{...e,hasMore:!1,more:void 0};const o=new Map([...e.commits,...n.commits]),a={repoPath:e.repoPath,commits:o,sha:e.sha,range:void 0,count:o.size,limit:null==r?(e.limit??0)+s:void 0,hasMore:null!=r||n.hasMore,startingCursor:(0,T.Z$)(e.commits)?.[0],endingCursor:n.endingCursor,pagedCommits:()=>{for(const t of e.commits.keys())n.commits.delete(t);return n.commits},query:e.query};return a.hasMore&&(a.more=this.getLogMoreFn(a,t)),a}}async getLogForFile(e,t,i){if(null==e)return;const r=(0,E.UH)(),s=this.getRelativePath(t,e);if(null!=e&&e===s)throw new Error(`File name cannot match the repository path; path=${s}`);(i={reverse:!1,...i}).renames=!1,i.all=!1;let n="log";null!=i.ref&&(n+=`:${i.ref}`),i.limit=this.getPagingLimit(i?.limit),i.limit&&(n+=`:n${i.limit}`),i.renames&&(n+=":follow"),i.reverse&&(n+=":reverse"),i.since&&(n+=`:since=${i.since}`),i.skip&&(n+=`:skip${i.skip}`),i.cursor&&(n+=`:cursor=${i.cursor}`);const o=await this.container.tracker.getOrAdd(u.YY.fromFile(s,e,i.ref));if(!i.force&&null==i.range){if(null!=o.state){const s=o.state.getLog(n);if(null!=s)return F.Yd.debug(r,`Cache hit: '${n}'`),s.item;if(null!=i.ref||null!=i.limit){const s=o.state.getLog(`log${i.renames?":follow":""}${i.reverse?":reverse":""}`);if(null!=s){if(null==i.ref)return F.Yd.debug(r,`Cache hit: ~'${n}'`),s.item;F.Yd.debug(r,`Cache ?: '${n}'`);let o=await s.item;if(null!=o&&!o.hasMore&&o.commits.has(i.ref)){F.Yd.debug(r,`Cache hit: '${n}'`);let s=!0,a=0;const c=new Map((0,T.DZ)(o.commits.entries(),(([e,t])=>{if(s){if(e!==i?.ref)return;s=!1}if(a++,!(null!=i?.limit&&a>i.limit))return[e,t]}))),l={...i};return o={...o,limit:i.limit,count:c.size,commits:c,query:i=>this.getLogForFile(e,t,{...l,limit:i})},o}}}}F.Yd.debug(r,`Cache miss: '${n}'`),null==o.state&&(o.state=new GitDocumentState)}const a=this.getLogForFileCore(e,s,o,n,r,i);if(null!=o.state&&null==i.range){F.Yd.debug(r,`Cache add: '${n}'`);const e={item:a};o.state.setLog(n,e)}return a}async getLogForFileCore(e,t,i,r,s,n){if(null==e)return;const o=this.getPagingLimit(n?.limit);try{const i=await this.ensureRepositoryContext(e);if(null==i)return;const{metadata:r,github:s,remotehub:a,session:c}=i,l=this.getAbsoluteUri(t,e),h=this.getRelativePath(l,a.getProviderRootUri(l)),u=n?.ref&&"HEAD"!==n.ref?n.ref:(await r.getRevision()).revision,d=await s.getCommits(c.accessToken,r.repo.owner,r.repo.name,u,{all:n?.all,after:n?.cursor,path:h,limit:o,since:n?.since?new Date(n.since):void 0}),m=new Map,{viewer:g=c.account.label}=d;for(const t of d.values){const i=null!=g&&t.author.name===g?"You":t.author.name,r=null!=g&&t.committer.name===g?"You":t.committer.name;let s=m.get(t.oid);if(null==s){const n=t.files?.map((t=>new f.K8(e,t.filename??"",(0,G.fromCommitFileStatus)(t.status)??f.NV.Modified,t.previous_filename,void 0,{additions:t.additions??0,deletions:t.deletions??0,changes:t.changes??0}))),o=(0,$.Mh)(h)?void 0:n?.find((e=>e.path===h))??new f.K8(e,h,f.NV.Modified,void 0,void 0,1===t.changedFiles?{additions:t.additions??0,deletions:t.deletions??0,changes:0}:void 0);s=new p.aM(this.container,e,t.oid,new p._j(i,t.author.email,new Date(t.author.date),t.author.avatarUrl),new p._j(r,t.committer.email,new Date(t.committer.date)),t.message.split("\n",1)[0],t.parents.nodes.map((e=>e.oid)),t.message,{file:o,files:n},{changedFiles:t.changedFiles??0,additions:t.additions??0,deletions:t.deletions??0},[]),m.set(t.oid,s)}}const w={repoPath:e,commits:m,sha:u,range:void 0,count:m.size,limit:o,hasMore:d.paging?.more??!1,endingCursor:d.paging?.cursor,query:i=>this.getLogForFile(e,t,{...n,limit:i})};return w.hasMore&&(w.more=this.getLogForFileMoreFn(w,t,n)),w}catch(e){if(null!=i.state&&null==n?.range&&!n?.reverse){const t=e?.toString()??"";F.Yd.debug(s,`Cache replace (with empty promise): '${r}'`);const n={item:z,errorMessage:t};return i.state.setLog(r,n),z}return}}getLogForFileMoreFn(e,t,i){return async r=>{const s=null!=r&&"object"==typeof r?r.until:void 0;let n="number"==typeof r?r:void 0;if(s&&(0,T.G)(e.commits.values(),(e=>e.ref===s)))return e;n=this.getPagingLimit(n);const o=await this.getLogForFile(e.repoPath,t,{...i,limit:null==s?n:0,cursor:e.endingCursor});if(null==o)return{...e,hasMore:!1,more:void 0};const a=new Map([...e.commits,...o.commits]),c={repoPath:e.repoPath,commits:a,sha:e.sha,range:e.range,count:a.size,limit:null==s?(e.limit??0)+n:void 0,hasMore:null!=s||o.hasMore,endingCursor:o.endingCursor,query:e.query};return c.hasMore&&(c.more=this.getLogForFileMoreFn(c,t,i)),c}}async getMergeBase(e,t,i,r){}async getMergeStatus(e){}async getRebaseStatus(e){}async getNextComparisonUris(e,t,i,r=0){if(!i)return;const s=(0,E.UH)();try{const s=await this.ensureRepositoryContext(e);if(null==s)return;const{metadata:n,github:o,remotehub:a,session:c}=s,l=this.getRelativePath(t,a.getProviderRootUri(t)),h=(await n.getRevision()).revision;"HEAD"===i&&(i=h);const d=await o.getNextCommitRefs(c.accessToken,n.repo.owner,n.repo.name,h,l,i);return{current:0===r?u.YY.fromFile(l,e,i):new u.YY(await this.getBestRevisionUri(e,l,d[r-1])),next:new u.YY(await this.getBestRevisionUri(e,l,d[r]))}}catch(e){throw F.Yd.error(e,s),e}}async getOldestUnpushedRefForFile(e,t){}async getPreviousComparisonUris(e,t,i,r=0,s=!1){if(i===m.Ii)return;const n=(0,E.UH)();i===m.CL&&(i=void 0);try{const s=await this.ensureRepositoryContext(e);if(null==s)return;const{metadata:n,github:o,remotehub:a,session:c}=s,l=this.getRelativePath(t,a.getProviderRootUri(t)),h=null!=i?1:0,d=await o.getCommitRefs(c.accessToken,n.repo.owner,n.repo.name,i&&"HEAD"!==i?i:(await n.getRevision()).revision,{path:l,first:h+r+1});if(null==d)return;const p=0===r?u.YY.fromFile(l,e,i):new u.YY(await this.getBestRevisionUri(e,l,d.values[h+r-1]?.oid??m.Ii));if(null==p||p.sha===m.Ii)return;return{current:p,previous:new u.YY(await this.getBestRevisionUri(e,l,d.values[h+r]?.oid??m.Ii))}}catch(e){throw F.Yd.error(e,n),e}}async getPreviousComparisonUrisForLine(e,t,i,r,s=0){if(r===m.Ii)return;const n=(0,E.UH)();try{const n=await this.ensureRepositoryContext(e);if(null==n)return;const{remotehub:o}=n;let a,c=this.getRelativePath(t,o.getProviderRootUri(t)),l=u.YY.fromFile(c,e,r),h=i,d=i,p=i;for(let t=0;t<Math.max(0,s)+2;t++){const t=await this.getBlameForLine(a??l,p,void 0,{forceSingleLine:!0});if(null==t)break;r=t.commit.sha,c=t.commit.file?.path??t.commit.file?.originalPath??c,p=t.line.originalLine-1;const i=u.YY.fromFile(c,e,r);null==a?(a=i,d=p):(l=a,h=d,a=i,d=p)}if(null==l)return;return{current:l,previous:a,line:(h??i)+1}}catch(e){throw F.Yd.error(e,n),e}}async getIncomingActivity(e,t){}async getRemotes(e,t){if(null==e)return[];const i=t?.providers??(0,P.v)(R.D.get("remotes",null)),s=r.Uri.parse(e,!0),[,n,o]=s.path.split("/",3),a=`https://github.com/${n}/${o}.git`,c="github.com",l=`${n}/${o}`;return[new y.ss(e,`${c}/${l}`,"origin","https",c,l,(0,P.B)(this.container,i)(a,c,l),[{type:y.XG.Fetch,url:a},{type:y.XG.Push,url:a}])]}async getRevisionContent(e,t,i){const s=i?this.createProviderUri(e,i,t):this.createVirtualUri(e,i,t);return r.workspace.fs.readFile(s)}async getStash(e){}async getStatusForFile(e,t){}async getStatusForFiles(e,t){}async getStatusForRepo(e){if(null==e)return;const t=await this.ensureRepositoryContext(e);if(null==t)return;const i=await t.metadata.getRevision();return null!=i?new C.Hk(e,i.name,i.revision,[],{ahead:0,behind:0},i.type===N.Branch||i.type===N.RemoteBranch?`origin/${i.name}`:void 0):void 0}async getTags(e,t){if(null==e)return j;const i=(0,E.UH)();let r=t?.cursor?void 0:this._tagsCache.get(e);if(null==r){async function n(){try{const{metadata:i,github:r,session:s}=await this.ensureRepositoryContext(e),n=[];let o=t?.cursor;const a=null==o;let c,l;for(;;){const t=await r.getTags(s.accessToken,i.repo.owner,i.repo.name,{cursor:o});for(const i of t.values)c=i.target.authoredDate??i.target.target?.authoredDate??i.target.tagger?.date,l=i.target.committedDate??i.target.target?.committedDate??i.target.tagger?.date,n.push(new A.gE(e,i.name,i.target.target?.oid??i.target.oid,i.target.message??i.target.target?.message??"",null!=c?new Date(c):void 0,null!=l?new Date(l):void 0));if(!t.paging?.more||!a)return{...t,values:n};o=t.paging.cursor}}catch(t){return F.Yd.error(t,i),this._tagsCache.delete(e),j}}r=n.call(this),null==t?.cursor&&this._tagsCache.set(e,r)}let s=await r;return null!=t?.filter&&(s={...s,values:s.values.filter(t.filter)}),null!=t?.sort&&(0,A.Pj)(s.values,"boolean"==typeof t.sort?void 0:t.sort),s}async getTreeEntryForRevision(e,t,i){if(null==e||!t)return;if("HEAD"===i){const t=await this.ensureRepositoryContext(e);if(null==t)return;const r=await t.metadata.getRevision();i=r?.revision}const s=i?this.createProviderUri(e,i,t):this.createVirtualUri(e,i,t),n=await r.workspace.fs.stat(s);return null!=n?{path:this.getRelativePath(s,e),commitSha:i,size:n.size,type:(n.type&r.FileType.Directory)===r.FileType.Directory?"tree":"blob"}:void 0}async getTreeForRevision(e,t){if(null==e)return[];if("HEAD"===t){const i=await this.ensureRepositoryContext(e);if(null==i)return[];const r=await i.metadata.getRevision();t=r?.revision}const i=t?this.createProviderUri(e,t):this.createVirtualUri(e,t),s=await r.workspace.fs.readDirectory(i);if(null==s)return[];const n=[];for(const[e,o]of s){const s=this.getAbsoluteUri(e,i);n.push({path:this.getRelativePath(e,s),commitSha:t,size:0,type:(o&r.FileType.Directory)===r.FileType.Directory?"tree":"blob"})}return[]}async getUniqueRepositoryId(e){}async hasBranchOrTag(e,t){const[{values:i},{values:r}]=await Promise.all([this.getBranches(e,{filter:t?.filter?.branches,sort:!1}),this.getTags(e,{filter:t?.filter?.tags,sort:!1})]);return 0!==i.length||0!==r.length}async hasCommitBeenPushed(e,t){return!0}isTrackable(e){return this.supportedSchemes.has(e.scheme)}async isTracked(e){if(!this.isTrackable(e)||null==this.container.git.getRepository(e))return!1;const t=e.with({scheme:n.sN.GitHub});return null!=await r.workspace.fs.stat(t)}async getDiffTool(e){}async openDiffTool(e,t,i){}async openDirectoryCompare(e,t,i,r){}async resolveReference(e,t,i,r){if(!t||t===m.Ii||null==i&&(0,v.D3)(t)||null!=i&&(0,v.l3)(t))return t;let s;if(null!=i)s=this.getRelativePath(i,e);else if(!(0,v.yo)(t)||t.endsWith("^3"))return t;const n=await this.ensureRepositoryContext(e);if(null==n)return t;const{metadata:o,github:a,session:c}=n,l=await a.resolveReference(c.accessToken,o.repo.owner,o.repo.name,t,s);return null!=l?l:s?m.Ii:t}async richSearchCommits(e,t,i){if(null==e)return;const r=(0,E.UH)(),s=(0,S.pD)(t),n=s.get("commit:");if(null!=n){const t=await this.getCommit(e,n[0]);if(null==t)return;return{repoPath:e,commits:new Map([[t.sha,t]]),sha:t.sha,range:void 0,count:1,limit:1,hasMore:!1}}const o=await this.getQueryArgsFromSearchQuery(t,s,e);if(0===o.length)return;const a=this.getPagingLimit(i?.limit);try{const{metadata:r,github:s,session:n}=await this.ensureRepositoryContext(e),c=`repo:${r.repo.owner}/${r.repo.name}+${o.join("+").trim()}`,l=await s.searchCommits(n.accessToken,c,{cursor:i?.cursor,limit:a,sort:"date"===i?.ordering?"committer-date":"author-date"===i?.ordering?"author-date":void 0});if(null==l)return;const h=new Map,u=n.account.label;for(const t of l.values){const i=null!=u&&t.author.name===u?"You":t.author.name,r=null!=u&&t.committer.name===u?"You":t.committer.name;let s=h.get(t.oid);null==s&&(s=new p.aM(this.container,e,t.oid,new p._j(i,t.author.email,new Date(t.author.date),t.author.avatarUrl),new p._j(r,t.committer.email,new Date(t.committer.date)),t.message.split("\n",1)[0],t.parents.nodes.map((e=>e.oid)),t.message,t.files?.map((t=>new f.K8(e,t.filename??"",(0,G.fromCommitFileStatus)(t.status)??f.NV.Modified,t.previous_filename,void 0,{additions:t.additions??0,deletions:t.deletions??0,changes:t.changes??0}))),{changedFiles:t.changedFiles??0,additions:t.additions??0,deletions:t.deletions??0},[]),h.set(t.oid,s))}const d={repoPath:e,commits:h,sha:void 0,range:void 0,count:h.size,limit:a,hasMore:l.pageInfo?.hasNextPage??!1,endingCursor:l.pageInfo?.endCursor??void 0,query:t=>this.getLog(e,{...i,limit:t})};if(d.hasMore){let e=function(r){return async s=>{s=this.getPagingLimit(s);const n=await this.richSearchCommits(r.repoPath,t,{...i,limit:s,cursor:r.endingCursor});if(null==n)return{...r,hasMore:!1,more:void 0};const o=new Map([...r.commits,...n.commits]),a={repoPath:r.repoPath,commits:o,sha:r.sha,range:void 0,count:o.size,limit:(r.limit??0)+s,hasMore:n.hasMore,endingCursor:n.endingCursor,query:r.query};return a.hasMore&&(a.more=e.call(this,a)),a}};d.more=e.call(this,d)}return d}catch(e){return void F.Yd.error(e,r)}}async searchCommits(e,t,i){t={matchAll:!1,matchCase:!1,matchRegex:!0,...t};const r=(0,S.FL)(t);try{const s=new Map,n=(0,S.pD)(t),o=n.get("commit:");if(null!=o){const m=await Promise.allSettled(o.map((t=>this.getCommit(e,t.replace(Q,"")))));let g=0;for(const f of m){const w=(0,O.Sb)(f);null!=w&&s.set(w.sha,{i:g++,date:Number("author-date"===i?.ordering?w.author.date:w.committer.date)})}return{repoPath:e,query:t,comparisonKey:r,results:s}}const a=await this.getQueryArgsFromSearchQuery(t,n,e);if(0===a.length)return{repoPath:e,query:t,comparisonKey:r,results:s};const{metadata:c,github:h,session:u}=await this.ensureRepositoryContext(e),d=`repo:${c.repo.owner}/${c.repo.name}+${a.join("+").trim()}`;async function p(n,o){if(i?.cancellation?.isCancellationRequested)return{repoPath:e,query:t,comparisonKey:r,results:s};n=this.getPagingLimit(n??R.D.get("advanced.maxSearchItems"));const a=await h.searchCommitShas(u.accessToken,d,{cursor:o,limit:n,sort:"date"===i?.ordering?"committer-date":"author-date"===i?.ordering?"author-date":void 0});if(null==a||i?.cancellation?.isCancellationRequested)return{repoPath:e,query:t,comparisonKey:r,results:s};for(const e of a.values)s.set(e.sha,{i:s.size,date:Number("author-date"===i?.ordering?e.authorDate:e.committerDate)});return o=a.pageInfo?.endCursor??void 0,{repoPath:e,query:t,comparisonKey:r,results:s,paging:a.pageInfo?.hasNextPage?{limit:n,hasMore:!0}:void 0,more:async e=>p.call(this,e,o)}}return p.call(this,i?.limit)}catch(v){if(v instanceof l.l0)throw v;throw new l.l0(v)}}async validateBranchOrTagName(e,t){return J.test(e)}async validateReference(e,t){return!0}async stageFile(e,t){}async stageDirectory(e,t){}async unStageFile(e,t){}async unStageDirectory(e,t){}async ensureRepositoryContext(e,t){let i=r.Uri.parse(e,!0);if(!/^github\+?/.test(i.authority))throw new a.kX(e,a.sh.NotAGitHubRepository);if(!t){const t=this.container.git.getRepository(i);if(null==t)throw new a.kX(e,a.sh.NotAGitHubRepository);i=t.uri}let s=this._remotehub;if(null==s)try{s=await this.ensureRemoteHubApi()}catch(t){throw a.R5,new a.kX(e,a.sh.RemoteHubApiNotFound,t)}const n=await(s?.getMetadata(i));if("github"!==n?.provider.id)throw new a.kX(e,a.sh.NotAGitHubRepository);let o,c;try{[o,c]=await Promise.all([this.ensureGitHub(),this.ensureSession()])}catch(t){if(t instanceof a._7)throw new a.kX(e,t.reason===a.Jx.UserDidNotConsent?a.sh.GitHubAuthenticationDenied:a.sh.GitHubAuthenticationNotFound,t);throw new a.kX(e)}if(null==o)throw new a.kX(e);return{github:o,metadata:n,remotehub:s,session:c}}async ensureGitHub(){if(null==this._github){const e=await this.container.github;null!=e&&this._disposables.push(e.onDidReauthenticate((()=>{this.ensureSession(!0)}))),this._github=e}return this._github}async ensureRemoteHubApi(e){if(null==this._remotehubPromise&&(this._remotehubPromise=U(),this._remotehubPromise.then((e=>this._remotehub=e),(()=>this._remotehub=void 0))),!e)return this._remotehubPromise;try{return await this._remotehubPromise}catch{return}}async ensureSession(e=!1,t=!1){if(e||null==this._sessionPromise){async function i(){let s=this.container.storage.get(`provider:authentication:skip:${this.descriptor.id}`,!1);try{if(e)return s=!1,this.container.storage.delete(`provider:authentication:skip:${this.descriptor.id}`),await r.authentication.getSession("github",K,{forceNewSession:!0});if(!s&&!t)return await r.authentication.getSession("github",K,{createIfNone:!0});const i=await r.authentication.getSession("github",K,{createIfNone:!1,silent:t});if(null!=i)return i;throw new Error("User did not consent")}catch(n){if(n instanceof Error&&n.message.includes("User did not consent")){if(!t&&(await this.container.storage.store(`provider:authentication:skip:${this.descriptor.id}`,!0),!s))return e||queueMicrotask((async()=>{const e="Re-enable";await r.window.showInformationMessage("GitLens has been disabled. Authentication is required for GitLens to work with remote GitHub repositories.",e)===e&&this.ensureSession(!0)})),e=!1,i.call(this);throw new a._7("github",a.Jx.UserDidNotConsent)}throw F.Yd.error(n),new a._7("github",void 0,n)}}this._sessionPromise=i.call(this)}return this._sessionPromise}createVirtualUri(e,t,i){let s;if("string"==typeof t)t&&(s=(0,v.D3)(t)?{v:1,ref:{id:t,type:2}}:{v:1,ref:{id:t,type:4}});else switch(t?.refType){case"revision":case"stash":s={v:1,ref:{id:t.ref,type:2}};break;case"branch":case"tag":s={v:1,ref:{id:t.name,type:4}}}if("string"==typeof e&&(e=r.Uri.parse(e,!0)),i){let t=e.path;t.endsWith("/")&&(t=t.slice(0,-1)),i=`${t}/${(i=this.getRelativePath(i,e)).startsWith("/")?i.slice(0,-1):i}`}return e.with({scheme:n.sN.Virtual,authority:X("github",s),path:i??e.path})}createProviderUri(e,t,i){const r=this.createVirtualUri(e,t,i);return null==this._remotehub?r.scheme!==n.sN.Virtual?r:r.with({scheme:n.sN.GitHub}):this._remotehub.getProviderUri(r)}getPagingLimit(e){return 0===(e=Math.min(100,e??R.D.get("advanced.maxListItems")??100))&&(e=100),e}async resolveReferenceCore(e,t,i){if(null==i||"HEAD"===i){return(await t.getRevision()).revision}if((0,v.D3)(i))return i;if((0,v.yk)(i))return;const[r,s]=await Promise.allSettled([this.getBranches(e,{filter:e=>e.name===i}),this.getTags(e,{filter:e=>e.name===i})]);return i=(0,O.Sb)(r)?.values[0]?.sha??(0,O.Sb)(s)?.values[0]?.sha}async getQueryArgsFromSearchQuery(e,t,i){const r=[];for(const[s,n]of t.entries())switch(s){case"message:":r.push(...n.map((e=>e.replace(/ /g,"+"))));break;case"author:":{let t;n.includes("@me")&&(t=await this.getCurrentUser(i));for(let i of n)if(i&&(i=i.replace(Q,e.matchRegex?"\\b":""),i)){if("@me"===i){if(null==t?.username)continue;i=`@${t.username}`}i=i.replace(/ /g,"+"),i.startsWith("@")?r.push(`author:${i.slice(1)}`):i.includes("@")?r.push(`author-email:${i}`):r.push(`author-name:${i}`)}break}}return r}}function X(e,t){return`${e}${null!=t?`+${(0,s.e)(JSON.stringify(t))}`:""}`}q([(0,_.cM)()],GitHubGitProvider.prototype,"getBestRevisionUri",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getWorkingUri",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"addRemote",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"pruneRemote",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"removeRemote",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"applyChangesToWorkingFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"branchContainsCommit",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"checkout",1),q([(0,_.cM)({singleLine:!0})],GitHubGitProvider.prototype,"resetCache",1),q([(0,_.cM)({singleLine:!0})],GitHubGitProvider.prototype,"resetCaches",1),q([(0,_.cM)({args:{1:e=>e.length}})],GitHubGitProvider.prototype,"excludeIgnoredUris",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"fetch",1),q([(0,k.H)(),(0,_.fF)()],GitHubGitProvider.prototype,"findRepositoryUri",1),q([(0,_.cM)({args:{1:e=>e.join(",")}})],GitHubGitProvider.prototype,"getAheadBehindCommitCount",1),q([(0,k.H)(((e,t)=>`${e.toString()}|${t?.isDirty}`)),(0,_.cM)({args:{1:e=>e?.isDirty}})],GitHubGitProvider.prototype,"getBlame",1),q([(0,_.cM)({args:{1:"<contents>"}})],GitHubGitProvider.prototype,"getBlameContents",1),q([(0,k.H)(((e,t,i,r)=>`${e.toString()}|${t}|${i?.isDirty}|${r?.forceSingleLine}`)),(0,_.cM)({args:{2:e=>e?.isDirty}})],GitHubGitProvider.prototype,"getBlameForLine",1),q([(0,_.cM)({args:{2:"<contents>"}})],GitHubGitProvider.prototype,"getBlameForLineContents",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getBlameForRange",1),q([(0,_.cM)({args:{2:"<contents>"}})],GitHubGitProvider.prototype,"getBlameForRangeContents",1),q([(0,_.cM)({args:{0:"<blame>"}})],GitHubGitProvider.prototype,"getBlameRange",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getBranch",1),q([(0,_.cM)({args:{1:!1}})],GitHubGitProvider.prototype,"getBranches",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getChangedFilesCount",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getCommit",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getCommitBranches",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getCommitCount",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getCommitForFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getCommitsForGraph",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getContributors",1),q([(0,k.H)(),(0,_.cM)()],GitHubGitProvider.prototype,"getCurrentUser",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getDefaultBranchName",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getDiffForFile",1),q([(0,_.cM)({args:{1:e=>"<contents>"}})],GitHubGitProvider.prototype,"getDiffForFileContents",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getDiffForLine",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getDiffStatus",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getFileStatusForCommit",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getLog",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getLogRefsOnly",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getLogForFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getMergeBase",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getMergeStatus",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getRebaseStatus",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getNextComparisonUris",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getOldestUnpushedRefForFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getPreviousComparisonUris",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getPreviousComparisonUrisForLine",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getIncomingActivity",1),q([(0,_.cM)({args:{1:!1}})],GitHubGitProvider.prototype,"getRemotes",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getRevisionContent",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getStash",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getStatusForFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getStatusForFiles",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getStatusForRepo",1),q([(0,_.cM)({args:{1:!1}})],GitHubGitProvider.prototype,"getTags",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getTreeEntryForRevision",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getTreeForRevision",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"hasBranchOrTag",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"hasCommitBeenPushed",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"getDiffTool",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"openDiffTool",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"openDirectoryCompare",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"resolveReference",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"richSearchCommits",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"searchCommits",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"validateBranchOrTagName",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"validateReference",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"stageFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"stageDirectory",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"unStageFile",1),q([(0,_.cM)()],GitHubGitProvider.prototype,"unStageDirectory",1),q([(0,k.H)()],GitHubGitProvider.prototype,"ensureRepositoryContext",1),q([(0,k.H)()],GitHubGitProvider.prototype,"ensureGitHub",1);class RepositoryWebPathMappingProvider{constructor(e){this._container=e}dispose(){}async getLocalRepoPaths(e){return[]}async writeLocalRepoPath(e,t){}}class WorkspacesWebPathMappingProvider{async getCloudWorkspaceRepoPath(e,t){}async getCloudWorkspaceCodeWorkspacePath(e){}async removeCloudWorkspaceCodeWorkspaceFilePath(e){}async writeCloudWorkspaceCodeWorkspaceFilePathToMap(e,t){}async confirmCloudWorkspaceCodeWorkspaceFilePath(e){return!1}async writeCloudWorkspaceRepoDiskPathToMap(e,t,i){}async getLocalWorkspaceData(){return{workspaces:{}}}async writeCodeWorkspaceFile(e,t,i){return!1}async updateCodeWorkspaceFileSettings(e,t){return!1}}var Z=i(9827);class AnthropicProvider{constructor(e){this.container=e,this.id="anthropic",this.name="Anthropic"}get model(){return R.D.get("ai.experimental.anthropic.model")||"claude-v1"}dispose(){}async generateCommitMessage(e,t){const i=await ee(this.container.storage);if(null==i)return;const s=this.model,n=te(s),o=e.substring(0,n);e.length>n&&r.window.showWarningMessage(`The diff of the staged changes had to be truncated to ${n} characters to fit within the Anthropic's limits.`);let a=R.D.get("experimental.generateCommitMessagePrompt");a.endsWith(".")||(a+=".");let c="\n\nHuman: You are an AI programming assistant tasked with writing a meaningful commit message by summarizing code changes.\n- Follow the user's instructions carefully & to the letter!\n- Don't repeat yourself or make anything up!\n- Minimize any other prose.";c+=`\n${a}\n- Avoid phrases like "this commit", "this change", etc.`,c+="\n\nAssistant: OK",t?.context&&(c+=`\n\nHuman: Use "${t.context}" to help craft the commit message.\n\nAssistant: OK`),c+=`\n\nHuman: Write a meaningful commit message for the following code changes:\n\n${o}`,c+="\n\nAssistant:";const l={model:s,prompt:c,stream:!1,max_tokens_to_sample:5e3,stop_sequences:["\n\nHuman:"]},h=await(0,Z.he)("https://api.anthropic.com/v1/complete",{headers:{Accept:"application/json",Authorization:`Bearer ${i}`,"Content-Type":"application/json",Client:"anthropic-typescript/0.4.3","X-API-Key":i},method:"POST",body:JSON.stringify(l)});if(!h.ok){let e;try{e=await h.json()}catch{}throw new Error(`Unable to generate commit message: (${this.name}:${h.status}) ${e?.error.message||h.statusText})`)}return(await h.json()).completion.trim()}async explainChanges(e,t){const i=await ee(this.container.storage);if(null==i)return;const s=this.model,n=te(s),o=t.substring(0,n);t.length>n&&r.window.showWarningMessage(`The diff of the commit changes had to be truncated to ${n} characters to fit within the OpenAI's limits.`);let a="\n\nHuman: You are an AI programming assistant tasked with providing an easy to understand but detailed explanation of a commit by summarizing the code changes while also using the commit message as additional context and framing.\nDon't make anything up!";a+=`\nUse the following user-provided commit message, which should provide some explanation to why these changes where made, when attempting to generate the rich explanation:\n\n${e}`,a+="\n\nAssistant: OK",a+=`\n\nHuman: Explain the following code changes:\n\n${o}`,a+="\n\nAssistant:";const c={model:s,prompt:a,stream:!1,max_tokens_to_sample:5e3,stop_sequences:["\n\nHuman:"]},l=await(0,Z.he)("https://api.anthropic.com/v1/complete",{headers:{Accept:"application/json",Authorization:`Bearer ${i}`,"Content-Type":"application/json",Client:"anthropic-typescript/0.4.3","X-API-Key":i,"anthropic-version":"2023-06-01"},method:"POST",body:JSON.stringify(c)});if(!l.ok){let e;try{e=await l.json()}catch{}throw new Error(`Unable to explain commit: (${this.name}:${l.status}) ${e?.error.message||l.statusText})`)}return(await l.json()).completion.trim()}}async function ee(e){let t=await e.getSecret("gitlens.anthropic.key");if(!t){const i=r.window.createInputBox();i.ignoreFocusOut=!0;const s=[];try{const e={iconPath:new r.ThemeIcon("link-external"),tooltip:"Open the Anthropic API Key Page"};t=await new Promise((t=>{s.push(i.onDidHide((()=>t(void 0))),i.onDidChangeValue((e=>{!e||/sk-[a-zA-Z0-9-_]{32,}/.test(e)?i.validationMessage=void 0:i.validationMessage="Please enter a valid Anthropic API key"})),i.onDidAccept((()=>{const e=i.value.trim();e&&/sk-[a-zA-Z0-9-_]{32,}/.test(e)?t(e):i.validationMessage="Please enter a valid Anthropic API key"})),i.onDidTriggerButton((t=>{t===e&&r.env.openExternal(r.Uri.parse("https://console.anthropic.com/account/keys"))}))),i.password=!0,i.title="Connect to Anthropic",i.placeholder="Please enter your Anthropic API key to use this feature",i.prompt=(0,W.gn)("input-prompt-links")?'Enter your [Anthropic API Key](https://console.anthropic.com/account/keys "Get your Anthropic API key")':"Enter your Anthropic API Key",i.buttons=[e],i.show()}))}finally{i.dispose(),s.forEach((e=>{e.dispose()}))}if(!t)return;e.storeSecret("gitlens.anthropic.key",t)}return t}function te(e){return"claude-2"===e||"claude-v1-100k"===e||"claude-instant-v1-100k"===e?135e3:12e3}class OpenAIProvider{constructor(e){this.container=e,this.id="openai",this.name="OpenAI"}get model(){return R.D.get("ai.experimental.openai.model")||"gpt-3.5-turbo"}dispose(){}get url(){return R.D.get("ai.experimental.openai.url")??"https://api.openai.com/v1/chat/completions"}async generateCommitMessage(e,t){const i=await ie(this.container.storage);if(null==i)return;const s=this.model,n=re(s),o=e.substring(0,n);e.length>n&&r.window.showWarningMessage(`The diff of the staged changes had to be truncated to ${n} characters to fit within the OpenAI's limits.`);let a=R.D.get("experimental.generateCommitMessagePrompt");a.endsWith(".")||(a+=".");const c={model:s,messages:[{role:"system",content:"You are an AI programming assistant tasked with writing a meaningful commit message by summarizing code changes.\n\n- Follow the user's instructions carefully & to the letter!\n- Don't repeat yourself or make anything up!\n- Minimize any other prose."},{role:"user",content:`${a}\n- Avoid phrases like "this commit", "this change", etc.`}]};t?.context&&c.messages.push({role:"user",content:`Use "${t.context}" to help craft the commit message.`}),c.messages.push({role:"user",content:`Write a meaningful commit message for the following code changes:\n\n${o}`});const l=await(0,Z.he)(this.url,{headers:{Accept:"application/json",Authorization:`Bearer ${i}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(c)});if(!l.ok){if(429===l.status)throw new Error(`Unable to generate commit message: (${this.name}:${l.status}) Too many requests (rate limit exceeded) or your API key is associated with an expired trial`);throw new Error(`Unable to generate commit message: (${this.name}:${l.status}) ${l.statusText}`)}return(await l.json()).choices[0].message.content.trim()}async explainChanges(e,t){const i=await ie(this.container.storage);if(null==i)return;const s=this.model,n=re(s),o=t.substring(0,n);t.length>n&&r.window.showWarningMessage(`The diff of the commit changes had to be truncated to ${n} characters to fit within the OpenAI's limits.`);const a={model:s,messages:[{role:"system",content:"You are an AI programming assistant tasked with providing an easy to understand but detailed explanation of a commit by summarizing the code changes while also using the commit message as additional context and framing.\n\n- Don't make anything up!"},{role:"user",content:`Use the following user-provided commit message, which should provide some explanation to why these changes where made, when attempting to generate the rich explanation:\n\n${e}`},{role:"assistant",content:"OK"},{role:"user",content:`Explain the following code changes:\n\n${o}`}]},c=await(0,Z.he)(this.url,{headers:{Accept:"application/json",Authorization:`Bearer ${i}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)});if(!c.ok){if(429===c.status)throw new Error(`Unable to explain commit: (${this.name}:${c.status}) Too many requests (rate limit exceeded) or your API key is associated with an expired trial`);throw new Error(`Unable to explain commit: (${this.name}:${c.status}) ${c.statusText}`)}return(await c.json()).choices[0].message.content.trim()}}async function ie(e){let t=await e.getSecret("gitlens.openai.key");if(!t){const i=r.window.createInputBox();i.ignoreFocusOut=!0;const s=[];try{const e={iconPath:new r.ThemeIcon("link-external"),tooltip:"Open the OpenAI API Key Page"};t=await new Promise((t=>{s.push(i.onDidHide((()=>t(void 0))),i.onDidChangeValue((e=>{!e||/sk-[a-zA-Z0-9]{32}/.test(e)?i.validationMessage=void 0:i.validationMessage="Please enter a valid OpenAI API key"})),i.onDidAccept((()=>{const e=i.value.trim();e&&/sk-[a-zA-Z0-9]{32}/.test(e)?t(e):i.validationMessage="Please enter a valid OpenAI API key"})),i.onDidTriggerButton((t=>{t===e&&r.env.openExternal(r.Uri.parse("https://platform.openai.com/account/api-keys"))}))),i.password=!0,i.title="Connect to OpenAI",i.placeholder="Please enter your OpenAI API key to use this feature",i.prompt=(0,W.gn)("input-prompt-links")?'Enter your [OpenAI API Key](https://platform.openai.com/account/api-keys "Get your OpenAI API key")':"Enter your OpenAI API Key",i.buttons=[e],i.show()}))}finally{i.dispose(),s.forEach((e=>{e.dispose()}))}if(!t)return;e.storeSecret("gitlens.openai.key",t)}return t}function re(e){switch(e){case"gpt-4-32k":case"gpt-4-32k-0314":case"gpt-4-32k-0613":return 43e3;case"gpt-3.5-turbo-16k":return 21e3;default:return 12e3}}class AIProviderService{constructor(e){this.container=e}get provider(){const e=R.D.get("ai.experimental.provider");return e===this._provider?.id||(this._provider?.dispose(),this._provider="anthropic"===e?new AnthropicProvider(this.container):new OpenAIProvider(this.container)),this._provider}dispose(){this._provider?.dispose()}async generateCommitMessage(e,t){const i=(0,b.uC)(e)?e:this.container.git.getRepository(e);if(null==i)throw new Error("Unable to find repository");const s=await this.container.git.getDiff(i.uri,m.pw,void 0,{includeRawDiff:!0});if(null==s?.diff)throw new Error("No staged changes to generate a commit message from.");const n=this.provider;if(await se(n,this.container.storage))return null!=t?.progress?r.window.withProgress(t.progress,(async()=>n.generateCommitMessage(s.diff,{context:t?.context}))):n.generateCommitMessage(s.diff,{context:t?.context})}async explainCommit(e,t,i){let s;if("string"==typeof e||e instanceof r.Uri){if("string"!=typeof t||!t)throw new Error("Invalid arguments provided");s=await this.container.git.getCommit(e,t)}else{if("string"==typeof t)throw new Error("Invalid arguments provided");s=(0,p.f_)(e)?e:await this.container.git.getCommit(e.repoPath,e.ref),i=t}if(null==s)throw new Error("Unable to find commit");const n=await this.container.git.getDiff(s.repoPath,s.sha,void 0,{includeRawDiff:!0});if(null==n?.diff)throw new Error("No changes found to explain.");const o=this.provider;if(await se(o,this.container.storage))return s.hasFullDetails()||(await s.ensureFullDetails(),(0,p.yp)(s)),null!=i?.progress?r.window.withProgress(i.progress,(async()=>o.explainChanges(s.message,n.diff))):o.explainChanges(s.message,n.diff)}}async function se(e,t){if(t.get(`confirm:ai:tos:${e.id}`,!1)||t.getWorkspace(`confirm:ai:tos:${e.id}`,!1))return!0;const i={title:"Yes"},s={title:"Always for this Workspace"},n={title:"Always"},o=await r.window.showInformationMessage(`This GitLens experimental feature requires sending a diff of the code changes to ${e.name}. This may contain sensitive information.\n\nDo you want to continue?`,{modal:!0},i,s,n,{title:"No",isCloseAffordance:!0});return o===i||(o===s?(t.storeWorkspace(`confirm:ai:tos:${e.id}`,!0),!0):o===n&&(t.store(`confirm:ai:tos:${e.id}`,!0),!0))}var ne=i(3139),oe=i(623),ae=i(9338),ce=i(1062),le=i(248),he=Object.defineProperty,ue=Object.getOwnPropertyDescriptor,de=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?ue(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&he(t,i,n),n};const pe=r.window.createTextEditorDecorationType({after:{margin:"0 0 0 3em",textDecoration:"none"},rangeBehavior:r.DecorationRangeBehavior.ClosedOpen}),me=2**30;class LineAnnotationController{constructor(e){this.container=e,this._enabled=!1,this._suspended=!1,this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this),R.D.onDidChange(this.onConfigurationChanged,this),e.fileAnnotations.onDidToggleAnnotations(this.onFileAnnotationsToggled,this),e.richRemoteProviders.onDidChangeConnectionState((()=>{this.refresh(r.window.activeTextEditor)})))}dispose(){this.clearAnnotations(this._editor),this.container.lineTracker.unsubscribe(this),this._disposable.dispose()}onReady(){this.onConfigurationChanged()}onConfigurationChanged(e){R.D.changed(e,"currentLine")&&(R.D.changed(e,"currentLine.enabled")&&(R.D.get("currentLine.enabled")?(this._enabled=!0,this.resume()):(this._enabled=!1,this.setLineTracker(!1))),this.refresh(r.window.activeTextEditor))}get suspended(){return!this._enabled||this._suspended}resume(){return this.setLineTracker(!0),!!this._suspended&&(this._suspended=!1,!0)}suspend(){return this.setLineTracker(!1),!this._suspended&&(this._suspended=!0,!0)}onActiveLinesChanged(e){e.pending||void 0===e.selections?this.clear(e.editor):this.refresh(e.editor)}onFileAnnotationsToggled(){this.refresh(r.window.activeTextEditor)}clear(e){this._cancellation?.cancel(),this._editor!==e&&null!=this._editor&&this.clearAnnotations(this._editor),this.clearAnnotations(e)}async toggle(e){this._enabled=!(this._enabled&&!this.suspended),this._enabled?this.resume()&&await this.refresh(e):this.suspend()&&await this.refresh(e)}clearAnnotations(e){void 0!==e&&!0!==e._disposed&&e.setDecorations(pe,[])}async getPullRequests(e,t,{timeout:i}={}){if(0===t.length)return;const r=await this.container.git.getBestRemoteWithRichProvider(e);if(null==r?.provider)return;const s=new Set;for(const[,e]of t)s.add(e.ref);if(0===s.size)return;const{provider:n}=r,o=await(0,O.xu)(s.values(),(e=>this.container.git.getPullRequestForCommit(e,n)),i);return 0===o.size||(0,T.yW)(o.values(),(e=>null==e))?void 0:o}async refresh(e,t){if(null==e&&null==this._editor)return;const i=(0,E.UH)(),s=this.container.lineTracker.selections;if(null==e||null==s||!(0,W.PH)(e))return(0,E.lH)(i,` ${n.NE.Dot} Skipped because there is no valid editor or no valid selections`),void this.clear(this._editor);this._editor!==e&&(this.clear(this._editor),this._editor=e);const o=R.D.get("currentLine");if(this.suspended)return(0,E.lH)(i,` ${n.NE.Dot} Skipped because the controller is suspended`),void this.clear(e);const a=await this.container.tracker.getOrAdd(e.document);if(!a.isBlameable&&this.suspended)return null!=i&&(i.exitDetails=` ${n.NE.Dot} Skipped because the ${this.suspended?"controller is suspended":`document(${a.uri.toString(!0)}) is not blameable`}`),void this.clear(e);if(null==e.document||!this.container.lineTracker.includes(s))return void(null!=i&&(i.exitDetails=` ${n.NE.Dot} Skipped because the ${null==e.document?"editor is gone":`selection(s)=${s.map((e=>`[${e.anchor}-${e.active}]`)).join()} are no longer current`}`));null!=i&&(i.exitDetails=` ${n.NE.Dot} selection(s)=${s.map((e=>`[${e.anchor}-${e.active}]`)).join()}`);const c=new Map;for(const e of s){const t=this.container.lineTracker.getState(e.active);null!=t?.commit?c.set(e.active,t.commit):F.Yd.debug(i,`Line ${e.active} returned no commit`)}const l=a.uri.repoPath,[h,u]=await Promise.all([ae.i.has(o.format,"tips")?this.container.git.getBranchesAndTagsTipsFn(l):void 0,null!=l&&o.pullRequests.enabled&&ae.i.has(o.format,"pullRequest","pullRequestAgo","pullRequestAgoOrDate","pullRequestDate","pullRequestState")?t?.prs??this.getPullRequests(l,[...(0,T.hX)(c,(([,e])=>!e.isUncommitted))],{timeout:100}):void 0]);null!=u&&(this._cancellation?.cancel(),this._cancellation=new r.CancellationTokenSource,this.waitForAnyPendingPullRequests(e,u,this._cancellation.token,100,i));const d=[];let p;if(e.document.uri.scheme===n.sN.Vsls||e.document.uri.scheme===n.sN.VslsScc){const e=R.D.get("hovers");p={autolinks:e.autolinks.enabled,dateFormat:R.D.get("defaultDateFormat"),format:e.detailsMarkdownFormat,pullRequests:{enabled:e.pullRequests.enabled}}}for(const[t,i]of c){if(i.isUncommitted&&""===o.uncommittedChangesFormat)continue;const s=u?.get(i.ref),c=(0,le.sV)(i,i.isUncommitted?o.uncommittedChangesFormat??o.format:o.format,{dateFormat:null===o.dateFormat?R.D.get("defaultDateFormat"):o.dateFormat,getBranchAndTagTips:h,pullRequestOrRemote:s,pullRequestPendingMessage:`PR ${n.NE.Ellipsis}`},o.scrollable);c.range=e.document.validateRange(new r.Range(t,me,t,me)),null!=p&&(c.hoverMessage=await(0,ce.nN)(i,a.uri,t,null!=s?{...p,pullRequests:{...p.pullRequests,pr:s}}:p)),d.push(c)}e.setDecorations(pe,d)}setLineTracker(e){e?this.container.lineTracker.subscribed(this)||this.container.lineTracker.subscribe(this,this.container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged,this)):this.container.lineTracker.unsubscribe(this)}async waitForAnyPendingPullRequests(e,t,i,r,s){const o=(0,T.QX)(t.values(),(e=>e instanceof O.PK));if(i.isCancellationRequested||0===o)return;F.Yd.debug(s,`${n.NE.Dot} ${o} pull request queries took too long (over ${r} ms)`);const a=new Map;for(const[e,i]of t)a.set(e,i instanceof O.PK?await i.promise:i);i.isCancellationRequested||e!==this._editor||(F.Yd.debug(s,`${n.NE.Dot} ${o} pull request queries completed; refreshing...`),this.refresh(e,{prs:a}))}}de([(0,_.cM)()],LineAnnotationController.prototype,"resume",1),de([(0,_.cM)()],LineAnnotationController.prototype,"suspend",1),de([(0,_.fF)({args:{0:e=>`editor=${e.editor?.document.uri.toString(!0)}, selections=${e.selections?.map((e=>`[${e.anchor}-${e.active}]`)).join(",")}, pending=${Boolean(e.pending)}, reason=${e.reason}`}})],LineAnnotationController.prototype,"onActiveLinesChanged",1),de([(0,_.fF)({args:!1,singleLine:!0})],LineAnnotationController.prototype,"clear",1),de([(0,_.cM)({args:!1})],LineAnnotationController.prototype,"toggle",1),de([(0,_.fF)({args:!1})],LineAnnotationController.prototype,"refresh",1);var ge=i(8294),fe=i(8388);class GitCodeLensController{constructor(e){this.container=e,this._canToggle=!1,this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this),R.D.onDidChange(this.onConfigurationChanged,this))}dispose(){this._providerDisposable?.dispose(),this._disposable?.dispose()}onReady(){this.onConfigurationChanged()}onConfigurationChanged(e){if(R.D.changed(e,["codeLens","defaultDateFormat","defaultDateSource","defaultDateStyle"])){null!=e&&F.Yd.log("CodeLens config changed; resetting CodeLens provider");const t=R.D.get("codeLens");t.enabled&&(t.recentChange.enabled||t.authors.enabled)?this.ensureProvider():(this._providerDisposable?.dispose(),this._provider=void 0),this._canToggle=t.recentChange.enabled||t.authors.enabled,(0,D.v)("gitlens:disabledToggleCodeLens",!this._canToggle)}}onBlameStateChanged(e){null!=this._provider&&e.blameable&&(F.Yd.log("Blame state changed; resetting CodeLens provider"),this._provider.reset("saved"))}onDirtyIdleTriggered(e){if(null==this._provider||!e.document.isBlameable)return;const t=R.D.get("advanced.blame.sizeThresholdAfterEdit");t>0&&e.document.lineCount>t||(F.Yd.log("Dirty idle triggered; resetting CodeLens provider"),this._provider.reset("idle"))}toggleCodeLens(){if(this._canToggle){if(F.Yd.log("toggleCodeLens()"),null!=this._provider)return this._providerDisposable?.dispose(),void(this._provider=void 0);this.ensureProvider()}}async ensureProvider(){if(null!=this._provider)return void this._provider.reset();this._providerDisposable?.dispose();const{GitCodeLensProvider:e}=await Promise.resolve().then(i.bind(i,5183));this._provider=new e(this.container),this._providerDisposable=r.Disposable.from(r.languages.registerCodeLensProvider(e.selector,this._provider),this.container.tracker.onDidChangeBlameState(this.onBlameStateChanged,this),this.container.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered,this))}}var we=i(2540);const ve=new Set(["commit:selected","file:selected"]),ye=new Map;class EventBus{constructor(){this._emitter=new r.EventEmitter}dispose(){this._emitter.dispose()}fire(e,t,i){(function(e){return ve.has(e)})(e)&&ye.set(e,t),this._emitter.fire({name:e,data:t,source:i?.source})}fireAsync(e,t,i){queueMicrotask((()=>this.fire(e,t,i)))}getCachedEventArgs(e){return ye.get(e)}on(e,t,i,r){return this._emitter.event((function(r){e===r.name&&t.call(i,r)}),i,r)}}var be=i(429),Ce=i(3620);const Ae={done:!0,value:void 0};class StringIterator{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){return e.charCodeAt(0)-this._value.charCodeAt(this._pos)}value(){return this._value[this._pos]}}class PathIterator{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){return this._value=e.replace(/\\$|\/$/,""),this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){const t=this._value.charCodeAt(this._to);if(t===n.mN.Slash||this._splitOnBackslash&&t===n.mN.Backslash){if(!e)break;this._from++}else e=!1}return this}cmp(e){return this._caseSensitive?(0,Ce.TT)(e,this._value,0,e.length,this._from,this._to):(0,Ce.j_)(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class TernarySearchTreeNode{isEmpty(){return!(this.left||this.mid||this.right||this.value)}}class TernarySearchTree{static forPaths(){return new TernarySearchTree(new PathIterator)}static forStrings(){return new TernarySearchTree(new StringIterator)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let r;for(this._root||(this._root=new TernarySearchTreeNode,this._root.segment=i.value()),r=this._root;;){const e=i.cmp(r.segment);if(e>0)r.left||(r.left=new TernarySearchTreeNode,r.left.segment=i.value()),r=r.left;else if(e<0)r.right||(r.right=new TernarySearchTreeNode,r.right.segment=i.value()),r=r.right;else{if(!i.hasNext())break;i.next(),r.mid||(r.mid=new TernarySearchTreeNode,r.mid.segment=i.value()),r=r.mid}}const s=r.value;return r.value=t,r.key=e,s}get(e){return this._getNode(e)?.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const e=t.cmp(i.segment);if(e>0)i=i.left;else if(e<0)i=i.right;else{if(!t.hasNext())break;t.next(),i=i.mid}}return i}has(e){const t=this._getNode(e);return!(void 0===t?.value&&void 0===t?.mid)}delete(e){this._delete(e,!1)}deleteSuperstr(e){this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),r=[];let s=this._root;for(;s;){const e=i.cmp(s.segment);if(e>0)r.push([1,s]),s=s.left;else if(e<0)r.push([-1,s]),s=s.right;else{if(!i.hasNext()){for(t?(s.left=void 0,s.mid=void 0,s.right=void 0):s.value=void 0;r.length>0&&s.isEmpty();){const[e,t]=r.pop();switch(e){case 1:t.left=void 0;break;case 0:t.mid=void 0;break;case-1:t.right=void 0}s=t}break}i.next(),r.push([0,s]),s=s.mid}}}findSubstr(e){const t=this._iter.reset(e);let i,r=this._root;for(;r;){const e=t.cmp(r.segment);if(e>0)r=r.left;else if(e<0)r=r.right;else{if(!t.hasNext())break;t.next(),i=r.value||i,r=r.mid}}return r?.value||i}findSuperstr(e,t=!1){const i=this._iter.reset(e);let r=this._root;for(;r;){const e=i.cmp(r.segment);if(e>0)r=r.left;else if(e<0)r=r.right;else{if(!i.hasNext()){if(!r.mid)return;return r=r.mid,{[Symbol.iterator]:()=>this._nodeIterator(r,t)}}i.next(),r=r.mid}}}_nodeIterator(e,t=!1){let i,r,s;return{next:()=>(s||(s=[],r=0,this._forEach(e,(e=>s.push(e)),t)),r>=s.length?Ae:(i?i.value=s[r++]:i={done:!1,value:s[r++]},i))}}forEach(e){this._forEach(this._root,e)}_forEach(e,t,i=!1){void 0!==e&&(this._forEach(e.left,t,i),e.value&&t(e.value,e.key),i||this._forEach(e.mid,t,i),this._forEach(e.right,t,i))}any(){return void 0!==this._root&&!this._root.isEmpty()}count(e){return void 0===this._root||this._root.isEmpty()?0:(0,T.QX)(this.entries(),void 0===e?void 0:([,t])=>e(t))}entries(){return this._iterator(this._root)}values(){return(0,T.UI)(this.entries(),(([,e])=>e))}highlander(){if(void 0===this._root||this._root.isEmpty())return;const e=this.entries();let t,i,r=0;for(;t=e.next(),!t.done;)if(i=t.value,r++,r>1)return;return i}some(e){return void 0!==this._root&&!this._root.isEmpty()&&(0,T.G)(this.entries(),(([,t])=>e(t)))}*[Symbol.iterator](){yield*this._iterator(this._root)}*_iterator(e){e&&(yield*this._iterator(e.left),e.value&&(yield[e.key,e.value]),yield*this._iterator(e.mid),yield*this._iterator(e.right))}}var Pe=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,Re=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Se(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Pe(t,i,n),n};const De=new Uint8Array(0);function ke(e){const t=(0,u.uy)(e)?e:u.YY.fromRevisionUri(e);return{path:t.relativePath,ref:t.sha,repoPath:t.repoPath}}class GitFileSystemProvider{constructor(e){this.container=e,this._searchTreeMap=new Map,this._onDidChangeFile=new r.EventEmitter,this._disposable=r.Disposable.from(r.workspace.registerFileSystemProvider(n.sN.GitLens,this,{isCaseSensitive:be.IJ,isReadonly:!0}))}dispose(){this._disposable.dispose()}get onDidChangeFile(){return this._onDidChangeFile.event}copy(e,t,i){throw r.FileSystemError.NoPermissions(e)}createDirectory(e){throw r.FileSystemError.NoPermissions(e)}delete(e,t){throw r.FileSystemError.NoPermissions(e)}async readDirectory(e){const{path:t,ref:i,repoPath:s}=ke(e),n=await this.getTree(t,i,s);if(void 0===n)throw r.FileSystemError.FileNotFound(e);return[...(0,T.UI)(n,(e=>[null!=t&&0!==t.length?(0,$.AH)((0,$.Gf)(t,e.path)):e.path,_e(e.type)]))]}async readFile(e){const{path:t,ref:i,repoPath:r}=ke(e);if(i===m.Ii)return De;const s=await this.container.git.getRevisionContent(r,t,i);return null!=s?s:De}rename(e,t,i){throw r.FileSystemError.NoPermissions(e)}async stat(e){const{path:t,ref:i,repoPath:s}=ke(e);if(i===m.Ii)return{type:r.FileType.File,size:0,ctime:0,mtime:0};let n;const o=this._searchTreeMap.get(i);if(void 0!==o)n=(await o).get(`/~/${t}`);else{if(null==t||0===t.length){if(void 0===await this.getTree(t,i,s))throw r.FileSystemError.FileNotFound(e);return{type:r.FileType.Directory,size:0,ctime:0,mtime:0}}n=await this.container.git.getTreeEntryForRevision(s,t,i)}if(void 0===n)throw r.FileSystemError.FileNotFound(e);return{type:_e(n.type),size:n.size,ctime:0,mtime:0}}watch(){return{dispose:()=>{}}}writeFile(e){throw r.FileSystemError.NoPermissions(e)}async createSearchTree(e,t){const i=TernarySearchTree.forPaths(),r=await this.container.git.getTreeForRevision(t,e);i.set("~",{commitSha:"",path:"~",size:0,type:"tree"});for(const e of r)i.set(`~/${e.path}`,e);return i}getOrCreateSearchTree(e,t){let i=this._searchTreeMap.get(e);return void 0===i&&(i=this.createSearchTree(e,t),this._searchTreeMap.set(e,i)),i}async getTree(e,t,i){return(await this.getOrCreateSearchTree(t,i)).findSuperstr(`/~/${e}`,!0)}}function _e(e){switch(e){case"blob":return r.FileType.File;case"tree":return r.FileType.Directory;default:return r.FileType.Unknown}}Re([(0,_.fF)()],GitFileSystemProvider.prototype,"readDirectory",1),Re([(0,_.fF)()],GitFileSystemProvider.prototype,"readFile",1),Re([(0,_.fF)()],GitFileSystemProvider.prototype,"stat",1);var Te=i(2133),Fe=i(4968),Ee=i(2800),$e=i(9529),Oe=i(1526),xe=Object.defineProperty,Ie=Object.getOwnPropertyDescriptor,Be=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ie(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&xe(t,i,n),n};const We=Object.freeze([]),Le=Object.freeze({dispose:()=>{}}),Me=new Map([["master",100],["main",15],["default",10],["develop",5],["development",1]]);class GitProviderService{constructor(e){this.container=e,this._onDidChangeProviders=new r.EventEmitter,this._onDidChangeRepositories=new r.EventEmitter,this._onDidChangeRepository=new r.EventEmitter,this.supportedSchemes=new Set,this._pendingRepositories=new Map,this._providers=new Map,this._repositories=new Te.x8,this._bestRemotesCache=new Map,this._visitedPaths=new Oe.u$,this._etag=0,this._initializing=!0,this._discoveredWorkspaceFolders=new Map,this._accessCache=new Map,this._context={enabled:!1,disabled:!1},this._disposable=r.Disposable.from(e.subscription.onDidChange(this.onSubscriptionChanged,this),r.window.onDidChangeWindowState(this.onWindowStateChanged,this),r.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),R.D.onDidChange(this.onConfigurationChanged,this),e.richRemoteProviders.onDidChangeConnectionState((e=>{"connected"===e.reason&&(0,fe.E3)("failed"),this.resetCaches("providers"),this.updateContext()})),r.workspace.isTrusted?Le:r.workspace.onDidGrantWorkspaceTrust((()=>{r.workspace.isTrusted&&r.workspace.workspaceFolders?.length&&this.discoverRepositories(r.workspace.workspaceFolders,{force:!0})})),...this.registerCommands()),this.container.BranchDateFormatting.reset(),this.container.CommitDateFormatting.reset(),this.container.CommitShaFormatting.reset(),this.container.PullRequestDateFormatting.reset(),this.updateContext()}get onDidChangeProviders(){return this._onDidChangeProviders.event}fireProvidersChanged(e,t){this.container.telemetry.enabled&&(this.container.telemetry.setGlobalAttributes({"providers.count":this._providers.size,"providers.ids":(0,T.v_)(this._providers.keys(),",")}),this.container.telemetry.sendEvent("providers/changed",{"providers.added":e?.length??0,"providers.removed":t?.length??0})),this._etag=Date.now(),this._onDidChangeProviders.fire({added:e??[],removed:t??[],etag:this._etag})}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}fireRepositoriesChanged(e,t){const i=this.openRepositories.map((e=>e.uri.scheme));this.container.telemetry.enabled&&(this.container.telemetry.setGlobalAttributes({"repositories.count":i.length,"repositories.schemes":(0,Ee.h8)(i,",")}),this.container.telemetry.sendEvent("repositories/changed",{"repositories.added":e?.length??0,"repositories.removed":t?.length??0})),this._etag=Date.now(),this._accessCache.clear(),this._reposVisibilityCache=void 0,this._onDidChangeRepositories.fire({added:e??[],removed:t??[],etag:this._etag}),e?.length&&this.container.telemetry.enabled&&queueMicrotask((async()=>{for(const t of e){const e=new Set,i=await t.getRemotes();for(const t of i)e.add(t.provider?.id??"unknown");this.container.telemetry.sendEvent("repository/opened",{"repository.id":t.idHash,"repository.scheme":t.uri.scheme,"repository.closed":t.closed,"repository.folder.scheme":t.folder?.uri.scheme,"repository.provider.id":t.provider.id,"repository.remoteProviders":(0,T.v_)(e,",")})}}))}get onDidChangeRepository(){return this._onDidChangeRepository.event}dispose(){this._disposable.dispose(),this._providers.clear(),this._repositories.forEach((e=>e.dispose())),this._repositories.clear()}get etag(){return this._etag}onConfigurationChanged(e){(R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle"))&&(this.container.BranchDateFormatting.reset(),this.container.CommitDateFormatting.reset(),this.container.PullRequestDateFormatting.reset()),R.D.changed(e,"advanced.abbreviatedShaLength")&&this.container.CommitShaFormatting.reset(),R.D.changed(e,"views.contributors.showAllBranches")&&this.resetCaches("contributors"),null!=e&&R.D.changed(e,"integrations.enabled")&&this.updateContext()}registerCommands(){return[(0,$e.xR)("gitlens.plus.resetRepositoryAccess",(()=>this.clearAllRepoVisibilityCaches())),(0,$e.xR)("gitlens.plus.refreshRepositoryAccess",(()=>this.clearAllOpenRepoVisibilityCaches()))]}onSubscriptionChanged(e){this._accessCache.clear(),this._subscription=e.current}onWindowStateChanged(e){e.focused?this._repositories.forEach((e=>e.resume())):this._repositories.forEach((e=>e.suspend()))}onWorkspaceFoldersChanged(e){if(this.container.telemetry.enabled){const e=r.workspace.workspaceFolders?.map((e=>e.uri.scheme));this.container.telemetry.setGlobalAttributes({"folders.count":e?.length??0,"folders.schemes":null!=e?(0,Ee.h8)(e,", "):""})}if(e.added.length&&this.discoverRepositories(e.added),e.removed.length){const t=[];for(const i of e.removed){const e=this._repositories.getClosest(i.uri);null!=e&&(this._repositories.remove(e.uri,!1),t.push(e))}t.length&&(this.updateContext(),queueMicrotask((()=>{this.fireRepositoriesChanged([],t),t.forEach((e=>e.dispose()))})))}}get hasProviders(){return 0!==this._providers.size}get registeredProviders(){return[...(0,T.UI)(this._providers.values(),(e=>({...e.descriptor})))]}get openRepositories(){if(0===this.repositoryCount)return We;const e=[...(0,T.hX)(this.repositories,(e=>!e.closed))];return 0===e.length?e:b._j.sort(e)}get openRepositoryCount(){return 0===this.repositoryCount?0:(0,T.QX)(this.repositories,(e=>!e.closed))}get repositories(){return this._repositories.values()}get repositoryCount(){return this._repositories.count}get highlander(){return 1===this.repositoryCount?(0,T.Ps)(this._repositories.values()):void 0}register(e,t){if(e!==t.descriptor.id)throw new Error(`Id '${e}' must match provider id '${t.descriptor.id}'`);if(this._providers.has(e))throw new Error(`Provider '${e}' has already been registered`);this._providers.set(e,t);for(const e of t.supportedSchemes)this.supportedSchemes.add(e);const i=[],s=t.openRepositoryInitWatcher?.();null!=s&&i.push(s,s.onDidCreate((e=>{const t=r.workspace.getWorkspaceFolder(e);null!=t&&this.discoverRepositories([t],{force:!0})})));const n=r.Disposable.from(t,...i,t.onDidChange((()=>{const{workspaceFolders:e}=r.workspace;e?.length&&this.discoverRepositories(e,{force:!0})})),t.onDidChangeRepository((async e=>{if(e.changed(b.I6.Remotes,b.I6.RemoteProviders,b.du.Any)&&this._bestRemotesCache.clear(),e.changed(b.I6.Closed,b.du.Any)?(this.updateContext(),queueMicrotask((()=>this.fireRepositoriesChanged([],[e.repository])))):e.changed(b.I6.Opened,b.du.Any)&&(this.updateContext(),queueMicrotask((()=>this.fireRepositoriesChanged([e.repository],[])))),e.changed(b.I6.Remotes,b.du.Any)){const i=await t.getRemotes(e.repository.path),r=this.getVisibilityInfoFromCache(e.repository.path);null!=r&&this.checkVisibilityCachedRemotes(e.repository.path,r,i)}this._onDidChangeRepository.fire(e)})),t.onDidCloseRepository((e=>{const t=this._repositories.get(e.uri);null!=t&&(t.closed=!0)})),t.onDidOpenRepository((e=>{const t=this._repositories.get(e.uri);null!=t?t.closed=!1:this.getOrOpenRepository(e.uri)})));return this.fireProvidersChanged([t]),this._initializing||this.onWorkspaceFoldersChanged({added:r.workspace.workspaceFolders??[],removed:[]}),{dispose:()=>{n.dispose(),this._providers.delete(e);const i=[];for(const t of[...this._repositories.values()])t?.provider.id===e&&(this._repositories.remove(t.uri,!1),i.push(t));const{deactivating:r}=this.container;r||this.updateContext(),i.length&&queueMicrotask((()=>{r||this.fireRepositoriesChanged([],i),i.forEach((e=>e.dispose()))})),r||this.fireProvidersChanged([],[t])}}}async registrationComplete(){const e=(0,E.UH)();this._initializing=!1;let{workspaceFolders:t}=r.workspace;t?.length?(await this.discoverRepositories(t),0===this.repositoryCount&&be.$L&&setTimeout((()=>{({workspaceFolders:t}=r.workspace),t?.length&&this.discoverRepositories(t,{force:!0})}),1e3)):this.updateContext();const i=R.D.getAny("git.autoRepositoryDetection");this.container.telemetry.enabled&&queueMicrotask((()=>this.container.telemetry.sendEvent("providers/registrationComplete",{"config.git.autoRepositoryDetection":i}))),(0,E.lH)(e,` ${n.NE.Dot} workspaceFolders=${t?.length}, git.autoRepositoryDetection=${i}`)}getOpenProviders(){return[...this.getOpenRepositoriesByProvider().keys()].map((e=>this._providers.get(e)))}getOpenRepositories(e){return(0,T.hX)(this.repositories,(t=>!t.closed&&(null==e||e===t.provider.id)))}getOpenRepositoriesByProvider(){const e=[...(0,T.hX)(this.repositories,(e=>!e.closed))];return 0===e.length?new Map:(0,Ee.XI)(e,(e=>e.provider.id))}hasOpenRepositories(e){return(0,T.G)(this.repositories,(t=>!t.closed&&(null==e||e===t.provider.id)))}async discoverRepositories(e,t){null!=this._isDiscoveringRepositories&&(await this._isDiscoveringRepositories,this._isDiscoveringRepositories=void 0);const i=(0,O.PQ)();this._isDiscoveringRepositories=i.promise;try{const i=[];for(const r of e){if(!t?.force&&this._discoveredWorkspaceFolders.has(r))continue;const e=this.discoverRepositoriesCore(r);i.push(e),this._discoveredWorkspaceFolders.set(r,e)}if(0===i.length)return;const r=await Promise.allSettled(i),s=(0,T.VS)((0,T.hX)(r,(e=>"fulfilled"===e.status)),(e=>e.value)),n=[];for(const e of s)this._repositories.add(e),e.closed||n.push(e);this.updateContext(),n.length&&queueMicrotask((()=>this.fireRepositoriesChanged(n)))}finally{i.fulfill()}}async discoverRepositoriesCore(e){const{provider:t}=this.getProvider(e.uri);try{return await t.discoverRepositories(e.uri)}catch(i){return this._discoveredWorkspaceFolders.delete(e),F.Yd.error(i,`${t.descriptor.name} Provider(${t.descriptor.id}) failed discovering repositories in ${e.uri.toString(!0)}`),[]}}async findRepositories(e,t){const{provider:i}=this.getProvider(e);return i.discoverRepositories(e,t)}async getSubscription(){return this._subscription??(this._subscription=await this.container.subscription.getSubscription())}async access(e,t){if(null==t){let i=this._accessCache.get(void 0);return null==i&&(i=this.accessCore(e,t),this._accessCache.set(void 0,i)),i}const{path:i}=this.getProvider(t),r=i;let s=this._accessCache.get(r);return null==s&&(s=this.accessCore(e,t),this._accessCache.set(r,s)),s}async accessCore(e,t){const i=await this.getSubscription();this.container.telemetry.enabled&&queueMicrotask((()=>{this.visibility()}));const r=i.plan.effective.id;if((0,Fe.aG)(r))return{allowed:!1!==i.account?.verified,subscription:{current:i}};function s(e,t=!1){const{path:r}=this.getProvider(e);let s=t?void 0:this._accessCache.get(r);return null==s&&(s=this.visibility(e).then((e=>e===h.q4.Private?{allowed:!1,subscription:{current:i,required:Fe.Cx.Pro},visibility:e}:{allowed:!0,subscription:{current:i},visibility:e}),(()=>({allowed:!0,subscription:{current:i}}))),this._accessCache.set(r,s)),s}if(null==t){const e=this.openRepositories;if(0===e.length)return{allowed:!1,subscription:{current:i}};if(1===e.length)return s.call(this,e[0].path);switch(await this.visibility()){case"private":return{allowed:!1,subscription:{current:i,required:Fe.Cx.Pro},visibility:h.q4.Private};case"mixed":return{allowed:"mixed",subscription:{current:i,required:Fe.Cx.Pro}};default:return{allowed:!0,subscription:{current:i},visibility:h.q4.Public}}}return s.call(this,t,!0)}async ensureAccess(e,t){const{allowed:i,subscription:r}=await this.access(e,t);if(!1===i)throw new a.$y(r.current,r.required)}supports(e,t){const{provider:i}=this.getProvider(e);return i.supports(t)}ensureRepoVisibilityCache(){if(null==this._repoVisibilityCache){const e=this.container.storage.get("repoVisibility")?.map((([e,t])=>[e,{visibility:t.visibility,timestamp:t.timestamp,remotesHash:t.remotesHash}]));this._repoVisibilityCache=new Map(e)}}clearRepoVisibilityCache(e){if(null==e)this._repoVisibilityCache=void 0,this.container.storage.delete("repoVisibility");else{e?.forEach((e=>this._repoVisibilityCache?.delete(e)));const t=Array.from(this._repoVisibilityCache?.entries()??[]);0===t.length?this.container.storage.delete("repoVisibility"):this.container.storage.store("repoVisibility",t)}}getVisibilityInfoFromCache(e){this.ensureRepoVisibilityCache();const t=this._repoVisibilityCache?.get(e);if(null==t)return;if(!(Date.now()-t.timestamp>2592e6))return t;this.clearRepoVisibilityCache([e])}checkVisibilityCachedRemotes(e,t,i){if(null==t)return!0;if(t.visibility===h.q4.Public){if(0==i.length||!i.some((e=>e.id===t.remotesHash)))return this.clearRepoVisibilityCache([e]),!1}else if(t.visibility===h.q4.Private){if(i.map((e=>e.id)).sort().join(",")!==t.remotesHash)return this.clearRepoVisibilityCache([e]),!1}return!0}updateVisibilityCache(e,t){this.ensureRepoVisibilityCache(),this._repoVisibilityCache?.set(e,t),this.container.storage.store("repoVisibility",Array.from(this._repoVisibilityCache.entries()))}clearAllRepoVisibilityCaches(){this.clearRepoVisibilityCache()}clearAllOpenRepoVisibilityCaches(){const e=this.openRepositories.map((e=>this.getProvider(e.path).path));this.clearRepoVisibilityCache(e)}async visibility(e){if(null==e){let e=this._reposVisibilityCache;return null==e&&(e=await this.visibilityCore(),this.container.telemetry.enabled&&(this.container.telemetry.setGlobalAttribute("repositories.visibility",e),this.container.telemetry.sendEvent("repositories/visibility")),this._reposVisibilityCache=e),e}const{path:t}=this.getProvider(e);let i=this.getVisibilityInfoFromCache(t)?.visibility;return null==i&&(i=await this.visibilityCore(e),this.container.telemetry.enabled&&queueMicrotask((()=>{const t=this.getRepository(e);this.container.telemetry.sendEvent("repository/visibility",{"repository.visibility":i,"repository.id":t?.idHash,"repository.scheme":t?.uri.scheme,"repository.closed":t?.closed,"repository.folder.scheme":t?.folder?.uri.scheme,"repository.provider.id":t?.provider.id})}))),i}async visibilityCore(e){async function t(e){const{provider:t,path:i}=this.getProvider(e),r=await t.getRemotes(i,{sort:!0}),s=this.getVisibilityInfoFromCache(i);if(null==s||!this.checkVisibilityCachedRemotes(i,s,r)){const[e,r]=await t.visibility(i);return e!==h.q4.Local&&this.updateVisibilityCache(i,{visibility:e,timestamp:Date.now(),remotesHash:r}),e}return s.visibility}if(null==e){const e=this.openRepositories;if(0===e.length)return"private";if(1===e.length)return t.call(this,e[0].path);let i=!1,r=!1,s=!1;for await(const n of(0,O.rX)(e.map((e=>t.call(this,e.path)))))if("fulfilled"===n.status)if(n.value===h.q4.Public){if(s||r)return"mixed";i=!0}else if(n.value===h.q4.Local){if(i||r)return"mixed";s=!0}else if(n.value===h.q4.Private){if(i||s)return"mixed";r=!0}return i?"public":s?"local":"private"}return t.call(this,e)}async setEnabledContext(e){let t=!e;if(!e&&this._initializing&&(t=!(this.container.storage.getWorkspace("assumeRepositoriesOnStartup")??1)),this.container.telemetry.setGlobalAttribute("enabled",e),this._context.enabled===e&&this._context.disabled===t)return;const i=[];this._context.enabled!==e&&(this._context.enabled=e,i.push((0,D.v)("gitlens:enabled",e))),this._context.disabled!==t&&(this._context.disabled=t,i.push((0,D.v)("gitlens:disabled",t))),await Promise.allSettled(i),this._initializing||this.container.storage.storeWorkspace("assumeRepositoriesOnStartup",e).catch()}updateContext(){if(this.container.deactivating)return;const e=this.openRepositoryCount,t=0!==e;this.setEnabledContext(t),this._initializing||(this.container.telemetry.setGlobalAttributes({enabled:t,"repositories.count":e}),t&&(async function(){const e=R.D.get("integrations.enabled"),i=this.container.telemetry.enabled,r=new Set;let s=!1,n=!1,o=!1;if(t)for(const t of this._repositories.values()){if(i){const e=await t.getRemotes();for(const t of e)r.add(t.provider?.id??"unknown")}if(!o&&e&&(o=await t.hasRichRemote(!0),o&&(n=!0,s=!0)),!n&&e&&(n=await t.hasRichRemote(),n&&(s=!0)),s||(s=await t.hasRemotes()),s&&(n&&o||!e))break}i&&(this.container.telemetry.setGlobalAttributes({"repositories.hasRemotes":s,"repositories.hasRichRemotes":n,"repositories.hasConnectedRemotes":o,"repositories.remoteProviders":(0,T.v_)(r,",")}),null==this._sendProviderContextTelemetryDebounced&&(this._sendProviderContextTelemetryDebounced=(0,B.Ds)((()=>this.container.telemetry.sendEvent("providers/context")),2500)),this._sendProviderContextTelemetryDebounced()),await Promise.allSettled([(0,D.v)("gitlens:hasRemotes",s),(0,D.v)("gitlens:hasRichRemotes",n),(0,D.v)("gitlens:hasConnectedRemotes",o)])}.call(this),this._providers.forEach((e=>e.updateContext?.()))))}getProvider(e){if(null==e||"string"!=typeof e&&!this.supportedSchemes.has(e.scheme))throw new a.MO(e);let t;"string"==typeof e?t=(0,$.UG)(e)??n.sN.File:({scheme:t}=e);const i=new Set;for(const r of this._providers.values()){const s=r.canHandlePathOrUri(t,e);null!=s&&i.add({provider:r,path:s})}if(0===i.size)throw new a.MO(e);if(i.size>1)for(const e of i)if(this.hasOpenRepositories(e.provider.descriptor.id))return e;return(0,T.Ps)(i)}getAbsoluteUri(e,t){if(null==t)return"string"==typeof e?(0,$.tE)(e)?r.Uri.parse(e,!0):r.Uri.file(e):e;if("string"!=typeof t&&"string"==typeof e){const i=(0,$.AH)(e);if(!(0,$.YP)(i))return r.Uri.joinPath(t,i)}const{provider:i}=this.getProvider(t);return i.getAbsoluteUri(e,t)}async getBestRevisionUri(e,t,i){if(null==e||i===m.Ii)return;const{provider:r,path:s}=this.getProvider(e);return r.getBestRevisionUri(s,r.getRelativePath(t,s),i)}getRelativePath(e,t){const{provider:i}=this.getProvider(e instanceof r.Uri?e:t);return i.getRelativePath(e,t)}getRevisionUri(e,t,i){let r,s;"string"==typeof e?(s=e,r="string"==typeof t?t:t?.originalPath??t?.path??""):(s=e.sha,i=e.repoPath,r=(0,$.M)(e));const{provider:n,path:o}=this.getProvider(i);return n.getRevisionUri(o,n.getRelativePath(r,o),s)}getWorkingUri(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getWorkingUri(r,t)}addRemote(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.addRemote(n,t,i,r)}pruneRemote(e,t){const{provider:i,path:r}=this.getProvider(e);return i.pruneRemote(r,t)}removeRemote(e,t){const{provider:i,path:r}=this.getProvider(e);return i.removeRemote(r,t)}applyChangesToWorkingFile(e,t,i){const{provider:r}=this.getProvider(e);return r.applyChangesToWorkingFile(e,t,i)}checkout(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.checkout(s,t,i)}async clone(e,t){const{provider:i}=this.getProvider(t);return i.clone?.(e,t)}resetCaches(...e){(0===e.length||e.includes("providers"))&&this._bestRemotesCache.clear(),this.container.events.fire("git:cache:reset",{caches:e})}excludeIgnoredUris(e,t){const{provider:i,path:r}=this.getProvider(e);return i.excludeIgnoredUris(r,t)}fetch(e,t){const{provider:i,path:r}=this.getProvider(e);return i.fetch(r,t)}async fetchAll(e,t){null==e&&(e=this.openRepositories),0!==e.length&&(1!==e.length?await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Fetching ${e.length} repositories`},(()=>Promise.all(e.map((e=>e.fetch({progress:!1,...t})))))):await e[0].fetch(t))}async pullAll(e,t){null==e&&(e=this.openRepositories),0!==e.length&&(1!==e.length?await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Pulling ${e.length} repositories`},(()=>Promise.all(e.map((e=>e.pull({progress:!1,...t})))))):await e[0].pull(t))}async pushAll(e,t){null==e&&(e=this.openRepositories),0!==e.length&&(1!==e.length?await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Pushing ${e.length} repositories`},(()=>Promise.all(e.map((e=>e.push({progress:!1,...t})))))):await e[0].push(t))}getAheadBehindCommitCount(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getAheadBehindCommitCount(r,t)}async getBlame(e,t){const{provider:i}=this.getProvider(e);return i.getBlame(e,t)}async getBlameContents(e,t){const{provider:i}=this.getProvider(e);return i.getBlameContents(e,t)}async getBlameForLine(e,t,i,r){const{provider:s}=this.getProvider(e);return s.getBlameForLine(e,t,i,r)}async getBlameForLineContents(e,t,i,r){const{provider:s}=this.getProvider(e);return s.getBlameForLineContents(e,t,i,r)}async getBlameForRange(e,t){const{provider:i}=this.getProvider(e);return i.getBlameForRange(e,t)}async getBlameForRangeContents(e,t,i){const{provider:r}=this.getProvider(e);return r.getBlameForRangeContents(e,t,i)}getBlameRange(e,t,i){const{provider:r}=this.getProvider(t);return r.getBlameRange(e,t,i)}async getBranch(e){if(null==e)return;const{provider:t,path:i}=this.getProvider(e);return t.getBranch(i)}async getBranchAheadRange(e){if(e.state.ahead>0)return(0,v.oI)(e.upstream?.name,e.ref);if(null==e.upstream){const{values:t}=await this.getBranches(e.repoPath,{filter:e=>Me.has(e.name)});if(t.length>0){let i;for(const e of t){const t=Me.get(e.name);if((null==i||i.weight<t)&&(i={weight:t,branch:e}),100===i.weight)break}const r=i.branch.upstream?.name??i.branch.ref;if(r!==e.ref)return(0,v.oI)(r,e.ref)}}}async getBranches(e,t){if(null==e)return{values:[]};const{provider:i,path:r}=this.getProvider(e);return i.getBranches(r,t)}async getBranchesAndTagsTipsFn(e,t){const[i,r]=await Promise.allSettled([this.getBranches(e),this.getTags(e)]),s=(0,O.Sb)(i)?.values??[],o=(0,O.Sb)(r)?.values??[],a=(0,Ee.Qy)(s.concat(o),(e=>e.sha),(e=>{if(t){if(e.name===t)return;if("branch"===e.refType&&e.getNameWithoutRemote()===t)return{name:e.name,compactName:e.getRemoteName(),type:e.refType}}return{name:e.name,compactName:void 0,type:e.refType}}));return(e,t)=>{const i=a.get(e);if(null!=i&&0!==i.length){if(!t?.compact)return i.map((e=>`${t?.icons?("tag"===e.type?"$(tag)":"$(git-branch)")+" ":""}${e.name}`)).join(", ");if(i.length>1){const[e]=i;return`${t?.icons?("tag"===e.type?"$(tag)":"$(git-branch)")+" ":""}${e.compactName??e.name}, ${n.NE.Ellipsis}`}return i.map((e=>`${t?.icons?("tag"===e.type?"$(tag)":"$(git-branch)")+" ":""}${e.compactName??e.name}`)).join(", ")}}}getChangedFilesCount(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getChangedFilesCount(r,t)}async getCommit(e,t){const{provider:i,path:r}=this.getProvider(e);if(t===m.CL||t===m.pw){const i=new Date,s=await this.getCurrentUser(e);return new p.aM(this.container,r,t,new p._j("You",s?.email??void 0,i),new p._j("You",s?.email??void 0,i),"Uncommitted changes",[],"Uncommitted changes",void 0,void 0,[])}return i.getCommit(r,t)}getCommitBranches(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.getCommitBranches(s,t,i)}getCommitCount(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getCommitCount(r,t)}async getCommitForFile(e,t,i){if(null==e)return;const{provider:r,path:s}=this.getProvider(e);return r.getCommitForFile(s,t,i)}getCommitsForGraph(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.getCommitsForGraph(s,t,i)}async getConfig(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getConfig?.(r,t)}async setConfig(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.setConfig?.(s,t,i)}async getContributors(e,t){if(null==e)return[];const{provider:i,path:r}=this.getProvider(e);return i.getContributors(r,t)}getCurrentUser(e){const{provider:t,path:i}=this.getProvider(e);return t.getCurrentUser(i)}async getDefaultBranchName(e,t){if(null==e)return;const{provider:i,path:r}=this.getProvider(e);return i.getDefaultBranchName(r,t)}async getDiff(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.getDiff?.(n,t,i,r)}getDiffForFile(e,t,i){const{provider:r}=this.getProvider(e);return r.getDiffForFile(e,t,i)}getDiffForFileContents(e,t,i){const{provider:r}=this.getProvider(e);return r.getDiffForFileContents(e,t,i)}getDiffForLine(e,t,i,r){const{provider:s}=this.getProvider(e);return s.getDiffForLine(e,t,i,r)}getDiffStatus(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.getDiffStatus(n,t,i,r)}async getFileStatusForCommit(e,t,i){if(i===m.Ii||(0,v.l3)(i))return;const{provider:r,path:s}=this.getProvider(e);return r.getFileStatusForCommit(s,t,i)}getGitDir(e){const{provider:t,path:i}=this.getProvider(e);return Promise.resolve(t.getGitDir?.(i))}getLastFetchedTimestamp(e){const{provider:t,path:i}=this.getProvider(e);return t.getLastFetchedTimestamp(i)}async getLog(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getLog(r,t)}async getLogRefsOnly(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getLogRefsOnly(r,t)}async getLogForFile(e,t,i){if(null==e)return;const{provider:r,path:s}=this.getProvider(e);return r.getLogForFile(s,t,i)}async getMergeBase(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.getMergeBase(n,t,i,r)}async getMergeStatus(e){const{provider:t,path:i}=this.getProvider(e);return t.getMergeStatus(i)}async getRebaseStatus(e){const{provider:t,path:i}=this.getProvider(e);return t.getRebaseStatus(i)}getNextComparisonUris(e,t,i,r=0){if(!i)return Promise.resolve(void 0);const{provider:s,path:n}=this.getProvider(e);return s.getNextComparisonUris(n,t,i,r)}async getOldestUnpushedRefForFile(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getOldestUnpushedRefForFile(r,t)}getPreviousComparisonUris(e,t,i,r=0,s=!1){if(i===m.Ii)return Promise.resolve(void 0);const{provider:n,path:o}=this.getProvider(e);return n.getPreviousComparisonUris(o,t,i,r,s)}getPreviousComparisonUrisForLine(e,t,i,r,s=0){if(r===m.Ii)return Promise.resolve(void 0);const{provider:n,path:o}=this.getProvider(e);return n.getPreviousComparisonUrisForLine(o,t,i,r,s)}async getPullRequestForBranch(e,t,i){let r,s;if(y.ss.is(t)){if(({provider:r}=t),!r?.hasRichIntegration())return}else r=t;null!=i&&({timeout:s,...i}=i);let n=r.getPullRequestForBranch(e,i);if(null==n||!(0,O.tI)(n))return n;null!=s&&s>0&&(n=(0,O.HO)(n,s));try{return await n}catch(e){if(e instanceof O.PK)throw e;return}}async getPullRequestForCommit(e,t,i){if((0,v.l3)(e))return;let r;if(y.ss.is(t)){if(({provider:r}=t),!r?.hasRichIntegration())return}else r=t;let s=r.getPullRequestForCommit(e);if(null==s||!(0,O.tI)(s))return s;null!=i?.timeout&&i.timeout>0&&(s=(0,O.HO)(s,i.timeout));try{return await s}catch(e){if(e instanceof O.PK)throw e;return}}async getMyPullRequests(e,t){let i,r;if(y.ss.is(e)){if(({provider:i}=e),!i?.hasRichIntegration())return}else i=e;null!=t&&({timeout:r,...t}=t);let s=i.searchMyPullRequests();if(null==s||!(0,O.tI)(s))return s;null!=r&&r>0&&(s=(0,O.HO)(s,r));try{return await s}catch(e){if(e instanceof O.PK)throw e;return}}async getMyIssues(e,t){let i,r;if(y.ss.is(e)){if(({provider:i}=e),!i?.hasRichIntegration())return}else i=e;null!=t&&({timeout:r,...t}=t);let s=i.searchMyIssues();if(null==s||!(0,O.tI)(s))return s;null!=r&&r>0&&(s=(0,O.HO)(s,r));try{return await s}catch(e){if(e instanceof O.PK)throw e;return}}async getIncomingActivity(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getIncomingActivity(r,t)}async getBestRemoteWithProvider(e){if(null==e)return;let t,i;if(Array.isArray(e)){if(0===e.length)return;t=e,i=e[0].repoPath}else i=e;"string"==typeof i&&(i=this.getAbsoluteUri(i));const r=(0,Te.YW)(i);let s=this._bestRemotesCache.get(r);if(void 0!==s)return s??void 0;if(t=(t??await this.getRemotesWithProviders(i)).filter((e=>null!=e.provider)),0!==t.length){if(1===t.length)s=t[0];else{const e=new Map([["upstream",15],["origin",10]]),i=await this.getBranch(t[0].repoPath),r=i?.getRemoteName();let n;null!=r&&e.set(r,100);let o=0;for(const i of t){if(i.default){n=i;break}let t=e.get(i.name)??-1;const r=i.provider;if(r.hasRichIntegration()&&r.maybeConnected){const e=await r.getRepositoryMetadata();!1===e?.isFork&&(t+=101)}t>o&&(n=i,o=t)}s=n??null}return this._bestRemotesCache.set(r,s),s??void 0}}async getBestRemoteWithRichProvider(e,t){if(null==e)return;let i,r;if(Array.isArray(e)){if(0===e.length)return;i=e,r=e[0].repoPath}else r=e;"string"==typeof r&&(r=this.getAbsoluteUri(r));const s=(0,Te.YW)(r);let n=this._bestRemotesCache.get(`rich+connected|${s}`);if(null!=n)return n;if(null===n&&!t?.includeDisconnected)return;if(t?.includeDisconnected&&(n=this._bestRemotesCache.get(`rich|${s}`),void 0!==n))return n??void 0;const o=await(null!=i?this.getBestRemoteWithProvider(i):this.getBestRemoteWithProvider(r));if(!o?.hasRichProvider())return this._bestRemotesCache.set(`rich|${s}`,null),void this._bestRemotesCache.set(`rich+connected|${s}`,null);const{provider:a}=o;if(a.maybeConnected??await a.isConnected())this._bestRemotesCache.set(`rich|${s}`,o),this._bestRemotesCache.set(`rich+connected|${s}`,o);else if(this._bestRemotesCache.set(`rich|${s}`,o),this._bestRemotesCache.set(`rich+connected|${s}`,null),!t?.includeDisconnected)return;return o}async getRemotes(e,t){if(null==e)return[];const{provider:i,path:r}=this.getProvider(e);return i.getRemotes(r,t)}async getRemotesWithProviders(e,t){if(null==e)return[];const i=this.container.git.getRepository(e);return(await(null!=i?i.getRemotes(t):this.getRemotes(e,t))).filter((e=>null!=e.provider))}getBestRepository(e,t){const i=this.repositoryCount;if(0!==i){if(1===i)return this.highlander;if(null!=e&&e instanceof r.Uri){const t=this.getRepository(e);if(null!=t)return t;e=void 0}return(null!=(t=e??t??r.window.activeTextEditor)?this.getRepository(t.document.uri):void 0)??this.highlander}}getBestRepositoryOrFirst(e,t){const i=this.repositoryCount;if(0!==i){if(1===i)return(0,T.Ps)(this._repositories.values());if(null!=e&&e instanceof r.Uri){const t=this.getRepository(e);if(null!=t)return t;e=void 0}return(null!=(t=e??t??r.window.activeTextEditor)?this.getRepository(t.document.uri):void 0)??(0,T.Ps)(this._repositories.values())}}async getOrOpenRepository(e,t){const i=(0,E.UH)(),s=(0,$.M)(e);let n,o;n=this.getRepository(e),null==n&&null!=this._isDiscoveringRepositories&&(await this._isDiscoveringRepositories,n=this.getRepository(e));if(t?.detectNested??R.D.get("detectNestedRepositories",e)){if(!t?.force&&this._visitedPaths.has(s))return n;if(((await r.workspace.fs.stat(e)).type&r.FileType.Directory)!==r.FileType.Directory&&(e=r.Uri.joinPath(e,".."),!t?.force&&this._visitedPaths.has((0,$.M)(e))))return n;o=!0}else if(null!=n)return n;const a=(0,Te.YW)(e);let c=this._pendingRepositories.get(a);if(null==c){async function l(){const{provider:r}=this.getProvider(e),c=await r.findRepositoryUri(e,o);if(this._visitedPaths.set(s),null==c)return;let l;if(0!==this._repositories.count){if(n=this._repositories.get(c),null!=n)return n;l=this._repositories.getClosest(r.getAbsoluteUri(e,c))}const h=R.D.getAny("git.autoRepositoryDetection")??!0,u=t?.closeOnOpen??(!0!==h&&"openEditors"!==h);F.Yd.log(i,`Repository found in '${c.toString(!0)}'`);const d=r.openRepository(l?.folder,c,!1,void 0,u),p=[];for(const e of d)this._repositories.add(e),e.closed||p.push(e);return this._pendingRepositories.delete(a),this.updateContext(),p.length&&queueMicrotask((()=>this.fireRepositoriesChanged(p))),n=1===d.length?d[0]:this.getRepository(e),n}c=l.call(this),this._pendingRepositories.set(a,c)}return c}async getOrOpenRepositoryForEditor(e){return null==(e=e??r.window.activeTextEditor)?this.highlander:this.getOrOpenRepository(e.document.uri)}getRepository(e){if(0!==this.repositoryCount&&null!=e){if("string"==typeof e){if(!e)return;return this._repositories.getClosest(this.getAbsoluteUri(e))}return this._repositories.getClosest(e)}}async getLocalInfoFromRemoteUri(e,t){for(const i of this.openRepositories)for(const r of await i.getRemotes()){const s=await(r?.provider?.getLocalInfoFromRemoteUri(i,e,t));if(null!=s)return s}}async getStash(e){if(null==e)return;const{provider:t,path:i}=this.getProvider(e);return t.getStash(i)}async getStatusForFile(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getStatusForFile(r,t)}async getStatusForFiles(e,t){const{provider:i,path:r}=this.getProvider(e);return i.getStatusForFiles(r,t)}async getStatusForRepo(e){if(null==e)return;const{provider:t,path:i}=this.getProvider(e);return t.getStatusForRepo(i)}async getTags(e,t){if(null==e)return{values:[]};const{provider:i,path:r}=this.getProvider(e);return i.getTags(r,t)}async getTreeEntryForRevision(e,t,i){if(null==e||!t)return;const{provider:r,path:s}=this.getProvider(e);return r.getTreeEntryForRevision(s,r.getRelativePath(t,s),i)}async getTreeForRevision(e,t){if(null==e)return[];const{provider:i,path:r}=this.getProvider(e);return i.getTreeForRevision(r,t)}getRevisionContent(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.getRevisionContent(s,t,i)}async getUniqueRepositoryId(e){const{provider:t,path:i}=this.getProvider(e),r=await t.getUniqueRepositoryId(i);return null!=r?r:"-"}async hasBranchOrTag(e,t){if(null==e)return!1;const{provider:i,path:r}=this.getProvider(e);return i.hasBranchOrTag(r,t)}async hasCommitBeenPushed(e,t){if(null==e)return!1;const{provider:i,path:r}=this.getProvider(e);return i.hasCommitBeenPushed(r,t)}async hasRemotes(e){if(null==e)return!1;const t=this.getRepository(e);return null!=t&&t.hasRemotes()}async hasTrackingBranch(e){if(null==e)return!1;const t=this.getRepository(e);return null!=t&&t.hasUpstreamBranch()}hasUnsafeRepositories(){for(const e of this._providers.values())if(e.hasUnsafeRepositories?.())return!0;return!1}isRepositoryForEditor(e,t){return null!=(t=t??r.window.activeTextEditor)&&e===this.getRepository(t.document.uri)}isTrackable(e){if(!this.supportedSchemes.has(e.scheme))return!1;const{provider:t}=this.getProvider(e);return t.isTrackable(e)}async isTracked(e){if(!this.supportedSchemes.has(e.scheme))return!1;const{provider:t}=this.getProvider(e);return t.isTracked(e)}async getDiffTool(e){if(null==e)return;const{provider:t,path:i}=this.getProvider(e);return t.getDiffTool(i)}async openDiffTool(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.openDiffTool(s,t,i)}async openDirectoryCompare(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.openDirectoryCompare(n,t,i,r)}async resolveReference(e,t,i,r){if(null!=i&&(0,v.j$)(t)&&(t="HEAD"),!t||t===m.Ii||null==i&&(0,v.D3)(t)||null!=i&&(0,v.l3)(t))return t;const{provider:s,path:n}=this.getProvider(e);return s.resolveReference(n,t,i,r)}async richSearchCommits(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.richSearchCommits(s,t,i)}searchCommits(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.searchCommits(s,t,i)}async runGitCommandViaTerminal(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.runGitCommandViaTerminal?.(n,t,i,r)}validateBranchOrTagName(e,t){const{provider:i,path:r}=this.getProvider(e);return i.validateBranchOrTagName(r,t)}async validateReference(e,t){if(null==t||0===t.length)return!1;if(t===m.Ii||(0,v.l3)(t))return!0;const{provider:i,path:r}=this.getProvider(e);return i.validateReference(r,t)}stageFile(e,t){const{provider:i,path:r}=this.getProvider(e);return i.stageFile(r,t)}stageDirectory(e,t){const{provider:i,path:r}=this.getProvider(e);return i.stageDirectory(r,t)}unStageFile(e,t){const{provider:i,path:r}=this.getProvider(e);return i.unStageFile(r,t)}unStageDirectory(e,t){const{provider:i,path:r}=this.getProvider(e);return i.unStageDirectory(r,t)}async stashApply(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.stashApply?.(s,t,i)}async stashDelete(e,t,i){const{provider:r,path:s}=this.getProvider(e);return r.stashDelete?.(s,t,i)}async stashRename(e,t,i,r,s){const{provider:n,path:o}=this.getProvider(e);return n.stashRename?.(o,t,i,r,s)}async stashSave(e,t,i,r){const{provider:s,path:n}=this.getProvider(e);return s.stashSave?.(n,t,i,r)}createWorktree(e,t,i){const{provider:r,path:s}=this.getProvider(e);return Promise.resolve(r.createWorktree?.(s,t,i))}async getWorktree(e,t){const{provider:i,path:r}=this.getProvider(e);return(await(i.getWorktrees?.(r))??[]).find(t)}async getWorktrees(e){const{provider:t,path:i}=this.getProvider(e);return await(t.getWorktrees?.(i))??[]}async getWorktreesDefaultUri(e){const{provider:t,path:i}=this.getProvider(e);let s=await(t.getWorktreesDefaultUri?.(i));return null!=s||(s=this.getRepository(i)?.uri,null!=s&&(s=r.Uri.joinPath(s,".."))),s}deleteWorktree(e,t,i){const{provider:r,path:s}=this.getProvider(e);return Promise.resolve(r.deleteWorktree?.(s,t,i))}async getOpenScmRepositories(){const e=await Promise.allSettled([...this._providers.values()].map((e=>e.getOpenScmRepositories())));return[...(0,T.VS)((0,T.hX)(e,(e=>"fulfilled"===e.status)),(e=>e.value))]}getScmRepository(e){const{provider:t,path:i}=this.getProvider(e);return t.getScmRepository(i)}getOrOpenScmRepository(e){const{provider:t,path:i}=this.getProvider(e);return t.getOrOpenScmRepository(i)}}Be([(0,_.fF)()],GitProviderService.prototype,"onSubscriptionChanged",1),Be([(0,_.fF)({args:{0:e=>`focused=${e.focused}`}})],GitProviderService.prototype,"onWindowStateChanged",1),Be([(0,_.fF)({args:{0:e=>`added=${e.added.length}, removed=${e.removed.length}`},singleLine:!0})],GitProviderService.prototype,"onWorkspaceFoldersChanged",1),Be([(0,_.cM)({args:{1:!1},singleLine:!0})],GitProviderService.prototype,"register",1),Be([(0,_.cM)({singleLine:!0})],GitProviderService.prototype,"registrationComplete",1),Be([(0,_.cM)({args:{0:e=>e.length}})],GitProviderService.prototype,"discoverRepositories",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"discoverRepositoriesCore",1),Be([(0,_.cM)()],GitProviderService.prototype,"findRepositories",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"access",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"accessCore",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"supports",1),Be([(0,_.fF)({exit:e=>`returned ${e?.visibility}`})],GitProviderService.prototype,"getVisibilityInfoFromCache",1),Be([(0,_.fF)()],GitProviderService.prototype,"clearAllRepoVisibilityCaches",1),Be([(0,_.fF)()],GitProviderService.prototype,"clearAllOpenRepoVisibilityCaches",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"visibility",1),Be([(0,_.fF)({exit:!0})],GitProviderService.prototype,"visibilityCore",1),Be([(0,_.fF)()],GitProviderService.prototype,"setEnabledContext",1),Be([(0,_.cM)()],GitProviderService.prototype,"getBestRevisionUri",1),Be([(0,_.cM)()],GitProviderService.prototype,"getRevisionUri",1),Be([(0,_.cM)()],GitProviderService.prototype,"getWorkingUri",1),Be([(0,_.cM)()],GitProviderService.prototype,"addRemote",1),Be([(0,_.cM)()],GitProviderService.prototype,"pruneRemote",1),Be([(0,_.cM)()],GitProviderService.prototype,"removeRemote",1),Be([(0,_.cM)()],GitProviderService.prototype,"applyChangesToWorkingFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"checkout",1),Be([(0,_.cM)()],GitProviderService.prototype,"clone",1),Be([(0,_.cM)({singleLine:!0})],GitProviderService.prototype,"resetCaches",1),Be([(0,_.cM)({args:{1:e=>e.length}})],GitProviderService.prototype,"excludeIgnoredUris",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"fetch",1),Be([(0,k.H)(((e,t)=>`${null==e?"":e.map((e=>e.id)).join(",")}|${JSON.stringify(t)}`)),(0,_.cM)({args:{0:e=>e?.map((e=>e.name)).join(", ")}})],GitProviderService.prototype,"fetchAll",1),Be([(0,k.H)(((e,t)=>`${null==e?"":e.map((e=>e.id)).join(",")}|${JSON.stringify(t)}`)),(0,_.cM)({args:{0:e=>e?.map((e=>e.name)).join(", ")}})],GitProviderService.prototype,"pullAll",1),Be([(0,k.H)((e=>`${null==e?"":e.map((e=>e.id)).join(",")}`)),(0,_.cM)({args:{0:e=>e?.map((e=>e.name)).join(", ")}})],GitProviderService.prototype,"pushAll",1),Be([(0,_.cM)({args:{1:e=>e.join(",")}})],GitProviderService.prototype,"getAheadBehindCommitCount",1),Be([(0,_.cM)({args:{1:e=>e?.isDirty}})],GitProviderService.prototype,"getBlame",1),Be([(0,_.cM)({args:{1:"<contents>"}})],GitProviderService.prototype,"getBlameContents",1),Be([(0,_.cM)({args:{2:e=>e?.isDirty}})],GitProviderService.prototype,"getBlameForLine",1),Be([(0,_.cM)({args:{2:"<contents>"}})],GitProviderService.prototype,"getBlameForLineContents",1),Be([(0,_.cM)()],GitProviderService.prototype,"getBlameForRange",1),Be([(0,_.cM)({args:{2:"<contents>"}})],GitProviderService.prototype,"getBlameForRangeContents",1),Be([(0,_.cM)({args:{0:"<blame>"}})],GitProviderService.prototype,"getBlameRange",1),Be([(0,_.cM)()],GitProviderService.prototype,"getBranch",1),Be([(0,_.cM)({args:{0:e=>e.name}})],GitProviderService.prototype,"getBranchAheadRange",1),Be([(0,_.cM)({args:{1:!1}})],GitProviderService.prototype,"getBranches",1),Be([(0,_.cM)()],GitProviderService.prototype,"getBranchesAndTagsTipsFn",1),Be([(0,_.cM)()],GitProviderService.prototype,"getChangedFilesCount",1),Be([(0,_.cM)()],GitProviderService.prototype,"getCommit",1),Be([(0,_.cM)()],GitProviderService.prototype,"getCommitBranches",1),Be([(0,_.cM)()],GitProviderService.prototype,"getCommitCount",1),Be([(0,_.cM)()],GitProviderService.prototype,"getCommitForFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"getCommitsForGraph",1),Be([(0,_.cM)()],GitProviderService.prototype,"getConfig",1),Be([(0,_.cM)()],GitProviderService.prototype,"setConfig",1),Be([(0,_.cM)()],GitProviderService.prototype,"getContributors",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"getCurrentUser",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDefaultBranchName",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDiff",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDiffForFile",1),Be([(0,_.cM)({args:{1:"<contents>"}})],GitProviderService.prototype,"getDiffForFileContents",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDiffForLine",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDiffStatus",1),Be([(0,_.cM)()],GitProviderService.prototype,"getFileStatusForCommit",1),Be([(0,_.fF)()],GitProviderService.prototype,"getGitDir",1),Be([(0,_.fF)()],GitProviderService.prototype,"getLastFetchedTimestamp",1),Be([(0,_.cM)()],GitProviderService.prototype,"getLog",1),Be([(0,_.cM)()],GitProviderService.prototype,"getLogRefsOnly",1),Be([(0,_.cM)()],GitProviderService.prototype,"getLogForFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"getMergeBase",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"getMergeStatus",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"getRebaseStatus",1),Be([(0,_.cM)()],GitProviderService.prototype,"getNextComparisonUris",1),Be([(0,_.cM)()],GitProviderService.prototype,"getOldestUnpushedRefForFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"getPreviousComparisonUris",1),Be([(0,_.cM)()],GitProviderService.prototype,"getPreviousComparisonUrisForLine",1),Be([(0,k.H)(((e,t,i)=>{const r=y.ss.is(t)?t.provider:t;return`${e}${null!=r?`|${r.id}:${r.domain}/${r.path}`:""}|${JSON.stringify(i)}`})),(0,_.fF)({args:{1:e=>e.name}})],GitProviderService.prototype,"getPullRequestForBranch",1),Be([(0,k.H)(((e,t,i)=>{const r=y.ss.is(t)?t.provider:t;return`${e}${null!=r?`|${r.id}:${r.domain}/${r.path}`:""}|${i?.timeout}`})),(0,_.fF)({args:{1:e=>e.name}})],GitProviderService.prototype,"getPullRequestForCommit",1),Be([(0,_.fF)({args:{0:e=>e.name}})],GitProviderService.prototype,"getMyPullRequests",1),Be([(0,_.fF)({args:{0:e=>e.name}})],GitProviderService.prototype,"getMyIssues",1),Be([(0,_.cM)()],GitProviderService.prototype,"getIncomingActivity",1),Be([(0,k.H)((e=>`${null==e||"string"==typeof e?e:e instanceof r.Uri?e.toString():`${e.length}:${e[0]?.repoPath??""}`}`)),(0,_.cM)({args:{0:e=>Array.isArray(e)?e.map((e=>e.name)).join(","):e}})],GitProviderService.prototype,"getBestRemoteWithProvider",1),Be([(0,k.H)(((e,t)=>`${null==e||"string"==typeof e?e:e instanceof r.Uri?e.toString():`${e.length}:${e[0]?.repoPath??""}`}|${t?.includeDisconnected??!1}`)),(0,_.cM)({args:{0:e=>Array.isArray(e)?e.map((e=>e.name)).join(","):e}})],GitProviderService.prototype,"getBestRemoteWithRichProvider",1),Be([(0,_.cM)({args:{1:!1}})],GitProviderService.prototype,"getRemotes",1),Be([(0,_.cM)()],GitProviderService.prototype,"getRemotesWithProviders",1),Be([(0,_.cM)({exit:!0})],GitProviderService.prototype,"getBestRepository",1),Be([(0,_.cM)({exit:!0})],GitProviderService.prototype,"getBestRepositoryOrFirst",1),Be([(0,_.cM)({exit:!0})],GitProviderService.prototype,"getOrOpenRepository",1),Be([(0,_.cM)({args:{0:e=>null!=e?`TextEditor(${F.Yd.toLoggable(e.document.uri)})`:void 0}})],GitProviderService.prototype,"getOrOpenRepositoryForEditor",1),Be([(0,_.cM)({exit:!0})],GitProviderService.prototype,"getRepository",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"getStash",1),Be([(0,_.cM)()],GitProviderService.prototype,"getStatusForFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"getStatusForFiles",1),Be([(0,_.cM)()],GitProviderService.prototype,"getStatusForRepo",1),Be([(0,_.cM)({args:{1:!1}})],GitProviderService.prototype,"getTags",1),Be([(0,_.cM)()],GitProviderService.prototype,"getTreeEntryForRevision",1),Be([(0,_.cM)()],GitProviderService.prototype,"getTreeForRevision",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"getRevisionContent",1),Be([(0,_.cM)()],GitProviderService.prototype,"getUniqueRepositoryId",1),Be([(0,_.cM)({args:{1:!1}})],GitProviderService.prototype,"hasBranchOrTag",1),Be([(0,_.cM)({args:{1:!1}})],GitProviderService.prototype,"hasCommitBeenPushed",1),Be([(0,_.cM)()],GitProviderService.prototype,"hasRemotes",1),Be([(0,_.cM)()],GitProviderService.prototype,"hasTrackingBranch",1),Be([(0,_.cM)()],GitProviderService.prototype,"hasUnsafeRepositories",1),Be([(0,_.cM)({args:{0:e=>e.uri.toString(!0),1:e=>null!=e?`TextEditor(${F.Yd.toLoggable(e.document.uri)})`:void 0}})],GitProviderService.prototype,"isRepositoryForEditor",1),Be([(0,_.cM)()],GitProviderService.prototype,"getDiffTool",1),Be([(0,_.cM)()],GitProviderService.prototype,"openDiffTool",1),Be([(0,_.cM)()],GitProviderService.prototype,"openDirectoryCompare",1),Be([(0,k.H)(),(0,_.cM)()],GitProviderService.prototype,"resolveReference",1),Be([(0,_.cM)({args:{1:e=>`[${e.matchAll?"A":""}${e.matchCase?"C":""}${e.matchRegex?"R":""}]: ${e.query.length>500?`${e.query.substring(0,500)}...`:e.query}`}})],GitProviderService.prototype,"richSearchCommits",1),Be([(0,_.cM)()],GitProviderService.prototype,"searchCommits",1),Be([(0,_.cM)({args:!1})],GitProviderService.prototype,"runGitCommandViaTerminal",1),Be([(0,_.cM)()],GitProviderService.prototype,"validateBranchOrTagName",1),Be([(0,_.cM)()],GitProviderService.prototype,"validateReference",1),Be([(0,_.cM)()],GitProviderService.prototype,"stageFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"stageDirectory",1),Be([(0,_.cM)()],GitProviderService.prototype,"unStageFile",1),Be([(0,_.cM)()],GitProviderService.prototype,"unStageDirectory",1),Be([(0,_.cM)()],GitProviderService.prototype,"stashApply",1),Be([(0,_.cM)()],GitProviderService.prototype,"stashDelete",1),Be([(0,_.cM)()],GitProviderService.prototype,"stashRename",1),Be([(0,_.cM)({args:{2:e=>e?.length}})],GitProviderService.prototype,"stashSave",1),Be([(0,_.cM)()],GitProviderService.prototype,"createWorktree",1),Be([(0,_.cM)()],GitProviderService.prototype,"getWorktree",1),Be([(0,_.cM)()],GitProviderService.prototype,"getWorktrees",1),Be([(0,_.cM)()],GitProviderService.prototype,"getWorktreesDefaultUri",1),Be([(0,_.cM)()],GitProviderService.prototype,"deleteWorktree",1),Be([(0,_.cM)()],GitProviderService.prototype,"getOpenScmRepositories",1),Be([(0,_.cM)()],GitProviderService.prototype,"getScmRepository",1),Be([(0,_.cM)()],GitProviderService.prototype,"getOrOpenScmRepository",1);var Ue=i(2075),Ne=i(5542);class RichRemoteProviderService{constructor(e){this.container=e,this._onDidChangeConnectionState=new r.EventEmitter,this._connectedCache=new Set}get onDidChangeConnectionState(){return this._onDidChangeConnectionState.event}connected(e){this._connectedCache.has(e)||(this._connectedCache.add(e),this.container.telemetry.sendEvent("remoteProviders/connected",{"remoteProviders.key":e}),this._onDidChangeConnectionState.fire({key:e,reason:"connected"}))}disconnected(e){this._connectedCache.delete(e),this.container.telemetry.sendEvent("remoteProviders/disconnected",{"remoteProviders.key":e}),this._onDidChangeConnectionState.fire({key:e,reason:"disconnected"})}}var Ge=i(4298),He=Object.defineProperty,Ve=Object.getOwnPropertyDescriptor,qe=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ve(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&He(t,i,n),n};const Qe=2**30;class LineHoverController{constructor(e){this.container=e,this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this),R.D.onDidChange(this.onConfigurationChanged,this))}dispose(){this.unregister(),this.container.lineTracker.unsubscribe(this),this._disposable.dispose()}onReady(){this.onConfigurationChanged()}onConfigurationChanged(e){if(!R.D.changed(e,"hovers.enabled")&&!R.D.changed(e,"hovers.currentLine.enabled"))return;const t=R.D.get("hovers");t.enabled&&t.currentLine.enabled?(this.container.lineTracker.subscribe(this,this.container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged,this)),this.register(r.window.activeTextEditor)):(this.container.lineTracker.unsubscribe(this),this.unregister())}onActiveLinesChanged(e){e.pending||(null!=e.editor&&null!=e.selections?this.isRegistered(e.editor?.document.uri)||this.register(e.editor):this.unregister())}async provideDetailsHover(e,t,i){if(!this.container.lineTracker.includes(t.line))return;const s=this.container.lineTracker.getState(t.line),n=s?.commit;if(null==n)return;const o=R.D.get("hovers");if(o.annotations.details){if(await this.container.fileAnnotations.getAnnotationType(r.window.activeTextEditor)===we.VP.Blame)return}const a="line"===o.currentLine.over;if(!a&&this.container.lineAnnotations.suspended)return;const c=e.validateRange(new r.Range(t.line,a?t.character:Qe,t.line,Qe));if(!a&&c.start.character!==t.character)return;let l=t.line;const h=l+1;l=(n.lines.find((e=>e.line===h))??n.lines[0]).originalLine-1;const u=await this.container.tracker.get(e);if(null==u)return;const d=await(0,ce.nN)(n,u.uri,l,{autolinks:o.autolinks.enabled,dateFormat:R.D.get("defaultDateFormat"),format:o.detailsMarkdownFormat,pullRequests:{enabled:o.pullRequests.enabled}});return new r.Hover(d,c)}async provideChangesHover(e,t,i){if(!this.container.lineTracker.includes(t.line))return;const s=this.container.lineTracker.getState(t.line),n=s?.commit;if(null==n)return;const o=R.D.get("hovers");if(o.annotations.changes){if(await this.container.fileAnnotations.getAnnotationType(r.window.activeTextEditor)===we.VP.Blame)return}const a="line"===o.currentLine.over;if(!a&&this.container.lineAnnotations.suspended)return;const c=e.validateRange(new r.Range(t.line,a?t.character:Qe,t.line,Qe));if(!a&&c.start.character!==t.character)return;const l=await this.container.tracker.get(e);if(null==l)return;const h=await(0,ce.jw)(n,l.uri,t.line,l.document);return null!=h?new r.Hover(h,c):void 0}isRegistered(e){return null!=this._hoverProviderDisposable&&Ge.n.equals(this._uri,e)}register(e){if(this.unregister(),null==e)return;const t=R.D.get("hovers");if(!t.enabled||!t.currentLine.enabled||!t.currentLine.details&&!t.currentLine.changes)return;this._uri=e.document.uri;const i=[];t.currentLine.changes&&i.push(r.languages.registerHoverProvider({pattern:this._uri.fsPath},{provideHover:this.provideChangesHover.bind(this)})),t.currentLine.details&&i.push(r.languages.registerHoverProvider({pattern:this._uri.fsPath},{provideHover:this.provideDetailsHover.bind(this)})),this._hoverProviderDisposable=r.Disposable.from(...i)}unregister(){this._uri=void 0,null!=this._hoverProviderDisposable&&(this._hoverProviderDisposable.dispose(),this._hoverProviderDisposable=void 0)}}qe([(0,_.fF)({args:{0:e=>`editor=${e.editor?.document.uri.toString(!0)}, selections=${e.selections?.map((e=>`[${e.anchor}-${e.active}]`)).join(",")}, pending=${Boolean(e.pending)}, reason=${e.reason}`}})],LineHoverController.prototype,"onActiveLinesChanged",1),qe([(0,_.fF)({args:{0:e=>F.Yd.toLoggable(e.uri),1:e=>`${e.line}:${e.character}`,2:!1}})],LineHoverController.prototype,"provideDetailsHover",1),qe([(0,_.fF)({args:{0:e=>F.Yd.toLoggable(e.uri),1:e=>`${e.line}:${e.character}`,2:!1}})],LineHoverController.prototype,"provideChangesHover",1);var Ye=Object.defineProperty,je=Object.getOwnPropertyDescriptor,ze=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?je(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Ye(t,i,n),n};class IntegrationAuthenticationService{constructor(e){this.container=e,this.providers=new Map}dispose(){this.providers.clear()}registerProvider(e,t){if(this.providers.has(e))throw new Error(`Provider with id ${e} already registered`);return this.providers.set(e,t),{dispose:()=>this.providers.delete(e)}}hasProvider(e){return this.providers.has(e)}async createSession(e,t){const i=this.providers.get(e);if(null==i)throw new Error(`Provider with id ${e} not registered`);const r=await(i?.createSession(t));if(null==r)return;const s=this.getSecretKey(e,i.getSessionId(t));return await this.container.storage.storeSecret(s,JSON.stringify(r)),r}async getSession(e,t,i){const r=this.providers.get(e);if(null==r)throw new Error(`Provider with id ${e} not registered`);const s=this.getSecretKey(e,r.getSessionId(t));let n;i?.forceNewSession&&await this.container.storage.deleteSecret(s);try{const e=await this.container.storage.getSecret(s);e&&(n=JSON.parse(e))}catch(e){try{await this.container.storage.deleteSecret(s)}catch{}if(!i?.createIfNeeded)throw e}return i?.createIfNeeded&&null==n?this.createSession(e,t):n}async deleteSession(e,t){const i=this.providers.get(e);if(null==i)throw new Error(`Provider with id ${e} not registered`);const r=this.getSecretKey(e,i.getSessionId(t));await this.container.storage.deleteSecret(r)}getSecretKey(e,t){return`gitlens.integration.auth:${e}|${t}`}}ze([(0,_.fF)()],IntegrationAuthenticationService.prototype,"createSession",1),ze([(0,_.fF)()],IntegrationAuthenticationService.prototype,"getSession",1),ze([(0,_.fF)()],IntegrationAuthenticationService.prototype,"deleteSession",1);var Ke=i(4290),Je=Object.defineProperty,Xe=Object.getOwnPropertyDescriptor,Ze=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Xe(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Je(t,i,n),n};const et="gitlens+";class SubscriptionAuthenticationProvider{constructor(e,t){this.container=e,this.server=t,this._onDidChangeSessions=new r.EventEmitter,this._sessionsPromise=this.getSessionsFromStorage(),this._disposable=r.Disposable.from(r.authentication.registerAuthenticationProvider(et,"GitKraken: GitLens",this,{supportsMultipleAccounts:!1}),this.container.storage.onDidChangeSecrets((()=>this.checkForUpdates())))}get onDidChangeSessions(){return this._onDidChangeSessions.event}dispose(){this._disposable.dispose()}get secretStorageKey(){return`gitlens.plus.auth:${this.container.env}`}abort(){return this.server.abort()}async createSession(e){const t=(0,E.UH)(),i=tt(e=e.sort());try{const t=await this.server.login(e,i),r=await this.createSessionForToken(t,e),s=await this._sessionsPromise,n=s.findIndex((e=>e.id===r.id||tt(e.scopes)===i));return n>-1?s.splice(n,1,r):s.push(r),await this.storeSessions(s),this._onDidChangeSessions.fire({added:[r],removed:[],changed:[]}),r}catch(e){if("Cancelled"===e)throw e;throw F.Yd.error(e,t),r.window.showErrorMessage(`Unable to sign in to GitKraken: ${e}`),e}}async getSessions(e){const t=(0,E.UH)();e=e?.sort();const i=tt(e),r=await this._sessionsPromise,s=null!=e?r.filter((e=>tt(e.scopes)===i)):r;return(0,E.lH)(t,` • Found ${s.length} sessions`),s}async removeSession(e){const t=(0,E.UH)();try{const t=await this._sessionsPromise,i=t.findIndex((t=>t.id===e));if(-1===i)return void F.Yd.log(`Unable to remove session ${e}; Not found`);const r=t[i];t.splice(i,1),await this.storeSessions(t),this._onDidChangeSessions.fire({added:[],removed:[r],changed:[]})}catch(e){throw F.Yd.error(e,t),r.window.showErrorMessage(`Unable to sign out of GitKraken: ${e}`),e}}async removeSessionsByScopes(e){const t=(0,E.UH)();try{e=e?.sort();const t=tt(e),i=[];let r=0;const s=await this._sessionsPromise;for(const e of s)tt(e.scopes)===t?(s.splice(r,1),i.push(e)):r++;if(0===i.length)return;await this.storeSessions(s),this._onDidChangeSessions.fire({added:[],removed:i,changed:[]})}catch(e){throw F.Yd.error(e,t),r.window.showErrorMessage(`Unable to sign out of GitKraken: ${e}`),e}}async checkForUpdates(){const e=await this._sessionsPromise;this._sessionsPromise=this.getSessionsFromStorage();const t=await this._sessionsPromise,i=[],r=[];for(const r of t)e.some((e=>e.id===r.id))||i.push(r);for(const i of e)t.some((e=>e.id===i.id))||r.push(i);(i.length||r.length)&&(F.Yd.debug(`Firing sessions changed event; added=${i.length}, removed=${r.length}`),this._onDidChangeSessions.fire({added:i,removed:r,changed:[]}))}async createSessionForToken(e,t){const i=await this.server.getAccountInfo(e);return{id:(0,Ke.Vj)(),accessToken:e,account:{label:i.accountName,id:i.id},scopes:t}}async getSessionsFromStorage(){let e;try{const t=await this.container.storage.getSecret(this.secretStorageKey);if(!t||"[]"===t)return[];try{e=JSON.parse(t)}catch(e){try{await this.container.storage.deleteSecret(this.secretStorageKey)}catch{}throw e}}catch(e){return F.Yd.error(e,"Unable to read sessions from storage"),[]}const t=e.map((async e=>{const t=tt(e.scopes);let i;if(F.Yd.debug(`Read session from storage with scopes=${t}`),null==e.account)try{i=await this.server.getAccountInfo(e.accessToken),F.Yd.debug(`Verified session with scopes=${t}`)}catch(e){if("Unauthorized"===e.message)return}return{id:e.id,account:{label:null!=e.account?e.account.label??e.account.displayName??"<unknown>":i?.accountName??"<unknown>",id:e.account?.id??i?.id??"<unknown>"},scopes:e.scopes,accessToken:e.accessToken}})),i=(await Promise.allSettled(t)).filter((e=>"fulfilled"===e.status)).map((e=>e.value)).filter((e=>Boolean(e)));return F.Yd.debug(`Found ${i.length} verified sessions`),i.length!==e.length&&await this.storeSessions(i),i}async storeSessions(e){try{this._sessionsPromise=Promise.resolve(e),await this.container.storage.storeSecret(this.secretStorageKey,JSON.stringify(e))}catch(t){F.Yd.error(t,`Unable to store ${e.length} sessions`)}}}function tt(e){return e?.join("|")}Ze([(0,_.fF)()],SubscriptionAuthenticationProvider.prototype,"createSession",1),Ze([(0,_.fF)()],SubscriptionAuthenticationProvider.prototype,"getSessions",1),Ze([(0,_.fF)()],SubscriptionAuthenticationProvider.prototype,"removeSession",1),Ze([(0,_.fF)()],SubscriptionAuthenticationProvider.prototype,"removeSessionsByScopes",1);var it=i(4488),rt=Object.defineProperty,st=Object.getOwnPropertyDescriptor,nt=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?st(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&rt(t,i,n),n};const ot="did-authenticate",at="Visual-Studio-Code-GitLens";class ServerConnection{constructor(e){this.container=e,this._deferredCodeExchanges=new Map,this._pendingStates=new Map}dispose(){}get baseApiUri(){return"staging"===this.container.env?r.Uri.parse("https://stagingapi.gitkraken.com"):"dev"===this.container.env?r.Uri.parse("https://devapi.gitkraken.com"):r.Uri.parse("https://api.gitkraken.com")}get baseAccountUri(){return"staging"===this.container.env?r.Uri.parse("https://stagingapp.gitkraken.com"):"dev"===this.container.env?r.Uri.parse("https://devapp.gitkraken.com"):r.Uri.parse("https://app.gitkraken.com")}abort(){return null==this._cancellationSource?Promise.resolve():(this._cancellationSource.cancel(),new Promise((e=>setTimeout(e,50))))}async getAccountInfo(e){const t=(0,E.UH)();let i;try{i=await(0,Z.he)(r.Uri.joinPath(this.baseApiUri,"user").toString(),{agent:(0,Z.Nx)(),headers:{Authorization:`Bearer ${e}`,"User-Agent":at}})}catch(e){throw F.Yd.error(e,t),e}if(!i.ok)throw F.Yd.error(void 0,`Getting account info failed: (${i.status}) ${i.statusText}`),new Error(i.statusText);const s=await i.json();return{id:s.id,accountName:s.username}}async login(e,t){this.updateStatusBarItem(!0);const i=(0,Ke.Vj)(),s=this._pendingStates.get(t)??[];this._pendingStates.set(t,[...s,i]);const n=await r.env.asExternalUri(r.Uri.parse(`${r.env.uriScheme}://${this.container.context.extension.id}/${ot}?gkstate=${i}`)),o=r.Uri.joinPath(this.baseAccountUri,"register").with({query:`${e.includes("gitlens")?"referrer=gitlens&":""}pass-token=true&return-url=${encodeURIComponent(n.toString())}`});await r.env.openExternal(o);let a=this._deferredCodeExchanges.get(t);return null==a&&(a=(0,I.ue)(this.container.uri.onDidReceiveAuthenticationUri,this.getUriHandlerDeferredExecutor(t)),this._deferredCodeExchanges.set(t,a)),null!=this._cancellationSource&&(this._cancellationSource.cancel(),this._cancellationSource.dispose(),this._cancellationSource=void 0),this._cancellationSource=new r.CancellationTokenSource,this.openCompletionInputFallback(this._cancellationSource.token),Promise.race([a.promise,new Promise(((e,t)=>this._cancellationSource?.token.onCancellationRequested((()=>t("Cancelled"))))),new Promise(((e,t)=>setTimeout(t,12e4,"Cancelled")))]).finally((()=>{this._cancellationSource?.cancel(),this._cancellationSource?.dispose(),this._cancellationSource=void 0,this._pendingStates.delete(t),a?.cancel(),this._deferredCodeExchanges.delete(t),this.updateStatusBarItem(!1)}))}async openCompletionInputFallback(e){const t=r.window.createInputBox();t.ignoreFocusOut=!0;const i=[];try{if(e.isCancellationRequested)return;const s=await new Promise((s=>{i.push(e.onCancellationRequested((()=>t.hide())),t.onDidHide((()=>s(void 0))),t.onDidChangeValue((e=>{if(e){try{const i=r.Uri.parse(e.trim());if(i.scheme&&"file"!==i.scheme)return void(t.validationMessage=void 0)}catch{}t.validationMessage="Please enter a valid authorization URL"}else t.validationMessage=void 0})),t.onDidAccept((()=>s(r.Uri.parse(t.value.trim()))))),t.title="GitKraken Sign In",t.placeholder="Please enter the provided authorization URL",t.prompt="If the auto-redirect fails, paste the authorization URL",t.show()}));null!=s&&this.container.uri.handleUri(s)}finally{t.dispose(),i.forEach((e=>{e.dispose()}))}}getUriHandlerDeferredExecutor(e){return(t,i,r)=>{const s=new URLSearchParams(t.query),n=this._pendingStates.get(e),o=s.get("gkstate");if(null==n||!o||!n.includes(o))return void F.Yd.log("State not found in accepted state. Skipping this execution...");const a=s.get("access-token"),c=s.get("code"),l=a??c;null==l?r("Token not returned"):i(l)}}updateStatusBarItem(e){e&&null==this._statusBarItem&&(this._statusBarItem=r.window.createStatusBarItem("gitlens.plus.signIn",r.StatusBarAlignment.Left),this._statusBarItem.name="GitKraken Sign in",this._statusBarItem.text="Signing in to GitKraken...",this._statusBarItem.show()),e||null==this._statusBarItem||(this._statusBarItem.dispose(),this._statusBarItem=void 0)}async fetchGraphql(e,t,i){return this.fetchCore(r.Uri.joinPath(this.baseAccountUri,"api/projects/graphql").toString(),t,{method:"POST",body:JSON.stringify(e),...i})}async fetchCore(e,t,i){const r=(0,E.UH)();try{const r={agent:(0,Z.Nx)(),...i,headers:{Authorization:`Bearer ${t}`,"User-Agent":at,"Content-Type":"application/json",...i?.headers}};return await(0,Z.he)(e,r)}catch(e){throw F.Yd.error(e,r),e}}}nt([(0,it.H)()],ServerConnection.prototype,"baseApiUri",1),nt([(0,it.H)()],ServerConnection.prototype,"baseAccountUri",1),nt([(0,_.fF)({args:!1})],ServerConnection.prototype,"getAccountInfo",1),nt([(0,_.fF)()],ServerConnection.prototype,"login",1);var ct=i(7512),lt=i(9967),ht=i(4550),ut=i(2215),dt=Object.defineProperty,pt=Object.getOwnPropertyDescriptor,mt=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?pt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&dt(t,i,n),n};const gt="Visual-Studio-Code-GitLens",ft=class{constructor(e,t){this.container=e,this._onDidChange=new r.EventEmitter,this._etag=0,this._disposable=r.Disposable.from((0,B.IH)(e.onReady)(this.onReady,this),this.container.subscriptionAuthentication.onDidChangeSessions((e=>setTimeout((()=>this.onAuthenticationChanged(e)),0)),this),R.D.onDidChange((e=>{R.D.changed(e,"plusFeatures")&&this.updateContext()})));const i=this.getStoredSubscription();null!=i&&(0,ht.L5)(t,"< 14.0")&&(i.previewTrial=void 0),this.changeSubscription(i,!0),setTimeout((()=>{this.ensureSession(!1)}),1e4)}get onDidChange(){return this._onDidChange.event}dispose(){this._statusBarSubscription?.dispose(),this._disposable.dispose()}async onAuthenticationChanged(e){let t=this._session;if(null==t&&null!=this._sessionPromise&&(t=await this._sessionPromise),null!=t&&e.removed?.some((e=>e.id===t.id)))return this._session=void 0,this._sessionPromise=void 0,void this.logout();const i=e.added?.[0]??e.changed?.[0];null!=i&&(i.id===t?.id&&i.accessToken===t?.accessToken||(this._session=t,this.validate()))}get baseApiUri(){const{env:e}=this.container;return"staging"===e?r.Uri.parse("https://stagingapi.gitkraken.com"):"dev"===e?r.Uri.parse("https://devapi.gitkraken.com"):r.Uri.parse("https://api.gitkraken.com")}get baseAccountUri(){const{env:e}=this.container;return"staging"===e?r.Uri.parse("https://stagingapp.gitkraken.com"):"dev"===e?r.Uri.parse("https://devapp.gitkraken.com"):r.Uri.parse("https://app.gitkraken.com")}get baseSiteUri(){const{env:e}=this.container;return"staging"===e?r.Uri.parse("https://staging.gitkraken.com"):"dev"===e?r.Uri.parse("https://dev.gitkraken.com"):r.Uri.parse("https://gitkraken.com")}get etag(){return this._etag}onReady(){this._disposable=r.Disposable.from(this._disposable,this.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this),...this.registerCommands()),this.updateContext()}onRepositoriesChanged(e){this.updateContext()}registerCommands(){return this.container.viewCommands,[(0,$e.xR)(n.Gh.PlusLoginOrSignUp,(()=>this.loginOrSignUp())),(0,$e.xR)(n.Gh.PlusLogout,(()=>this.logout())),(0,$e.xR)(n.Gh.PlusStartPreviewTrial,(()=>this.startPreviewTrial())),(0,$e.xR)(n.Gh.PlusManage,(()=>this.manage())),(0,$e.xR)(n.Gh.PlusPurchase,(()=>this.purchase())),(0,$e.xR)(n.Gh.PlusResendVerification,(()=>this.resendVerification())),(0,$e.xR)(n.Gh.PlusValidate,(()=>this.validate())),(0,$e.xR)(n.Gh.PlusShowPlans,(()=>this.showPlans())),(0,$e.xR)(n.Gh.PlusHide,(()=>R.D.updateEffective("plusFeatures.enabled",!1))),(0,$e.xR)(n.Gh.PlusRestore,(()=>R.D.updateEffective("plusFeatures.enabled",!0))),(0,$e.xR)("gitlens.plus.reset",(()=>this.logout(!0)))]}async getSubscription(e=!1){const t=this.ensureSession(!1);return e||await t,this._subscription}async learnAboutPreviewOrTrial(){const e=await this.getSubscription();e.state===Fe.jc.FreeInPreviewTrial?(0,W.lN)(this.container.context.extension.id,"gitlens.welcome","gitlens.welcome.preview",!1):e.state===Fe.jc.FreePlusInTrial&&(0,W.lN)(this.container.context.extension.id,"gitlens.welcome","gitlens.welcome.trial",!1)}async loginOrSignUp(){if(!await(0,ut.C)())return!1;await this.container.subscriptionAuthentication.abort(),this.showAccountView();const e=await this.ensureSession(!0),t=Boolean(e);if(t){const{account:e,plan:{actual:t,effective:i}}=this._subscription;if(!1===e?.verified){const e={title:"Resend Verification",isCloseAffordance:!0},t={title:"Cancel"};await r.window.showInformationMessage(`You must verify your email before you can access ${i.name}.`,e,t)===e&&this.resendVerification()}else if((0,Fe.dz)(this._subscription)){const e=(0,Fe.PY)(this._subscription,"days"),t={title:"OK",isCloseAffordance:!0},s={title:"Learn More"};await r.window.showInformationMessage(`Welcome to ${i.name} (Trial). You can now try Pro features on privately hosted repos for ${(0,Ce._6)("more day",e??0)}.`,{modal:!0},t,s)===s&&this.learnAboutPreviewOrTrial()}else(0,Fe.ww)(this._subscription)?r.window.showInformationMessage(`Welcome to ${t.name}. You can now use Pro features on privately hosted repos.`,"OK"):r.window.showInformationMessage(`Welcome to ${t.name}. You can use Pro features on local & publicly hosted repos.`,"OK")}return t}async logout(e=!1){return this.logoutCore(e)}async logoutCore(e=!1){null!=this._validationTimer&&(clearInterval(this._validationTimer),this._validationTimer=void 0),await this.container.subscriptionAuthentication.abort(),this._sessionPromise=void 0,null!=this._session?(this.container.subscriptionAuthentication.removeSession(this._session.id),this._session=void 0):this.container.subscriptionAuthentication.removeSessionsByScopes(ft.authenticationScopes),e&&this.container.debugging?this.changeSubscription(void 0):this.changeSubscription({...this._subscription,plan:{actual:(0,Fe.fV)(Fe.Cx.Free,!1,void 0,null!=this._subscription.plan?.actual?.startedOn?new Date(this._subscription.plan.actual.startedOn):void 0),effective:(0,Fe.fV)(Fe.Cx.Free,!1,void 0,null!=this._subscription.plan?.effective?.startedOn?new Date(this._subscription.plan.actual.startedOn):void 0)},account:void 0})}manage(){r.env.openExternal(this.baseAccountUri)}async purchase(){await(0,ut.C)()&&(null==this._subscription.account?this.showPlans():r.env.openExternal(r.Uri.joinPath(this.baseAccountUri,"subscription").with({query:"product=gitlens&license=PRO"})),await this.showAccountView())}async resendVerification(){if(this._subscription.account?.verified)return!0;const e=(0,E.UH)();this.showAccountView(!0);const t=await this.ensureSession(!1);if(null==t)return!1;try{const i=await(0,Z.he)(r.Uri.joinPath(this.baseApiUri,"resend-email").toString(),{method:"POST",agent:(0,Z.Nx)(),headers:{Authorization:`Bearer ${t.accessToken}`,"User-Agent":gt,"Content-Type":"application/json"},body:JSON.stringify({id:t.account.id})});if(!i.ok)return F.Yd.error("",e,`Unable to resend verification email; status=(${i.status}): ${i.statusText}`),r.window.showErrorMessage(`Unable to resend verification email; Status: ${i.statusText}`,"OK"),!1;const s={title:"Recheck"},n={title:"Cancel"};if(await r.window.showInformationMessage("Once you have verified your email address, click 'Recheck'.",s,n)===s)return await this.validate(),!0}catch(t){F.Yd.error(t,e),r.window.showErrorMessage("Unable to resend verification email","OK")}return!1}async showAccountView(e=!1){e&&!R.D.get("plusFeatures.enabled",void 0,!0)||this.container.accountView.visible||await(0,$e.P0)(n.Gh.ShowAccountView)}showPlans(){r.env.openExternal(r.Uri.joinPath(this.baseSiteUri,"gitlens/pricing"))}async startPreviewTrial(e){if(!await(0,ut.C)())return;let{plan:t,previewTrial:i}=this._subscription;if(null!=i){if(this.showAccountView(),!e&&t.effective.id===Fe.Cx.Free){const e={title:"Start Free Pro Trial",isCloseAffordance:!0},t={title:"Cancel"};await r.window.showInformationMessage("Your 3-day Pro preview has ended, start a free Pro trial to get an additional 7 days.\n\n✨ A trial or paid plan is required to use Pro features on privately hosted repos.",{modal:!0},e,t)===e&&this.loginOrSignUp()}return}if((0,Fe._n)(this._subscription))return;const s=new Date;let n,o=new Date(s);this.container.debugging?(o=(0,ct.IH)(o,{minutes:1}),n=0):(o.setHours(23,59,59,999),o=(0,ct.IH)(o,{days:3}),n=3),i={startedOn:s.toISOString(),expiresOn:o.toISOString()},this.changeSubscription({...this._subscription,plan:{...this._subscription.plan,effective:(0,Fe.fV)(Fe.Cx.Pro,!1,void 0,s,o)},previewTrial:i}),e||setTimeout((async()=>{const e={title:"Learn More"};await r.window.showInformationMessage(`You can now preview Pro features for ${(0,Ce._6)("day",n)}. After which, you can start a free Pro trial for an additional 7 days.`,{title:"OK",isCloseAffordance:!0},e)===e&&this.learnAboutPreviewOrTrial()}),1)}async validate(){const e=(0,E.UH)(),t=await this.ensureSession(!1);if(null!=t)try{await this.checkInAndValidate(t)}catch(t){F.Yd.error(t,e)}else this.changeSubscription(this._subscription)}async checkInAndValidate(e,t=!1){if(!t)return this.checkInAndValidateCore(e);const i=this.checkInAndValidateCore(e);await Promise.race([i,new Promise((e=>setTimeout(e,3e3,!0)))])&&await r.window.withProgress({location:r.ProgressLocation.Notification,title:"Validating your GitKraken account..."},(()=>i))}async checkInAndValidateCore(e){const t=(0,E.UH)();try{const t={id:e.account.id,platform:(0,be.Xf)(),gitlensVersion:this.container.version,machineId:r.env.machineId,sessionId:r.env.sessionId,vscodeEdition:r.env.appName,vscodeHost:r.env.appHost,vscodeVersion:r.version,previewStartedOn:this._subscription.previewTrial?.startedOn,previewExpiresOn:this._subscription.previewTrial?.expiresOn},i=await(0,Z.he)(r.Uri.joinPath(this.baseApiUri,"gitlens/checkin").toString(),{method:"POST",agent:(0,Z.Nx)(),headers:{Authorization:`Bearer ${e.accessToken}`,"User-Agent":gt,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new a.dt("Unable to validate account",void 0,i.status,i.statusText);const s=await i.json();this.validateSubscription(s),this._lastCheckInDate=new Date}catch(e){if(F.Yd.error(e,t),e instanceof a.dt)throw e;throw new a.dt("Unable to validate account",e)}finally{this.startDailyValidationTimer()}}startDailyValidationTimer(){null!=this._validationTimer&&clearInterval(this._validationTimer),this._validationTimer=setInterval((()=>{null!=this._lastCheckInDate&&this._lastCheckInDate.getDate()===(new Date).getDate()||this.ensureSession(!1,!0)}),216e5)}validateSubscription(e){const t={id:e.user.id,name:e.user.name,email:e.user.email,verified:"activated"===e.user.status,createdOn:e.user.createdDate,organizationIds:e.orgIds??[]},i=Object.entries(e.licenses.effectiveLicenses),r=Object.entries(e.licenses.paidLicenses);let s,n;if(r.length>0){r.length>1&&r.sort(((e,t)=>(0,Fe.kU)(yt(t[0]))+Ct(t[1].latestStatus)-((0,Fe.kU)(yt(e[0]))+Ct(e[1].latestStatus))));const[e,t]=r[0];s=(0,Fe.fV)(yt(e),bt(e),t.organizationId,new Date(t.latestStartDate),new Date(t.latestEndDate),"cancelled"===t.latestStatus)}if(null==s&&(s=(0,Fe.fV)(Fe.Cx.FreePlus,!1,void 0,null!=e.user.firstGitLensCheckIn?new Date(e.user.firstGitLensCheckIn):null!=e.user.createdDate?new Date(e.user.createdDate):void 0)),i.length>0){i.length>1&&i.sort(((e,t)=>(0,Fe.kU)(yt(t[0]))+Ct(t[1].latestStatus)-((0,Fe.kU)(yt(e[0]))+Ct(e[1].latestStatus))));const[e,t]=i[0];n=(0,Fe.fV)(yt(e),bt(e),t.organizationId,new Date(t.latestStartDate),new Date(t.latestEndDate),"cancelled"===t.latestStatus)}(null==n||(0,Fe.kU)(s.id)>=(0,Fe.kU)(n.id))&&(n={...s}),this.changeSubscription({...this._subscription,plan:{actual:s,effective:n},account:t})}async ensureSession(e,t){if(null!=this._sessionPromise&&void 0===this._session&&await this._sessionPromise,!t&&null!=this._session)return this._session;if(null===this._session&&!e)return;void 0===this._sessionPromise&&(this._sessionPromise=this.getOrCreateSession(e).then((e=>(this._session=e,this._sessionPromise=void 0,this._session)),(()=>(this._session=null,this._sessionPromise=void 0,this._session))));return await this._sessionPromise??void 0}async getOrCreateSession(e){const t=(0,E.UH)();let i;try{i=await r.authentication.getSession(et,ft.authenticationScopes,{createIfNone:e,silent:!e})}catch(e){if(i=null,e instanceof Error&&e.message.includes("User did not consent"))return F.Yd.debug(t,"User declined authentication"),await this.logoutCore(),null;F.Yd.error(e,t)}if(null==i)return F.Yd.debug(t,"No valid session was found"),await this.logoutCore(),i??null;try{await this.checkInAndValidate(i,e)}catch(s){if(F.Yd.error(s,t),this.container.telemetry.sendEvent("account/validation/failed",{"account.id":i.account.id,exception:String(s),code:s.original?.code,statusCode:s.statusCode}),F.Yd.debug(t,`Account validation failed (${s.statusCode??s.original?.code})`),s instanceof a.dt){const t=i.account.label;if("ENOTFOUND"!==s.original?.code&&null!=s.statusCode&&s.statusCode<500&&s.statusCode>=400){if(i=null,await this.logoutCore(),e){const e=401===s.statusCode;queueMicrotask((async()=>{const i={title:"Retry Sign In"};await r.window.showErrorMessage(`Unable to sign in to your (${t}) GitKraken account. Please try again. If this issue persists, please contact support.${e?"":` Error=${s.message}`}`,i)===i&&this.loginOrSignUp()}))}}else i=i??null}}return i}changeSubscription(e,t=!1){null==e&&(e={plan:{actual:(0,Fe.fV)(Fe.Cx.Free,!1,void 0),effective:(0,Fe.fV)(Fe.Cx.Free,!1,void 0)},account:void 0,state:Fe.jc.Free}),(0,Fe.Z1)(e)&&(e={...e,plan:{...e.plan,effective:e.plan.actual}}),!(0,Fe.ww)(e)&&null!=e.previewTrial&&((0,Fe.EE)(e.previewTrial.expiresOn)??0)>0&&(e={...e,plan:{...e.plan,effective:(0,Fe.fV)(Fe.Cx.Pro,!1,void 0,new Date(e.previewTrial.startedOn),new Date(e.previewTrial.expiresOn))}}),e.state=(0,Fe.RE)(e);const i=this._subscription,r=null!=i&&JSON.stringify(i)===JSON.stringify(e);r||(queueMicrotask((()=>{let t=vt(e);this.container.telemetry.setGlobalAttributes(t),t={...t,...r?{}:vt(i,"previous")},this.container.telemetry.sendEvent(null==i?"subscription":"subscription/changed",t)})),this.storeSubscription(e),this._subscription=e,this._etag=Date.now(),t||(this.updateContext(),null!=i&&this._onDidChange.fire({current:e,previous:i,etag:this._etag})))}getStoredSubscription(){const e=this.container.storage.get("premium:subscription"),t=e?.data;return null!=t&&(t.plan.actual.name=(0,Fe.tL)(t.plan.actual.id),t.plan.effective.name=(0,Fe.tL)(t.plan.effective.id)),t}async storeSubscription(e){return this.container.storage.store("premium:subscription",{v:1,data:e})}updateContext(){this._updateAccessContextDebounced?.cancel(),null==this._updateAccessContextDebounced&&(this._updateAccessContextDebounced=(0,B.Ds)(this.updateAccessContext.bind(this),500)),null!=this._cancellationSource&&(this._cancellationSource.cancel(),this._cancellationSource.dispose()),this._cancellationSource=new r.CancellationTokenSource,this._updateAccessContextDebounced(this._cancellationSource.token),this.updateStatusBar();const{plan:{actual:e},state:t}=this._subscription;(0,D.v)("gitlens:plus",e.id!=Fe.Cx.Free?e.id:void 0),(0,D.v)("gitlens:plus:state",t)}async updateAccessContext(e){let t=!1;if(0!==this.container.git.repositoryCount&&(({allowed:t}=await this.container.git.access()),e.isCancellationRequested))return;const i=R.D.get("plusFeatures.enabled")??!0;let r;if(!i&&"mixed"===t){r=[];for(const t of this.container.git.repositories){if(t.closed)continue;const i=await this.container.git.access(void 0,t.uri);if(e.isCancellationRequested)return;i.allowed||r.push(t.uri.toString())}}(0,D.v)("gitlens:plus:enabled",Boolean(t)||i),(0,D.v)("gitlens:plus:required",!1===t),(0,D.v)("gitlens:plus:disallowedRepos",r)}updateStatusBar(){const{account:e,plan:{effective:t}}=this._subscription;if(t.id===Fe.Cx.Free)return this._statusBarSubscription?.dispose(),void(this._statusBarSubscription=void 0);const i=(0,Fe.dz)(this._subscription);if(!i&&!1!==e?.verified)return this._statusBarSubscription?.dispose(),void(this._statusBarSubscription=void 0);if(null==this._statusBarSubscription&&(this._statusBarSubscription=r.window.createStatusBarItem("gitlens.plus.subscription",r.StatusBarAlignment.Left,1)),this._statusBarSubscription.name="GitKraken Subscription",this._statusBarSubscription.command=n.Gh.ShowHomeView,!1===e?.verified)this._statusBarSubscription.text=`$(warning) ${t.name} (Unverified)`,this._statusBarSubscription.backgroundColor=new r.ThemeColor("statusBarItem.warningBackground"),this._statusBarSubscription.tooltip=new r.MarkdownString(i?`**Please verify your email**\n\nYou must verify your email before you can start your **${t.name}** trial.\n\nClick for details`:"**Please verify your email**\n\nYou must verify your email before you can use Pro features on privately hosted repos.\n\nClick for details",!0);else{const e=(0,Fe.PY)(this._subscription,"days");this._statusBarSubscription.text=`${t.name} (Trial)`,this._statusBarSubscription.tooltip=new r.MarkdownString(`You have ${(0,Ce._6)("day",e??0)} left in your free **${t.name}** trial, which gives you additional access to Pro features on privately hosted repos.\n\nClick for details`,!0)}this._statusBarSubscription.show()}};let wt=ft;function vt(e,t){return null==e?{}:{...(0,lt.xH)(e.account,{arrays:"join",prefix:(t?`${t}.`:"")+"account",skipPaths:["name","email"],skipNulls:!0,stringify:!0}),...(0,lt.xH)(e.plan,{prefix:(t?`${t}.`:"")+"subscription",skipPaths:["actual.name","effective.name"],skipNulls:!0,stringify:!0}),...(0,lt.xH)(e.previewTrial,{prefix:(t?`${t}.`:"")+"subscription.previewTrial",skipPaths:["actual.name","effective.name"],skipNulls:!0,stringify:!0}),"subscription.state":e.state}}function yt(e){switch(e){case"gitlens-pro":case"bundle-pro":return Fe.Cx.Pro;case"gitlens-teams":case"bundle-teams":return Fe.Cx.Teams;case"gitlens-hosted-enterprise":case"gitlens-self-hosted-enterprise":case"gitlens-standalone-enterprise":case"bundle-hosted-enterprise":case"bundle-self-hosted-enterprise":case"bundle-standalone-enterprise":return Fe.Cx.Enterprise;default:return Fe.Cx.FreePlus}}function bt(e){switch(e){case"bundle-pro":case"bundle-teams":case"bundle-hosted-enterprise":case"bundle-self-hosted-enterprise":case"bundle-standalone-enterprise":return!0;default:return!1}}function Ct(e){switch(e){case"active":return 100;case"expired":case"cancelled":return-100;case"in_trial":case"trial":return 1;case"canceled":case"non_renewing":return 0}}function At(e){return e.registerWebviewView({id:"gitlens.views.graph",fileName:"graph.html",title:"Commit Graph",contextKeyPrefix:"gitlens:webviewView:graph",trackingFeature:"graphView",plusFeature:!0,webviewHostOptions:{retainContextWhenHidden:!0}},(async(e,t)=>{const{GraphWebviewProvider:r}=await Promise.resolve().then(i.bind(i,1302));return new r(e,t)}),(()=>"panel"===R.D.get("graph.layout")))}function Pt(e,t){return r.Disposable.from((0,$e.xR)(n.Gh.ShowGraph,((...e)=>"panel"===R.D.get("graph.layout")?(0,$e.P0)(n.Gh.ShowGraphView,...e):(0,$e.P0)(n.Gh.ShowGraphPage,...e))),(0,$e.xR)("gitlens.graph.switchToEditorLayout",(async()=>{await R.D.updateEffective("graph.layout","editor"),queueMicrotask((()=>{(0,$e.P0)(n.Gh.ShowGraphPage)}))})),(0,$e.xR)("gitlens.graph.switchToPanelLayout",(async()=>{await R.D.updateEffective("graph.layout","panel"),queueMicrotask((async()=>{await(0,$e.dO)("gitlens.views.graph.resetViewLocation"),await(0,$e.dO)("gitlens.views.graphDetails.resetViewLocation"),(0,$e.P0)(n.Gh.ShowGraphView)}))})),(0,$e.xR)(n.Gh.ToggleGraph,((...e)=>{(0,D.fw)("gitlens:webviewView:graph:visible")?(0,$e.dO)("workbench.action.closePanel"):(0,$e.P0)(n.Gh.ShowGraphView,...e)})),(0,$e.xR)(n.Gh.ToggleMaximizedGraph,((...e)=>{(0,D.fw)("gitlens:webviewView:graph:visible")||(0,$e.P0)(n.Gh.ShowGraphView,...e),(0,$e.dO)("workbench.action.toggleMaximizedPanel")})),(0,$e.xR)(n.Gh.ShowInCommitGraph,(i=>{const r="preserveFocus"in i&&(i.preserveFocus??!1);"panel"===R.D.get("graph.layout")?e.graphView.show({preserveFocus:r},i):t.show({preserveFocus:r},i)})))}wt.authenticationScopes=["gitlens"],mt([(0,it.H)()],wt.prototype,"baseApiUri",1),mt([(0,it.H)()],wt.prototype,"baseAccountUri",1),mt([(0,it.H)()],wt.prototype,"baseSiteUri",1),mt([(0,_.fF)()],wt.prototype,"learnAboutPreviewOrTrial",1),mt([(0,_.cM)()],wt.prototype,"loginOrSignUp",1),mt([(0,_.cM)()],wt.prototype,"logout",1),mt([(0,_.cM)()],wt.prototype,"manage",1),mt([(0,_.cM)()],wt.prototype,"purchase",1),mt([(0,k.H)(),(0,_.cM)()],wt.prototype,"resendVerification",1),mt([(0,_.cM)()],wt.prototype,"showAccountView",1),mt([(0,k.H)(),(0,_.cM)()],wt.prototype,"startPreviewTrial",1),mt([(0,k.H)(),(0,_.cM)()],wt.prototype,"validate",1),mt([(0,k.H)((e=>e.account.id))],wt.prototype,"checkInAndValidate",1),mt([(0,_.fF)({args:{0:e=>e?.account.label}})],wt.prototype,"checkInAndValidateCore",1),mt([(0,_.fF)()],wt.prototype,"validateSubscription",1),mt([(0,k.H)(),(0,_.fF)()],wt.prototype,"ensureSession",1),mt([(0,_.fF)()],wt.prototype,"getOrCreateSession",1),mt([(0,_.fF)()],wt.prototype,"changeSubscription",1);class GraphStatusBarController{constructor(e){this._disposable=r.Disposable.from(R.D.onDidChange(this.onConfigurationChanged,this),e.subscription.onDidChange(this.onSubscriptionChanged,this),(0,B.IH)(e.onReady)((()=>queueMicrotask((()=>this.updateStatusBar())))),(0,D.ve)((e=>{"gitlens:enabled"!==e&&"gitlens:plus:enabled"!==e||this.updateStatusBar()})),{dispose:()=>this._statusBarItem?.dispose()})}dispose(){this._disposable.dispose()}onConfigurationChanged(e){(R.D.changed(e,"graph.statusBar.enabled")||R.D.changed(e,"plusFeatures.enabled"))&&this.updateStatusBar()}onSubscriptionChanged(e){this.updateStatusBar()}updateStatusBar(){R.D.get("graph.statusBar.enabled")&&(0,D.fw)("gitlens:enabled")&&(0,ut.L)()?(null==this._statusBarItem&&(this._statusBarItem=r.window.createStatusBarItem("gitlens.graph",r.StatusBarAlignment.Left,9997),this._statusBarItem.name="GitLens Commit Graph",this._statusBarItem.command=n.Gh.ShowGraph,this._statusBarItem.text="$(gitlens-graph)",this._statusBarItem.tooltip=new r.MarkdownString("Visualize commits on the Commit Graph ✨"),this._statusBarItem.accessibilityInformation={label:"Show the GitLens Commit Graph"}),this._statusBarItem.show()):(this._statusBarItem?.dispose(),this._statusBarItem=void 0)}}var St=i(6503),Rt=i(635),Dt=i(1907);class WorkspacesApi{constructor(e,t){this.container=e,this.server=t}async getAccessToken(){const e=await this.container.subscriptionAuthentication.getSessions(["gitlens"]);if(!e.length)return;return e[0].accessToken}async getWorkspace(e,t){const i=await this.getAccessToken();if(null==i)return;let r;if(t?.includeRepositories){let e=`(first: ${t?.repoCount??Dt.CL}`;t?.repoPage&&(e+=`, page: ${t.repoPage}`),e+=")",r=`\n\t\t\t\tprovider_data {\n\t\t\t\t\trepositories ${e} {\n\t\t\t\t\t\ttotal_count\n\t\t\t\t\t\tpage_info {\n\t\t\t\t\t\t\tend_cursor\n\t\t\t\t\t\t\thas_next_page\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnodes {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\trepository_id\n\t\t\t\t\t\t\tprovider\n\t\t\t\t\t\t\tprovider_organization_id\n\t\t\t\t\t\t\tprovider_organization_name\n\t\t\t\t\t\t\turl\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`}const s=`\n\t\t\tquery getWorkspace {\n\t\t\t\tproject(id: "${e}") { ${`\n\t\t\tid\n\t\t\tdescription\n\t\t\tname\n\t\t\torganization {\n\t\t\t\tid\n\t\t\t}\n\t\t\tprovider\n\t\t\t${r??""}\n\t\t`} }\n\t\t\t}\n\t\t`,n=await this.server.fetchGraphql({query:s},i);if(!n.ok)throw F.Yd.error(void 0,`Getting workspace failed: (${n.status}) ${n.statusText}`),new Error(n.statusText);return await n.json()}async getWorkspaces(e){const t=await this.getAccessToken();if(null==t)return;let i;if(e?.includeRepositories){let t=`(first: ${e?.repoCount??Dt.CL}`;e?.repoPage&&(t+=`, page: ${e.repoPage}`),t+=")",i=`\n\t\t\t\tprovider_data {\n\t\t\t\t\trepositories ${t} {\n\t\t\t\t\t\ttotal_count\n\t\t\t\t\t\tpage_info {\n\t\t\t\t\t\t\tend_cursor\n\t\t\t\t\t\t\thas_next_page\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnodes {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\trepository_id\n\t\t\t\t\t\t\tprovider\n\t\t\t\t\t\t\tprovider_organization_id\n\t\t\t\t\t\t\tprovider_organization_name\n\t\t\t\t\t\t\turl\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`}const r=`\n\t\t\ttotal_count\n\t\t\tpage_info {\n\t\t\t\tend_cursor\n\t\t\t\thas_next_page\n\t\t\t}\n\t\t\tnodes {\n\t\t\t\tid\n\t\t\t\tdescription\n\t\t\t\tname\n\t\t\t\torganization {\n\t\t\t\t\tid\n\t\t\t\t}\n\t\t\t\tprovider\n\t\t\t\t${i??""}\n\t\t\t}\n\t\t`;let s=`(first: ${e?.count??Dt.U1}`;e?.cursor?s+=`, after: "${e.cursor}"`:e?.page&&(s+=`, page: ${e.page}`),s+=")";let n="query getWorkpaces {";if(n+=`memberProjects: projects ${s} { ${r} }`,null==e?.cursor&&e?.includeOrganizations){const t=(await this.container.subscription.getSubscription())?.account?.organizationIds??[];for(const i of t){let t=`(first: ${e?.count??Dt.U1}`;e?.page&&(t+=`, page: ${e.page}`),t+=`, organization_id: "${i}")`,n+=`organizationProjects_${i}: projects ${t} { ${r} }`}}n+="}";const o=await this.server.fetchGraphql({query:n},t);if(!o.ok)throw F.Yd.error(void 0,`Getting workspaces failed: (${o.status}) ${o.statusText}`),new Error(o.statusText);const a=new Set,c=await o.json();if(null==c?.data)return;let l;for(const e of Object.values(c.data))if(null!=e)if(null==l){l={data:{projects:e}};for(const t of e.nodes)a.add(t.id)}else for(const t of e.nodes)a.has(t.id)||(a.add(t.id),l.data.projects.nodes.push(t));return null!=l&&(l.data.projects.total_count=a.size),l}async getWorkspaceRepositories(e,t){const i=await this.getAccessToken();if(null==i)return;let r=`(first: ${t?.count??Dt.CL}`;t?.cursor?r+=`, after: "${t.cursor}"`:t?.page&&(r+=`, page: ${t.page}`),r+=")";const s=await this.server.fetchGraphql({query:`\n                    query getWorkspaceRepos {\n                        project (id: "${e}") {\n                            provider_data {\n\t\t\t\t\t\t\t\trepositories ${r} {\n\t\t\t\t\t\t\t\t\ttotal_count\n\t\t\t\t\t\t\t\t\tpage_info {\n\t\t\t\t\t\t\t\t\t\tend_cursor\n\t\t\t\t\t\t\t\t\t\thas_next_page\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnodes {\n\t\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\t\t\trepository_id\n\t\t\t\t\t\t\t\t\t\tprovider\n\t\t\t\t\t\t\t\t\t\tprovider_organization_id\n\t\t\t\t\t\t\t\t\t\tprovider_organization_name\n\t\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n                        }\n                    }\n\t\t\t\t`},i);if(!s.ok)throw F.Yd.error(void 0,`Getting workspace repos failed: (${s.status}) ${s.statusText}`),new Error(s.statusText);return await s.json()}async createWorkspace(e){if(!e.name||!e.description||!e.provider)return;if(!(e.provider!==Dt.Xu.Azure||e.azureOrganizationName&&e.azureProjectName))return;if((e.provider===Dt.Xu.GitHubEnterprise||e.provider===Dt.Xu.GitLabSelfHosted)&&!e.hostUrl)return;const t=await this.getAccessToken();if(null==t)return;const i=await this.server.fetchGraphql({query:`\n                    mutation createWorkspace {\n\t\t\t\t\t\tcreate_project(\n\t\t\t\t\t\t\tinput: {\n\t\t\t\t\t\t  \t\ttype: GK_PROJECT\n\t\t\t\t\t\t  \t\tname: "${e.name}"\n\t\t\t\t\t\t  \t\tdescription: "${e.description}"\n\t\t\t\t\t\t  \t\tprovider: ${e.provider}\n\t\t\t\t\t\t\t\t${e.hostUrl?`host_url: "${e.hostUrl}"`:""}\n\t\t\t\t\t\t\t\t${e.azureOrganizationName?`azure_organization_id: "${e.azureOrganizationName}"`:""}\n\t\t\t\t\t\t\t\t${e.azureProjectName?`azure_project: "${e.azureProjectName}"`:""}\n\t\t\t\t\t\t  \t\tprofile_id: "shared-services"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tdescription,\n\t\t\t\t\t\t\torganization {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tprovider\n\t\t\t\t\t\t}\n                    }\n\t\t\t\t`},t);if(!i.ok)throw F.Yd.error(void 0,`Creating workspace failed: (${i.status}) ${i.statusText}`),new Error(i.statusText);return await i.json()}async deleteWorkspace(e){const t=await this.getAccessToken();if(null==t)return;const i=await this.server.fetchGraphql({query:`\n                    mutation deleteWorkspace {\n\t\t\t\t\t\tdelete_project(\n\t\t\t\t\t\t\tid: "${e}"\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t}\n                    }\n\t\t\t\t`},t);if(!i.ok)throw F.Yd.error(void 0,`Deleting workspace failed: (${i.status}) ${i.statusText}`),new Error(i.statusText);const r=await i.json();if(r?.errors?.some((e=>e.message.includes("permission")))){const e="Adding repositories to workspace failed: you do not have permission to delete this workspace";throw F.Yd.error(void 0,e),new Error(e)}return r}async addReposToWorkspace(e,t){if(0===t.length)return;const i=await this.getAccessToken();if(null==i)return;let r="[";r+=t.map((e=>`{ provider_organization_id: "${e.owner}", name: "${e.repoName}" }`)).join(","),r+="]";let s=1;const n=t.map((e=>`Repository${s++}: repository(provider_organization_id: "${e.owner}", name: "${e.repoName}") {\n\t\t\tid\n\t\t\tname\n\t\t\trepository_id\n\t\t\tprovider\n\t\t\tprovider_organization_id\n\t\t\tprovider_organization_name\n\t\t\turl\n\t\t}`)).join(","),o=await this.server.fetchGraphql({query:`\n                    mutation addReposToWorkspace {\n\t\t\t\t\t\tadd_repositories_to_project(\n\t\t\t\t\t\t\tinput: {\n\t\t\t\t\t\t\t\tproject_id: "${e}",\n\t\t\t\t\t\t\t\trepositories: ${r}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\tprovider_data {\n\t\t\t\t\t\t\t\t${n}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n                    }\n\t\t\t\t`},i);if(!o.ok)throw F.Yd.error(void 0,`Adding repositories to workspace failed: (${o.status}) ${o.statusText}`),new Error(o.statusText);const a=await o.json();if(a?.errors?.some((e=>e.message.includes("permission")))){const e="Adding repositories to workspace failed: you do not have permission to add repositories to this workspace";throw F.Yd.error(void 0,e),new Error(e)}return a}async removeReposFromWorkspace(e,t){if(0===t.length)return;const i=await this.getAccessToken();if(null==i)return;let r="[";r+=t.map((e=>`{ provider_organization_id: "${e.owner}", name: "${e.repoName}" }`)).join(","),r+="]";const s=await this.server.fetchGraphql({query:`\n                    mutation removeReposFromWorkspace {\n\t\t\t\t\t\tremove_repositories_from_project(\n\t\t\t\t\t\t\tinput: {\n\t\t\t\t\t\t\t\tproject_id: "${e}",\n\t\t\t\t\t\t\t\trepositories: ${r}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t}\n                    }\n\t\t\t\t`},i);if(!s.ok)throw F.Yd.error(void 0,`Removing repositories from workspace failed: (${s.status}) ${s.statusText}`),new Error(s.statusText);const n=await s.json();if(n?.errors?.some((e=>e.message.includes("permission")))){const e="Adding repositories to workspace failed: you do not have permission to remove repositories from this workspace";throw F.Yd.error(void 0,e),new Error(e)}return n}}class WorkspacesService{constructor(e,t){this.container=e,this.server=t,this._onDidResetWorkspaces=new r.EventEmitter,this._currentWorkspaceAutoAddSetting=Dt.XU.Disabled,this._workspacesApi=new WorkspacesApi(this.container,this.server),this._workspacesPathProvider=new WorkspacesWebPathMappingProvider,this._currentWorkspaceId=r.workspace.getConfiguration("gitkraken")?.get("workspaceId"),this._currentWorkspaceAutoAddSetting=r.workspace.getConfiguration("gitkraken")?.get("workspaceAutoAddSetting")??Dt.XU.Disabled,this._disposable=r.Disposable.from(e.subscription.onDidChange(this.onSubscriptionChanged,this)),null!=this._currentWorkspaceId&&setTimeout((()=>this.addMissingCurrentWorkspaceRepos()),1e4)}get onDidResetWorkspaces(){return this._onDidResetWorkspaces.event}dispose(){this._disposable.dispose()}get currentWorkspaceId(){return this._currentWorkspaceId}get currentWorkspace(){return this._currentWorkspace}onSubscriptionChanged(e){null!=e.current.account&&e.current.account.id===e.previous?.account?.id&&e.current.state===e.previous?.state||this.resetWorkspaces({cloud:!0})}async loadCloudWorkspaces(e=!1){const t=await this.container.subscription.getSubscription();if(null==t?.account)return{cloudWorkspaces:void 0,cloudWorkspaceInfo:"Please sign in to use cloud workspaces."};const i=[];let r;try{const t=await this._workspacesApi.getWorkspaces({includeRepositories:!e,includeOrganizations:!0});r=t?.data?.projects?.nodes}catch{return{cloudWorkspaces:void 0,cloudWorkspaceInfo:"Failed to load cloud workspaces."}}let s=0;const n=t.state===Fe.jc.FreeInPreviewTrial||t.state===Fe.jc.FreePlusInTrial||t.state===Fe.jc.Paid;if(r?.length)for(const t of r){const r=await this._workspacesPathProvider.getCloudWorkspaceCodeWorkspacePath(t.id);if(!n&&t.organization?.id){s+=1;continue}const o=t.provider_data?.repositories?.nodes;let a=null!=o?o.map((e=>({...e,workspaceId:t.id}))):o;null!=a||e||(a=[]),i.push(new Dt.CH(this.container,t.id,t.name,t.organization?.id,t.provider,null!=this._currentWorkspaceId&&this._currentWorkspaceId===t.id,a,r))}return{cloudWorkspaces:i,cloudWorkspaceInfo:s>0?`${s} shared workspaces hidden - upgrade to GitLens Pro to access.`:void 0}}async loadLocalWorkspaces(){const e=[],t=(await this._workspacesPathProvider.getLocalWorkspaceData())?.workspaces||{};for(const i of Object.values(t))e.push(new Dt.qP(this.container,i.localId,i.name,i.repositories.map((e=>({localPath:e.localPath,name:e.localPath.split(/[\\/]/).pop()??"unknown",workspaceId:i.localId}))),null!=this._currentWorkspaceId&&this._currentWorkspaceId===i.localId));return{localWorkspaces:e,localWorkspaceInfo:void 0}}getCloudWorkspace(e){return this._cloudWorkspaces?.find((t=>t.id===e))}getLocalWorkspace(e){return this._localWorkspaces?.find((t=>t.id===e))}async getWorkspaces(e){const t={cloudWorkspaces:[],localWorkspaces:[],cloudWorkspaceInfo:void 0,localWorkspaceInfo:void 0};if(null==this._cloudWorkspaces||e?.force){const i=await this.loadCloudWorkspaces(e?.excludeRepositories);this._cloudWorkspaces=i.cloudWorkspaces,t.cloudWorkspaceInfo=i.cloudWorkspaceInfo}if(null==this._localWorkspaces||e?.force){const e=await this.loadLocalWorkspaces();this._localWorkspaces=e.localWorkspaces,t.localWorkspaceInfo=e.localWorkspaceInfo}const i=[...this._cloudWorkspaces??[],...this._localWorkspaces??[]].find((e=>e.current));return null!=i&&(this._currentWorkspaceId=i.id,this._currentWorkspace=i),t.cloudWorkspaces=this._cloudWorkspaces??[],t.localWorkspaces=this._localWorkspaces??[],t}async getCloudWorkspaceRepositories(e){const t=await this._workspacesApi.getWorkspaceRepositories(e),i=t?.data?.project?.provider_data?.repositories?.nodes;return i?.map((t=>({...t,workspaceId:e})))??[]}async addMissingCurrentWorkspaceRepos(e){if(null==this._currentWorkspaceId)return;let t=[...this._cloudWorkspaces??[],...this._localWorkspaces??[]].find((e=>e.current));if(null==t)try{const e=await this._workspacesApi.getWorkspace(this._currentWorkspaceId,{includeRepositories:!0});if(null==e?.data?.project)return;const i=e.data.project.provider_data?.repositories?.nodes,s=null!=i?i.map((t=>({...t,workspaceId:e.data.project.id}))):[];t=new Dt.CH(this.container,e.data.project.id,e.data.project.name,e.data.project.organization?.id,e.data.project.provider,!0,s,r.workspace.workspaceFile?.fsPath)}catch{return}if(!e?.force&&this._currentWorkspaceAutoAddSetting===Dt.XU.Disabled||!t?.current)return;if(this._currentWorkspace=t,!(await t.getRepositoryDescriptors())?.length)return;const i=[...(await this.resolveWorkspaceRepositoriesByName(t,{resolveFromPath:!0,usePathMapping:!0})).values()].map((e=>e.repository)),s=new Map;for(const e of this.container.git.openRepositories)s.set(e.id,e);const n=i.filter((e=>!s.has(e.id)));if(0===n.length)return void(e?.force&&r.window.showInformationMessage("No new repositories found to add.",{modal:!0}));let o=[];if(!e?.force&&this._currentWorkspaceAutoAddSetting===Dt.XU.Prompt){const e={title:"Add..."},t={title:"Change Auto-Add Behavior..."},i={title:"Cancel",isCloseAffordance:!0},s=await r.window.showInformationMessage("New repositories found in the linked GitKraken workspace. Would you like to add them to the current VS Code workspace?",e,t,i);if(null==s||s===i)return;if(s===t)return void this.chooseCodeWorkspaceAutoAddSetting({current:!0})}if(e?.force||this._currentWorkspaceAutoAddSetting===Dt.XU.Prompt){const e=await(0,Rt.rf)("Add Repositories to Workspace","Choose which repositories to add to the current workspace",n);if(0===e.length)return;o=e.map((e=>e.repoPath))}else o=n.map((e=>e.path));if(0===o.length)return;const a=r.workspace.workspaceFolders?.length??0;r.window.withProgress({location:r.ProgressLocation.Notification,title:"Adding new repositories from linked cloud workspace...",cancellable:!1},(()=>new Promise((e=>{r.workspace.updateWorkspaceFolders(a,0,...o.map((e=>({uri:r.Uri.file(e)})))),e(!0)}))))}resetWorkspaces(e){(e?.cloud??1)&&(this._cloudWorkspaces=void 0),(e?.local??1)&&(this._localWorkspaces=void 0),this._onDidResetWorkspaces.fire()}async getCloudWorkspaceRepoPath(e,t){return this._workspacesPathProvider.getCloudWorkspaceRepoPath(e,t)}async updateCloudWorkspaceRepoLocalPath(e,t,i){await this._workspacesPathProvider.writeCloudWorkspaceRepoDiskPathToMap(e,t,i)}async getRepositoriesInParentFolder(e){const t=(await r.window.showOpenDialog({title:"Choose a folder containing repositories for this workspace",canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1}))?.[0];if(null!=t&&!e?.isCancellationRequested)try{return this.container.git.findRepositories(t,{cancellation:e,depth:1,silent:!0})}catch(e){return}}async locateAllCloudWorkspaceRepos(e,t){const i=this.getCloudWorkspace(e);if(null==i)return;const r=await i.getRepositoryDescriptors();if(null==r||0===r.length)return;const s=await this.getRepositoriesInParentFolder(t);if(null!=s&&0!==s.length&&!t?.isCancellationRequested)for(const i of(await this.resolveWorkspaceRepositoriesByName(e,{cancellation:t,repositories:s})).values())if(await this.locateWorkspaceRepo(e,i.descriptor,i.repository),t?.isCancellationRequested)return}async locateWorkspaceRepo(e,t,i){let s;if(null==i||i instanceof r.Uri){let e=i;if(null==e&&(e=(await r.window.showOpenDialog({title:`Choose a location for ${t.name}`,canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1}))?.[0]),null==e)return;if(s=await this.container.git.getOrOpenRepository(e,{closeOnOpen:!0,detectNested:!1}),null==s)return}else s=i;const n=s.uri.fsPath,o=await s.getRemotes(),a=[];for(const e of o){const t=e.provider?.url({type:St.J.Repo});null!=t&&a.push(t)}for(const e of a)await this.container.repositoryPathMapping.writeLocalRepoPath({remoteUrl:e},n);null!=t.id&&(await this.container.repositoryPathMapping.writeLocalRepoPath({remoteUrl:t.url,repoInfo:{provider:t.provider,owner:t.provider_organization_id,repoName:t.name}},n),await this.updateCloudWorkspaceRepoLocalPath(e,t.id,n))}async createCloudWorkspace(e){const t=r.window.createInputBox();t.title="Create Cloud Workspace";const i=r.window.createQuickPick();i.title="Create Cloud Workspace";const s={GitHub:Dt.Xu.GitHub,"GitHub Enterprise":Dt.Xu.GitHubEnterprise};t.ignoreFocusOut=!0;const n=[];let o,a,c,l,h,u;if(null!=e?.repos&&e.repos.length>0){for(const t of e.repos){if(0===(await t.getRemotes({filter:e=>"github.com"===e.domain})).length)return void await r.window.showErrorMessage("Only GitHub is supported for this operation. Please ensure all open repositories are hosted on GitHub.",{modal:!0})}u=Dt.Xu.GitHub}try{if(o=await new Promise((e=>{n.push(t.onDidHide((()=>e(void 0))),t.onDidAccept((()=>{const i=t.value.trim();i?e(i):t.validationMessage="Please enter a non-empty name for the workspace"}))),t.placeholder="Please enter a name for the new workspace",t.prompt="Enter your workspace name",t.show()})),!o)return;if(a=await new Promise((e=>{n.push(t.onDidHide((()=>e(void 0))),t.onDidAccept((()=>{const i=t.value.trim();i?e(i):t.validationMessage="Please enter a non-empty description for the workspace"}))),t.value="",t.title="Create Workspace",t.placeholder="Please enter a description for the new workspace",t.prompt="Enter your workspace description",t.show()})),!a)return;if(null==u&&(u=await new Promise((e=>{n.push(i.onDidHide((()=>e(void 0))),i.onDidAccept((()=>{0!==i.activeItems.length&&e(s[i.activeItems[0].label])}))),i.placeholder="Please select a provider for the new workspace",i.items=Object.keys(s).map((e=>({label:e}))),i.canSelectMany=!1,i.show()}))),!u)return;if((u==Dt.Xu.GitHubEnterprise||u==Dt.Xu.GitLabSelfHosted)&&(c=await new Promise((e=>{n.push(t.onDidHide((()=>e(void 0))),t.onDidAccept((()=>{const i=t.value.trim();i?e(i):t.validationMessage="Please enter a non-empty host URL for the workspace"}))),t.value="",t.placeholder="Please enter a host URL for the new workspace",t.prompt="Enter your workspace host URL",t.show()})),!c))return;if(u==Dt.Xu.Azure){if(l=await new Promise((e=>{n.push(t.onDidHide((()=>e(void 0))),t.onDidAccept((()=>{const i=t.value.trim();i?e(i):t.validationMessage="Please enter a non-empty organization name for the workspace"}))),t.value="",t.placeholder="Please enter an organization name for the new workspace",t.prompt="Enter your workspace organization name",t.show()})),!l)return;if(h=await new Promise((e=>{n.push(t.onDidHide((()=>e(void 0))),t.onDidAccept((()=>{const i=t.value.trim();i?e(i):t.validationMessage="Please enter a non-empty project name for the workspace"}))),t.value="",t.placeholder="Please enter a project name for the new workspace",t.prompt="Enter your workspace project name",t.show()})),!h)return}}finally{t.dispose(),i.dispose(),n.forEach((e=>{e.dispose()}))}const d={name:o,description:a,provider:u,hostUrl:c,azureOrganizationName:l,azureProjectName:h};let p;try{const e=await this._workspacesApi.createWorkspace(d);p=e?.data?.create_project}catch{return}if(null!=p){null==this._cloudWorkspaces&&(this._cloudWorkspaces=[]);const t=await this._workspacesPathProvider.getCloudWorkspaceCodeWorkspacePath(p.id);this._cloudWorkspaces?.push(new Dt.CH(this.container,p.id,p.name,p.organization?.id,p.provider,null!=this._currentWorkspaceId&&this._currentWorkspaceId===p.id,[],t));const i=this.getCloudWorkspace(p.id);null!=i&&await this.addCloudWorkspaceRepos(i.id,{repos:e?.repos,suppressNotifications:!0})}}async deleteCloudWorkspace(e){const t=await r.window.showWarningMessage("Are you sure you want to delete this workspace? This cannot be undone.",{modal:!0},{title:"Confirm"},{title:"Cancel",isCloseAffordance:!0});if(null!=t&&"Cancel"!=t.title)try{const t=await this._workspacesApi.deleteWorkspace(e);t?.data?.delete_project?.id===e&&(this._cloudWorkspaces=this._cloudWorkspaces?.filter((t=>t.id!==e)))}catch(e){r.window.showErrorMessage(e.message)}}async filterReposForProvider(e,t){const i=[];for(const r of e){(await r.getRemotes({filter:e=>e.provider?.id===Dt.Jv[t]})).length&&i.push(r)}return i}async filterReposForCloudWorkspace(e,t){const i=this.getCloudWorkspace(t)??this.getLocalWorkspace(t);if(null==i)return e;const r=[...(await i.getRepositoriesByName()).values()].map((e=>e.repository));return e.filter((e=>!r.find((t=>t.id===e.id))))}async addCloudWorkspaceRepos(e,t){const i=this.getCloudWorkspace(e);if(null==i)return;const s=[];let n=t?.repos;if(!t?.repos){let s=await this.filterReposForProvider(this.container.git.openRepositories,i.provider);s=await this.filterReposForCloudWorkspace(s,e);const o=[{label:"Choose repositories from a folder",description:void 0,choice:Dt.Pv.ParentFolder}];s.length>0&&o.unshift({label:"Choose repositories from the current window",description:void 0,choice:Dt.Pv.CurrentWindow}),o[0].picked=!0;const a=await r.window.showQuickPick(o,{placeHolder:"Choose repositories from the current window or a folder",ignoreFocusOut:!0});if(null==a)return;a.choice===Dt.Pv.ParentFolder&&await r.window.withProgress({location:r.ProgressLocation.Notification,title:"Finding repositories to add to the workspace...",cancellable:!0},(async(n,o)=>{const a=await this.getRepositoriesInParentFolder(o);null!=a&&(0!==a.length?o.isCancellationRequested||(s=await this.filterReposForProvider(a,i.provider),0!==s.length?o.isCancellationRequested||(s=await this.filterReposForCloudWorkspace(s,e),0===s.length&&(t?.suppressNotifications||r.window.showInformationMessage("All possible repositories are already in this workspace.",{modal:!0}))):t?.suppressNotifications||r.window.showInformationMessage(`No matching repositories found for provider ${i.provider}.`,{modal:!0})):t?.suppressNotifications||r.window.showInformationMessage("No repositories found in the chosen folder.",{modal:!0}))}));const c=await(0,Rt.rf)("Add Repositories to Workspace","Choose which repositories to add to the workspace",s);if(0===c.length)return;n=c.map((e=>e.repoPath))}if(null==n)return;for(const e of n){const t=e instanceof b._j?e:await this.container.git.getOrOpenRepository(r.Uri.file(e),{closeOnOpen:!0});if(null==t)continue;const i=kt(await t.getRemote("origin")||(await t.getRemotes())?.[0]);null!=i&&s.push({owner:i.owner,repoName:i.repoName,repo:t,url:i.url})}if(0===s.length)return;let o=[];const a=new Set((await i.getRepositoryDescriptors()).map((e=>e.id)));await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Adding repositories to workspace ${i.name}...`,cancellable:!1},(async()=>{try{const t=await this._workspacesApi.addReposToWorkspace(e,s.map((e=>({owner:e.owner,repoName:e.repoName}))));if(null==t?.data.add_repositories_to_project)return;o=Object.values(t.data.add_repositories_to_project.provider_data).filter((e=>null!=e)).map((t=>({...t,workspaceId:e})))}catch(e){return void r.window.showErrorMessage(e.message)}o.length>0&&i.addRepositories(o),o.length<s.length&&(o=(await i.getRepositoryDescriptors({force:!0})).filter((e=>!a.has(e.id))));for(const{repo:t,repoName:i,url:r}of s){const s=o.find((e=>e.name.toLowerCase()===i||e.url===r));null!=s&&await this.locateWorkspaceRepo(e,s,t)}}))}async removeCloudWorkspaceRepo(e,t){const i=this.getCloudWorkspace(e);if(null==i)return;const s=await r.window.showWarningMessage(`Are you sure you want to remove ${t.name} from this workspace? This cannot be undone.`,{modal:!0},{title:"Confirm"},{title:"Cancel",isCloseAffordance:!0});if(null!=s&&"Cancel"!=s.title)try{const r=await this._workspacesApi.removeReposFromWorkspace(e,[{owner:t.provider_organization_id,repoName:t.name}]);if(null==r?.data.remove_repositories_from_project)return;i.removeRepositories([t.name])}catch(e){r.window.showErrorMessage(e.message)}}async resolveWorkspaceRepositoriesByName(e,t){const i=new Map,s=e instanceof Dt.CH||e instanceof Dt.qP?e:this.getLocalWorkspace(e)??this.getCloudWorkspace(e);if(null==s)return i;const n=await s.getRepositoryDescriptors();if(null==n||0===n.length)return i;const o=t?.repositories??this.container.git.repositories,a=new Map,c=new Map;for(const e of o){if(t?.cancellation?.isCancellationRequested)break;if(c.set((0,$.AH)(e.uri.fsPath.toLowerCase()),e),s instanceof Dt.CH){const t=await e.getRemotes();for(const i of t){const t=kt(i);null!=t&&a.set(`${t.provider}/${t.owner}/${t.repoName}`,e)}}}for(const e of n){let s=null,n=null;null==e.id?s=e.localPath:!0===t?.usePathMapping&&(s=await this.getMappedPathForCloudWorkspaceRepoDescriptor(e)),null!=s&&(n=c.get((0,$.AH)(s.toLowerCase()))),null==n&&null!=e.id&&null!=e.provider&&(n=a.get(`${e.provider.toLowerCase()}/${e.provider_organization_id.toLowerCase()}/${e.name.toLowerCase()}`)),null!=s&&null==n&&!0===t?.resolveFromPath&&(n=await this.container.git.getOrOpenRepository(r.Uri.file(s),{closeOnOpen:!0,force:!0})),null!=n&&i.set(e.name,{descriptor:e,repository:n})}return i}async saveAsCodeWorkspaceFile(e){const t=this.getCloudWorkspace(e)??this.getLocalWorkspace(e);if(null==t)return;const i=await t.getRepositoryDescriptors();if(null==i)return;const s=await t.getRepositoriesByName();if(0===s.size)return void r.window.showErrorMessage("No repositories in this workspace could be found locally. Please locate at least one repository.",{modal:!0});const n=[];for(const e of s.values()){const t=e.repository;t.virtual||n.push(t.uri.fsPath)}if(n.length<i.length){const e=await r.window.showWarningMessage("Some repositories in this workspace could not be located locally. Do you want to continue?",{modal:!0},{title:"Continue"},{title:"Cancel",isCloseAffordance:!0});if(null==e||"Cancel"==e.title)return}const o=await r.window.showSaveDialog({defaultUri:r.Uri.file(`${t.name}.code-workspace`),filters:{"Code Workspace":["code-workspace"]},title:"Choose a location for the new code workspace file"});if(null==o)return;const a=await this.chooseCodeWorkspaceAutoAddSetting();if(!await this._workspacesPathProvider.writeCodeWorkspaceFile(o,n,{workspaceId:e,workspaceAutoAddSetting:a}))return void r.window.showErrorMessage("Could not create the new workspace file. Check logs for details");t.setLocalPath(o.fsPath);const c=await r.window.showInformationMessage(`Workspace file created for ${t.name}. Would you like to open it now?`,{modal:!0},{title:"Open in New Window",location:W.Tc.NewWindow},{title:"Open in Current Window",location:W.Tc.CurrentWindow},{title:"Cancel",isCloseAffordance:!0});null!=c&&"Cancel"!=c.title&&this.openCodeWorkspaceFile(e,{location:c.location})}async chooseCodeWorkspaceAutoAddSetting(e){if(e?.current&&(null==r.workspace.workspaceFile||null==this._currentWorkspaceId||null==this._currentWorkspaceAutoAddSetting))return Dt.XU.Disabled;const t=e?.current?this._currentWorkspaceAutoAddSetting:Dt.XU.Disabled,i=[{label:"Add on Workspace (Window) Open",description:this._currentWorkspaceAutoAddSetting===Dt.XU.Enabled?"current":void 0,option:Dt.XU.Enabled},{label:"Prompt on Workspace (Window) Open",description:this._currentWorkspaceAutoAddSetting===Dt.XU.Prompt?"current":void 0,option:Dt.XU.Prompt},{label:"Never",description:this._currentWorkspaceAutoAddSetting===Dt.XU.Disabled?"current":void 0,option:Dt.XU.Disabled}],s=await r.window.showQuickPick(i,{placeHolder:"Choose the behavior of automatically adding missing repositories to the current VS Code workspace",title:"Linked Workspace: Automatically Add Repositories"});if(null==s?.option)return t;const n=s.option;if(e?.current&&null!=r.workspace.workspaceFile){if(!await this._workspacesPathProvider.updateCodeWorkspaceFileSettings(r.workspace.workspaceFile,{workspaceAutoAddSetting:n}))return this._currentWorkspaceAutoAddSetting;this._currentWorkspaceAutoAddSetting=n}return n}async openCodeWorkspaceFile(e,t){const i=this.getCloudWorkspace(e)??this.getLocalWorkspace(e);if(null==i)return;if(null==i.localPath){const t=await r.window.showInformationMessage(`The workspace file for ${i.name} has not been created. Would you like to create it now?`,{modal:!0},{title:"Create"},{title:"Cancel",isCloseAffordance:!0});if(null==t||"Cancel"==t.title)return;return void this.saveAsCodeWorkspaceFile(e)}let s=t?.location===W.Tc.CurrentWindow?W.Tc.CurrentWindow:W.Tc.NewWindow;if(!t?.location){const e=await r.window.showInformationMessage(`How would you like to open the workspace file for ${i.name}?`,{modal:!0},{title:"Open in New Window",location:W.Tc.NewWindow},{title:"Open in Current Window",location:W.Tc.CurrentWindow},{title:"Cancel",isCloseAffordance:!0});if(null==e||"Cancel"==e.title)return;s=e.location??W.Tc.NewWindow}if(!await this._workspacesPathProvider.confirmCloudWorkspaceCodeWorkspaceFilePath(i.id)){await this._workspacesPathProvider.removeCloudWorkspaceCodeWorkspaceFilePath(i.id),i.setLocalPath(void 0);const e=await r.window.showInformationMessage(`The workspace file for ${i.name} could not be found. Would you like to locate it now?`,{modal:!0},{title:"Locate"},{title:"Cancel",isCloseAffordance:!0});if("Locate"!==e?.title)return;const t=(await r.window.showOpenDialog({defaultUri:r.Uri.file(i.localPath),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{"Code Workspace":["code-workspace"]},title:"Locate the workspace file"}))?.[0]?.fsPath;if(null==t)return;await this._workspacesPathProvider.writeCloudWorkspaceCodeWorkspaceFilePathToMap(i.id,t),i.setLocalPath(t)}(0,W.ic)(r.Uri.file(i.localPath),{location:s})}async getMappedPathForCloudWorkspaceRepoDescriptor(e){let t=await this.getCloudWorkspaceRepoPath(e.workspaceId,e.id);return null==t&&(t=(await this.container.repositoryPathMapping.getLocalRepoPaths({remoteUrl:e.url,repoInfo:{repoName:e.name,provider:e.provider,owner:e.provider_organization_id}}))?.[0]),t}}function kt(e){if(null==e.provider?.owner)return;const t=e.provider.path.split("/").pop();return null!=t?{provider:e.provider.id.toLowerCase(),owner:e.provider.owner.toLowerCase(),repoName:t.toLowerCase(),url:e.provider.url({type:St.J.Repo})}:void 0}var _t=Object.defineProperty,Tt=Object.getOwnPropertyDescriptor,Ft=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Tt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&_t(t,i,n),n};class StatusBarController{constructor(e){this.container=e,this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this),R.D.onDidChange(this.onConfigurationChanged,this))}dispose(){this.clearBlame(),this._statusBarBlame?.dispose(),this._statusBarMode?.dispose(),this.container.lineTracker.unsubscribe(this),this._disposable.dispose()}onReady(){this.onConfigurationChanged()}onConfigurationChanged(e){if(R.D.changed(e,"mode")){const t=R.D.get("mode.statusBar.enabled")?this.container.mode:void 0;if(t?.statusBarItemName){const i="left"!==R.D.get("mode.statusBar.alignment")?r.StatusBarAlignment.Right:r.StatusBarAlignment.Left;R.D.changed(e,"mode.statusBar.alignment")&&this._statusBarMode?.alignment!==i&&(this._statusBarMode?.dispose(),this._statusBarMode=void 0),this._statusBarMode=this._statusBarMode??r.window.createStatusBarItem("gitlens.mode",i,i===r.StatusBarAlignment.Right?999:1),this._statusBarMode.name="GitLens Modes",this._statusBarMode.command=n.Gh.SwitchMode,this._statusBarMode.text=t.statusBarItemName,this._statusBarMode.tooltip=new r.MarkdownString(`**${t.statusBarItemName}** ${n.NE.Dash} ${t.description}\n\n---\n\nClick to Switch GitLens Modes`,!0),this._statusBarMode.accessibilityInformation={label:`GitLens Mode: ${t.statusBarItemName}\nClick to Switch GitLens Modes`},this._statusBarMode.show()}else this._statusBarMode?.dispose(),this._statusBarMode=void 0}if(R.D.changed(e,"statusBar"))if(R.D.get("statusBar.enabled")){const t="left"!==R.D.get("statusBar.alignment")?r.StatusBarAlignment.Right:r.StatusBarAlignment.Left;R.D.changed(e,"statusBar.alignment")&&this._statusBarBlame?.alignment!==t&&(this._statusBarBlame?.dispose(),this._statusBarBlame=void 0),this._statusBarBlame=this._statusBarBlame??r.window.createStatusBarItem("gitlens.blame",t,t===r.StatusBarAlignment.Right?1e3:0),this._statusBarBlame.name="GitLens Current Line Blame",this._statusBarBlame.command=R.D.get("statusBar.command"),R.D.changed(e,"statusBar.enabled")&&this.container.lineTracker.subscribe(this,this.container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged,this))}else R.D.changed(e,"statusBar.enabled")&&(this.container.lineTracker.unsubscribe(this),this._statusBarBlame?.dispose(),this._statusBarBlame=void 0)}onActiveLinesChanged(e){let t=!(R.D.get("statusBar.reduceFlicker")&&"selection"===e.reason&&(e.pending||null!=e.selections));if(!e.pending&&null!=e.selections){const i=this.container.lineTracker.getState(e.selections[0].active);if(null!=i?.commit)return void this.updateBlame(e.editor,i.commit);t=!0}t?this.clearBlame():null!=this._statusBarBlame&&(this._statusBarBlame.text=this._statusBarBlame.text.replace("$(git-commit)","$(watch)"))}clearBlame(){this._pullRequestCancellation?.cancel(),this._tooltipCancellation?.cancel(),this._statusBarBlame?.hide()}async updateBlame(e,t,i){const s=R.D.get("statusBar");if(!s.enabled||null==this._statusBarBlame||!(0,W.PH)(e))return;const o=(0,E.UH)(),a=s.pullRequests.enabled&&(ae.i.has(s.format,"pullRequest","pullRequestAgo","pullRequestAgoOrDate","pullRequestDate","pullRequestState")||ae.i.has(s.tooltipFormat,"pullRequest","pullRequestAgo","pullRequestAgoOrDate","pullRequestDate","pullRequestState")),[c,l]=await Promise.all([ae.i.has(s.format,"tips")||ae.i.has(s.tooltipFormat,"tips")?this.container.git.getBranchesAndTagsTipsFn(t.repoPath):void 0,a&&void 0===i?.pr?this.getPullRequest(t,{timeout:100}):i?.pr??void 0]);let h;switch(null!=l&&(this._pullRequestCancellation?.cancel(),this._pullRequestCancellation=new r.CancellationTokenSource,this.waitForPendingPullRequest(e,t,l,this._pullRequestCancellation.token,100,o)),this._statusBarBlame.text=`$(git-commit) ${ae.i.fromTemplate(s.format,t,{dateFormat:null===s.dateFormat?R.D.get("defaultDateFormat"):s.dateFormat,getBranchAndTagTips:c,messageTruncateAtNewLine:!0,pullRequestOrRemote:l,pullRequestPendingMessage:"PR $(watch)"})}`,s.command){case we.ef.CopyRemoteCommitUrl:h="Click to Copy Remote Commit URL";break;case we.ef.CopyRemoteFileUrl:this._statusBarBlame.command=n.Gh.CopyRemoteFileUrl,h="Click to Copy Remote File Revision URL";break;case we.ef.DiffWithPrevious:this._statusBarBlame.command=n.Gh.DiffLineWithPrevious,h="Click to Open Line Changes with Previous Revision";break;case we.ef.DiffWithWorking:this._statusBarBlame.command=n.Gh.DiffLineWithWorking,h="Click to Open Line Changes with Working File";break;case we.ef.OpenCommitOnRemote:h="Click to Open Commit on Remote";break;case we.ef.OpenFileOnRemote:h="Click to Open Revision on Remote";break;case we.ef.RevealCommitInView:h="Click to Reveal Commit in the Side Bar";break;case we.ef.ShowCommitsInView:h="Click to Search for Commit";break;case we.ef.ShowQuickCommitDetails:h="Click to Show Commit";break;case we.ef.ShowQuickCommitFileDetails:h="Click to Show Commit (file)";break;case we.ef.ShowQuickCurrentBranchHistory:h="Click to Show Branch History";break;case we.ef.ShowQuickFileHistory:h="Click to Show File History";break;case we.ef.ToggleCodeLens:h="Click to Toggle Git CodeLens";break;case we.ef.ToggleFileBlame:h="Click to Toggle File Blame";break;case we.ef.ToggleFileChanges:null!=t.file&&(this._statusBarBlame.command=(0,$e._N)({title:"Toggle File Changes",command:n.Gh.ToggleFileChanges,arguments:[t.file.uri,{type:we.VP.Changes,context:{sha:t.sha,only:!1,selection:!1}}]})),h="Click to Toggle File Changes";break;case we.ef.ToggleFileChangesOnly:null!=t.file&&(this._statusBarBlame.command=(0,$e._N)({title:"Toggle File Changes",command:n.Gh.ToggleFileChanges,arguments:[t.file.uri,{type:we.VP.Changes,context:{sha:t.sha,only:!0,selection:!1}}]})),h="Click to Toggle File Changes";break;case we.ef.ToggleFileHeatmap:h="Click to Toggle File Heatmap"}this._statusBarBlame.tooltip=h,this._statusBarBlame.accessibilityInformation={label:`${this._statusBarBlame.text}\n${h}`},null!=this._tooltipDelayTimer&&clearTimeout(this._tooltipDelayTimer),this._tooltipCancellation?.cancel(),this._tooltipDelayTimer=setTimeout((()=>{this._tooltipDelayTimer=void 0,this._tooltipCancellation=new r.CancellationTokenSource,this.updateCommitTooltip(this._statusBarBlame,t,h,c,{enabled:a||null!=l,pr:l},this._tooltipCancellation.token)}),500),this._statusBarBlame.show()}async getPullRequest(e,{timeout:t}={}){const i=await this.container.git.getBestRemoteWithRichProvider(e.repoPath);if(null==i?.provider)return;const{provider:r}=i;try{return await this.container.git.getPullRequestForCommit(e.ref,r,{timeout:t})}catch(e){return e instanceof O.PK?e:void 0}}async updateCommitTooltip(e,t,i,r,s,n){if(n.isCancellationRequested)return;const o=await(0,ce.nN)(t,t.getGitUri(),t.lines[0].line,{autolinks:!0,cancellationToken:n,dateFormat:R.D.get("defaultDateFormat"),format:R.D.get("statusBar.tooltipFormat"),getBranchAndTagTips:r,pullRequests:s});n.isCancellationRequested||(o.appendMarkdown(`\n\n---\n\n${i}`),e.tooltip=o,e.accessibilityInformation={label:`${e.text}\n${i}`})}async waitForPendingPullRequest(e,t,i,r,s,o){!r.isCancellationRequested&&i instanceof O.PK&&(F.Yd.debug(o,`${n.NE.Dot} pull request query took too long (over ${s} ms)`),i=await i.promise,r.isCancellationRequested||(F.Yd.debug(o,`${n.NE.Dot} pull request query completed; refreshing...`),this.updateBlame(e,t,{pr:i??null})))}}Ft([(0,_.fF)({args:{0:e=>`editor=${e.editor?.document.uri.toString(!0)}, selections=${e.selections?.map((e=>`[${e.anchor}-${e.active}]`)).join(",")}, pending=${Boolean(e.pending)}, reason=${e.reason}`}})],StatusBarController.prototype,"onActiveLinesChanged",1),Ft([(0,_.fF)({args:!1})],StatusBarController.prototype,"updateBlame",1);var Et=Object.defineProperty,$t=Object.getOwnPropertyDescriptor,Ot=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?$t(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Et(t,i,n),n};const xt=Object.create(null),It=[];class KeyboardScope{constructor(e){this._paused=!0,this._mapping=e;for(const e in this._mapping)this._mapping[e]=this._mapping[e]??xt;It.push(this._mapping)}async dispose(){const e=It.indexOf(this._mapping),t=(0,E.UH)();(0,E.lH)(t,` • index=${e}`),e===It.length-1?(It.pop(),await this.updateKeyCommandsContext(It[It.length-1])):It.splice(e,1)}get paused(){return this._paused}async clearKeyCommand(e){const t=(0,E.UH)(),i=It[It.length-1];i===this._mapping&&null!=i[e]?(i[e]=void 0,await(0,D.v)(`${n.m1}:key:${e}`,!1)):(0,E.lH)(t," • skipped")}async pause(e){if(this._paused)return;this._paused=!0;const t=Object.keys(this._mapping).reduce(((t,i)=>(t[i]=null==e||e.includes(i)?void 0:this._mapping[i],t)),Object.create(null));await this.updateKeyCommandsContext(t)}async resume(){this._paused&&(this._paused=!1,await this.updateKeyCommandsContext(this._mapping))}async start(){await this.resume()}async setKeyCommand(e,t){const i=(0,E.UH)(),r=It[It.length-1];if(r!==this._mapping)return void(0,E.lH)(i," • skipped");const s=Boolean(r[e]);r[e]=t,s||await(0,D.v)(`${n.m1}:key:${e}`,!0)}async updateKeyCommandsContext(e){await Promise.all(n.XP.map((t=>(0,D.v)(`${n.m1}:key:${t}`,Boolean(e?.[t])))))}}Ot([(0,_.cM)({args:!1,prefix:e=>`${e.prefix}[${It.length}]`})],KeyboardScope.prototype,"dispose",1),Ot([(0,_.cM)({args:!1,prefix:(e,t)=>`${e.prefix}[${It.length}](${t})`})],KeyboardScope.prototype,"clearKeyCommand",1),Ot([(0,_.cM)({args:!1,prefix:e=>`${e.prefix}(paused=${e.instance._paused})`})],KeyboardScope.prototype,"pause",1),Ot([(0,_.cM)({args:!1,prefix:e=>`${e.prefix}(paused=${e.instance._paused})`})],KeyboardScope.prototype,"resume",1),Ot([(0,_.cM)({args:!1,prefix:(e,t)=>`${e.prefix}[${It.length}](${t})`})],KeyboardScope.prototype,"setKeyCommand",1);class Keyboard{constructor(){const e=n.XP.map((e=>(0,$e.xR)(`${n.m1}.key.${e}`,(()=>this.execute(e)),this)));this._disposable=r.Disposable.from(...e)}dispose(){this._disposable.dispose()}createScope(e){return new KeyboardScope({...e})}async beginScope(e){const t=this.createScope(e);return await t.start(),t}async execute(e){const t=(0,E.UH)();if(It.length)try{let i=It[It.length-1][e];if("function"==typeof i&&(i=await i()),"function"!=typeof i?.onDidPressKey)return void(0,E.lH)(t," • skipped, no callback");await i.onDidPressKey(e)}catch(e){F.Yd.error(e,t)}else(0,E.lH)(t," • skipped, no mappings")}}Ot([(0,_.cM)({args:!1,prefix:(e,t)=>`${e.prefix}[${It.length}](${void 0===t?"":Object.keys(t).join(",")})`})],Keyboard.prototype,"createScope",1),Ot([(0,_.cM)({args:!1,prefix:(e,t)=>`${e.prefix}[${It.length}](${void 0===t?"":Object.keys(t).join(",")})`})],Keyboard.prototype,"beginScope",1),Ot([(0,_.cM)()],Keyboard.prototype,"execute",1);class TelemetryService{constructor(e){this.container=e,this._enabled=!1,this.globalAttributes=new Map,this.eventQueue=[],e.context.subscriptions.push(R.D.onDidChange((t=>{R.D.changed(t,"telemetry.enabled")&&this.ensureTelemetry(e)})),r.env.onDidChangeTelemetryEnabled((()=>this.ensureTelemetry(e)))),this.ensureTelemetry(e)}get enabled(){return this._enabled}dispose(){this.provider?.dispose(),this.provider=void 0}ensureTelemetry(e){if(this._enabled=r.env.isTelemetryEnabled&&R.D.get("telemetry.enabled",void 0,!0),!this._enabled)return null!=this._initializationTimer&&(clearTimeout(this._initializationTimer),this._initializationTimer=void 0),this.eventQueue.length=0,this.provider?.dispose(),void(this.provider=void 0);null==this._initializationTimer&&(this._initializationTimer=setTimeout((()=>this.initializeTelemetry(e)),7500))}async initializeTelemetry(e){if(null!=this._initializationTimer&&(clearTimeout(this._initializationTimer),this._initializationTimer=void 0),this.provider=new((await Promise.resolve().then(i.bind(i,5750))).OpenTelemetryProvider)({env:e.env,extensionId:e.id,extensionVersion:e.version,machineId:r.env.machineId,sessionId:r.env.sessionId,language:r.env.language,platform:(0,be.Xf)(),vscodeEdition:r.env.appName,vscodeHost:r.env.appHost,vscodeRemoteName:r.env.remoteName??"",vscodeShell:r.env.shell,vscodeUIKind:String(r.env.uiKind),vscodeVersion:r.version},(0,Z.Nx)(),e.debugging),this.eventQueue.length){const e=[...this.eventQueue];this.eventQueue.length=0;for(const{type:t,name:i,data:r,global:s}of e)"sendEvent"===t&&(this.provider.setGlobalAttributes(s),this.provider.sendEvent(i,Bt(r)))}this.provider.setGlobalAttributes(this.globalAttributes)}sendEvent(e,t,i,r){this._enabled&&(null!=this.provider?this.provider.sendEvent(e,Bt(t),i,r):this.eventQueue.push({type:"sendEvent",name:e,data:t,global:new Map([...this.globalAttributes]),startTime:i??Date.now(),endTime:r??Date.now()}))}startEvent(e,t,i){if(this._enabled){if(null!=this.provider){const r=this.provider.startEvent(e,Bt(t),i);return{dispose:()=>r?.end()}}return i=i??Date.now(),{dispose:()=>this.sendEvent(e,t,i,Date.now())}}}setGlobalAttribute(e,t){null==t?this.globalAttributes.delete(e):this.globalAttributes.set(e,t),this.provider?.setGlobalAttributes(this.globalAttributes)}setGlobalAttributes(e){for(const[t,i]of Object.entries(e))null==i?this.globalAttributes.delete(t):this.globalAttributes.set(t,i);this.provider?.setGlobalAttributes(this.globalAttributes)}deleteGlobalAttribute(e){this.globalAttributes.delete(e),this.provider?.setGlobalAttributes(this.globalAttributes)}}function Bt(e){if(null==e)return;const t=Object.create(null);for(const[i,r]of Object.entries(e))null!=r&&(t[i]=r);return t}class UsageTracker{constructor(e,t){this.container=e,this.storage=t,this._onDidChange=new r.EventEmitter}get onDidChange(){return this._onDidChange.event}dispose(){}get(e){return this.storage.get("usages")?.[e]}async reset(e){let t=this.storage.get("usages");if(null!=t){if(null==e)return await this.storage.delete("usages"),void this._onDidChange.fire(void 0);t=(0,lt.iC)(t,e,void 0),await this.storage.store("usages",t),this._onDidChange.fire({key:e,usage:void 0})}}async track(e){let t=this.storage.get("usages");null==t&&(t=Object.create(null));const i=Date.now();let r=t[e];null==r?(r={count:0,firstUsedAt:i,lastUsedAt:i},t[e]=r):(r.count!==Number.MAX_SAFE_INTEGER&&r.count++,r.lastUsedAt=i),this.container.telemetry.sendEvent("usage/track",{"usage.key":e,"usage.count":r.count}),await this.storage.store("usages",t),this._onDidChange.fire({key:e,usage:r})}}const Wt=/\b(g(?:it)?\b\s*)\b(branch|checkout|cherry-pick|fetch|grep|log|merge|pull|push|rebase|reset|revert|show|stash|status|tag)\b/gi,Lt=/\b((?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ,~^:?*[\\]+[^ ./])\b/gi,Mt=/^[0-9a-f]{7,40}\.\.\.?[0-9a-f]{7,40}$/,Ut=/^[0-9a-f]{7,40}$/;class GitTerminalLinkProvider{constructor(e){this.container=e,this.disposable=r.window.registerTerminalLinkProvider(this)}dispose(){this.disposable.dispose()}async provideTerminalLinks(e){if(0===e.line.trim().length)return[];const t=this.container.git.highlander?.path;if(!t)return[];const i=R.D.get("terminalLinks.showDetailsView"),r=[];let s,o;const a=new RegExp(Lt,Lt.flags),c=new RegExp(Wt,Wt.flags);let l;for(;;){if(l=c.exec(e.line),null!=l){const[e,t,i]=l,s={startIndex:l.index+t.length,length:i.length,tooltip:"Open in Git Command Palette",command:{command:n.Gh.GitCommands,args:{command:i}}};r.push(s)}if(l=a.exec(e.line),null==l)break;const[h,u]=l;if("HEAD"===u.toUpperCase()){const e={startIndex:l.index,length:u.length,tooltip:"Show HEAD",command:{command:n.Gh.ShowQuickBranchHistory,args:{branch:"HEAD",repoPath:t}}};r.push(e);continue}void 0===s&&(s=await this.container.git.getBranches(t));let p=s.values.find((e=>e.name===u));if(null==p&&(p=s.values.find((e=>(0,d.S3)(e.name)===u))),null!=p){const e={startIndex:l.index,length:u.length,tooltip:"Show Branch",command:{command:n.Gh.ShowQuickBranchHistory,args:{repoPath:t,branch:p.name}}};r.push(e);continue}void 0===o&&(o=await this.container.git.getTags(t));const m=o.values.find((e=>e.name===u));if(null==m){if(Ut.test(u)){if(await this.container.git.validateReference(t,u)){const e={startIndex:l.index,length:u.length,tooltip:"Show Commit",command:i?{command:n.Gh.ShowInDetailsView,args:{repoPath:t,refs:[u]}}:{command:n.Gh.ShowQuickCommit,args:{repoPath:t,sha:u}}};r.push(e)}}else if(Mt.test(u)){const e={startIndex:l.index,length:u.length,tooltip:"Show Commits",command:{command:n.Gh.GitCommands,args:{command:"log",state:{repo:t,reference:(0,v.xB)(u,t,{refType:"revision"})}}}};r.push(e)}}else{const e={startIndex:l.index,length:u.length,tooltip:"Show Tag",command:{command:n.Gh.ShowQuickBranchHistory,args:{repoPath:t,tag:m.name}}};r.push(e)}}return r}handleTerminalLink(e){r.commands.executeCommand(e.command.command,e.command.args)}}var Nt=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,Ht=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Gt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Nt(t,i,n),n};const Vt=class{constructor(){this._onDidChangeActiveLines=new r.EventEmitter,this._state=new Map,this._subscriptions=new Map,this._suspended=!1}get onDidChangeActiveLines(){return this._onDidChangeActiveLines.event}dispose(){for(const e of this._subscriptions.keys())this.unsubscribe(e)}onActiveTextEditorChanged(e){e!==this._editor&&(null==e||(0,W.PH)(e))&&(this.reset(),this._editor=e,this._selections=Vt.toLineSelections(e?.selections),this.trigger("editor"))}onTextEditorSelectionChanged(e){if(this._editor!==e.textEditor&&!(0,W.PH)(e.textEditor))return;const t=Vt.toLineSelections(e.selections);this._editor===e.textEditor&&this.includes(t)||(this.reset(),this._editor=e.textEditor,this._selections=t,this.trigger(this._editor===e.textEditor?"selection":"editor"))}getState(e){return this._state.get(e)}setState(e,t){this._state.set(e,t)}get selections(){return this._selections}includes(e,t){if("number"!=typeof e)return Vt.includes(e,this._selections);if(null==this._selections||0===this._selections.length)return!1;const i=e,r=t?.activeOnly??!0;for(const e of this._selections)if(i===e.active||!r&&(e.anchor>=i&&i>=e.active||e.active>=i&&i>=e.anchor))return!0;return!1}refresh(){this.trigger("editor")}reset(){this._state.clear()}subscribed(e){return this._subscriptions.has(e)}subscribe(e,t){const i=(0,E.UH)(),s={dispose:()=>this.unsubscribe(e)},n=0===this._subscriptions.size;let o=this._subscriptions.get(e);return null==o?(o=[t],this._subscriptions.set(e,o)):o.push(t),n&&(F.Yd.debug(i,"Starting line tracker..."),this._disposable=r.Disposable.from(r.window.onDidChangeActiveTextEditor((0,B.Ds)(this.onActiveTextEditorChanged,0),this),r.window.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged,this),this.onStart?.()??{dispose:()=>{}}),queueMicrotask((()=>this.onActiveTextEditorChanged(r.window.activeTextEditor)))),s}unsubscribe(e){const t=this._subscriptions.get(e);if(null!=t){this._subscriptions.delete(e);for(const e of t)e.dispose();0===this._subscriptions.size&&(null!=this._linesChangedDebounced&&this._linesChangedDebounced.cancel(),this._disposable?.dispose(),this._disposable=void 0)}}get suspended(){return this._suspended}resume(e){(e?.force||this._suspended)&&(this._suspended=!1,this.onResume?.(),this.trigger("editor"))}suspend(e){!e?.force&&this._suspended||(this._suspended=!0,this.onSuspend?.(),this.trigger("editor"))}fireLinesChanged(e){this._onDidChangeActiveLines.fire(e)}trigger(e){this.onLinesChanged({editor:this._editor,selections:this.selections,reason:e})}onLinesChanged(e){null!=e.selections?(null==this._linesChangedDebounced&&(this._linesChangedDebounced=(0,B.Ds)((e=>{e.editor===r.window.activeTextEditor&&Vt.includes(e.selections,Vt.toLineSelections(e.editor?.selections))&&this.fireLinesChanged(e)}),250)),this._linesChangedDebounced.pending?.()||this.fireLinesChanged({...e,pending:!0}),this._linesChangedDebounced(e)):queueMicrotask((()=>{e.editor===r.window.activeTextEditor&&(null!=this._linesChangedDebounced&&this._linesChangedDebounced.cancel(),this.fireLinesChanged(e))}))}static includes(e,t){if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;let i;return e.every(((e,r)=>(i=t[r],e.active===i.active&&e.anchor===i.anchor)))}static toLineSelections(e){return e?.map((e=>({active:e.active.line,anchor:e.anchor.line})))}};let qt=Vt;Ht([(0,_.fF)({args:!1})],qt.prototype,"subscribe",1),Ht([(0,_.fF)({args:!1})],qt.prototype,"unsubscribe",1),Ht([(0,_.fF)()],qt.prototype,"resume",1),Ht([(0,_.fF)()],qt.prototype,"suspend",1);var Qt=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,jt=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Yt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Qt(t,i,n),n};class GitLineState{constructor(e){this.commit=e,null!=e&&e.file}}class GitLineTracker extends qt{constructor(e){super(),this.container=e}async fireLinesChanged(e){this.reset();let t=!1;this.suspended||e.pending||null==e.selections||null==e.editor||(t=await this.updateState(e.selections,e.editor)),super.fireLinesChanged(t?e:{...e,selections:void 0})}onStart(){return this.onResume(),r.Disposable.from({dispose:()=>this.onSuspend()},this.container.tracker.onDidChangeBlameState(this.onBlameStateChanged,this),this.container.tracker.onDidChangeDirtyState(this.onDirtyStateChanged,this),this.container.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered,this))}onResume(){null==this._subscriptionOnlyWhenActive&&(this._subscriptionOnlyWhenActive=this.container.tracker.onDidChangeContent(this.onContentChanged,this))}onSuspend(){this._subscriptionOnlyWhenActive?.dispose(),this._subscriptionOnlyWhenActive=void 0}onBlameStateChanged(e){this.trigger("editor")}onContentChanged(e){e.contentChanges.some((e=>this.selections?.some((t=>e.range.end.line>=t.active&&t.active>=e.range.start.line||e.range.start.line>=t.active&&t.active>=e.range.end.line))))&&this.trigger("editor")}onDirtyIdleTriggered(e){const t=R.D.get("advanced.blame.sizeThresholdAfterEdit");t>0&&e.document.lineCount>t||this.resume()}onDirtyStateChanged(e){e.dirty?this.suspend():this.resume({force:!0})}async updateState(e,t){const i=(0,E.UH)();if(!this.includes(e))return(0,E.lH)(i,` ${n.NE.Dot} lines no longer match`),!1;const r=await this.container.tracker.getOrAdd(t.document);if(!r.isBlameable)return(0,E.lH)(i,` ${n.NE.Dot} document is not blameable`),!1;if(1===e.length){const s=await this.container.git.getBlameForLine(r.uri,e[0].active,t?.document);if(null==s)return(0,E.lH)(i,` ${n.NE.Dot} blame failed`),!1;this.setState(s.line.line-1,new GitLineState(s.commit))}else{const s=await this.container.git.getBlame(r.uri,t.document);if(null==s)return(0,E.lH)(i,` ${n.NE.Dot} blame failed`),!1;for(const t of e){const e=s.lines[t.active];this.setState(t.active,new GitLineState(s.commits.get(e.sha)))}}return this.includes(e)?r.isBlameable?(t.document.isDirty&&r.setForceDirtyStateChangeOnNextDocumentChange(),!0):((0,E.lH)(i,` ${n.NE.Dot} document is not blameable`),!1):((0,E.lH)(i,` ${n.NE.Dot} lines no longer match`),!1)}}jt([(0,_.fF)({args:{0:e=>`editor=${e.editor.document.uri.toString(!0)}, doc=${e.document.uri.toString(!0)}, blameable=${e.blameable}`}})],GitLineTracker.prototype,"onBlameStateChanged",1),jt([(0,_.fF)({args:{0:e=>`editor=${e.editor.document.uri.toString(!0)}, doc=${e.document.uri.toString(!0)}`}})],GitLineTracker.prototype,"onContentChanged",1),jt([(0,_.fF)({args:{0:e=>`editor=${e.editor.document.uri.toString(!0)}, doc=${e.document.uri.toString(!0)}`}})],GitLineTracker.prototype,"onDirtyIdleTriggered",1),jt([(0,_.fF)({args:{0:e=>`editor=${e.editor.document.uri.toString(!0)}, doc=${e.document.uri.toString(!0)}, dirty=${e.dirty}`}})],GitLineTracker.prototype,"onDirtyStateChanged",1),jt([(0,_.fF)({args:{0:e=>e?.map((e=>e.active)).join(","),1:e=>e.document.uri.toString(!0)},exit:!0})],GitLineTracker.prototype,"updateState",1);var zt=i(4794),Kt=i(4043);class DeepLinkService{constructor(e){this.container=e,this._disposables=[],this._context={state:Kt.mg.Idle},this._onDeepLinkProgressUpdated=new r.EventEmitter,this._disposables.push(e.uri.onDidReceiveUri((async e=>{const t=(0,Kt.lX)(e);if(null!=t&&this._context.state===Kt.mg.Idle){if(!t.type||!t.repoId&&!t.remoteUrl&&!t.repoPath)return r.window.showErrorMessage("Unable to resolve link"),void F.Yd.warn(`Unable to resolve link - missing basic properties: ${e.toString()}`);if(!Object.values(Kt._n).includes(t.type))return r.window.showErrorMessage("Unable to resolve link"),void F.Yd.warn(`Unable to resolve link - unknown link type: ${e.toString()}`);if(t.type!==Kt._n.Repository&&null==t.targetId)return r.window.showErrorMessage("Unable to resolve link"),void F.Yd.warn(`Unable to resolve link - no target id provided: ${e.toString()}`);if(t.type===Kt._n.Comparison&&null==t.secondaryTargetId)return r.window.showErrorMessage("Unable to resolve link"),void F.Yd.warn(`Unable to resolve link - no secondary target id provided: ${e.toString()}`);this.setContextFromDeepLink(t,e.toString()),await this.processDeepLink()}})));const t=this.container.storage.get("deepLinks:pending");null!=t&&(this.container.storage.delete("deepLinks:pending"),this.processPendingDeepLink(t))}dispose(){r.Disposable.from(...this._disposables).dispose()}resetContext(){this._context={state:Kt.mg.Idle,url:void 0,repoId:void 0,repo:void 0,remoteUrl:void 0,remote:void 0,repoPath:void 0,targetId:void 0,secondaryTargetId:void 0,targetType:void 0,targetSha:void 0}}setContextFromDeepLink(e,t){this._context={...this._context,repoId:e.repoId,targetType:e.type,url:t,remoteUrl:e.remoteUrl,repoPath:e.repoPath,targetId:e.targetId,secondaryTargetId:e.secondaryTargetId}}async processPendingDeepLink(e){if(null==e.url)return;const t=(0,Kt.lX)(r.Uri.parse(e.url));if(null==t)return;this._context={state:Kt.mg.CloneOrAddRepo},this.setContextFromDeepLink(t,e.url);let i=Kt.WA.OpenRepo;if(null!=e.repoPath){const t=r.Uri.parse(e.repoPath);try{const e=await this.container.git.getOrOpenRepository(t,{detectNested:!1});null!=e&&(this._context.repo=e,i=Kt.WA.RepoOpened)}catch{}}queueMicrotask((()=>{this.processDeepLink(i)}))}async getShaForBranch(e){const{repo:t,remote:i}=this._context;if(!t)return;const r=null!=i?`${i.name}/${e}`:e;let s=await t.getBranch(r);return null!=s?.sha?s.sha:(s=await t.getBranch(e),null!=s?.sha?s.sha:void 0)}async getShaForTag(e){const{repo:t}=this._context;if(!t)return;const i=await t.getTag(e);return null!=i?.sha?i.sha:void 0}async getShaForCommit(e){const{repo:t}=this._context;if(t)return await this.container.git.validateReference(t.path,e)?e:void 0}async getRefsForComparison(e,t){const i=await this.validateComparisonRef(e)?e:void 0;if(null==i)return;const r=await this.validateComparisonRef(t)?t:void 0;return null!=r?[i,r]:void 0}async validateComparisonRef(e){if(""===e)return!0;if((0,v.D3)(e))return null!=await this.getShaForCommit(e);const t=e.toLocaleLowerCase();if(!t.startsWith("refs/tags/")&&!t.startsWith("tags/")){if(null!=await this.getShaForBranch(e))return!0}if(null!=await this.getShaForTag(e))return!0;return null!=await this.getShaForCommit(e)}async getShasForTargets(){const{repo:e,targetType:t,targetId:i,secondaryTargetId:r}=this._context;if(null!=e&&t!==Kt._n.Repository&&null!=i){if(t===Kt._n.Branch)return this.getShaForBranch(i);if(t===Kt._n.Tag)return this.getShaForTag(i);if(t===Kt._n.Commit)return this.getShaForCommit(i);if(t===Kt._n.Comparison){if(null==r)return;return this.getRefsForComparison(i,r)}}}async showOpenTypePrompt(){const e=[{title:"Open Folder",action:Kt.HP.Folder},{title:"Open Workspace",action:Kt.HP.Workspace}];null!=this._context.remoteUrl&&e.push({title:"Clone",action:Kt.HP.Clone}),e.push({title:"Cancel",isCloseAffordance:!0});const t=await r.window.showInformationMessage("No matching repository found. Please choose an option.",{modal:!0},...e);return t?.action}async showOpenLocationPrompt(e){const t=[{title:"Open",action:W.Tc.CurrentWindow},{title:"Open in New Window",action:W.Tc.NewWindow}];e!==Kt.HP.Workspace&&t.push({title:"Add to Workspace",action:W.Tc.AddToWorkspace}),t.push({title:"Cancel",isCloseAffordance:!0});const i=await r.window.showInformationMessage(`Please choose an option to open the repository ${e===Kt.HP.Clone?"after cloning":e}.`,{modal:!0},...t);return i?.action}async showFetchPrompt(){const e=await r.window.showInformationMessage("The link target(s) couldn't be found. Would you like to fetch from the remote?",{modal:!0},{title:"Fetch",action:!0},{title:"Cancel",isCloseAffordance:!0});return e?.action||!1}async showAddRemotePrompt(e,t){let i;const s=await r.window.showInformationMessage(`Unable to find a remote for '${e}'. Would you like to add a new remote?`,{modal:!0},{title:"Yes"},{title:"No",isCloseAffordance:!0});return"Yes"!==s?.title||(i=await r.window.showInputBox({prompt:"Enter a name for the remote",validateInput:e=>e?t.includes(e)?"A remote with that name already exists":void 0:"A name is required"})),i}async processDeepLink(e=Kt.WA.DeepLinkEventFired){let t,i,s,o,a,c="",l=e,h=[],u="",d="";for(queueMicrotask((()=>{r.window.withProgress({cancellable:!0,location:r.ProgressLocation.Notification,title:`Opening repository for link: ${this._context.url}}`},((e,t)=>(e.report({increment:0}),new Promise((i=>{t.onCancellationRequested((()=>{queueMicrotask((()=>this.processDeepLink(Kt.WA.DeepLinkCancelled))),i()})),this._disposables.push(this._onDeepLinkProgressUpdated.event((({message:t,increment:r})=>{e.report({message:t,increment:r}),100===r&&i()})))})))))}));;){this._context.state=Kt.eT[this._context.state][l];const{state:e,repoId:p,repo:m,url:g,remoteUrl:f,remote:w,repoPath:y,targetSha:b,secondaryTargetSha:C,targetType:A}=this._context;switch(this._onDeepLinkProgressUpdated.fire(Kt.gn[e]),e){case Kt.mg.Idle:return l===Kt.WA.DeepLinkErrored&&(r.window.showErrorMessage("Unable to resolve link"),F.Yd.warn(`Unable to resolve link - ${c}: ${g}`)),void this.resetContext();case Kt.mg.RepoMatch:case Kt.mg.AddedRepoMatch:if(!p&&!f&&!y){l=Kt.WA.DeepLinkErrored,c="No repository id, remote url or path was provided.";break}null!=f&&([,u,d]=(0,zt.Sk)(f));for(const e of this.container.git.repositories){if(null!=y&&(0,$.AH)(e.path.toLowerCase())===(0,$.AH)(y.toLowerCase())){this._context.repo=e,l=Kt.WA.RepoMatchedWithPath;break}if(null!=u&&null!=d&&(h=await e.getRemotes({filter:e=>e.matches(u,d)}),h.length>0)){this._context.repo=e,this._context.remote=h[0],l=Kt.WA.RepoMatchedWithRemoteUrl;break}if(null!=p&&"-"!==p&&await this.container.git.validateReference(e.path,p)){this._context.repo=e,l=Kt.WA.RepoMatchedWithId;break}}this._context.repo||(e===Kt.mg.RepoMatch?l=Kt.WA.RepoMatchFailed:(l=Kt.WA.DeepLinkErrored,c="No matching repository found."));break;case Kt.mg.CloneOrAddRepo:if(!p&&!f&&!y){l=Kt.WA.DeepLinkErrored,c="Missing repository id, remote url and path.";break}if(i=await this.showOpenTypePrompt(),!i){l=Kt.WA.DeepLinkCancelled;break}if(s=await this.showOpenLocationPrompt(i),!s){l=Kt.WA.DeepLinkCancelled;break}if(o=(await r.window.showOpenDialog({title:`Choose a ${i===Kt.HP.Workspace?"workspace":"folder"} to ${i===Kt.HP.Clone?"clone the repository to":"open the repository"}`,canSelectFiles:i===Kt.HP.Workspace,canSelectFolders:i!==Kt.HP.Workspace,canSelectMany:!1,...i===Kt.HP.Workspace&&{filters:{Workspaces:["code-workspace"]}}}))?.[0],!o){l=Kt.WA.DeepLinkCancelled;break}if(null!=o&&null!=f&&i===Kt.HP.Clone){try{a=await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Cloning repository for link: ${this._context.url}}`},(async()=>this.container.git.clone(f,o?.fsPath??"")))}catch{l=Kt.WA.DeepLinkErrored,c="Unable to clone repository";break}if(!a){l=Kt.WA.DeepLinkErrored,c="Unable to clone repository";break}o=r.Uri.file(a)}s===W.Tc.AddToWorkspace&&(r.workspace.workspaceFolders?.length||0)>1?l=Kt.WA.OpenRepo:(await this.container.storage.store("deepLinks:pending",{url:this._context.url,repoPath:o.toString()}),l=Kt.WA.DeepLinkStored),(0,W.ic)(o,{location:s});break;case Kt.mg.OpeningRepo:return void this._disposables.push((0,I.IH)(this.container.git.onDidChangeRepositories)((()=>{queueMicrotask((()=>this.processDeepLink(Kt.WA.RepoAdded)))})));case Kt.mg.RemoteMatch:if(!m||!f){l=Kt.WA.DeepLinkErrored,c="Missing repository or remote url.";break}if(h=await m.getRemotes({filter:e=>e.url===f}),h.length>0){this._context.remote=h[0],l=Kt.WA.RemoteMatched;break}this._context.remote||(l=Kt.WA.RemoteMatchFailed);break;case Kt.mg.AddRemote:if(!m||!f){l=Kt.WA.DeepLinkErrored,c="Missing repository or remote url.";break}if(t=await this.showAddRemotePrompt(f,(await m.getRemotes()).map((e=>e.name))),!t){l=Kt.WA.DeepLinkCancelled;break}try{await m.addRemote(t,f,{fetch:!0})}catch{l=Kt.WA.DeepLinkErrored,c="Failed to add remote.";break}if([this._context.remote]=await m.getRemotes({filter:e=>e.url===f}),!this._context.remote){l=Kt.WA.DeepLinkErrored,c="Failed to add remote.";break}l=Kt.WA.RemoteAdded;break;case Kt.mg.TargetMatch:case Kt.mg.FetchedTargetMatch:if(!m||!A){l=Kt.WA.DeepLinkErrored,c="Missing repository or target type.";break}if(A===Kt._n.Repository){l=Kt.WA.TargetMatched;break}if(A===Kt._n.Comparison?[this._context.targetSha,this._context.secondaryTargetSha]=await this.getShasForTargets()??[]:this._context.targetSha=await this.getShasForTargets(),null==this._context.targetSha||null==this._context.secondaryTargetSha&&A===Kt._n.Comparison){e===Kt.mg.TargetMatch&&null!=w?l=Kt.WA.TargetMatchFailed:(l=Kt.WA.DeepLinkErrored,c=`No matching ${null==b?"target":"secondary target"} found.`);break}l=A===Kt._n.Comparison?Kt.WA.TargetsMatched:Kt.WA.TargetMatched;break;case Kt.mg.Fetch:if(!m||!w){l=Kt.WA.DeepLinkErrored,c="Missing repository or remote.";break}if(!await this.showFetchPrompt()){l=Kt.WA.DeepLinkCancelled;break}try{await m.fetch({remote:w.name,progress:!0})}catch{l=Kt.WA.DeepLinkErrored,c="Error fetching remote.";break}l=Kt.WA.TargetFetched;break;case Kt.mg.OpenGraph:if(!m||!A){l=Kt.WA.DeepLinkErrored,c="Missing repository or target type.";break}if(A===Kt._n.Repository){await(0,$e.P0)(n.Gh.ShowInCommitGraph,m),l=Kt.WA.DeepLinkResolved;break}if(!b){l=Kt.WA.DeepLinkErrored,c=`Cannot find target ${A} in repo.`;break}await(0,$e.P0)(n.Gh.ShowInCommitGraph,{ref:(0,v.xB)(b,m.path)}),l=Kt.WA.DeepLinkResolved;break;case Kt.mg.OpenComparison:if(!m){l=Kt.WA.DeepLinkErrored,c="Missing repository.";break}if(null==b||null==C){l=Kt.WA.DeepLinkErrored,c="Missing target or secondary target.";break}await this.container.searchAndCompareView.compare(m.path,""===C||(0,v.D3)(C)?C:{label:C,ref:C},""===b||(0,v.D3)(b)?b:{label:b,ref:b}),l=Kt.WA.DeepLinkResolved;break;default:l=Kt.WA.DeepLinkErrored,c="Unknown state."}}}async copyDeepLinkUrl(e,t,i,s){const n=await("string"==typeof e?this.generateDeepLinkUrl(e,t,i,s):this.generateDeepLinkUrl(e,t));await r.env.clipboard.writeText(n.toString())}async generateDeepLinkUrl(e,t,i,s){const n="string"!=typeof e?e.repoPath:e;let o,a,c,l;try{o=await this.container.git.getUniqueRepositoryId(n)}catch{o="-"}if("string"!=typeof e)switch(e.refType){case"branch":a=Kt._n.Branch,c=e.remote?(0,d.S3)(e.name):e.name;break;case"revision":a=Kt._n.Commit,c=e.ref;break;case"tag":a=Kt._n.Tag,c=e.name}null!=i&&null!=s&&(a=Kt._n.Comparison,c=i.label??i.ref,l=s.label??s.ref);const h=R.D.get("deepLinks.schemeOverride"),u=h?!0===h?r.env.uriScheme:h:"vscode";let p;p=a===Kt._n.Comparison?`/${a}/${l}...${c}`:null!=a&&a!==Kt._n.Repository?`/${a}/${c}`:"";const m=new URL(`${u}://${this.container.context.extension.id}/${Kt.I$.DeepLink}/${Kt._n.Repository}/${o}${p}`);m.searchParams.set("url",t);return(new URLSearchParams).set("url",t),m}}var Jt=Object.defineProperty,Xt=Object.getOwnPropertyDescriptor;class UriService{constructor(e){this.container=e,this._onDidReceiveAuthenticationUri=new r.EventEmitter,this._onDidReceiveUri=new r.EventEmitter,this._disposable=r.window.registerUriHandler(this)}get onDidReceiveAuthenticationUri(){return this._onDidReceiveAuthenticationUri.event}get onDidReceiveUri(){return this._onDidReceiveUri.event}dispose(){this._disposable.dispose()}handleUri(e){const[,t]=e.path.split("/");t!==ot?this._onDidReceiveUri.fire(e):this._onDidReceiveAuthenticationUri.fire(e)}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Xt(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&Jt(t,i,n)})([(0,_.cM)({args:{0:e=>e.with({query:""}).toString(!0)}})],UriService.prototype,"handleUri",1);var Zt=i(3608),ei=i(7382),ti=i(4004),ii=i(6922),ri=i(5517),si=i(5688),ni=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,ai=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?oi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ni(t,i,n),n};class BranchesRepositoryNode extends ii.vb{async getChildren(){return null==this.child&&(this.child=new Zt.r(this.uri,this.view,this,this.repo)),this.child.getChildren()}changed(e){return e.changed(b.I6.Config,b.I6.Heads,b.I6.Index,b.I6.Remotes,b.I6.RemoteProviders,b.I6.Status,b.I6.Unknown,b.du.Any)}}class BranchesViewNode extends ii.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No branches could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new BranchesRepositoryNode(u.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.repo.getBranches({filter:e=>!e.remote});return 0===t.values.length?(this.view.message="No branches could be found.",this.view.title="Branches",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Branches (${t.values.length})`,e.getChildren())}return this.view.title="Branches",this.children}getTreeItem(){return new r.TreeItem("Branches",r.TreeItemCollapsibleState.Expanded)}}class BranchesView extends ri._{constructor(e){super(e,"branches","Branches","branchesView"),this.configKey="branches"}get canReveal(){return this.config.reveal||!R.D.get("views.repositories.showBranches")}getRoot(){return new BranchesViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("branches"),this.refresh(!0))),this),(0,si.i)(this.getQualifiedCommand("setLayoutToList"),(()=>this.setLayout(we.CZ.List)),this),(0,si.i)(this.getQualifiedCommand("setLayoutToTree"),(()=>this.setLayout(we.CZ.Tree)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(we.Vc.Auto)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(we.Vc.List)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(we.Vc.Tree)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchComparisonOn"),(()=>this.setShowBranchComparison(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchComparisonOff"),(()=>this.setShowBranchComparison(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchPullRequestOn"),(()=>this.setShowBranchPullRequest(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchPullRequestOff"),(()=>this.setShowBranchPullRequest(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat")||R.D.changed(e,"sortBranchesBy"))}findBranch(e,t){if(e.remote)return;const{repoPath:i}=e;return this.findNode((t=>t.branch?.ref===e.ref),{allowPaging:!0,maxDepth:4,canTraverse:e=>e instanceof BranchesViewNode||(e instanceof BranchesRepositoryNode||e instanceof ti.n)&&e.repoPath===i,token:t})}async findCommit(e,t){const{repoPath:i}=e,r=await this.container.git.getCommitBranches(e.repoPath,e.ref,(0,p.f_)(e)?{commitDate:e.committer.date}:void 0);if(0!==r.length)return this.findNode((t=>t.commit?.ref===e.ref),{allowPaging:!0,maxDepth:5,canTraverse:async t=>t instanceof BranchesViewNode||(t instanceof BranchesRepositoryNode||t instanceof ti.n?t.repoPath===i:!!(t instanceof ei.E&&t.repoPath===i&&r.includes(t.branch.name))&&(await t.loadMore({until:e.ref}),!0)),token:t})}revealBranch(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,v.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findBranch(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealCommit(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,v.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findCommit(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof ii.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof BranchesViewNode||e instanceof ii.vb});return void 0!==i&&await this.reveal(i,t),i}setLayout(e){return R.D.updateEffective(`views.${this.configKey}.branches.layout`,e)}setFilesLayout(e){return R.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAvatars(e){return R.D.updateEffective(`views.${this.configKey}.avatars`,e)}setShowBranchComparison(e){return R.D.updateEffective(`views.${this.configKey}.showBranchComparison`,!!e&&we.DH.Branch)}async setShowBranchPullRequest(e){await R.D.updateEffective(`views.${this.configKey}.pullRequests.showForBranches`,e),await R.D.updateEffective(`views.${this.configKey}.pullRequests.enabled`,e)}}ai([(0,k.H)((()=>""))],BranchesView.prototype,"revealBranch",1),ai([(0,k.H)((()=>""))],BranchesView.prototype,"revealCommit",1),ai([(0,k.H)((()=>""))],BranchesView.prototype,"revealRepository",1);var ci=i(9354),li=i(2601),hi=i(2925),ui=i(21),di=i(9719),pi=Object.defineProperty,mi=Object.getOwnPropertyDescriptor,gi=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?mi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&pi(t,i,n),n};class CommitsRepositoryNode extends ii.vb{async getChildren(){if(null==this.child){const e=await this.repo.getBranch();if(null==e)return this.view.message="No commits could be found.",[];let t;if(this.view.message=void 0,this.view.state.myCommitsOnly){const e=await this.view.container.git.getCurrentUser(this.repo.path);null!=e&&(t=[{name:e.name,email:e.email,username:e.username,id:e.id}])}this.child=new ei.E(this.uri,this.view,this.splatted?this.parent??this:this,this.repo,e,!0,{expanded:!0,limitCommits:!this.splatted,showComparison:this.view.config.showBranchComparison,showCurrent:!1,showTracking:!0,authors:t})}return this.child.getChildren()}async refresh(e=!1){e?this.child=void 0:this.parent?.triggerChange(!1),await this.ensureSubscription()}async subscribe(){const e=await(this.repo?.getLastFetched())??0,t=b._j.getLastFetchedUpdateInterval(e);return 0!==e&&t>0?r.Disposable.from(await super.subscribe(),(0,B.DH)((()=>{t!==b._j.getLastFetchedUpdateInterval(e)&&this.resetSubscription(),this.splatted?this.view.triggerNodeChange(this.parent??this):this.view.triggerNodeChange(this)}),t)):super.subscribe()}changed(e){return e.changed(b.I6.Config,b.I6.Heads,b.I6.Index,b.I6.Remotes,b.I6.RemoteProviders,b.I6.Status,b.I6.Unknown,b.du.Any)}}gi([(0,k.H)(),(0,_.fF)()],CommitsRepositoryNode.prototype,"refresh",1),gi([(0,_.fF)()],CommitsRepositoryNode.prototype,"subscribe",1);class CommitsViewNode extends ii.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No commits could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new CommitsRepositoryNode(u.YY.fromRepoPath(e.path),this.view,this,e,t,{showBranchAndLastFetched:!0})))}const e=R.D.get("plusFeatures.enabled")&&null==this.view.container.usage.get("graphWebview:shown")?new ui.$h(this.view,this,(0,$e.fA)(n.Gh.ShowGraph,"Show Commit Graph"),"Visualize commits on the Commit Graph ✨",void 0,"Visualize commits on the Commit Graph ✨",new r.ThemeIcon("gitlens-graph")):void 0;if(1===this.children.length){const[t]=this.children,i=await t.repo.getBranch();if(null!=i){const e=await t.repo.getLastFetched()??0,r=i.getTrackingStatus();this.view.description=`${r?`${r} ${n.NE.Dot} `:""}${i.name}${i.rebasing?" (Rebasing)":""}${e?` ${n.NE.Dot} Last fetched ${b._j.formatLastFetched(e)}`:""}`}return null==e?t.getChildren():[e,...await t.getChildren()]}return null==e?this.children:[e,...this.children]}getTreeItem(){return new r.TreeItem("Commits",r.TreeItemCollapsibleState.Expanded)}}class CommitsView extends ri._{constructor(e){super(e,"commits","Commits","commitsView"),this.configKey="commits",this._state={},this.disposables.push(e.usage.onDidChange(this.onUsageChanged,this))}onUsageChanged(e){null!=e&&"graphWebview:shown"!==e.key||this.refresh()}get canReveal(){return this.config.reveal||!R.D.get("views.repositories.showCommits")}get state(){return this._state}getRoot(){return new CommitsViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("branches","status","tags"),this.refresh(!0))),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(we.Vc.Auto)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(we.Vc.List)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(we.Vc.Tree)),this),(0,si.i)(this.getQualifiedCommand("setMyCommitsOnlyOn"),(()=>this.setMyCommitsOnly(!0)),this),(0,si.i)(this.getQualifiedCommand("setMyCommitsOnlyOff"),(()=>this.setMyCommitsOnly(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchComparisonOn"),(()=>this.setShowBranchComparison(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchComparisonOff"),(()=>this.setShowBranchComparison(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchPullRequestOn"),(()=>this.setShowBranchPullRequest(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowBranchPullRequestOff"),(()=>this.setShowBranchPullRequest(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat")||R.D.changed(e,"plusFeatures.enabled"))}onSelectionChanged(e){super.onSelectionChanged(e),this.notifySelections()}onVisibilityChanged(e){super.onVisibilityChanged(e),e.visible&&this.notifySelections()}notifySelections(){const e=this.selection?.[0];null!=e&&((e instanceof hi.D||e instanceof di.m||e instanceof li.R)&&this.container.events.fire("commit:selected",{commit:e.commit,interaction:"passive",preserveFocus:!0,preserveVisibility:!0},{source:this.id}),(e instanceof di.m||e instanceof li.R)&&this.container.events.fire("file:selected",{uri:e.uri,preserveFocus:!0,preserveVisibility:!0},{source:this.id}))}async findCommit(e,t){const{repoPath:i}=e,r=await this.container.git.getBranch(e.repoPath);if(null==r)return;return(await this.container.git.getCommitBranches(e.repoPath,e.ref,{branch:r.name,commitDate:(0,p.f_)(e)?e.committer.date:void 0})).length?this.findNode((t=>t.commit?.ref===e.ref),{allowPaging:!0,maxDepth:2,canTraverse:async t=>{if(t instanceof CommitsViewNode){let i=await(t.getSplattedChild?.());return i instanceof CommitsRepositoryNode&&(i=await(i.getSplattedChild?.()),i instanceof ei.E&&await i.loadMore({until:e.ref})),!0}if(t instanceof CommitsRepositoryNode&&t.repoPath===i){const i=await(t.getSplattedChild?.());if(i instanceof ei.E)return await i.loadMore({until:e.ref}),!0}return t instanceof ci.V&&t.repoPath===i},token:t}):void 0}async revealCommit(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,v.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findCommit(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof ii.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof CommitsViewNode||e instanceof ii.vb});return void 0!==i&&await this.reveal(i,t),i}setFilesLayout(e){return R.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setMyCommitsOnly(e){(0,D.v)("gitlens:views:commits:myCommitsOnly",e),this.state.myCommitsOnly=e,this.refresh(!0)}setShowAvatars(e){return R.D.updateEffective(`views.${this.configKey}.avatars`,e)}setShowBranchComparison(e){return R.D.updateEffective(`views.${this.configKey}.showBranchComparison`,!!e&&we.DH.Working)}async setShowBranchPullRequest(e){await R.D.updateEffective(`views.${this.configKey}.pullRequests.showForBranches`,e),await R.D.updateEffective(`views.${this.configKey}.pullRequests.enabled`,e)}}gi([(0,k.H)((()=>""))],CommitsView.prototype,"revealCommit",1),gi([(0,k.H)((()=>""))],CommitsView.prototype,"revealRepository",1);var fi=i(5310),wi=i(4562),vi=Object.defineProperty,yi=Object.getOwnPropertyDescriptor,bi=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?yi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&vi(t,i,n),n};class ContributorsRepositoryNode extends ii.vb{async getChildren(){return null==this.child&&(this.child=new wi.I(this.uri,this.view,this,this.repo)),this.child.getChildren()}async subscribe(){return r.Disposable.from(await super.subscribe(),(0,fe.cL)((e=>this.child?.updateAvatar(e.email))))}changed(e){return e.changed(b.I6.Config,b.I6.Heads,b.I6.Remotes,b.I6.Unknown,b.du.Any)}}bi([(0,_.fF)()],ContributorsRepositoryNode.prototype,"subscribe",1);class ContributorsViewNode extends ii.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No contributors could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new ContributorsRepositoryNode(u.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.getChildren();return 0===t.length?(this.view.message="No contributors could be found.",this.view.title="Contributors",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Contributors (${t.length})`,t)}return this.view.title="Contributors",this.children}getTreeItem(){return new r.TreeItem("Contributors",r.TreeItemCollapsibleState.Expanded)}}class ContributorsView extends ri._{constructor(e){super(e,"contributors","Contributors","contributorsView"),this.configKey="contributors"}get canReveal(){return this.config.reveal||!R.D.get("views.repositories.showContributors")}getRoot(){return new ContributorsViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("contributors"),this.refresh(!0))),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(we.Vc.Auto)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(we.Vc.List)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(we.Vc.Tree)),this),(0,si.i)(this.getQualifiedCommand("setShowAllBranchesOn"),(()=>this.setShowAllBranches(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAllBranchesOff"),(()=>this.setShowAllBranches(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowStatisticsOn"),(()=>this.setShowStatistics(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowStatisticsOff"),(()=>this.setShowStatistics(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat")||R.D.changed(e,"sortContributorsBy"))}findContributor(e,t){const{repoPath:i,username:r,email:s,name:n}=e;return this.findNode((e=>e instanceof fi.K&&e.contributor.username===r&&e.contributor.email===s&&e.contributor.name===n),{maxDepth:2,canTraverse:e=>e instanceof ContributorsViewNode||e instanceof ContributorsRepositoryNode&&e.repoPath===i,token:t})}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof ii.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof ContributorsViewNode||e instanceof ii.vb});return void 0!==i&&await this.reveal(i,t),i}async revealContributor(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing contributor '${e.name}' in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findContributor(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}setFilesLayout(e){return R.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAllBranches(e){return R.D.updateEffective(`views.${this.configKey}.showAllBranches`,e)}setShowAvatars(e){return R.D.updateEffective(`views.${this.configKey}.avatars`,e)}setShowStatistics(e){return R.D.updateEffective(`views.${this.configKey}.showStatistics`,e)}}bi([(0,k.H)((()=>""))],ContributorsView.prototype,"revealRepository",1),bi([(0,k.H)((()=>""))],ContributorsView.prototype,"revealContributor",1);var Ci=i(5539),Ai=i(1614);const Pi=" (pinned)";class LineHistoryView extends ri._{constructor(e){super(e,"lineHistory","Line History","lineHistoryView"),this.configKey="lineHistory",(0,D.v)("gitlens:views:lineHistory:editorFollowing",!0)}get showCollapseAll(){return!1}getRoot(){return new Ai.A(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>this.refresh(!0)),this),(0,si.i)(this.getQualifiedCommand("changeBase"),(()=>this.changeBase()),this),(0,si.i)(this.getQualifiedCommand("setEditorFollowingOn"),(()=>this.setEditorFollowing(!0)),this),(0,si.i)(this.getQualifiedCommand("setEditorFollowingOff"),(()=>this.setEditorFollowing(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat"))}changeBase(){this.root?.changeBase()}setEditorFollowing(e){const t=this.ensureRoot();t.hasUri&&((0,D.v)("gitlens:views:lineHistory:editorFollowing",e),this.root?.setEditorFollowing(e),this.description?.endsWith(Pi)?e&&(this.description=this.description.substr(0,this.description.length-9)):e||null==this.description||(this.description+=Pi),e&&(t.ensureSubscription(),this.refresh(!0)))}setShowAvatars(e){return R.D.updateEffective(`views.${this.configKey}.avatars`,e)}}var Si=i(3479),Ri=i(5478),Di=i(3636);class ComparePickerNode extends ii.Re{constructor(e,t,i){super(u.Wj,e,t),this.selectedRef=i,this.order=Date.now(),this.pinned=!1}get canDismiss(){return!0}getChildren(){return[]}getTreeItem(){const e=this.selectedRef,t=e?.repoPath;let i,s;if(void 0!==t&&this.view.container.git.repositoryCount>1){const e=this.view.container.git.getRepository(t);i=e?.formattedName??t}return null==e?(s=new r.TreeItem("Compare <branch, tag, or ref> with <branch, tag, or ref>",r.TreeItemCollapsibleState.None),s.contextValue=ii.Td.ComparePicker,s.description=i,s.tooltip=`Click to select or enter a reference for compare${n.NE.Ellipsis}`,s.command={title:`Compare${n.NE.Ellipsis}`,command:this.view.getQualifiedCommand("selectForCompare")}):(s=new r.TreeItem(`Compare ${e.label} with <branch, tag, or ref>`,r.TreeItemCollapsibleState.None),s.contextValue=ii.Td.ComparePickerWithRef,s.description=i,s.tooltip=`Click to compare ${e.label} with${n.NE.Ellipsis}`,s.command={title:`Compare ${e.label} with${n.NE.Ellipsis}`,command:this.view.getQualifiedCommand("compareWithSelected")}),s}}var ki=i(5538),_i=i(812),Ti=i(4655),Fi=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,$i=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ei(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Fi(t,i,n),n};class SearchAndCompareViewNode extends ii.Re{constructor(e){super(u.Wj,e),this.splatted=!0}get children(){if(null==this._children){this._children=[];const e=this.view.getPinned();0!==e.length&&this._children.push(...e)}return this._children}getChildren(){return 0===this.children.length?[]:(this.view.message=void 0,this.children.sort(((e,t)=>(e.pinned?-1:1)-(t.pinned?-1:1)||t.order-e.order)))}getTreeItem(){this.splatted=!1;const e=new r.TreeItem("SearchAndCompare",r.TreeItemCollapsibleState.Expanded);return e.contextValue=ii.Td.SearchAndCompare,e}addOrReplace(e,t){this.children.includes(e)||(t&&this.clear(),this.children.push(e),this.view.triggerNodeChange())}clear(e=!1){if(0===this.children.length)return;this.removeComparePicker(!0);const t=this._children.findIndex((e=>!e.pinned));-1!==t&&this._children.splice(t,this._children.length),e||this.view.triggerNodeChange()}dismiss(e){if(e===this.comparePicker)return void this.removeComparePicker();if(0===this.children.length)return;const t=this.children.indexOf(e);-1!==t&&(this.children.splice(t,1),this.view.triggerNodeChange())}async refresh(){if(0===this.children.length)return;const e=[...(0,Ee.DZ)(this.children,(e=>{const t=void 0!==e.refresh&&e.refresh();return(0,O.tI)(t)?t:void 0}))];await Promise.all(e)}async compareWithSelected(e,t){const i=this.comparePicker?.selectedRef;if(null!=i){if(null==e)e=i.repoPath;else if(e!==i.repoPath)return void this.selectForCompare(e,t);if(null==t){const r=await(0,Di.V)(e,`Compare ${this.getRefName(i.ref)} with`,"Choose a reference to compare with",{allowEnteringRefs:!0,picked:"string"==typeof i.ref?i.ref:i.ref.ref,include:Di.H.BranchesAndTags|Di.H.HEAD,sort:{branches:{current:!0}}});if(null==r)return void(null!=this.comparePicker&&(await this.view.show(),await this.view.reveal(this.comparePicker,{focus:!0,select:!0})));t=r.ref}this.removeComparePicker(),await this.view.compare(e,i.ref,t)}}async selectForCompare(e,t,i){if(null==e&&(e=(await(0,Rt.vJ)("Compare"))?.path),null==e)return;this.removeComparePicker(!0);let r,s=i?.prompt??!1;if(null==t){const i=await(0,Di.V)(e,"Compare","Choose a reference to compare",{allowEnteringRefs:{ranges:!0},include:Di.H.BranchesAndTags|Di.H.HEAD|Di.H.WorkingTree,sort:{branches:{current:!0},tags:{}}});if(null==i)return void await this.triggerChange();if(t=i.ref,(0,v.yk)(t)){const e=(0,v.t6)(t);null!=e&&(t=e.ref1||"HEAD",r=e.ref2||"HEAD")}s=!0}this.comparePicker=new ComparePickerNode(this.view,this,{label:this.getRefName(t),repoPath:e,ref:t}),this.children.unshift(this.comparePicker),(0,D.v)("gitlens:views:canCompare",!0),await this.triggerChange(),await this.view.reveal(this.comparePicker,{focus:!1,select:!0}),s&&await this.compareWithSelected(e,r)}getRefName(e){return"string"==typeof e?(0,v.zL)(e,{strings:{working:"Working Tree"}}):e.label??(0,v.zL)(e.ref)}removeComparePicker(e=!1){if((0,D.v)("gitlens:views:canCompare",!1),null!=this.comparePicker){const t=this.children.indexOf(this.comparePicker);-1!==t&&(this.children.splice(t,1),e||this.triggerChange()),this.comparePicker=void 0}}}$i([(0,_.cM)()],SearchAndCompareViewNode.prototype,"clear",1),$i([(0,_.cM)({args:{0:e=>e.toString()}})],SearchAndCompareViewNode.prototype,"dismiss",1),$i([(0,k.H)(),(0,_.fF)()],SearchAndCompareViewNode.prototype,"refresh",1);class SearchAndCompareView extends ri._{constructor(e){super(e,"searchAndCompare","Search & Compare","searchAndCompareView"),this.configKey="searchAndCompare",(0,D.v)("gitlens:views:searchAndCompare:keepResults",this.keepResults)}getRoot(){return new SearchAndCompareViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("clear"),(()=>this.clear()),this),(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>this.refresh(!0)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(we.Vc.Auto)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(we.Vc.List)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(we.Vc.Tree)),this),(0,si.i)(this.getQualifiedCommand("setKeepResultsToOn"),(()=>this.setKeepResults(!0)),this),(0,si.i)(this.getQualifiedCommand("setKeepResultsToOff"),(()=>this.setKeepResults(!1)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,si.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,si.i)(this.getQualifiedCommand("pin"),this.pin,this),(0,si.i)(this.getQualifiedCommand("unpin"),this.unpin,this),(0,si.i)(this.getQualifiedCommand("swapComparison"),this.swapComparison,this),(0,si.i)(this.getQualifiedCommand("selectForCompare"),(()=>this.selectForCompare())),(0,si.i)(this.getQualifiedCommand("compareWithSelected"),this.compareWithSelected,this),(0,si.i)(this.getQualifiedCommand("setFilesFilterOnLeft"),(e=>this.setFilesFilter(e,_i.W.Left)),this),(0,si.i)(this.getQualifiedCommand("setFilesFilterOnRight"),(e=>this.setFilesFilter(e,_i.W.Right)),this),(0,si.i)(this.getQualifiedCommand("setFilesFilterOff"),(e=>this.setFilesFilter(e,void 0)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat"))}get keepResults(){return this.container.storage.getWorkspace("views:searchAndCompare:keepResults",!0)}clear(){this.root?.clear()}dismissNode(e){null!=this.root&&(e instanceof ComparePickerNode||e instanceof ki.f||e instanceof Ti.V)&&e.canDismiss&&this.root.dismiss(e)}compare(e,t,i){return this.addResults(new ki.f(this,this.ensureRoot(),e,"string"==typeof t?{ref:t}:t,"string"==typeof i?{ref:i}:i))}compareWithSelected(e,t){this.ensureRoot().compareWithSelected(e,t)}selectForCompare(e,t,i){this.ensureRoot().selectForCompare(e,t,i)}async search(e,t,{label:i,reveal:r},s,n){this.visible||await this.show();const o={label:`Results ${"string"==typeof i?i:i.label}`,queryLabel:i};null==n?await this.addResults(new Ti.V(this,this.root,e,t,o,s),r):await n.edit({pattern:t,labels:o,log:s})}getPinned(){let e=this.container.storage.getWorkspace("views:searchAndCompare:pinned");if(null==e){const t=this.container.storage.getWorkspace("pinned:comparisons");if(null==t)return[];e=Object.create(null);for(const i of Object.values(t))e[ki.f.getPinnableId(i.path,i.ref1.ref,i.ref2.ref)]={type:"comparison",timestamp:Date.now(),path:i.path,ref1:i.ref1,ref2:i.ref2};this.container.storage.storeWorkspace("views:searchAndCompare:pinned",e),this.container.storage.deleteWorkspace("pinned:comparisons")}const t=Object.create(null);let i=!1;const r=this.ensureRoot(),s=Object.entries(e).sort((([,e],[,t])=>(t.timestamp??0)-(e.timestamp??0))).map((([e,s])=>{if("comparison"===s.type){const n=ki.f.getPinnableId(s.path,s.ref1.ref,s.ref2.ref);return e!==n?(i=!0,t[n]=s):t[e]=s,new ki.f(this,r,s.path,{label:s.ref1.label,ref:s.ref1.ref??s.ref1.name??s.ref1.sha},{label:s.ref2.label,ref:s.ref2.ref??s.ref2.name??s.ref2.sha},s.timestamp)}const n=Ti.V.getPinnableId(s.path,s.search);return e!==n?(i=!0,t[n]=s):t[e]=s,new Ti.V(this,r,s.path,(0,S.uP)(s.search),s.labels,void 0,s.timestamp)}));return i&&this.container.storage.storeWorkspace("views:searchAndCompare:pinned",t),s}async updatePinned(e,t){let i=this.container.storage.getWorkspace("views:searchAndCompare:pinned");i=(0,lt.iC)(i,e,t),await this.container.storage.storeWorkspace("views:searchAndCompare:pinned",i),this.triggerNodeChange(this.ensureRoot())}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof ii.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof SearchAndCompareViewNode||e instanceof ii.vb});return void 0!==i&&await this.reveal(i,t),i}async addResults(e,t={expand:!0,focus:!0,select:!0}){this.visible||await this.show();this.ensureRoot().addOrReplace(e,!this.keepResults),queueMicrotask((()=>this.reveal(e,t)))}setFilesLayout(e){return R.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setKeepResults(e){this.container.storage.storeWorkspace("views:searchAndCompare:keepResults",e),(0,D.v)("gitlens:views:searchAndCompare:keepResults",e)}setShowAvatars(e){return R.D.updateEffective(`views.${this.configKey}.avatars`,e)}pin(e){if(e instanceof ki.f||e instanceof Ti.V)return e.pin()}setFilesFilter(e,t){e instanceof _i.V&&(e.filter=t)}swapComparison(e){if(e instanceof ki.f)return e.swap()}unpin(e){if(e instanceof ki.f||e instanceof Ti.V)return e.unpin()}}$i([(0,k.H)((()=>""))],SearchAndCompareView.prototype,"revealRepository",1);var Oi=i(727),xi=i(2758),Ii=i(1101),Bi=Object.defineProperty,Wi=Object.getOwnPropertyDescriptor,Li=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Wi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Bi(t,i,n),n};class StashesRepositoryNode extends ii.vb{async getChildren(){return null==this.child&&(this.child=new Oi.m(this.uri,this.view,this,this.repo)),this.child.getChildren()}changed(e){return e.changed(b.I6.Stash,b.I6.Unknown,b.du.Any)}}class StashesViewNode extends ii.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No stashes could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new StashesRepositoryNode(u.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.repo.getStash();return null==t||0===t.commits.size?(this.view.message="No stashes could be found.",this.view.title="Stashes",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Stashes (${t.commits.size})`,e.getChildren())}return this.view.title="Stashes",this.children}getTreeItem(){return new r.TreeItem("Stashes",r.TreeItemCollapsibleState.Expanded)}}class StashesView extends ri._{constructor(e){super(e,"stashes","Stashes","stashesView"),this.configKey="stashes"}get canReveal(){return this.config.reveal||!R.D.get("views.repositories.showStashes")}getRoot(){return new StashesViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("stashes"),this.refresh(!0))),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(we.Vc.Auto)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(we.Vc.List)),this),(0,si.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(we.Vc.Tree)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||R.D.changed(e,"defaultDateFormat")||R.D.changed(e,"defaultDateLocale")||R.D.changed(e,"defaultDateShortFormat")||R.D.changed(e,"defaultDateSource")||R.D.changed(e,"defaultDateStyle")||R.D.changed(e,"defaultGravatarsStyle")||R.D.changed(e,"defaultTimeFormat"))}onSelectionChanged(e){super.onSelectionChanged(e),this.notifySelections()}onVisibilityChanged(e){super.onVisibilityChanged(e),e.visible&&this.notifySelections()}notifySelections(){const e=this.selection?.[0];null!=e&&((e instanceof Ii.i||e instanceof xi.y)&&this.container.events.fire("commit:selected",{commit:e.commit,interaction:"passive",preserveFocus:!0,preserveVisibility:!0},{source:this.id}),e instanceof xi.y&&this.container.events.fire("file:selected",{uri:e.uri,preserveFocus:!0,preserveVisibility:!0},{source:this.id}))}findStash(e,t){const{repoPath:i}=e;return this.findNode((t=>t.commit?.ref===e.ref),{maxDepth:2,canTraverse:e=>e instanceof StashesViewNode||e instanceof StashesRepositoryNode&&e.repoPath===i,token:t})}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof ii.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof StashesViewNode||e instanceof ii.vb});return void 0!==i&&await this.reveal(i,t),i}async revealStash(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,v.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findStash(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}setFilesLayout(e){return R.D.updateEffective(`views.${this.configKey}.files.layout`,e)}}Li([(0,k.H)((()=>""))],StashesView.prototype,"revealRepository",1),Li([(0,k.H)((()=>""))],StashesView.prototype,"revealStash",1);var Mi=i(9137),Ui=i(4398);class ViewFileDecorationProvider{constructor(){this._onDidChange=new r.EventEmitter,this.disposable=r.Disposable.from(r.window.registerFileDecorationProvider({provideFileDecoration:(e,t)=>{if("gitlens-view"===e.scheme)return"branch"===e.authority?this.provideBranchCurrentDecoration(e,t):"remote"===e.authority?this.provideRemoteDefaultDecoration(e,t):"workspaces"===e.authority?this.provideWorkspaceDecoration(e,t):void 0}}),r.window.registerFileDecorationProvider(this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}provideWorkspaceDecoration(e,t){const[,i,s]=e.path.split("/");if("repository"===i){if("open"===s)return{badge:"●",color:new r.ThemeColor("gitlens.decorations.workspaceRepoOpenForegroundColor"),tooltip:""};if("missing"===s)return{badge:"?",color:new r.ThemeColor("gitlens.decorations.workspaceRepoMissingForegroundColor"),tooltip:""}}if("workspace"===i&&"current"===s)return{badge:"●",color:new r.ThemeColor("gitlens.decorations.workspaceCurrentForegroundColor"),tooltip:""}}provideFileDecoration(e,t){if(e.scheme===n.sN.Git){const t=(0,Ui.h)(e);null!=t?.decoration&&(e=r.Uri.parse(t?.decoration))}if("gitlens-view"===e.scheme)switch(e.authority){case"branch":return this.provideBranchStatusDecoration(e,t);case"commit-file":return this.provideCommitFileStatusDecoration(e,t)}}provideCommitFileStatusDecoration(e,t){const[,,i]=e.path.split("/");switch(i){case"!":return{badge:"I",color:new r.ThemeColor("gitlens.decorations.ignoredForegroundColor"),tooltip:"Ignored"};case"?":return{badge:"U",color:new r.ThemeColor("gitlens.decorations.untrackedForegroundColor"),tooltip:"Untracked"};case"A":return{badge:"A",color:new r.ThemeColor("gitlens.decorations.addedForegroundColor"),tooltip:"Added"};case"C":return{badge:"C",color:new r.ThemeColor("gitlens.decorations.copiedForegroundColor"),tooltip:"Copied"};case"D":return{badge:"D",color:new r.ThemeColor("gitlens.decorations.deletedForegroundColor"),tooltip:"Deleted"};case"M":return{badge:"M",tooltip:"Modified"};case"R":return{badge:"R",color:new r.ThemeColor("gitlens.decorations.renamedForegroundColor"),tooltip:"Renamed"};default:return}}provideBranchStatusDecoration(e,t){const[,,i]=e.path.split("/");switch(i){case d.Yu.Ahead:return{badge:"▲",color:new r.ThemeColor("gitlens.decorations.branchAheadForegroundColor"),tooltip:"Ahead"};case d.Yu.Behind:return{badge:"▼",color:new r.ThemeColor("gitlens.decorations.branchBehindForegroundColor"),tooltip:"Behind"};case d.Yu.Diverged:return{badge:"▼▲",color:new r.ThemeColor("gitlens.decorations.branchDivergedForegroundColor"),tooltip:"Diverged"};case d.Yu.MissingUpstream:return{badge:"!",color:new r.ThemeColor("gitlens.decorations.branchMissingUpstreamForegroundColor"),tooltip:"Missing Upstream"};case d.Yu.UpToDate:return{badge:"",color:new r.ThemeColor("gitlens.decorations.branchUpToDateForegroundColor"),tooltip:"Up to Date"};case d.Yu.Unpublished:return{badge:"▲+",color:new r.ThemeColor("gitlens.decorations.branchUnpublishedForegroundColor"),tooltip:"Unpublished"};default:return}}provideBranchCurrentDecoration(e,t){const[,,i,s]=e.path.split("/");if(!s)return;let o;switch(i){case d.Yu.Ahead:o=new r.ThemeColor("gitlens.decorations.branchAheadForegroundColor");break;case d.Yu.Behind:o=new r.ThemeColor("gitlens.decorations.branchBehindForegroundColor");break;case d.Yu.Diverged:o=new r.ThemeColor("gitlens.decorations.branchDivergedForegroundColor");break;case d.Yu.UpToDate:o=new r.ThemeColor("gitlens.decorations.branchUpToDateForegroundColor");break;case d.Yu.Unpublished:o=new r.ThemeColor("gitlens.decorations.branchUnpublishedForegroundColor")}return{badge:n.NE.Check,color:o,tooltip:"Current Branch"}}provideRemoteDefaultDecoration(e,t){const[,i]=e.path.split("/");if(i)return{badge:n.NE.Check,tooltip:"Default Remote"}}}var Ni=i(9100);class WorkspaceMissingRepositoryNode extends ii.Re{constructor(e,t,i,r){super(u.Wj,e,t),this.workspace=i,this.wsRepositoryDescriptor=r,this.updateContext({wsRepositoryDescriptor:r}),this._uniqueId=(0,ii.tO)("missing-workspace-repository",this.context)}get id(){return this._uniqueId}toClipboard(){return this.name}get name(){return this.wsRepositoryDescriptor.name}get workspaceId(){return this.wsRepositoryDescriptor.workspaceId}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(this.name,r.TreeItemCollapsibleState.None);return e.id=this.id,e.description="missing",e.tooltip=new r.MarkdownString(`${this.name}\n\nRepository could not be found`),e.contextValue=ii.Td.WorkspaceMissingRepository,e.iconPath=new r.ThemeIcon("question",new r.ThemeColor("gitlens.decorations.workspaceRepoMissingForegroundColor")),e.resourceUri=r.Uri.parse("gitlens-view://workspaces/repository/missing"),e}}var Gi=Object.defineProperty,Hi=Object.getOwnPropertyDescriptor,Vi=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Hi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Gi(t,i,n),n};class WorkspaceNode extends ii.CF{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.workspace=r,this.updateContext({workspace:r}),this._uniqueId=(0,ii.tO)("workspace",this.context)}dispose(){super.dispose(),this.resetChildren()}resetChildren(){if(null!=this._children){for(const e of this._children)"dispose"in e&&e.dispose();this._children=void 0}}get id(){return this._uniqueId}toClipboard(){return this.workspace.name}async getChildren(){if(null==this._children){this._children=[];try{const e=await this.workspace.getRepositoryDescriptors();if(null==e||0===e.length)return this._children.push(new ui.$h(this.view,this,(0,$e.fA)("gitlens.views.workspaces.addRepos","Add Repositories...",this),"No repositories")),this._children;const t=await this.workspace.getRepositoriesByName({force:!0});for(const i of e){const e=t.get(i.name)?.repository;e?this._children.push(new Ni.q(u.YY.fromRepoPath(e.path),this.view,this,e,this.getNewContext({wsRepositoryDescriptor:i}))):this._children.push(new WorkspaceMissingRepositoryNode(this.view,this,this.workspace,i))}}catch(e){return[new ui.AE(this.view,this,"Failed to load repositories")]}}return this._children}async getTreeItem(){const e=new r.TreeItem(this.workspace.name,r.TreeItemCollapsibleState.Collapsed);let t=`${ii.Td.Workspace}`;e.resourceUri=void 0;const i=[];return this.workspace.type===Dt.EI.Cloud?t+="+cloud":t+="+local",this.workspace.current&&(t+="+current",i.push("current"),e.resourceUri=r.Uri.parse("gitlens-view://workspaces/workspace/current")),null!=this.workspace.localPath&&(t+="+hasPath"),0===(await this.workspace.getRepositoryDescriptors())?.length&&(t+="+empty"),e.id=this.id,e.contextValue=t,e.iconPath=new r.ThemeIcon(this.workspace.type==Dt.EI.Cloud?"cloud":"folder"),e.tooltip=`${this.workspace.name}\n${this.workspace.type===Dt.EI.Cloud?"Cloud Workspace "+(this.workspace.shared?"(Shared)":""):"Local Workspace"}${this.workspace.type===Dt.EI.Cloud&&null!=this.workspace.provider?`\nProvider: ${this.workspace.provider}`:""}`,this.workspace.type===Dt.EI.Cloud&&null!=this.workspace.organizationId&&i.push("shared"),e.description=i.join(", "),e}refresh(e=!1){null!=this._children&&e&&this.resetChildren()}etag(){return this.view.container.git.etag}subscribe(){return r.Disposable.from(this.view.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this))}onRepositoriesChanged(e){this.triggerChange(!0)}}Vi([(0,k.H)(),(0,_.fF)()],WorkspaceNode.prototype,"refresh",1),Vi([(0,_.fF)()],WorkspaceNode.prototype,"subscribe",1);var qi=i(7424),Qi=Object.defineProperty,Yi=Object.getOwnPropertyDescriptor;class WorkspacesViewNode extends ii.Re{async getChildren(){if(null==this._children){const e=[],{cloudWorkspaces:t,cloudWorkspaceInfo:i,localWorkspaces:r,localWorkspaceInfo:s}=await this.view.container.workspaces.getWorkspaces();if(t.length||r.length){e.push(new qi.S(this.view));for(const i of t)e.push(new WorkspaceNode(this.uri,this.view,this,i));null!=i&&e.push(new ui.AE(this.view,this,i));for(const t of r)e.push(new WorkspaceNode(this.uri,this.view,this,t));0===t.length&&null==i&&e.push(new ui.AE(this.view,this,"No cloud workspaces found.")),null!=s&&e.push(new ui.AE(this.view,this,s))}this._children=e}return this._children}getTreeItem(){return new r.TreeItem("Workspaces",r.TreeItemCollapsibleState.Expanded)}refresh(){if(null!=this._children){if(this._children.length)for(const e of this._children)"dispose"in e&&e.dispose();this._children=void 0}}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?Yi(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&Qi(t,i,n)})([(0,k.H)(),(0,_.fF)()],WorkspacesViewNode.prototype,"refresh",1);class WorkspacesView extends ri._{constructor(e){super(e,"workspaces","Workspaces","workspaceView"),this.configKey="repositories",this._disposable=r.Disposable.from(this.container.workspaces.onDidResetWorkspaces((()=>{this.ensureRoot().triggerChange(!0)}))),this.description="PREVIEW  ☁️"}dispose(){this._disposable.dispose(),super.dispose()}get canSelectMany(){return!1}getRoot(){return new WorkspacesViewNode(u.Wj,this)}async show(e){if(await(0,ut.C)())return super.show(e)}get canReveal(){return!1}registerCommands(){return this.container.viewCommands,[(0,si.i)(this.getQualifiedCommand("info"),(()=>r.env.openExternal(r.Uri.parse("https://help.gitkraken.com/gitlens/side-bar/#workspaces-☁%ef%b8%8f"))),this),(0,si.i)(this.getQualifiedCommand("copy"),(()=>(0,$e.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,si.i)(this.getQualifiedCommand("refresh"),(()=>{this.container.workspaces.resetWorkspaces()}),this),(0,si.i)(this.getQualifiedCommand("addRepos"),(async e=>{await this.container.workspaces.addCloudWorkspaceRepos(e.workspace.id),e.getParent()?.triggerChange(!0)})),(0,si.i)(this.getQualifiedCommand("addReposFromLinked"),(async e=>{await this.container.workspaces.addMissingCurrentWorkspaceRepos({force:!0}),e.getParent()?.triggerChange(!0)})),(0,si.i)(this.getQualifiedCommand("convert"),(async e=>{const t=[];for(const i of e.getChildren())i instanceof Ni.q&&t.push(i.repo);0!==t.length&&(await this.container.workspaces.createCloudWorkspace({repos:t}),this.ensureRoot().triggerChange(!0))}),this),(0,si.i)(this.getQualifiedCommand("create"),(async()=>{await this.container.workspaces.createCloudWorkspace(),this.ensureRoot().triggerChange(!0)}),this),(0,si.i)(this.getQualifiedCommand("createLocal"),(async e=>{await this.container.workspaces.saveAsCodeWorkspaceFile(e.workspace.id),this.ensureRoot().triggerChange(!0)}),this),(0,si.i)(this.getQualifiedCommand("openLocal"),(async e=>{await this.container.workspaces.openCodeWorkspaceFile(e.workspace.id,{location:W.Tc.CurrentWindow}),this.ensureRoot().triggerChange(!0)}),this),(0,si.i)(this.getQualifiedCommand("openLocalNewWindow"),(async e=>{await this.container.workspaces.openCodeWorkspaceFile(e.workspace.id,{location:W.Tc.NewWindow})}),this),(0,si.i)(this.getQualifiedCommand("changeAutoAddSetting"),(async()=>{await this.container.workspaces.chooseCodeWorkspaceAutoAddSetting({current:!0})}),this),(0,si.i)(this.getQualifiedCommand("delete"),(async e=>{await this.container.workspaces.deleteCloudWorkspace(e.workspace.id),e.getParent()?.triggerChange(!0)}),this),(0,si.i)(this.getQualifiedCommand("locateAllRepos"),(async e=>{e.workspace.type===Dt.EI.Cloud&&(await r.window.withProgress({location:r.ProgressLocation.Notification,title:`Locating Repositories for '${e.workspace.name}'...`,cancellable:!0},((t,i)=>this.container.workspaces.locateAllCloudWorkspaceRepos(e.workspace.id,i))),e.triggerChange(!0))}),this),(0,si.i)(this.getQualifiedCommand("repo.locate"),(async e=>{const t=e.wsRepositoryDescriptor;null!=t&&null!=e.workspace?.id&&(await this.container.workspaces.locateWorkspaceRepo(e.workspace.id,t),e.getParent()?.triggerChange(!0))}),this),(0,si.i)(this.getQualifiedCommand("repo.openInNewWindow"),(e=>{const t=e.getParent();null!=t&&t instanceof WorkspaceNode&&(0,W.ic)(e.repo.uri,{location:W.Tc.NewWindow})}),this),(0,si.i)(this.getQualifiedCommand("repo.open"),(e=>{const t=e.getParent();null!=t&&t instanceof WorkspaceNode&&(0,W.ic)(e.repo.uri,{location:W.Tc.CurrentWindow})}),this),(0,si.i)(this.getQualifiedCommand("repo.addToWindow"),(e=>{const t=e.getParent();null!=t&&t instanceof WorkspaceNode&&(0,W.ic)(e.repo.uri,{location:W.Tc.AddToWorkspace})}),this),(0,si.i)(this.getQualifiedCommand("repo.remove"),(async e=>{const t=e.wsRepositoryDescriptor;null!=t?.id&&null!=e.workspace?.id&&(await this.container.workspaces.removeCloudWorkspaceRepo(e.workspace.id,t),e.getParent()?.getParent()?.triggerChange(!0))}))]}}var ji=i(7933),zi=i(6767);class RequestType{constructor(e){this.name=e}}const Ki=new RequestType("git"),Ji=new RequestType("git/logStreamTo"),Xi=new RequestType("repositories/inFolder");var Zi=Object.defineProperty,er=Object.getOwnPropertyDescriptor,tr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?er(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Zi(t,i,n),n};const ir=()=>!0,rr=new Map([["blame",ir],["branch",e=>"--contains"===e[1]],["cat-file",ir],["check-mailmap",ir],["check-ref-format",ir],["config",e=>"--get"===e[1]||"--get-regex"===e[1]],["diff",ir],["difftool",ir],["for-each-ref",ir],["log",ir],["ls-files",ir],["ls-tree",ir],["merge-base",ir],["remote",e=>"-v"===e[1]||"get-url"===e[1]],["rev-list",ir],["rev-parse",ir],["show",ir],["show-ref",ir],["stash",e=>"list"===e[1]],["status",ir],["symbolic-ref",ir],["tag",e=>"-l"===e[1]],["worktree",e=>"list"===e[1]]]),sr=/^[/|\\]/,nr=class{constructor(e,t,i){this._api=e,this._service=t,this.container=i,this._localToSharedPaths=new Map,this._sharedToLocalPaths=new Map,t.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this)),this._disposable=r.Disposable.from(r.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this.onRequest(Ki,this.onGitCommandRequest.bind(this)),this.onRequest(Ji,this.onGitLogStreamToCommandRequest.bind(this)),this.onRequest(Xi,this.onGetRepositoriesForUriRequest.bind(this)),this.onWorkspaceFoldersChanged()}static async share(e,t){const i=await e.shareService(this.ServiceId);if(null==i)throw new Error("Failed to share host service");return new nr(e,i,t)}dispose(){this._disposable.dispose(),this._api.unshareService(nr.ServiceId)}onRequest(e,t){this._service.onRequest(e.name,(function(e,i){let r;for(const t of e)if("object"==typeof t&&"__type"in t){r=t;break}return t(r??e[0],i)}))}onAvailabilityChanged(e){}onWorkspaceFoldersChanged(e){if(null==r.workspace.workspaceFolders||0===r.workspace.workspaceFolders.length)return;const t=(0,E.UH)();let i,s;this._localToSharedPaths.clear(),this._sharedToLocalPaths.clear();for(const e of r.workspace.workspaceFolders)i=(0,$.AH)(e.uri.fsPath),s=(0,$.AH)(this.convertLocalUriToShared(e.uri).toString()),F.Yd.debug(t,`shared='${s}' ↔ local='${i}'`),this._localToSharedPaths.set(i,s),this._sharedToLocalPaths.set(s,i);let n=(0,T.v_)(this._sharedToLocalPaths.values(),"|");n=n.replace(/(\/|\\)/g,"[\\\\/|\\\\]"),this._localPathsRegex=new RegExp(`(${n})`,"gi");let o=(0,T.v_)(this._localToSharedPaths.values(),"|");o=o.replace(/(\/|\\)/g,"[\\\\/|\\\\]"),this._sharedPathsRegex=new RegExp(`^(${o})`,"i")}async onGitCommandRequest(e,t){const i=rr.get(e.args[0]);if(null==i||!i(e.args))throw new Error(`Git ${e.args[0]} command is not allowed`);const{options:r,args:s}=e,[n,o]=this.convertGitCommandCwd(r.cwd);r.cwd=n;let a=await function(e,...t){return Promise.resolve("")}(r,...this.convertGitCommandArgs(s,o));return"string"==typeof a?(null!=this._localPathsRegex&&a.length>0&&(a=a.replace(this._localPathsRegex,((e,t)=>{const i=this._localToSharedPaths.get((0,$.AH)(t));return null!=i?i:t}))),{data:a}):{data:a.toString("binary"),isBuffer:!0}}async onGitLogStreamToCommandRequest(e,t){const{options:i,args:r}=e,[s,n]=this.convertGitCommandCwd(e.repoPath);let[o,a]=await function(e,t,i,r,...s){return Promise.resolve([[""],0])}(s,e.sha,e.limit,i,...this.convertGitCommandArgs(r,n));return null!=this._localPathsRegex&&o.length>0&&(o=o.map((e=>e.replace(this._localPathsRegex,((e,t)=>{const i=this._localToSharedPaths.get((0,$.AH)(t));return null!=i?i:t}))))),{data:o,count:a}}async onGetRepositoriesForUriRequest(e,t){const i=[],s=this.convertSharedUriToLocal(r.Uri.parse(e.folderUri,!0)),n=this.container.git.getRepository(s);if(null!=n){const e=this.convertLocalUriToShared(n.uri);i.push({folderUri:e.toString(),root:n.root,closed:n.closed})}return{repositories:i}}convertLocalUriToShared(e){const t=(0,E.UH)();let i=this._api.convertLocalUriToShared(e);F.Yd.debug(t,`LiveShare.convertLocalUriToShared(${e.toString(!0)}) returned ${i.toString(!0)}`);const s=e.path;let n=i.path;if(i.authority.length>0&&(n=`/${i.authority}${n}`),new RegExp(`${s}$`,"i").test(n))if(n.length===s.length){const t=r.workspace.getWorkspaceFolder(e);i=i.with({path:`/~${t.index}`})}else i=i.with({path:n.substr(0,n.length-s.length)});else if(!n.startsWith("/~")){const t=r.workspace.getWorkspaceFolder(e);i=i.with({path:`/~${t.index}${n}`})}return i}convertGitCommandCwd(e){let t=!1;if(null!=e&&e.length>0&&null!=this._sharedToLocalPaths)if(this._sharedPathsRegex?.test(e))e=(0,$.AH)(e).replace(this._sharedPathsRegex,((e,i)=>{t||(t="/~0"===i);const r=this._sharedToLocalPaths.get(i);return null!=r?r:i}));else if(sr.test(e)){const i=this._sharedToLocalPaths.get("vsls:/~0");null!=i&&(t=!0,e=(0,$.AH)(this.container.git.getAbsoluteUri(e,i).fsPath))}return[e,t]}convertGitCommandArgs(e,t){let i=!1,r=-1;for(const s of e)r++,"--"!==s?i&&"string"==typeof s&&(t&&sr.test(s[0])&&e.splice(r,1,s.substr(1)),this._sharedPathsRegex?.test(s)&&e.splice(r,1,(0,$.AH)(s).replace(this._sharedPathsRegex,((e,t)=>{const i=this._sharedToLocalPaths.get(t);return null!=i?i:t})))):i=!0;return e}convertSharedUriToLocal(e){(0,$.tD)(e.path)&&(e=e.with({path:`${e.path}/`}));const t=this._api.convertSharedUriToLocal(e);let i=t.path;const r=e.path;return i.endsWith(r)&&(i=i.substr(0,i.length-r.length)),47===i.charCodeAt(i.length-1)&&(i=i.slice(0,-1)),t.with({path:i})}};let or=nr;or.ServiceId="proxy",tr([(0,_.cM)()],or.prototype,"onAvailabilityChanged",1),tr([(0,_.fF)()],or.prototype,"onWorkspaceFoldersChanged",1),tr([(0,_.cM)()],or.prototype,"onGitCommandRequest",1),tr([(0,_.cM)()],or.prototype,"onGitLogStreamToCommandRequest",1),tr([(0,_.cM)()],or.prototype,"onGetRepositoriesForUriRequest",1),tr([(0,_.fF)({exit:!0})],or.prototype,"convertLocalUriToShared",1),tr([(0,_.cM)()],or,"share",1);var ar=Object.defineProperty,cr=Object.getOwnPropertyDescriptor,lr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?cr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ar(t,i,n),n};const hr=class{constructor(e,t,i){this._api=e,this._service=t,this.container=i,t.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this)),this.onAvailabilityChanged(t.isServiceAvailable)}static async connect(e,t){const i=(0,E.UH)();try{const i=await e.getSharedService(or.ServiceId);if(null==i)throw new Error("Failed to connect to host service");return new hr(e,i,t)}catch(e){return void F.Yd.error(e,i)}}dispose(){}onAvailabilityChanged(e){e?this.container.git.setEnabledContext(!0):(this.container.git.setEnabledContext(!1),r.window.showWarningMessage("GitLens features will be unavailable. Unable to connect to the host GitLens service. The host may have disabled GitLens guest access or may not have GitLens installed."))}async git(e,...t){const i=await this.sendRequest(Ki,{__type:"gitlens",options:e,args:t});return i.isBuffer?Buffer.from(i.data,"binary"):i.data}async gitLogStreamTo(e,t,i,r,...s){const n=await this.sendRequest(Ji,{__type:"gitlens",repoPath:e,sha:t,limit:i,options:r,args:s});return[n.data,n.count]}async getRepositoriesForUri(e){return(await this.sendRequest(Xi,{__type:"gitlens",folderUri:e.toString()})).repositories}sendRequest(e,t,i){return this._service.request(e.name,[t],i)}};let ur=hr;lr([(0,_.cM)()],ur.prototype,"onAvailabilityChanged",1),lr([(0,_.cM)()],ur.prototype,"git",1),lr([(0,_.cM)()],ur.prototype,"gitLogStreamTo",1),lr([(0,_.cM)()],ur.prototype,"getRepositoriesForUri",1),lr([(0,_.fF)()],ur.prototype,"sendRequest",1),lr([(0,_.cM)()],ur,"connect",1);var dr=Object.defineProperty,pr=Object.getOwnPropertyDescriptor,mr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?pr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&dr(t,i,n),n};function gr(e){switch(e){case"available":return{status:"online",statusText:"Available"};case"away":return{status:"away",statusText:"Away"};case"busy":return{status:"busy",statusText:"Busy"};case"doNotDisturb":return{status:"dnd",statusText:"DND"};default:return{status:"offline",statusText:"Offline"}}}class VslsController{constructor(e){this.container=e,this._readonly=!1,this._ready=(0,O.PQ)(),this._disposable=r.Disposable.from((0,I.IH)(e.onReady)(this.onReady,this))}dispose(){this._ready.fulfill(),this._disposable.dispose(),this._host?.dispose(),this._guest?.dispose()}onReady(){this.initialize()}async initialize(){r.workspace.workspaceFolders?.some((e=>e.uri.scheme===n.sN.Vsls))&&this.setReadonly(!0);try{this._api=this.getLiveShareApi();const e=await this._api;if(null==e)return(0,D.v)("gitlens:vsls",!1),void this._ready.fulfill();(0,D.v)("gitlens:vsls",!0),this._disposable=r.Disposable.from(this._disposable,e.onDidChangeSession((t=>this.onLiveShareSessionChanged(e,t)),this)),this.onLiveShareSessionChanged(e,{session:e.session})}catch(e){F.Yd.error(e)}}async onLiveShareSessionChanged(e,t){switch(this._host?.dispose(),this._host=void 0,this._guest?.dispose(),this._guest=void 0,t.session.role){case 1:this.setReadonly(!1),(0,D.v)("gitlens:vsls","host"),R.D.get("liveshare.allowGuestAccess")&&(this._host=await or.share(e,this.container)),this._ready.fulfill();break;case 2:this.setReadonly(!0),(0,D.v)("gitlens:vsls","guest"),this._guest=await ur.connect(e,this.container),this._ready.fulfill();break;default:this.setReadonly(!1),(0,D.v)("gitlens:vsls",!0),this._ready.pending||(this._ready=(0,O.PQ)())}}async getLiveShareApi(){try{const e=r.extensions.getExtension("ms-vsliveshare.vsliveshare");if(null!=e){const t=e.isActive?e.exports:await e.activate();return await t.getApi("1.0.4753")??void 0}}catch(e){F.Yd.error(e)}}get readonly(){return this._readonly}setReadonly(e){this._readonly=e,(0,D.v)("gitlens:readonly",!!e||void 0)}async guest(){return null!=this._guest||await this._ready.promise,this._guest}async getContact(e){if(null==e)return;const t=await this._api;if(null==t)return;return(await t.getContacts([e])).contacts[e]}async getContacts(e){const t=await this._api;if(null==t)return;const i=await t.getContacts(e);return Object.values(i.contacts)}async getContactPresence(e){const t=await this.getContact(e);if(null!=t)return gr(t.status)}async getContactsPresence(e){const t=await this.getContacts(e);if(null!=t)return new Map(Object.values(t).map((e=>[e.email,gr(e.status)])))}maybeGetPresence(e){return this.getContactPresence(e)}async invite(e){if(null==e)return;const t=await this.getContact(e);return null!=t?t.invite():void 0}async startSession(){const e=await this._api;if(null!=e)return e.share()}}mr([(0,_.fF)()],VslsController.prototype,"getContact",1),mr([(0,_.fF)({args:{0:e=>e.length}})],VslsController.prototype,"getContacts",1),mr([(0,_.fF)()],VslsController.prototype,"getContactPresence",1),mr([(0,_.fF)({args:{0:e=>e.length}})],VslsController.prototype,"getContactsPresence",1),mr([(0,_.fF)(),(0,zi.V)(250)],VslsController.prototype,"maybeGetPresence",1);var fr=i(9152),wr=i(7925),vr=i(5798),yr=i(6260);const br=new vr.ke("rebase/abort"),Cr=new vr.ke("rebase/disable"),Ar=new vr.ke("rebase/search"),Pr=new vr.ke("rebase/start"),Sr=new vr.ke("rebase/switch"),Rr=new vr.ke("rebase/reorder"),Dr=new vr.ke("rebase/change/entry"),kr=new vr.ke("rebase/move/entry"),_r=new vr.ke("rebase/selection/update"),Tr=new vr.jH("rebase/didChange");var Fr=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,$r=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Er(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Fr(t,i,n),n};const Or=2**30,xr=new TextDecoder("utf8");let Ir=0;let Br=0;const Wr=/^\s?#\s?Rebase\s([0-9a-f]+)(?:..([0-9a-f]+))?\sonto\s([0-9a-f]+)\s.*$/im,Lr=/^\s?(p|pick|r|reword|e|edit|s|squash|f|fixup|d|drop)\s([0-9a-f]+?)\s(.*)$/gm,Mr=new Map([["p","pick"],["pick","pick"],["r","reword"],["reword","reword"],["e","edit"],["edit","edit"],["s","squash"],["squash","squash"],["f","fixup"],["fixup","fixup"],["d","drop"],["drop","drop"]]);class RebaseEditorProvider{constructor(e){this.container=e,this.ascending=!1,this._disableAfterNextUse=!1,this._disposable=r.Disposable.from(r.window.registerCustomEditorProvider("gitlens.rebase",this,{supportsMultipleEditorsPerDocument:!1,webviewOptions:{enableFindWidget:!0,retainContextWhenHidden:!0}})),this.ascending="asc"===R.D.get("rebaseEditor.ordering")}dispose(){this._disposable.dispose()}get contextKeyPrefix(){return"gitlens:webview:rebase"}get enabled(){const e=R.D.inspectAny("workbench.editorAssociations")?.globalValue;if(null==e||0===e.length)return!0;if(Array.isArray(e)){const t=e.find((e=>"git-rebase-todo"===e.filenamePattern));return null==t||"gitlens.rebase"===t.viewType}const t=e["git-rebase-todo"];return null==t||"gitlens.rebase"===t}async enableForNextUse(){this.enabled||(await this.setEnabled(!0),this._disableAfterNextUse=!0)}async setEnabled(e){this._disableAfterNextUse=!1;const t=R.D.inspectAny("workbench.editorAssociations");let i=t?.globalValue;if(Array.isArray(i)&&(i=i.reduce(((e,t)=>(e[t.filenamePattern]=t.viewType,e)),Object.create(null))),null==i){if(e)return;i={"git-rebase-todo":"default"}}else i["git-rebase-todo"]=e?"gitlens.rebase":"default";await R.D.updateAny("workbench.editorAssociations",i,r.ConfigurationTarget.Global)}async resolveCustomTextEditor(e,t,i){this.container.usage.track("rebaseEditor:shown");const s=(0,$.AH)(r.Uri.joinPath(e.uri,"..","..","..").fsPath),n=this.container.git.getRepository(s),o=[],a={dispose:()=>{r.Disposable.from(...o).dispose()},id:(Br===Or?Br=1:Br++,Br),subscriptions:o,document:e,panel:t,repoPath:n?.path??s,firstSelection:!0};o.push(t.onDidDispose((()=>{(0,yr.qW)(this.contextKeyPrefix),r.Disposable.from(...o).dispose()})),t.onDidChangeViewState((e=>this.onViewStateChanged(a,e))),t.webview.onDidReceiveMessage((e=>this.onMessageReceived(a,e))),r.workspace.onDidChangeTextDocument((t=>{0!==t.contentChanges.length&&t.document.uri.toString()===e.uri.toString()&&this.updateState(a,!0)})),r.workspace.onDidSaveTextDocument((t=>{t.uri.toString()===e.uri.toString()&&this.updateState(a,!0)}))),null!=n&&o.push(n.onDidChange((e=>{e.changed(b.I6.Rebase,b.du.Any)&&this.updateState(a)}))),t.webview.options={enableCommandUris:!0,enableScripts:!0},t.webview.html=await this.getHtml(a),this._disableAfterNextUse&&(this._disableAfterNextUse=!1,this.setEnabled(!1))}onViewFocusChanged(e){(0,yr.Db)(this.contextKeyPrefix,e.focused,e.focused,e.inputFocused)}onViewStateChanged(e,t){const{active:i,visible:r}=t.webviewPanel;r?(0,yr.Db)(this.contextKeyPrefix,i):(0,yr.qW)(this.contextKeyPrefix),e.pendingChange&&this.updateState(e)}async parseState(e){if(void 0===e.branchName){const t=await this.container.git.getBranch(e.repoPath);e.branchName=t?.name??null}const t=await async function(e,t,i){const r=t.document.getText(),s=Ur(r);let[,,,n]=Wr.exec(r)??["","",""];null!=t.authors&&null!=t.commits||await async function(e,t,i,r){t.commits=[],t.authors=new Map;const s=await e.git.richSearchCommits(t.repoPath,{query:`${i?`#:${i} `:""}${(0,T.v_)((0,T.UI)(r,(e=>`#:${e.sha}`))," ")}`},{limit:0});if(null!=s)for(const e of s.commits.values())if(t.commits.push(e),t.authors.has(e.author.name)||t.authors.set(e.author.name,{author:e.author.name,avatarUrl:(await e.getAvatarUri()).toString(!0),email:e.author.email}),!t.authors.has(e.committer.name)){const i=await e.committer.getAvatarUri(e);t.authors.set(e.committer.name,{author:e.committer.name,avatarUrl:i.toString(!0),email:e.committer.email})}}(e,t,n,s);const a=R.D.get("defaultDateFormat"),c=fr.CE.getMarkdownCommandArgs("${commit}",t.repoPath),l=n?t.commits?.find((e=>e.sha.startsWith(n))):void 0;let h;for(const e of s)h=t.commits?.find((t=>t.sha.startsWith(e.sha))),null!=h&&(h.sha===l?.sha&&(n=""),e.commit={sha:h.sha,author:h.author.name,committer:h.committer.name,date:h.formatDate(a),dateFromNow:h.formatDateFromNow(),message:(0,o.X)(h.message??h.summary)});return{timestamp:Date.now(),branch:t.branchName??"",onto:n?{sha:n,commit:null!=l?{sha:l.sha,author:l.author.name,committer:l.committer.name,date:l.formatDate(a),dateFromNow:l.formatDateFromNow(),message:(0,o.X)(l.message||"root")}:void 0}:void 0,entries:s,authors:null!=t.authors?Object.fromEntries(t.authors):{},commands:{commit:c},ascending:i}}(this.container,e,this.ascending);return t}async postMessage(e,t){try{const i=await e.panel.webview.postMessage(t);return e.pendingChange=!i,i}catch(t){return F.Yd.error(t),e.pendingChange=!0,!1}}onMessageReceived(e,t){switch(t.method){case vr.W2.method:(0,vr.mq)(vr.W2,t,(e=>{this.onViewFocusChanged(e)}));break;case br.method:(0,vr.mq)(br,t,(()=>this.abort(e)));break;case Cr.method:(0,vr.mq)(Cr,t,(()=>this.disable(e)));break;case Ar.method:(0,vr.mq)(Ar,t,(()=>(0,$e.dO)("editor.action.webvieweditor.showFind")));break;case Pr.method:(0,vr.mq)(Pr,t,(()=>this.rebase(e)));break;case Sr.method:(0,vr.mq)(Sr,t,(()=>this.switchToText(e)));break;case Rr.method:(0,vr.mq)(Rr,t,(t=>this.swapOrdering(t,e)));break;case Dr.method:(0,vr.mq)(Dr,t,(t=>this.onEntryChanged(e,t)));break;case kr.method:(0,vr.mq)(kr,t,(t=>this.onEntryMoved(e,t)));break;case _r.method:(0,vr.mq)(_r,t,(t=>this.onSelectionChanged(e,t)))}}async onEntryChanged(e,t){const i=Ur(e.document),s=i.find((e=>e.sha===t.sha));if(null==s)return;const n=e.document.positionAt(s.index),o=e.document.validateRange(new r.Range(new r.Position(n.line,0),new r.Position(n.line,Or)));let a=t.action;const c=new r.WorkspaceEdit,l=[...i];l.splice(i.indexOf(s),1,{...s,action:t.action});let h=!1;for(const e of l)"squash"===e.action||"fixup"===e.action?h=!0:h&&"drop"!==e.action&&(h=!1);if(h){const t=l[l.length-1];if(s.sha===t.sha)a="pick";else{const i=e.document.positionAt(t.index),s=e.document.validateRange(new r.Range(new r.Position(i.line,0),new r.Position(i.line,Or)));c.replace(e.document.uri,s,`pick ${t.sha} ${t.message}`)}}c.replace(e.document.uri,o,`${a} ${s.sha} ${s.message}`),await r.workspace.applyEdit(c)}async onEntryMoved(e,t){const i=Ur(e.document),s=i.find((e=>e.sha===t.sha));if(null==s)return;const n=i.findIndex((e=>e.sha===t.sha));let o;if(t.relative){if(-1===t.to&&0===n||1===t.to&&n===i.length-1)return;o=n+t.to}else{if(n===t.to)return;o=t.to}const a=i[o];let c=e.document.positionAt(a.index).line;o<n&&c++;const l=e.document.positionAt(s.index),h=e.document.validateRange(new r.Range(new r.Position(l.line,0),new r.Position(l.line+1,0))),u=[...i];u.splice(n,1),u.splice(o,0,s);let d=!1;for(const e of u)"squash"===e.action||"fixup"===e.action?d=!0:d&&"drop"!==e.action&&(d=!1);const p=new r.WorkspaceEdit;let m=s.action;if(d){const t=u[u.length-1];if(s.sha===t.sha)m="pick";else{const i=e.document.positionAt(t.index),s=e.document.validateRange(new r.Range(new r.Position(i.line,0),new r.Position(i.line,Or)));p.replace(e.document.uri,s,`pick ${t.sha} ${t.message}`)}}p.delete(e.document.uri,h),p.insert(e.document.uri,new r.Position(c,0),`${m} ${s.sha} ${s.message}\n`),await r.workspace.applyEdit(p)}onSelectionChanged(e,t){null==e.fireSelectionChangedDebounced&&(e.fireSelectionChangedDebounced=(0,B.Ds)(this.fireSelectionChanged.bind(this),250)),e.fireSelectionChangedDebounced(e,t.sha)}fireSelectionChanged(e,t){if(null==t)return;const i=R.D.get("rebaseEditor.showDetailsView");t=e.commits?.find((e=>e.sha.startsWith(t)))?.sha??t,this.container.events.fire("commit:selected",{commit:(0,v.xB)(t,e.repoPath,{refType:"revision"}),interaction:"passive",preserveFocus:!0,preserveVisibility:e.firstSelection?!1===i:"selection"!==i},{source:"gitlens.rebase"}),e.firstSelection=!1}updateState(e,t=!1){if(t)return e.notifyDidChangeStateDebounced?.cancel(),void this.notifyDidChangeState(e);null==e.notifyDidChangeStateDebounced&&(e.notifyDidChangeStateDebounced=(0,B.Ds)(this.notifyDidChangeState.bind(this),250)),e.notifyDidChangeStateDebounced(e)}async notifyDidChangeState(e){if(!e.panel.visible)return void(e.pendingChange=!0);const t=await this.parseState(e);this.postMessage(e,{id:(Ir===Or?Ir=1:Ir++,`host:${Ir}`),method:Tr.method,params:{state:t}})}async abort(e){e.dispose();const t=new r.WorkspaceEdit;t.replace(e.document.uri,new r.Range(0,0,e.document.lineCount,0),""),await r.workspace.applyEdit(t),await e.document.save(),e.panel.dispose()}async disable(e){await this.abort(e),await this.setEnabled(!1)}async rebase(e){e.dispose(),await e.document.save(),e.panel.dispose()}swapOrdering(e,t){this.ascending=e.ascending??!1,R.D.updateEffective("rebaseEditor.ordering",this.ascending?"asc":"desc"),this.updateState(t,!0)}switchToText(e){(0,wr.QP)(),(0,$e.dO)("vscode.open",e.document.uri,{override:!1,preview:!1})}async getHtml(e){const t=r.Uri.joinPath(this.container.context.extensionUri,"dist","webviews"),i=r.Uri.joinPath(t,"rebase.html"),[s,n]=await Promise.all([r.workspace.fs.readFile(i),this.parseState(e)]);return(0,yr.Q5)(xr.decode(s),e.panel.webview.cspSource,(0,Ke.Vu)(),e.panel.webview.asWebviewUri(this.container.context.extensionUri).toString(),e.panel.webview.asWebviewUri(t).toString(),"editor",n)}}function Ur(e){const t="string"==typeof e?e:e.getText(),i=[];let r,s,n,o;for(;;){if(r=Lr.exec(t),null==r)break;[,s,n,o]=r,i.push({index:r.index,action:Mr.get(s)??"pick",sha:` ${n}`.substr(1),message:null==o||0===o.length?"":` ${o}`.substr(1)})}return i.reverse()}$r([(0,_.fF)({args:{0:e=>e.uri.toString(!0)}})],RebaseEditorProvider.prototype,"resolveCustomTextEditor",1),$r([(0,_.fF)({args:{0:e=>`focused=${e.focused}, inputFocused=${e.inputFocused}`}})],RebaseEditorProvider.prototype,"onViewFocusChanged",1),$r([(0,_.fF)({args:{0:e=>`${e.id}:${e.document.uri.toString(!0)}`,1:e=>`active=${e.webviewPanel.active}, visible=${e.webviewPanel.visible}`}})],RebaseEditorProvider.prototype,"onViewStateChanged",1),$r([(0,_.fF)({args:{0:e=>`${e.id}:${e.document.uri.toString(!0)}`}})],RebaseEditorProvider.prototype,"updateState",1),$r([(0,_.fF)({args:{0:e=>`${e.id}:${e.document.uri.toString(!0)}`}})],RebaseEditorProvider.prototype,"notifyDidChangeState",1),$r([(0,_.cM)({args:!1})],RebaseEditorProvider.prototype,"abort",1),$r([(0,_.cM)({args:!1})],RebaseEditorProvider.prototype,"disable",1),$r([(0,_.cM)({args:!1})],RebaseEditorProvider.prototype,"rebase",1),$r([(0,_.cM)({args:!1})],RebaseEditorProvider.prototype,"swapOrdering",1),$r([(0,_.cM)({args:!1})],RebaseEditorProvider.prototype,"switchToText",1);var Nr=i(1753);var Gr=Object.defineProperty,Hr=Object.getOwnPropertyDescriptor,Vr=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Hr(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Gr(t,i,n),n};const qr=class{constructor(e,t,s,o,a){this._onReady=new r.EventEmitter,this.BranchDateFormatting={dateFormat:void 0,dateStyle:void 0,reset:()=>{this.BranchDateFormatting.dateFormat=R.D.get("defaultDateFormat"),this.BranchDateFormatting.dateStyle=R.D.get("defaultDateStyle")}},this.CommitDateFormatting={dateFormat:null,dateSource:we.Vn.Authored,dateStyle:we.Dn.Relative,reset:()=>{this.CommitDateFormatting.dateFormat=R.D.get("defaultDateFormat"),this.CommitDateFormatting.dateSource=R.D.get("defaultDateSource"),this.CommitDateFormatting.dateStyle=R.D.get("defaultDateStyle")}},this.CommitShaFormatting={length:7,reset:()=>{this.CommitShaFormatting.length=Math.max(5,R.D.get("advanced.abbreviatedShaLength"))}},this.PullRequestDateFormatting={dateFormat:null,dateStyle:we.Dn.Relative,reset:()=>{this.PullRequestDateFormatting.dateFormat=R.D.get("defaultDateFormat"),this.PullRequestDateFormatting.dateStyle=R.D.get("defaultDateStyle")}},this.TagDateFormatting={dateFormat:null,dateStyle:we.Dn.Relative,reset:()=>{this.TagDateFormatting.dateFormat=R.D.get("defaultDateFormat"),this.TagDateFormatting.dateStyle=R.D.get("defaultDateStyle")}},this._deactivating=!1,this._ready=!1,this._context=e,this._prerelease=s,this._version=o,this.ensureModeApplied(),this._disposables=[this._storage=t,this._telemetry=new TelemetryService(this),this._usage=new UsageTracker(this,t),R.D.onDidChangeAny(this.onAnyConfigurationChanged,this)],this._richRemoteProviders=new RichRemoteProviderService(this);const c=new ServerConnection(this);this._disposables.push(c),this._disposables.push(this._subscriptionAuthentication=new SubscriptionAuthenticationProvider(this,c)),this._disposables.push(this._subscription=new wt(this,a)),this._disposables.push(this._workspaces=new WorkspacesService(this,c)),this._disposables.push(this._git=new GitProviderService(this)),this._disposables.push(new GitFileSystemProvider(this)),this._disposables.push(this._repositoryPathMapping=new RepositoryWebPathMappingProvider(this)),this._disposables.push(this._uri=new UriService(this)),this._disposables.push(this._deepLinks=new DeepLinkService(this)),this._disposables.push(this._actionRunners=new ge.AR(this)),this._disposables.push(this._tracker=new GitDocumentTracker(this)),this._disposables.push(this._lineTracker=new GitLineTracker(this)),this._disposables.push(this._keyboard=new Keyboard),this._disposables.push(this._vsls=new VslsController(this)),this._disposables.push(this._eventBus=new EventBus),this._disposables.push(this._ai=new AIProviderService(this)),this._disposables.push(this._fileAnnotationController=new oe.fK(this)),this._disposables.push(this._lineAnnotationController=new LineAnnotationController(this)),this._disposables.push(this._lineHoverController=new LineHoverController(this)),this._disposables.push(this._statusBarController=new StatusBarController(this)),this._disposables.push(this._codeLensController=new GitCodeLensController(this)),this._disposables.push(this._webviews=new Nr.V(this)),this._disposables.push(this._webviews.registerWebviewPanel(n.Gh.ShowTimelinePage,{id:"gitlens.timeline",fileName:"timeline.html",iconPath:"images/gitlens-icon.png",title:"Visual File History",contextKeyPrefix:"gitlens:webview:timeline",trackingFeature:"timelineWebview",plusFeature:!0,column:r.ViewColumn.Active,webviewHostOptions:{retainContextWhenHidden:!1,enableFindWidget:!1}},(async(e,t)=>{const{TimelineWebviewProvider:r}=await Promise.resolve().then(i.bind(i,9042));return new r(e,t)}))),this._disposables.push(this._timelineView=function(e){return e.registerWebviewView({id:"gitlens.views.timeline",fileName:"timeline.html",title:"Visual File History",contextKeyPrefix:"gitlens:webviewView:timeline",trackingFeature:"timelineView",plusFeature:!0,webviewHostOptions:{retainContextWhenHidden:!1}},(async(e,t)=>{const{TimelineWebviewProvider:r}=await Promise.resolve().then(i.bind(i,9042));return new r(e,t)}))}(this._webviews)),this._disposables.push(this._graphPanel=function(e){return e.registerWebviewPanel(n.Gh.ShowGraphPage,{id:"gitlens.graph",fileName:"graph.html",iconPath:"images/gitlens-icon.png",title:"Commit Graph",contextKeyPrefix:"gitlens:webview:graph",trackingFeature:"graphWebview",plusFeature:!0,column:r.ViewColumn.Active,webviewHostOptions:{retainContextWhenHidden:!0,enableFindWidget:!1}},(async(e,t)=>{const{GraphWebviewProvider:r}=await Promise.resolve().then(i.bind(i,1302));return new r(e,t)}),(()=>"editor"===R.D.get("graph.layout")))}(this._webviews)),this._disposables.push(Pt(this,this._graphPanel)),"panel"===R.D.get("graph.layout")&&this._disposables.push(this._graphView=At(this._webviews)),this._disposables.push(new GraphStatusBarController(this));const l=function(e){return e.registerWebviewPanel(n.Gh.ShowSettingsPage,{id:"gitlens.settings",fileName:"settings.html",iconPath:"images/gitlens-icon.png",title:"GitLens Settings",contextKeyPrefix:"gitlens:webview:settings",trackingFeature:"settingsWebview",plusFeature:!1,column:r.ViewColumn.Active,webviewHostOptions:{retainContextWhenHidden:!1,enableFindWidget:!0}},(async(e,t)=>{const{SettingsWebviewProvider:r}=await Promise.resolve().then(i.bind(i,5596));return new r(e,t)}))}(this._webviews);this._disposables.push(l),this._disposables.push(function(e){return r.Disposable.from(...[n.Gh.ShowSettingsPageAndJumpToBranchesView,n.Gh.ShowSettingsPageAndJumpToCommitsView,n.Gh.ShowSettingsPageAndJumpToContributorsView,n.Gh.ShowSettingsPageAndJumpToFileHistoryView,n.Gh.ShowSettingsPageAndJumpToLineHistoryView,n.Gh.ShowSettingsPageAndJumpToRemotesView,n.Gh.ShowSettingsPageAndJumpToRepositoriesView,n.Gh.ShowSettingsPageAndJumpToSearchAndCompareView,n.Gh.ShowSettingsPageAndJumpToStashesView,n.Gh.ShowSettingsPageAndJumpToTagsView,n.Gh.ShowSettingsPageAndJumpToWorkTreesView,n.Gh.ShowSettingsPageAndJumpToViews,n.Gh.ShowSettingsPageAndJumpToCommitGraph,n.Gh.ShowSettingsPageAndJumpToAutolinks].map((t=>{let i;const r=/.*?#(.*)/.exec(t);return null!=r&&([,i]=r),(0,$e.xR)(t,((...t)=>{e.show(void 0,i,...t)}))})))}(l)),this._disposables.push(function(e){return e.registerWebviewPanel(n.Gh.ShowWelcomePage,{id:"gitlens.welcome",fileName:"welcome.html",iconPath:"images/gitlens-icon.png",title:"Welcome to GitLens",contextKeyPrefix:"gitlens:webview:welcome",trackingFeature:"welcomeWebview",plusFeature:!1,column:r.ViewColumn.Active,webviewHostOptions:{retainContextWhenHidden:!1,enableFindWidget:!0}},(async(e,t)=>{const{WelcomeWebviewProvider:r}=await Promise.resolve().then(i.bind(i,7338));return new r(e,t)}))}(this._webviews)),this._disposables.push(this._rebaseEditor=new RebaseEditorProvider(this)),this._disposables.push(function(e){return e.registerWebviewPanel(n.Gh.ShowFocusPage,{id:"gitlens.focus",fileName:"focus.html",iconPath:"images/gitlens-icon.png",title:"Focus View",contextKeyPrefix:"gitlens:webview:focus",trackingFeature:"focusWebview",plusFeature:!0,column:r.ViewColumn.Active,webviewHostOptions:{retainContextWhenHidden:!0,enableFindWidget:!0}},(async(e,t)=>{const{FocusWebviewProvider:r}=await Promise.resolve().then(i.bind(i,1629));return new r(e,t)}))}(this._webviews)),this._disposables.push(new ViewFileDecorationProvider),this._disposables.push(this._repositoriesView=new Ri.a(this)),this._disposables.push(this._commitDetailsView=function(e){return e.registerWebviewView({id:"gitlens.views.commitDetails",fileName:"commitDetails.html",title:"Commit Details",contextKeyPrefix:"gitlens:webviewView:commitDetails",trackingFeature:"commitDetailsView",plusFeature:!1,webviewHostOptions:{retainContextWhenHidden:!1}},(async(e,t)=>{const{CommitDetailsWebviewProvider:r}=await Promise.resolve().then(i.bind(i,9206));return new r(e,t,{mode:"default"})}))}(this._webviews)),this._disposables.push(this._graphDetailsView=function(e){return e.registerWebviewView({id:"gitlens.views.graphDetails",fileName:"commitDetails.html",title:"Commit Graph Details",contextKeyPrefix:"gitlens:webviewView:commitDetails",trackingFeature:"commitDetailsView",plusFeature:!1,webviewHostOptions:{retainContextWhenHidden:!1}},(async(e,t)=>{const{CommitDetailsWebviewProvider:r}=await Promise.resolve().then(i.bind(i,9206));return new r(e,t,{mode:"graph"})}))}(this._webviews)),this._disposables.push(this._commitsView=new CommitsView(this)),this._disposables.push(this._fileHistoryView=new Ci.K(this)),this._disposables.push(this._lineHistoryView=new LineHistoryView(this)),this._disposables.push(this._branchesView=new BranchesView(this)),this._disposables.push(this._remotesView=new Si.L5(this)),this._disposables.push(this._stashesView=new StashesView(this)),this._disposables.push(this._tagsView=new Mi.wc(this)),this._disposables.push(this._worktreesView=new ji.m9(this)),this._disposables.push(this._contributorsView=new ContributorsView(this)),this._disposables.push(this._searchAndCompareView=new SearchAndCompareView(this)),this._disposables.push(this._workspacesView=new WorkspacesView(this)),this._disposables.push(this._homeView=function(e){return e.registerWebviewView({id:"gitlens.views.home",fileName:"home.html",title:"Home",contextKeyPrefix:"gitlens:webviewView:home",trackingFeature:"homeView",plusFeature:!1,webviewHostOptions:{retainContextWhenHidden:!1}},(async(e,t)=>{const{HomeWebviewProvider:r}=await Promise.resolve().then(i.bind(i,2384));return new r(e,t)}))}(this._webviews)),this._disposables.push(this._accountView=function(e){return e.registerWebviewView({id:"gitlens.views.account",fileName:"account.html",title:"GitKraken Account",contextKeyPrefix:"gitlens:webviewView:account",trackingFeature:"accountView",plusFeature:!1,webviewHostOptions:{retainContextWhenHidden:!1}},(async(e,t)=>{const{AccountWebviewProvider:r}=await Promise.resolve().then(i.bind(i,420));return new r(e,t)}))}(this._webviews)),R.D.get("terminalLinks.enabled")&&this._disposables.push(this._terminalLinks=new GitTerminalLinkProvider(this)),this._disposables.push(R.D.onDidChange((e=>{R.D.changed(e,"terminalLinks.enabled")&&(this._terminalLinks?.dispose(),R.D.get("terminalLinks.enabled")&&this._disposables.push(this._terminalLinks=new GitTerminalLinkProvider(this)))}))),e.subscriptions.push({dispose:()=>this._disposables.reverse().forEach((e=>{e.dispose()}))})}static#e;static#t=new Proxy({},{get:function(e,t){if(null!=qr.#e)return qr.#e[t];if("config"===t)return R.D.getAll();throw new Error("Container is not initialized")}});static create(e,t,i,r,s){if(null!=qr.#e)throw new Error("Container is already initialized");return qr.#e=new qr(e,t,i,r,s),qr.#e}static get instance(){return qr.#e??qr.#t}get onReady(){return this._onReady.event}deactivate(){this._deactivating=!0}get deactivating(){return this._deactivating}async ready(){if(this._ready)throw new Error("Container is already ready");this._ready=!0,await this.registerGitProviders(),queueMicrotask((()=>this._onReady.fire()))}async registerGitProviders(){const e=await async function(e){return[new GitHubGitProvider(e)]}(this);for(const t of e)this._disposables.push(this._git.register(t.descriptor.id,t));this._git.registrationComplete()}onAnyConfigurationChanged(e){R.D.changedAny(e,n.m1)&&(this._mode=void 0,R.D.changed(e,"outputLevel")&&(F.Yd.logLevel=(0,we.oE)(R.D.get("outputLevel"))),R.D.changed(e,"defaultGravatarsStyle")&&(0,fe.Wr)(R.D.get("defaultGravatarsStyle")),R.D.changed(e,"mode")&&this.ensureModeApplied(),R.D.changed(e,"graph.layout")&&("panel"===R.D.get("graph.layout")?(this._graphPanel?.close(),this._graphView=At(this._webviews)):(this._graphView?.dispose(),this._graphView=void 0)))}get actionRunners(){return this._actionRunners}get ai(){return this._ai}get autolinks(){return null==this._autolinks&&this._disposables.push(this._autolinks=new ne.P(this)),this._autolinks}get branchesView(){return this._branchesView}get codeLens(){return this._codeLensController}get commitsView(){return this._commitsView}get commitDetailsView(){return this._commitDetailsView}get context(){return this._context}get contributorsView(){return this._contributorsView}get debugging(){return this._context.extensionMode===r.ExtensionMode.Development}get env(){if(this.prereleaseOrDebugging){const e=R.D.getAny("gitkraken.env");if("dev"===e)return"dev";if("staging"===e)return"staging"}return"production"}get events(){return this._eventBus}get fileAnnotations(){return this._fileAnnotationController}get fileHistoryView(){return this._fileHistoryView}get git(){return this._git}get uri(){return this._uri}get deepLinks(){return this._deepLinks}get github(){return null==this._github&&(this._github=this._loadGitHubApi()),this._github}async _loadGitHubApi(){try{const e=new((await Promise.resolve().then(i.bind(i,9616))).GitHubApi)(this);return this._disposables.push(e),e}catch(e){return void F.Yd.error(e)}}get gitlab(){return null==this._gitlab&&(this._gitlab=this._loadGitLabApi()),this._gitlab}async _loadGitLabApi(){try{const e=new((await Promise.resolve().then(i.bind(i,1848))).GitLabApi)(this);return this._disposables.push(e),e}catch(e){return void F.Yd.error(e)}}get graphDetailsView(){return this._graphDetailsView}get graphView(){return null==this._graphView&&this._disposables.push(this._graphView=At(this._webviews)),this._graphView}get homeView(){return this._homeView}get accountView(){return this._accountView}get id(){return this._context.extension.id}get integrationAuthentication(){return null==this._integrationAuthentication&&this._disposables.push(this._integrationAuthentication=new IntegrationAuthenticationService(this),new Ue.z4(this),new Ne.h(this)),this._integrationAuthentication}get keyboard(){return this._keyboard}get lineAnnotations(){return this._lineAnnotationController}get lineHistoryView(){return this._lineHistoryView}get lineHovers(){return this._lineHoverController}get lineTracker(){return this._lineTracker}get repositoryPathMapping(){return this._repositoryPathMapping}get prerelease(){return this._prerelease}get prereleaseOrDebugging(){return this._prerelease||this.debugging}get rebaseEditor(){return this._rebaseEditor}get remotesView(){return this._remotesView}get repositoriesView(){return this._repositoriesView}get searchAndCompareView(){return this._searchAndCompareView}get subscription(){return this._subscription}get subscriptionAuthentication(){return this._subscriptionAuthentication}get richRemoteProviders(){return this._richRemoteProviders}get stashesView(){return this._stashesView}get statusBar(){return this._statusBarController}get storage(){return this._storage}get tagsView(){return this._tagsView}get telemetry(){return this._telemetry}get timelineView(){return this._timelineView}get tracker(){return this._tracker}get usage(){return this._usage}get version(){return this._version}get viewCommands(){return null==this._viewCommands&&(this._viewCommands=new si.s(this)),this._viewCommands}get vsls(){return this._vsls}get workspaces(){return this._workspaces}get workspacesView(){return this._workspacesView}get worktreesView(){return this._worktreesView}get mode(){return null==this._mode&&(this._mode=R.D.get("modes")?.[R.D.get("mode.active")]),this._mode}ensureModeApplied(){const e=this.mode;if(null!=e){if(null!=e.annotations){let t;switch(e.annotations){case"blame":t=n.Gh.ToggleFileBlame;break;case"changes":t=n.Gh.ToggleFileChanges;break;case"heatmap":t=n.Gh.ToggleFileHeatmap}if(null!=t){const i={type:e.annotations,on:!0};setTimeout($e.P0,50,t,i)}}R.D.applyOverrides({get:(t,i)=>{if(null!=e.annotations){if(R.D.matches(`${e.annotations}.toggleMode`,t,i))return i=we.TF.Window;if(R.D.matches(e.annotations,t,i))return i.toggleMode=we.TF.Window,i}for(const r of["codeLens","currentLine","hovers","statusBar"])if(null!=e[r]){if(R.D.matches(`${r}.enabled`,t,i))return i=e[r];if(R.D.matches(r,t,i))return i.enabled=e[r],i}return i},getAll:t=>(null!=e.annotations&&(t[e.annotations].toggleMode=we.TF.Window),null!=e.codeLens&&(t.codeLens.enabled=e.codeLens),null!=e.currentLine&&(t.currentLine.enabled=e.currentLine),null!=e.hovers&&(t.hovers.enabled=e.hovers),null!=e.statusBar&&(t.statusBar.enabled=e.statusBar),t),onDidChange:e=>{if(!R.D.changed(e,["mode","modes"]))return e;const t=e.affectsConfiguration;return{...e,affectsConfiguration:(e,i)=>!!/^gitlens\.(?:modes?|blame|changes|heatmap|codeLens|currentLine|hovers|statusBar)\b/.test(e)||t(e,i)}}})}else R.D.clearOverrides()}};let Qr=qr;function Yr(e){return e instanceof Qr}Vr([(0,_.cM)()],Qr.prototype,"registerGitProviders",1),Vr([(0,it.H)()],Qr.prototype,"debugging",1),Vr([(0,it.H)()],Qr.prototype,"env",1),Vr([(0,it.H)()],Qr.prototype,"id",1),Vr([(0,it.H)()],Qr.prototype,"prereleaseOrDebugging",1)},3148:(e,t,i)=>{i.d(t,{X:()=>a});const r="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";var s=i(3620);const n=/:([-+_a-z0-9]+):/g;let o;function a(e){return null==o&&(o=JSON.parse((0,s.QC)(r))),e.replace(n,((e,t)=>o[t]||e))}},3317:(e,t,i)=>{i.d(t,{U:()=>n});const{fromCharCode:r}=String,s=new TextEncoder;function n(e){let t="string"==typeof e?s.encode(e):e,i="";for(let e=0,{length:s}=t;e<s;e++)i+=r(t[e]);return globalThis.btoa(i)}},4290:(e,t,i)=>{i.d(t,{Vu:()=>l,FB:()=>h,Vj:()=>u});var r=i(3317);function s(e,t){let[i,r,s,n]=e;i+=(r&s|~r&n)+t[0]-680876936|0,i=(i<<7|i>>>25)+r|0,n+=(i&r|~i&s)+t[1]-389564586|0,n=(n<<12|n>>>20)+i|0,s+=(n&i|~n&r)+t[2]+606105819|0,s=(s<<17|s>>>15)+n|0,r+=(s&n|~s&i)+t[3]-1044525330|0,r=(r<<22|r>>>10)+s|0,i+=(r&s|~r&n)+t[4]-176418897|0,i=(i<<7|i>>>25)+r|0,n+=(i&r|~i&s)+t[5]+1200080426|0,n=(n<<12|n>>>20)+i|0,s+=(n&i|~n&r)+t[6]-1473231341|0,s=(s<<17|s>>>15)+n|0,r+=(s&n|~s&i)+t[7]-45705983|0,r=(r<<22|r>>>10)+s|0,i+=(r&s|~r&n)+t[8]+1770035416|0,i=(i<<7|i>>>25)+r|0,n+=(i&r|~i&s)+t[9]-1958414417|0,n=(n<<12|n>>>20)+i|0,s+=(n&i|~n&r)+t[10]-42063|0,s=(s<<17|s>>>15)+n|0,r+=(s&n|~s&i)+t[11]-1990404162|0,r=(r<<22|r>>>10)+s|0,i+=(r&s|~r&n)+t[12]+1804603682|0,i=(i<<7|i>>>25)+r|0,n+=(i&r|~i&s)+t[13]-40341101|0,n=(n<<12|n>>>20)+i|0,s+=(n&i|~n&r)+t[14]-1502002290|0,s=(s<<17|s>>>15)+n|0,r+=(s&n|~s&i)+t[15]+1236535329|0,r=(r<<22|r>>>10)+s|0,i+=(r&n|s&~n)+t[1]-165796510|0,i=(i<<5|i>>>27)+r|0,n+=(i&s|r&~s)+t[6]-1069501632|0,n=(n<<9|n>>>23)+i|0,s+=(n&r|i&~r)+t[11]+643717713|0,s=(s<<14|s>>>18)+n|0,r+=(s&i|n&~i)+t[0]-373897302|0,r=(r<<20|r>>>12)+s|0,i+=(r&n|s&~n)+t[5]-701558691|0,i=(i<<5|i>>>27)+r|0,n+=(i&s|r&~s)+t[10]+38016083|0,n=(n<<9|n>>>23)+i|0,s+=(n&r|i&~r)+t[15]-660478335|0,s=(s<<14|s>>>18)+n|0,r+=(s&i|n&~i)+t[4]-405537848|0,r=(r<<20|r>>>12)+s|0,i+=(r&n|s&~n)+t[9]+568446438|0,i=(i<<5|i>>>27)+r|0,n+=(i&s|r&~s)+t[14]-1019803690|0,n=(n<<9|n>>>23)+i|0,s+=(n&r|i&~r)+t[3]-187363961|0,s=(s<<14|s>>>18)+n|0,r+=(s&i|n&~i)+t[8]+1163531501|0,r=(r<<20|r>>>12)+s|0,i+=(r&n|s&~n)+t[13]-1444681467|0,i=(i<<5|i>>>27)+r|0,n+=(i&s|r&~s)+t[2]-51403784|0,n=(n<<9|n>>>23)+i|0,s+=(n&r|i&~r)+t[7]+1735328473|0,s=(s<<14|s>>>18)+n|0,r+=(s&i|n&~i)+t[12]-1926607734|0,r=(r<<20|r>>>12)+s|0,i+=(r^s^n)+t[5]-378558|0,i=(i<<4|i>>>28)+r|0,n+=(i^r^s)+t[8]-2022574463|0,n=(n<<11|n>>>21)+i|0,s+=(n^i^r)+t[11]+1839030562|0,s=(s<<16|s>>>16)+n|0,r+=(s^n^i)+t[14]-35309556|0,r=(r<<23|r>>>9)+s|0,i+=(r^s^n)+t[1]-1530992060|0,i=(i<<4|i>>>28)+r|0,n+=(i^r^s)+t[4]+1272893353|0,n=(n<<11|n>>>21)+i|0,s+=(n^i^r)+t[7]-155497632|0,s=(s<<16|s>>>16)+n|0,r+=(s^n^i)+t[10]-1094730640|0,r=(r<<23|r>>>9)+s|0,i+=(r^s^n)+t[13]+681279174|0,i=(i<<4|i>>>28)+r|0,n+=(i^r^s)+t[0]-358537222|0,n=(n<<11|n>>>21)+i|0,s+=(n^i^r)+t[3]-722521979|0,s=(s<<16|s>>>16)+n|0,r+=(s^n^i)+t[6]+76029189|0,r=(r<<23|r>>>9)+s|0,i+=(r^s^n)+t[9]-640364487|0,i=(i<<4|i>>>28)+r|0,n+=(i^r^s)+t[12]-421815835|0,n=(n<<11|n>>>21)+i|0,s+=(n^i^r)+t[15]+530742520|0,s=(s<<16|s>>>16)+n|0,r+=(s^n^i)+t[2]-995338651|0,r=(r<<23|r>>>9)+s|0,i+=(s^(r|~n))+t[0]-198630844|0,i=(i<<6|i>>>26)+r|0,n+=(r^(i|~s))+t[7]+1126891415|0,n=(n<<10|n>>>22)+i|0,s+=(i^(n|~r))+t[14]-1416354905|0,s=(s<<15|s>>>17)+n|0,r+=(n^(s|~i))+t[5]-57434055|0,r=(r<<21|r>>>11)+s|0,i+=(s^(r|~n))+t[12]+1700485571|0,i=(i<<6|i>>>26)+r|0,n+=(r^(i|~s))+t[3]-1894986606|0,n=(n<<10|n>>>22)+i|0,s+=(i^(n|~r))+t[10]-1051523|0,s=(s<<15|s>>>17)+n|0,r+=(n^(s|~i))+t[1]-2054922799|0,r=(r<<21|r>>>11)+s|0,i+=(s^(r|~n))+t[8]+1873313359|0,i=(i<<6|i>>>26)+r|0,n+=(r^(i|~s))+t[15]-30611744|0,n=(n<<10|n>>>22)+i|0,s+=(i^(n|~r))+t[6]-1560198380|0,s=(s<<15|s>>>17)+n|0,r+=(n^(s|~i))+t[13]+1309151649|0,r=(r<<21|r>>>11)+s|0,i+=(s^(r|~n))+t[4]-145523070|0,i=(i<<6|i>>>26)+r|0,n+=(r^(i|~s))+t[11]-1120210379|0,n=(n<<10|n>>>22)+i|0,s+=(i^(n|~r))+t[2]+718787259|0,s=(s<<15|s>>>17)+n|0,r+=(n^(s|~i))+t[9]-343485551|0,r=(r<<21|r>>>11)+s|0,e[0]=i+e[0]|0,e[1]=r+e[1]|0,e[2]=s+e[2]|0,e[3]=n+e[3]|0}function n(e){const t=[];for(let i=0;i<64;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t}const o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(e){let t="";for(let i=0;i<4;i+=1)t+=o[e>>8*i+4&15]+o[e>>8*i&15];return t}function c(e,t="hex"){const i=(r=function(e){const t=e.length;let i,r=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=t;i+=64)s(r,n(e.substring(i-64,i)));let o=(e=e.substring(i-64)).length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<o;i+=1)a[i>>2]|=e.charCodeAt(i)<<(i%4<<3);if(a[i>>2]|=128<<(i%4<<3),i>55)for(s(r,a),i=0;i<16;i+=1)a[i]=0;const c=(8*t).toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(c[2],16),h=parseInt(c[1],16)||0;return a[14]=l,a[15]=h,s(r,a),r}(e),r.map(a).join(""));var r;return"hex"===t?i:btoa(function(e){const t=[],i=e.length;for(let r=0;r<i-1;r+=2)t.push(parseInt(e.substr(r,2),16));return String.fromCharCode.apply(String,t)}(i))}function l(){return(0,r.U)(globalThis.crypto.getRandomValues(new Uint8Array(16)))}function h(e,t="hex"){return c(e,t)}function u(){return globalThis.crypto.randomUUID()}},9827:(e,t,i)=>{i.d(t,{Nx:()=>s,a_:()=>n,he:()=>r});const r=globalThis.fetch;function s(e){}async function n(e,t){return t()}},185:(e,t,i)=>{i.d(t,{d:()=>a,e:()=>o});const r=new TextDecoder,s=new TextEncoder,n=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function o(e){const t=s.encode(e),i=new Array(t.length);for(let e=0;e<t.length;++e)i[e]=n[t[e]];return i.join("")}function a(e){const t=e.match(/(\w{2})/g);if(null===t)return"";const i=new Uint8Array(t.map((e=>parseInt(e,16))));return r.decode(i)}},9376:(e,t,i)=>{function r(e){const t=.001*performance.now();let i=Math.floor(t),r=Math.floor(t%1*1e9);return void 0!==e&&(i-=e[0],r-=e[1],r<0&&(i--,r+=1e9)),[i,r]}i.d(t,{a:()=>r})},429:(e,t,i)=>{i.d(t,{$L:()=>r,ED:()=>c,IJ:()=>o,Xf:()=>l});const r=!0,s=navigator?.userAgentData?.platform,n=navigator.userAgent,o="Linux"===s||n.indexOf("Linux")>=0,a="macOS"===s||n.indexOf("Macintosh")>=0,c="Windows"===s||n.indexOf("Windows")>=0;function l(){return c?"web-windows":a?"web-macOS":o?"web-linux":"web"}},4575:(e,t,i)=>{i.d(t,{$y:()=>AccessDeniedError,Bn:()=>ProviderRequestClientError,Jx:()=>s,MO:()=>ProviderNotFoundError,R5:()=>ExtensionNotFoundError,Ww:()=>ProviderRequestNotFoundError,Xq:()=>ProviderFetchError,_7:()=>AuthenticationError,dt:()=>AccountValidationError,kX:()=>OpenVirtualRepositoryError,sh:()=>n,yx:()=>ProviderRequestRateLimitError});var r=i(4968);class AccessDeniedError extends Error{constructor(e,t){let i;i=!1===e.account?.verified?"Email verification required":null!=t&&(0,r.aG)(t)?"Paid plan required":"Plan required",super(i),this.subscription=e,this.required=t,Error.captureStackTrace?.(this,AccessDeniedError)}}class AccountValidationError extends Error{constructor(e,t,i,r){super(e+=`; status=${i}: ${r}`),this.original=t,this.statusCode=i,this.statusText=r,Error.captureStackTrace?.(this,AccountValidationError)}}var s=(e=>(e[e.UserDidNotConsent=1]="UserDidNotConsent",e[e.Unauthorized=2]="Unauthorized",e[e.Forbidden=3]="Forbidden",e))(s||{});class AuthenticationError extends Error{constructor(e,t,i){let r,s;if(null==t)r=`Unable to get required authentication session for '${e}'`;else if("string"==typeof t)r=t,s=void 0;else switch(s=t,s){case 1:r=`'${e}' authentication is required for this operation`;break;case 2:r=`Your '${e}' credentials are either invalid or expired`;break;case 3:r=`Your '${e}' credentials do not have the required access`}super(r),this.id=e,this.original=i,this.reason=s,Error.captureStackTrace?.(this,AuthenticationError)}}class ExtensionNotFoundError extends Error{constructor(e,t){super(`Unable to find the ${t} extension (${e}). Please ensure it is installed and enabled.`),this.extensionId=e,this.extensionName=t,Error.captureStackTrace?.(this,ExtensionNotFoundError)}}var n=(e=>(e[e.RemoteHubApiNotFound=1]="RemoteHubApiNotFound",e[e.NotAGitHubRepository=2]="NotAGitHubRepository",e[e.GitHubAuthenticationNotFound=3]="GitHubAuthenticationNotFound",e[e.GitHubAuthenticationDenied=4]="GitHubAuthenticationDenied",e))(n||{});class OpenVirtualRepositoryError extends Error{constructor(e,t,i){let r,s;if(null==t)r=`Unable to open the virtual repository: ${e}`;else if("string"==typeof t)r=t,s=void 0;else switch(s=t,r=`Unable to open the virtual repository: ${e}; `,s){case 1:r+="Unable to get required api from the GitHub Repositories extension. Please ensure that the GitHub Repositories extension is installed and enabled";break;case 2:r+="Only GitHub repositories are supported currently";break;case 3:r+="Unable to get required GitHub authentication";break;case 4:r+="GitHub authentication is required"}super(r),this.original=i,this.reason=s,this.repoPath=e,Error.captureStackTrace?.(this,OpenVirtualRepositoryError)}}class ProviderFetchError extends Error{constructor(e,t,i){super(`${e} request failed: ${t.ok?"":`(${t.status}) ${t.statusText}. `}${i?.length?i[0].message:""}`),this.response=t,Error.captureStackTrace?.(this,ProviderFetchError)}get status(){return this.response.status}get statusText(){return this.response.statusText}}class ProviderNotFoundError extends Error{constructor(e){super(`No provider registered for '${null==e?String(e):"string"==typeof e?e:e.toString(!0)}'`),Error.captureStackTrace?.(this,ProviderNotFoundError)}}class ProviderRequestClientError extends Error{constructor(e){super(e.message),this.original=e,Error.captureStackTrace?.(this,ProviderRequestClientError)}}class ProviderRequestNotFoundError extends Error{constructor(e){super(e.message),this.original=e,Error.captureStackTrace?.(this,ProviderRequestNotFoundError)}}class ProviderRequestRateLimitError extends Error{constructor(e,t,i){super(e.message),this.original=e,this.token=t,this.resetAt=i,Error.captureStackTrace?.(this,ProviderRequestRateLimitError)}}},8887:(e,t,i)=>{i.d(t,{A:()=>r,x:()=>s});var r=(e=>(e.Stashes="stashes",e.Timeline="timeline",e.Worktrees="worktrees",e.StashOnlyStaged="stashOnlyStaged",e))(r||{}),s=(e=>(e.Timeline="timeline",e.Worktrees="worktrees",e.Graph="graph",e.Focus="focus",e))(s||{})},9311:(e,t,i)=>{i.d(t,{g:()=>a,m:()=>o});var r=i(5255),s=i(9529),n=i(7469);async function o(e){const t=(0,n.PQ)();return await(0,s.P0)(r.Gh.GitCommands,{...e,completion:t}),t.promise}async function a(e,t){await(0,s.b2)(r.Gh.BrowseRepoAtRevision,void 0,{uri:e,before:t?.before,openInNewWindow:t?.openInNewWindow})}},3401:(e,t,i)=>{i.d(t,{Od:()=>o,PQ:()=>a,Ue:()=>n,ay:()=>c});var r=i(5567),s=i(9311);function n(e,t,i){return(0,s.m)({command:"branch",state:{subcommand:"create",repo:e,reference:t,name:i}})}function o(e,t){return(0,s.m)({command:"branch",state:{subcommand:"delete",repo:e,references:t}})}function a(e,t,i){return(0,s.m)({command:"branch",state:{subcommand:"rename",repo:e,reference:t,name:i}})}async function c(e,t){const i=e.remote?r.W.instance.remotesView:r.W.instance.branchesView,s=i.canReveal?await i.revealBranch(e,t):await r.W.instance.repositoriesView.revealBranch(e,t);return null==s&&i.show({preserveFocus:!t?.focus}),s}},6897:(e,t,i)=>{i.d(t,{$H:()=>p,$J:()=>E,Dh:()=>_,E4:()=>O,Fw:()=>$,GM:()=>x,Gp:()=>g,Hl:()=>T,Os:()=>P,Ou:()=>w,SJ:()=>m,Xy:()=>y,YM:()=>D,YS:()=>R,ZB:()=>S,aE:()=>k,ay:()=>F,ce:()=>b,iK:()=>C,tc:()=>A,vw:()=>v,wr:()=>f,zb:()=>d});var r=i(9496),s=i(5255),n=i(5567),o=i(9529),a=i(2509),c=i(7462),l=i(6450),h=i(439),u=i(4321);async function d(e,t,i){await S(e,t,{preserveFocus:!0,preview:!1});let r=t.ref;"string"!=typeof e&&"?"===e.status&&(r=`${r}^3`),await n.W.instance.git.applyChangesToWorkingFile(c.YY.fromFile(e,t.repoPath,r),r,i?.ref)}async function p(e){await r.env.clipboard.writeText(e.ref)}async function m(e){let t;if((0,l.f_)(e))t=e,null==t.message&&await t.ensureFullDetails();else if(t=await n.W.instance.git.getCommit(e.repoPath,e.ref),null==t)return;const i=t.message??t.summary;await r.env.clipboard.writeText(i)}async function g(e,t,i){let s,n;if((0,l.f_)(e)?(null==e.files&&await e.ensureFullDetails(),s=e.files??[],n={repoPath:e.repoPath,ref1:e.unresolvedPreviousSha,ref2:e.sha},i=t):(s=e,n=t),s.length>10){const e=await r.window.showWarningMessage(`Are you sure you want to open the changes for all ${s.length} files?`,{title:"Yes"},{title:"No",isCloseAffordance:!0});if(null==e||"No"===e.title)return}i={preserveFocus:!0,preview:!1,...i};for(const e of s)await v(e,n,i)}async function f(e,t){let i;if((0,l.f_)(e)?(null==e.files&&await e.ensureFullDetails(),i=e.files??[],t={repoPath:e.repoPath,ref:e.sha}):i=e,i.length>10){const e=await r.window.showWarningMessage(`Are you sure you want to open the changes for all ${i.length} files?`,{title:"Yes"},{title:"No",isCloseAffordance:!0});if(null==e||"No"===e.title)return}for(const e of i)y(e,t)}async function w(e,t,i){let s,n;if((0,l.f_)(e)?(null==e.files&&await e.ensureFullDetails(),s=e.files??[],n={repoPath:e.repoPath,ref:e.sha},i=t):(s=e,n=t),s.length>10){const e=await r.window.showWarningMessage(`Are you sure you want to open the changes for all ${s.length} files?`,{title:"Yes"},{title:"No",isCloseAffordance:!0});if(null==e||"No"===e.title)return}i={preserveFocus:!0,preview:!1,...i};for(const e of s)await b(e,n,i)}async function v(e,t,i){const r=(0,l.f_)(t);if("string"==typeof e){if(!r)throw new Error("Invalid arguments");const i=await t.findFile(e);if(null==i)throw new Error("Invalid arguments");e=i}if(i={preserveFocus:!0,preview:!1,...i},"A"===e.status&&r){const r=await t.getCommitForFile(e);return void(0,o.P0)(s.Gh.DiffWithPrevious,{commit:r,showOptions:i})}const n=r?{repoPath:t.repoPath,ref1:t.unresolvedPreviousSha,ref2:t.sha}:t,a=c.YY.fromFile(e,n.repoPath),h="R"===e.status||"C"===e.status?c.YY.fromFile(e,n.repoPath,n.ref2,!0):a;await(0,o.P0)(s.Gh.DiffWith,{repoPath:n.repoPath,lhs:{uri:a,sha:n.ref1},rhs:{uri:h,sha:n.ref2},showOptions:i})}async function y(e,t,i){if("string"==typeof e){if(!(0,l.f_)(t))throw new Error("Invalid arguments");const i=await t.findFile(e);if(null==i)throw new Error("Invalid arguments");e=i}return n.W.instance.git.openDiffTool(t.repoPath,c.YY.fromFile(e,e.repoPath??t.repoPath),{ref1:(0,u.l3)(t.ref)?"":`${t.ref}^`,ref2:(0,u.l3)(t.ref)?"":t.ref,staged:(0,u.rD)(t.ref)||null!=e.indexStatus,tool:i})}async function b(e,t,i){if("string"==typeof e){if(!(0,l.f_)(t))throw new Error("Invalid arguments");const i=await t.findFile(e);if(null==i)throw new Error("Invalid arguments");e=i}if("D"===e.status)return;let r;r=(0,l.f_)(t)?{repoPath:t.repoPath,ref:t.sha}:t,i={preserveFocus:!0,preview:!1,...i},await(0,o.b2)(s.Gh.DiffWithWorking,void 0,{uri:c.YY.fromFile(e,r.repoPath,r.ref),showOptions:i})}async function C(e,t,i,r){return n.W.instance.git.openDirectoryCompare(e,t,i,r)}async function A(e){return C(e.repoPath,e.ref,`${e.ref}^`)}async function P(e){return C(e.repoPath,e.ref,void 0)}async function S(e,t,i){let n;if(e instanceof r.Uri)n=e,i=t;else{const i=t;if(n=c.YY.fromFile(e,i.repoPath,i.ref),"string"!=typeof e&&"?"===e.status)return}i={preserveFocus:!0,preview:!1,...i},await(0,o.b2)(s.Gh.OpenWorkingFile,void 0,{uri:n,showOptions:i})}async function R(e,t,i){let s;if(e instanceof r.Uri){if((0,l.f_)(t))throw new Error("Invalid arguments");s=e,i=t}else{if(!(0,l.f_)(t))throw new Error("Invalid arguments");const i=t;let r;if("string"==typeof e){const t=await i.findFile(e);if(null==t)throw new Error("Invalid arguments");r=t}else r=e;s=n.W.instance.git.getRevisionUri("D"===r.status?await i.getPreviousSha()??h.Ii:i.sha,r,i.repoPath)}const{annotationType:o,line:c,...u}={preserveFocus:!0,preview:!1,...i};null!=c&&0!==c&&(u.selection=new r.Range(c,0,c,0));const d=await(0,a.GR)(s,u);null!=o&&null!=d&&await n.W.instance.fileAnnotations.show(d,o,{selection:{line:c}})}async function D(e,t){let i;if(e instanceof r.Uri)i=e;else{if(null==t)throw new Error("Invalid arguments");if(i=c.YY.fromFile(e,t.repoPath,t.ref),"string"!=typeof e&&"?"===e.status)return}await(0,o.P0)(s.Gh.OpenFileOnRemote,i,{sha:t?.ref})}async function k(e,t,i){let s;if((0,l.f_)(e)?(null==e.files&&await e.ensureFullDetails(),s=e.files??[],t=e.repoPath,i=e.sha):s=e,s.length>10){const e=await r.window.showWarningMessage(`Are you sure you want to open all ${s.length} files?`,{title:"Yes"},{title:"No",isCloseAffordance:!0});if(null==e||"No"===e.title)return}const o=(await Promise.all(s.map((e=>n.W.instance.git.getWorkingUri(t,c.YY.fromFile(e,t,i)))))).filter((e=>Boolean(e)));(0,a.$_)(o)}async function _(e,t,i,s){let o;if((0,l.f_)(e)?(null==e.files&&await e.ensureFullDetails(),o=e.files??[],t=e.repoPath,i=e.sha,s=await e.getPreviousSha()):o=e,o.length>10){const e=await r.window.showWarningMessage(`Are you sure you want to open all ${o.length} file revisions?`,{title:"Yes"},{title:"No",isCloseAffordance:!0});if(null==e||"No"===e.title)return}(0,a.$_)(o.map((e=>n.W.instance.git.getRevisionUri("D"===e.status?s:i,e,t))))}async function T(e,t){let i,r;"string"==typeof e?(i=e,r=t.ref):(i=e.path,r="?"===e.status?`${t.ref}^3`:"D"===e.status?`${t.ref}^`:t.ref),await n.W.instance.git.checkout(t.repoPath,r,{path:i})}async function F(e,t){const i=[n.W.instance.commitsView,n.W.instance.branchesView,n.W.instance.remotesView];for(const r of i){const i=r.canReveal?await r.revealCommit(e,t):await n.W.instance.repositoriesView.revealCommit(e,t);if(null!=i)return i}i[0].show({preserveFocus:!t?.focus})}async function E(e,t){if(null==t)return void await(0,o.P0)(s.Gh.ShowQuickCommit,{commit:e});let i;i=t instanceof r.Uri?t:c.YY.fromFile(t,e.repoPath,e.ref),await(0,o.P0)(s.Gh.ShowQuickCommitFile,i,{sha:e.sha})}function $(e,t){const{preserveFocus:i,...r}={...t,commit:e};return n.W.instance.commitDetailsView.show({preserveFocus:i},r)}function O(e,t){const{preserveFocus:i,...r}={...t,commit:e};return n.W.instance.graphDetailsView.show({preserveFocus:i},r)}async function x(e,t){await(0,o.P0)(s.Gh.ShowInCommitGraph,{ref:(0,u.qj)(e),preserveFocus:t?.preserveFocus})}},7445:(e,t,i)=>{i.d(t,{a:()=>o,q:()=>n});var r=i(5567),s=i(9311);function n(e,t){return(0,s.m)({command:"co-authors",state:{repo:e,contributors:t}})}async function o(e,t){const i=r.W.instance.contributorsView,s=i.canReveal?await i.revealContributor(e,t):await r.W.instance.repositoriesView.revealContributor(e,t);return null==s&&i.show({preserveFocus:!t?.focus}),s}},4155:(e,t,i)=>{i.d(t,{IH:()=>n,Od:()=>c,Qs:()=>a,ay:()=>l,he:()=>o});var r=i(5567),s=i(9311);function n(e,t,i,r){return(0,s.m)({command:"remote",confirm:r?.confirm,state:{repo:e,subcommand:"add",name:t,url:i,flags:r?.fetch?["-f"]:void 0,reveal:r?.reveal}})}async function o(e,t){if("string"==typeof e){const t=r.W.instance.git.getRepository(e);if(null==t)return;e=t}await e.fetch({remote:t})}async function a(e,t){return(0,s.m)({command:"remote",state:{repo:e,subcommand:"prune",remote:t}})}async function c(e,t){return(0,s.m)({command:"remote",state:{repo:e,subcommand:"remove",remote:t}})}async function l(e,t){const i=r.W.instance.remotesView,s=null!=e?i.canReveal?await i.revealRemote(e,t):await r.W.instance.repositoriesView.revealRemote(e,t):void 0;return null==s&&i.show({preserveFocus:!t?.focus}),s}},8834:(e,t,i)=>{i.d(t,{CU:()=>p,DW:()=>u,QP:()=>o,TS:()=>c,VF:()=>h,X4:()=>l,ay:()=>g,gu:()=>m,he:()=>a,mc:()=>d,qM:()=>f});var r=i(5567),s=i(9529),n=i(9311);function o(e,t){return(0,n.m)({command:"cherry-pick",state:{repo:e,references:t}})}function a(e,t){return(0,n.m)({command:"fetch",state:{repos:e,reference:t}})}function c(e,t){return(0,n.m)({command:"merge",state:{repo:e,reference:t}})}function l(e,t){return(0,n.m)({command:"pull",state:{repos:e,reference:t}})}function h(e,t,i){return(0,n.m)({command:"push",state:{repos:e,flags:t?["--force"]:[],reference:i}})}function u(e,t,i=!0){return(0,n.m)({command:"rebase",state:{repo:e,reference:t,flags:i?["--interactive"]:[]}})}function d(e,t,i){return(0,n.m)({command:"reset",confirm:null==i||i.includes("--hard"),state:{repo:e,reference:t,flags:i}})}function p(e,t){return(0,n.m)({command:"revert",state:{repo:e,references:t}})}function m(e,t,i){return(0,n.m)({command:"switch",state:{repos:e,reference:t},confirm:i})}async function g(e,t,i){const s=t?.canReveal?await t.revealRepository(e,i):await r.W.instance.repositoriesView.revealRepository(e,i);return null==s&&(t??r.W.instance.repositoriesView).show({preserveFocus:!i?.focus}),s}async function f(e){await(0,s.dO)("revealFileInOS",e.uri)}},252:(e,t,i)=>{i.d(t,{Cw:()=>o,Fw:()=>u,PQ:()=>a,Sw:()=>c,VF:()=>l,ay:()=>h,nn:()=>n});var r=i(5567),s=i(9311);function n(e,t){return(0,s.m)({command:"stash",state:{subcommand:"apply",repo:e,reference:t}})}function o(e,t){return(0,s.m)({command:"stash",state:{subcommand:"drop",repo:e,reference:t}})}function a(e,t,i){return(0,s.m)({command:"stash",state:{subcommand:"rename",repo:e,reference:t,message:i}})}function c(e,t){return(0,s.m)({command:"stash",state:{subcommand:"pop",repo:e,reference:t}})}function l(e,t,i,r=!1,n=!1,o){return(0,s.m)({command:"stash",state:{subcommand:"push",repo:e,uris:t,onlyStagedUris:o,message:i,flags:[...r?["--keep-index"]:[],...n?["--staged"]:[]]}})}async function h(e,t){const i=r.W.instance.stashesView,s=i.canReveal?await i.revealStash(e,t):await r.W.instance.repositoriesView.revealStash(e,t);return null==s&&i.show({preserveFocus:!t?.focus}),s}function u(e,t){const{preserveFocus:i,...s}={...t,commit:e};return r.W.instance.commitDetailsView.show({preserveFocus:i},s)}},6713:(e,t,i)=>{i.d(t,{Od:()=>o,Ue:()=>n,ay:()=>a});var r=i(5567),s=i(9311);function n(e,t,i){return(0,s.m)({command:"tag",state:{subcommand:"create",repo:e,reference:t,name:i}})}function o(e,t){return(0,s.m)({command:"tag",state:{subcommand:"delete",repo:e,references:t}})}async function a(e,t){const i=r.W.instance.tagsView,s=i.canReveal?await i.revealTag(e,t):await r.W.instance.repositoriesView.revealTag(e,t);return null==s&&i.show({preserveFocus:!t?.focus}),s}},5025:(e,t,i)=>{i.d(t,{BC:()=>m,Od:()=>h,Ue:()=>c,ay:()=>u,bA:()=>l,qM:()=>d});var r=i(5567),s=i(2800),n=i(9529),o=i(2509),a=i(9311);function c(e,t,i,r){return(0,a.m)({command:"worktree",state:{subcommand:"create",repo:e,uri:t,reference:i,createBranch:r?.createBranch,flags:r?.createBranch?["-b"]:void 0,reveal:r?.reveal}})}function l(e,t){return(0,a.m)({command:"worktree",state:{subcommand:"open",repo:e.repoPath,uri:e.uri,flags:p(t?.location)}})}function h(e,t){return(0,a.m)({command:"worktree",state:{subcommand:"delete",repo:e,uris:(0,s.zx)(t)}})}async function u(e,t){const i=r.W.instance.worktreesView,s=null!=e?i.canReveal?await i.revealWorktree(e,t):await r.W.instance.repositoriesView.revealWorktree(e,t):void 0;return null==s&&i.show({preserveFocus:!t?.focus}),s}async function d(e){await(0,n.dO)("revealFileInOS",e.uri)}function p(e){if(null!=e)switch(e){case o.Tc.NewWindow:return["--new-window"];case o.Tc.AddToWorkspace:return["--add-to-workspace"];case o.Tc.CurrentWindow:default:return[]}}function m(e){if(null!=e)return e.includes("--new-window")?o.Tc.NewWindow:e.includes("--add-to-workspace")?o.Tc.AddToWorkspace:o.Tc.CurrentWindow}},6592:(e,t,i)=>{i.d(t,{Nk:()=>WorktreeDeleteError,P6:()=>WorktreeCreateError,bk:()=>r,ef:()=>StashApplyError,g1:()=>s,hK:()=>n,l0:()=>GitSearchError,s8:()=>StashPushError,xe:()=>o});class GitSearchError extends Error{constructor(e){super(e.message),this.original=e,Error.captureStackTrace?.(this,GitSearchError)}}var r=(e=>(e[e.WorkingChanges=1]="WorkingChanges",e))(r||{});class StashApplyError extends Error{constructor(e,t){let i,r;null==e?i="Unable to apply stash":"string"==typeof e?(i=e,r=void 0):(r=e,i="Unable to apply stash. Your working tree changes would be overwritten. Please commit or stash your changes before trying again"),super(i),this.original=t,this.reason=r,Error.captureStackTrace?.(this,StashApplyError)}static is(e,t){return e instanceof StashApplyError&&(null==t||e.reason===t)}}var s=(e=>(e[e.ConflictingStagedAndUnstagedLines=1]="ConflictingStagedAndUnstagedLines",e))(s||{});class StashPushError extends Error{constructor(e,t){let i,r;if(null==e)i="Unable to stash";else if("string"==typeof e)i=e,r=void 0;else if(r=e,1===r)i="Stash was created, but the working tree cannot be updated because at least one file has staged and unstaged changes on the same line(s).\n\nDo you want to try again by stashing both your staged and unstaged changes?";else i="Unable to stash";super(i),this.original=t,this.reason=r,Error.captureStackTrace?.(this,StashApplyError)}static is(e,t){return e instanceof StashPushError&&(null==t||e.reason===t)}}var n=(e=>(e[e.AlreadyCheckedOut=1]="AlreadyCheckedOut",e[e.AlreadyExists=2]="AlreadyExists",e))(n||{});class WorktreeCreateError extends Error{constructor(e,t){let i,r;if(null==e)i="Unable to create worktree";else if("string"==typeof e)i=e,r=void 0;else switch(r=e,r){case 1:i="Unable to create worktree because it is already checked out";break;case 2:i="Unable to create worktree because it already exists"}super(i),this.original=t,this.reason=r,Error.captureStackTrace?.(this,WorktreeCreateError)}static is(e,t){return e instanceof WorktreeCreateError&&(null==t||e.reason===t)}}var o=(e=>(e[e.HasChanges=1]="HasChanges",e[e.MainWorkingTree=2]="MainWorkingTree",e))(o||{});class WorktreeDeleteError extends Error{constructor(e,t){let i,r;if(null==e)i="Unable to delete worktree";else if("string"==typeof e)i=e,r=void 0;else switch(r=e,r){case 1:i="Unable to delete worktree because there are uncommitted changes";break;case 2:i="Unable to delete worktree because it is a main working tree"}super(i),this.original=t,this.reason=r,Error.captureStackTrace?.(this,WorktreeDeleteError)}static is(e,t){return e instanceof WorktreeDeleteError&&(null==t||e.reason===t)}}},9338:(e,t,i)=>{i.d(t,{i:()=>CommitFormatter});var r=i(8388),s=i(9152),n=i(7139),o=i(2540),a=i(5255),c=i(5567),l=i(3148),h=i(2215),u=i(5148),d=i(3105),p=i(7469),m=i(3620),g=i(6450),f=i(439),w=i(4092),v=i(4321),y=i(3050),b=i(5485);class CommitFormatter extends b.M{reset(e,t){super.reset(e,t),null==this._options.outputFormat&&(this._options.outputFormat="plaintext")}get _authorDate(){return this._item.author.formatDate(this._options.dateFormat)}get _authorDateAgo(){return this._item.author.fromNow()}get _authorDateAgoShort(){return this._item.author.fromNow(!0)}get _committerDate(){return this._item.committer.formatDate(this._options.dateFormat)}get _committerDateAgo(){return this._item.committer.fromNow()}get _committerDateAgoShort(){return this._item.committer.fromNow(!0)}get _date(){return this._item.formatDate(this._options.dateFormat)}get _dateAgo(){return this._item.formatDateFromNow()}get _dateAgoShort(){return this._item.formatDateFromNow(!0)}get _pullRequestDate(){const{pullRequestOrRemote:e}=this._options;return null!=e&&w.i7.is(e)?e.formatDate(this._options.dateFormat)??"":""}get _pullRequestDateAgo(){const{pullRequestOrRemote:e}=this._options;return null!=e&&w.i7.is(e)?e.formatDateFromNow()??"":""}get _pullRequestDateOrAgo(){return(null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle"))===o.Dn.Absolute?this._pullRequestDate:this._pullRequestDateAgo}get ago(){return this._padOrTruncate(this._dateAgo,this._options.tokenOptions.ago)}get agoOrDate(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._date:this._dateAgo,this._options.tokenOptions.agoOrDate)}get agoOrDateShort(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._date:this._dateAgoShort,this._options.tokenOptions.agoOrDateShort)}get author(){let{name:e,email:t}=this._item.author;const i=this._padOrTruncate(e,this._options.tokenOptions.author);switch(this._options.outputFormat){case"markdown":return`[${i}](${t?`mailto:${t} "Email ${e} (${t})"`:`# "${e}"`})`;case"html":return e=(0,m.se)(e),t=(0,m.se)(t),`<a ${t?`href="mailto:${t}" title="Email ${e} (${t})"`:`href="#" title="${e}"`})${this._options.htmlFormat?.classes?.author?` class="${this._options.htmlFormat.classes.author}"`:""}>${i}</a>`;default:return i}}get authorAgo(){return this._padOrTruncate(this._authorDateAgo,this._options.tokenOptions.authorAgo)}get authorAgoOrDate(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._authorDate:this._authorDateAgo,this._options.tokenOptions.authorAgoOrDate)}get authorAgoOrDateShort(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._authorDate:this._authorDateAgoShort,this._options.tokenOptions.authorAgoOrDateShort)}get authorDate(){return this._padOrTruncate(this._authorDate,this._options.tokenOptions.authorDate)}get authorNotYou(){let{name:e,email:t}=this._item.author;if("You"===e)return this._padOrTruncate("",this._options.tokenOptions.authorNotYou);const i=this._padOrTruncate(e,this._options.tokenOptions.authorNotYou);switch(this._options.outputFormat){case"markdown":return`[${i}](${t?`mailto:${t} "Email ${e} (${t})"`:`# "${e}"`})`;case"html":return e=(0,m.se)(e),t=(0,m.se)(t),`<a ${t?`href="mailto:${t}" title="Email ${e} (${t})"`:`href="#" title="${e}"`})${this._options.htmlFormat?.classes?.author?` class="${this._options.htmlFormat.classes.author}"`:""}>${i}</a>`;default:return i}}get avatar(){const{outputFormat:e}=this._options;if("plaintext"===e||!u.D.get("hovers.avatars"))return this._padOrTruncate("",this._options.tokenOptions.avatar);let{name:t}=this._item.author;const i=this._options.presence;if(null!=i){let r=`${t} ${"You"===t?"are":"is"} ${"dnd"===i.status?"in ":""}${i.statusText.toLocaleLowerCase()}`;"html"===e&&(r=(0,m.se)(r));return this._getAvatar(e,r,this._options.avatarSize).then((t=>this._padOrTruncate(`${t}${this._getPresence(e,i,r)}`,this._options.tokenOptions.avatar)))}return"html"===e&&(t=(0,m.se)(t)),this._getAvatar(e,t,this._options.avatarSize)}async _getAvatar(e,t,i){i=i??u.D.get("hovers.avatarSize");const r=this._item.getAvatarUri({defaultStyle:u.D.get("defaultGravatarsStyle"),size:i}),s=(await r).toString(!0);return this._padOrTruncate("html"===e?`<img src="${s}" alt="title)" title="${t}" width="${i}" height="${i}"${this._options.htmlFormat?.classes?.avatar?` class="${this._options.htmlFormat.classes.avatar}"`:""} />`:`![${t}](${s}|width=${i},height=${i} "${t}")`,this._options.tokenOptions.avatar)}_getPresence(e,t,i){return"html"===e?`<img src="${(0,r.TU)(t.status)}" alt="${i}" title="${i}"${this._options.htmlFormat?.classes?.avatarPresence?` class="${this._options.htmlFormat.classes.avatarPresence}"`:""}/>`:`![${i}](${(0,r.TU)(t.status)} "${i}")`}get changes(){return this._padOrTruncate((0,g.f_)(this._item)?this._item.formatStats():"",this._options.tokenOptions.changes)}get changesDetail(){return this._padOrTruncate((0,g.f_)(this._item)?this._item.formatStats({expand:!0,separator:", "}):"",this._options.tokenOptions.changesDetail)}get changesShort(){return this._padOrTruncate((0,g.f_)(this._item)?this._item.formatStats({compact:!0,separator:""}):"",this._options.tokenOptions.changesShort)}get commands(){if("plaintext"===this._options.outputFormat||"html"===this._options.outputFormat)return this._padOrTruncate("",this._options.tokenOptions.commands);let e;if(this._item.isUncommitted){const{previousLineComparisonUris:t}=this._options;return null!=t?.previous?(e=`[\`${this._padOrTruncate((0,v.zL)((0,v.rD)(t.current.sha)?t.current.sha:f.CL),this._options.tokenOptions.commands)}\`](${s.CE.getMarkdownCommandArgs(this._item.sha,this._item.repoPath)} "Open Details")`,e+=` &nbsp;[$(chevron-left)$(compare-changes)](${s.V.getMarkdownCommandArgs({lhs:{sha:t.previous.sha??"",uri:t.previous.documentUri()},rhs:{sha:t.current.sha??"",uri:t.current.documentUri()},repoPath:this._item.repoPath,line:this._options.editor?.line})} "Open Changes with Previous Revision")`,e+=` &nbsp;[$(versions)](${s.DA.getMarkdownCommandArgs(c.W.instance.git.getRevisionUri(t.previous),o.VP.Blame,this._options.editor?.line)} "Open Blame Prior to this Change")`):e=`[\`${this._padOrTruncate((0,v.zL)(this._item.isUncommittedStaged?f.pw:f.CL),this._options.tokenOptions.commands)}\`](${s.CE.getMarkdownCommandArgs(this._item.sha,this._item.repoPath)} "Open Details")`,e}const t=" &nbsp;&nbsp;|&nbsp;&nbsp; ";if(e=`---\n\n[\`$(git-commit) ${this.id}\`](${s.CE.getMarkdownCommandArgs(this._item.sha,this._item.repoPath)} "Open Details")`,e+=` &nbsp;[$(chevron-left)$(compare-changes)](${s.V.getMarkdownCommandArgs(this._item,this._options.editor?.line)} "Open Changes with Previous Revision")`,null!=this._item.file&&null!=this._item.unresolvedPreviousSha){const t=c.W.instance.git.getRevisionUri(this._item.unresolvedPreviousSha,this._item.file.originalPath??this._item.file?.path,this._item.repoPath);e+=` &nbsp;[$(versions)](${s.DA.getMarkdownCommandArgs(t,o.VP.Blame,this._options.editor?.line)} "Open Blame Prior to this Change")`}if(e+=` &nbsp;[$(search)](${n.mY.getMarkdownCommandArgsCore(a.Gh.RevealCommitInView,{repoPath:this._item.repoPath,sha:this._item.sha,revealInView:!0})} "Reveal in Side Bar")`,(0,h.L)()&&(e+=` &nbsp;[$(gitlens-graph)](${n.mY.getMarkdownCommandArgsCore(a.Gh.ShowInCommitGraph,{ref:(0,v.qj)(this._item)})} "Open in Commit Graph")`),null!=this._options.remotes&&0!==this._options.remotes.length){const t=y.ss.getHighlanderProviders(this._options.remotes);e+=` &nbsp;[$(globe)](${s._f.getMarkdownCommandArgs(this._item.sha)} "Open Commit on ${t?.length?t[0].name:"Remote"}")`}const{pullRequestOrRemote:i}=this._options;if(null!=i&&(w.i7.is(i)?e+=`${t}[$(git-pull-request) PR #${i.id}](${C("openPullRequest",{repoPath:this._item.repoPath,provider:{id:i.provider.id,name:i.provider.name,domain:i.provider.domain},pullRequest:{id:i.id,url:i.url}})} "Open Pull Request \\#${i.id}${1==c.W.instance.actionRunners.count("openPullRequest")?` on ${i.provider.name}`:"..."}\n${a.NE.Dash.repeat(2)}\n${(0,m.ry)(i.title).replace(/"/g,'\\"')}\n${i.state}, ${i.formatDateFromNow()}")`:i instanceof p.PK?e+=`${t}[$(git-pull-request) PR $(loading~spin)](command:${a.Gh.RefreshHover} "Searching for a Pull Request (if any) that introduced this commit...")`:null!=i.provider&&u.D.get("integrations.enabled")&&(e+=`${t}[$(plug) Connect to ${i.provider.name}${a.NE.Ellipsis}](${s.tM.getMarkdownCommandArgs(i)} "Connect to ${i.provider.name} to enable the display of the Pull Request (if any) that introduced this commit")`)),c.W.instance.actionRunners.count("hover.commands")>0){const{name:i,email:r}=this._item.author;e+=`${t}[$(organization) Team${a.NE.SpaceThinnest}${a.NE.Ellipsis}](${C("hover.commands",{repoPath:this._item.repoPath,commit:{sha:this._item.sha,author:{name:i,email:r,presence:this._options.presence}},file:null!=this._options.editor?{uri:this._options.editor?.uri.toString(),line:this._options.editor?.line}:void 0})} "Show Team Actions")`}const r=this._item.getGitUri();return e+=`${t}[$(ellipsis)](${s.MZ.getMarkdownCommandArgs(null!=r?{revisionUri:c.W.instance.git.getRevisionUri(r).toString(!0)}:{commit:this._item})} "Show More Actions")`,this._padOrTruncate(e,this._options.tokenOptions.commands)}get committerAgo(){return this._padOrTruncate(this._committerDateAgo,this._options.tokenOptions.committerAgo)}get committerAgoOrDate(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._committerDate:this._committerDateAgo,this._options.tokenOptions.committerAgoOrDate)}get committerAgoOrDateShort(){const e=null!=this._options.dateStyle?this._options.dateStyle:u.D.get("defaultDateStyle");return this._padOrTruncate(e===o.Dn.Absolute?this._committerDate:this._committerDateAgoShort,this._options.tokenOptions.committerAgoOrDateShort)}get committerDate(){return this._padOrTruncate(this._committerDate,this._options.tokenOptions.committerDate)}get date(){return this._padOrTruncate(this._date,this._options.tokenOptions.date)}get email(){const{email:e}=this._item.author;return this._padOrTruncate(e??"",this._options.tokenOptions.email)}get footnotes(){const{outputFormat:e}=this._options;return this._padOrTruncate(null==this._options.footnotes||0===this._options.footnotes.size?"":(0,d.v_)((0,d.UI)(this._options.footnotes,(([t,i])=>"plaintext"===e?`${(0,m.sC)(t)} ${i}`:i)),"html"===e?"<br \\>":"markdown"===e?"\\\n":"\n"),this._options.tokenOptions.footnotes)}get id(){const e=this._padOrTruncate(this._item.shortSha??"",this._options.tokenOptions.id);return"plaintext"!==this._options.outputFormat&&this._options.unpublished?`<span style="color:#35b15e;"${this._options.htmlFormat?.classes?.id?` class="${this._options.htmlFormat.classes.id}"`:""}>${e} (unpublished)</span>`:e}get link(){let e;switch(this._options.outputFormat){case"markdown":e=`[\`$(git-commit) ${this._padOrTruncate(this._item.shortSha??"",this._options.tokenOptions.id)}\`](${s.CE.getMarkdownCommandArgs(this._item.sha,this._item.repoPath)} "Open Details")`;break;case"html":{const t=this._padOrTruncate(this._item.shortSha??"",this._options.tokenOptions.id);e=`<a href="${s.CE.getMarkdownCommandArgs(this._item.sha,this._item.repoPath)}" title="Open Details"${this._options.htmlFormat?.classes?.link?` class="${this._options.htmlFormat.classes.link}"`:""}><span class="codicon codicon-git-commit"></span>${t}</a>`;break}default:return this.id}return this._padOrTruncate(e,this._options.tokenOptions.link)}get message(){const{outputFormat:e}=this._options;if(this._item.isUncommitted){const t=this._item.file?.hasConflicts??!1,i=this._item.isUncommittedStaged||(this._options.previousLineComparisonUris?.current?.isUncommittedStaged??!1);let r=(t?"Merge":i?"Staged":"Uncommitted")+" changes";switch(e){case"html":r=`<span ${this._options.htmlFormat?.classes?.message?`class="${this._options.htmlFormat.classes.message}"`:""}>${r}</span>`;break;case"markdown":r=`\n> ${r}`}return this._padOrTruncate(r,this._options.tokenOptions.message)}let t=(this._options.messageTruncateAtNewLine?this._item.summary:this._item.message??this._item.summary).trim().replace(/\r?\n/g,"\n");switch(t=(0,l.X)(t),t=this._padOrTruncate(t,this._options.tokenOptions.message),"plaintext"!==e&&(t=(0,m.se)(t)),"markdown"===e&&(t=(0,m.ry)(t,{quoted:!0})),this._options.messageAutolinks&&(t=c.W.instance.autolinks.linkify(t,e,this._options.remotes,this._options.autolinkedIssuesOrPullRequests,this._options.footnotes)),null!=this._options.messageIndent&&"plaintext"===e&&(t=t.replace(/^/gm,a.NE.Space.repeat(this._options.messageIndent))),e){case"html":return`<span ${this._options.htmlFormat?.classes?.id?`class="${this._options.htmlFormat.classes.id}"`:""}>${t}</span>`;case"markdown":return`\n> ${t}`;default:return t}}get pullRequest(){const{pullRequestOrRemote:e}=this._options;if(null==e||"html"===this._options.outputFormat)return this._padOrTruncate("",this._options.tokenOptions.pullRequest);let t;if(w.i7.is(e))if("markdown"===this._options.outputFormat){const i=(0,m.ry)(e.title).replace(/"/g,'\\"').trim();if(t=`PR [**#${e.id}**](${C("openPullRequest",{repoPath:this._item.repoPath,provider:{id:e.provider.id,name:e.provider.name,domain:e.provider.domain},pullRequest:{id:e.id,url:e.url}})} "Open Pull Request \\#${e.id}${1==c.W.instance.actionRunners.count("openPullRequest")?` on ${e.provider.name}`:"..."}\n${a.NE.Dash.repeat(2)}\n${(0,m.ry)(e.title).replace(/"/g,'\\"')}\n${e.state}, ${e.formatDateFromNow()}")`,null!=this._options.footnotes){const t=this._options.footnotes.size+1;this._options.footnotes.set(t,`${w.i7.getMarkdownIcon(e)} [**${i}**](${e.url} "Open Pull Request \\#${e.id} on ${e.provider.name}")\\\n${a.NE.Space.repeat(4)} #${e.id} ${e.state.toLocaleLowerCase()} ${e.formatDateFromNow()}`)}}else if(null!=this._options.footnotes){const i=this._options.footnotes.size+1;this._options.footnotes.set(i,`PR #${e.id}: ${e.title}  ${a.NE.Dot}  ${e.state}, ${e.formatDateFromNow()}`),t=`PR #${e.id}${(0,m.sC)(i)}`}else t=`PR #${e.id}`;else{if(!(e instanceof p.PK))return this._padOrTruncate("",this._options.tokenOptions.pullRequest);t="markdown"===this._options.outputFormat?`[PR $(loading~spin)](command:${a.Gh.RefreshHover} "Searching for a Pull Request (if any) that introduced this commit...")`:this._options?.pullRequestPendingMessage??""}return this._padOrTruncate(t,this._options.tokenOptions.pullRequest)}get pullRequestAgo(){return this._padOrTruncate(this._pullRequestDateAgo,this._options.tokenOptions.pullRequestAgo)}get pullRequestAgoOrDate(){return this._padOrTruncate(this._pullRequestDateOrAgo,this._options.tokenOptions.pullRequestAgoOrDate)}get pullRequestDate(){return this._padOrTruncate(this._pullRequestDate,this._options.tokenOptions.pullRequestDate)}get pullRequestState(){const{pullRequestOrRemote:e}=this._options;return this._padOrTruncate(null!=e&&w.i7.is(e)?e.state??"":"",this._options.tokenOptions.pullRequestState)}get sha(){return this._padOrTruncate(this._item.shortSha??"",this._options.tokenOptions.sha)}get stashName(){return this._padOrTruncate(this._item.stashName??"",this._options.tokenOptions.stashName)}get stashNumber(){return this._padOrTruncate(this._item.number??"",this._options.tokenOptions.stashNumber)}get stashOnRef(){return this._padOrTruncate(this._item.stashOnRef??"",this._options.tokenOptions.stashOnRef)}get tips(){let e=this._options.getBranchAndTagTips?.(this._item.sha,{icons:"markdown"===this._options.outputFormat});if(null!=e&&"plaintext"!==this._options.outputFormat){const t=e.split(", ");e=t.map((e=>`<span style="color:#ffffff;background-color:#1d76db;"${this._options.htmlFormat?.classes?.tips?` class="${this._options.htmlFormat.classes.tips}"`:""}>&nbsp;&nbsp;${e}&nbsp;&nbsp;</span>`)).join(a.NE.Space.repeat(3))}return this._padOrTruncate(e??"",this._options.tokenOptions.tips)}static fromTemplate(e,t,i){if(null!=i&&"string"!=typeof i||(i={dateFormat:i}),CommitFormatter.has(e,"footnotes")&&null==i.footnotes&&(i.footnotes=new Map),CommitFormatter.has(e,"avatar")&&i?.outputFormat)throw new Error("Invalid template token 'avatar' used in non-async call");return super.fromTemplateCore(this,e,t,i)}static fromTemplateAsync(e,t,i){return CommitFormatter.has(e,"footnotes")&&(null!=i&&"string"!=typeof i||(i={dateFormat:i}),null==i.footnotes&&(i.footnotes=new Map)),super.fromTemplateCoreAsync(this,e,t,i)}static has(e,...t){return super.has(e,...t)}}function C(e,t){return n.mY.getMarkdownCommandArgsCore(`${a.Gh.ActionPrefix}${e}`,{...t,type:e})}},5485:(e,t,i)=>{i.d(t,{M:()=>a});var r=i(3620);const s=new Map,n=/ /g,o=class{constructor(e,t){this.collapsableWhitespace=0,this.reset(e,t)}reset(e,t){this._item=e,this.collapsableWhitespace=0,null==t&&null!=this._options||(null==t&&(t={}),null==t.dateFormat&&(t.dateFormat="MMMM Do, YYYY h:mma"),null==t.tokenOptions&&(t.tokenOptions={}),this._options=t)}_padOrTruncate(e,t){if(null==e||0===e.length)return e;null==t&&(t={collapseWhitespace:!1,padDirection:"left",prefix:void 0,suffix:void 0,truncateTo:void 0});let i=t.truncateTo;if(null==i)this.collapsableWhitespace=0;else{i+=this.collapsableWhitespace,this.collapsableWhitespace=0;const s=(0,r.dz)(e),n=i-s;n>0?(t.collapseWhitespace&&(this.collapsableWhitespace=n),"left"===t.padDirection?e=(0,r.Q_)(e,i,void 0,s):(t.collapseWhitespace&&(i-=n),e=(0,r.eh)(e,i,void 0,s))):n<0&&(e=(0,r.$G)(e,i,void 0,s))}return(t.prefix||t.suffix)&&(e=`${t.prefix??""}${e}${t.suffix??""}`),e}static fromTemplateCore(e,t,i,s){if(t=t.replace(n," "),e instanceof o)return(0,r.sX)(t,e);let a;if(a=null==s||"string"==typeof s?{dateFormat:s}:s,null==a.tokenOptions){const e=(0,r.Gg)(t).reduce(((e,t)=>(e[t.key]=t.options,e)),Object.create(null));a.tokenOptions=e}return null==this._formatter?this._formatter=new e(i,a):this._formatter.reset(i,a),(0,r.sX)(t,this._formatter)}static fromTemplateCoreAsync(e,t,i,s){if(t=t.replace(n," "),e instanceof o)return(0,r.Qu)(t,e);let a;if(a=null==s||"string"==typeof s?{dateFormat:s}:s,null==a.tokenOptions){const e=(0,r.Gg)(t).reduce(((e,t)=>(e[t.key]=t.options,e)),Object.create(null));a.tokenOptions=e}return null==this._formatter?this._formatter=new e(i,a):this._formatter.reset(i,a),(0,r.Qu)(t,this._formatter)}static has(e,...t){const i=1===t.length?t[0]:`(${t.join("|")})`;let r=s.get(i);return null==r&&(r=new RegExp(`\\b${i}\\b`),s.set(i,r)),r.test(e)}};let a=o;a._formatter=void 0},6373:(e,t,i)=>{i.d(t,{o:()=>StatusFileFormatter});var r=i(5255),s=i(3700),n=i(7881),o=i(5485);class StatusFileFormatter extends o.M{get directory(){const e=(0,n.OC)(this._item,!1,this._options.relativePath);return this._padOrTruncate(e,this._options.tokenOptions.directory)}get file(){const e=(0,s.EZ)(this._item.path);return this._padOrTruncate(e,this._options.tokenOptions.file)}get filePath(){const e=(0,n.PM)(this._item,{relativeTo:this._options.relativePath,truncateTo:this._options.tokenOptions.filePath?.truncateTo});return this._padOrTruncate(e,this._options.tokenOptions.filePath)}get originalPath(){const e=(0,n.Gv)(this._item,this._options.relativePath);return this._padOrTruncate(e,this._options.tokenOptions.originalPath)}get path(){const e=(0,n.W5)(this._item,this._options.relativePath);return this._padOrTruncate(e,this._options.tokenOptions.path)}get status(){const e=(0,n.K9)(this._item.status);return this._padOrTruncate(e,this._options.tokenOptions.status)}get working(){let e="";return e=null!=this._item.workingTreeStatus&&null!=this._item.indexStatus?`${r.NE.Pencil}${r.NE.Space}${r.NE.SpaceThinnest}${r.NE.Check}`:null!=this._item.workingTreeStatus?`${r.NE.Pencil}${r.NE.SpaceThin}${r.NE.SpaceThinnest}${r.NE.EnDash}${r.NE.Space}`:null!=this._item.indexStatus?`${r.NE.Space}${r.NE.EnDash}${r.NE.Space.repeat(2)}${r.NE.Check}`:"",this._padOrTruncate(e,this._options.tokenOptions.working)}get changes(){return this._padOrTruncate(n.K8.is(this._item)?this._item.formatStats():"",this._options.tokenOptions.changes)}get changesDetail(){return this._padOrTruncate(n.K8.is(this._item)?this._item.formatStats({expand:!0,separator:", "}):"",this._options.tokenOptions.changesDetail)}get changesShort(){return this._padOrTruncate(n.K8.is(this._item)?this._item.formatStats({compact:!0,separator:""}):"",this._options.tokenOptions.changesShort)}static fromTemplate(e,t,i){return super.fromTemplateCore(this,e,t,i)}}},2380:(e,t,i)=>{i.d(t,{pq:()=>r,q4:()=>s});var r=(e=>(e.Git="git",e.GitHub="github",e.Vsls="vsls",e))(r||{}),s=(e=>(e.Private="private",e.Public="public",e.Local="local",e))(s||{})},7462:(e,t,i)=>{i.d(t,{Wj:()=>C,YY:()=>b,uy:()=>A});var r=i(9496),s=i(185),n=i(4398),o=i(5255),a=i(5567),c=i(4298),l=i(4241),h=i(4488),u=i(1774),d=i(3700),p=i(2509),m=i(439),g=i(4321),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor,v=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&f(t,i,n),n};const y=class extends r.Uri{constructor(e,t){var i=(...e)=>{super(...e)};if(null==e)return void i({scheme:"unknown"});if(e.scheme===o.sN.GitLens){i({scheme:e.scheme,authority:e.authority,path:e.path,query:e.query,fragment:e.fragment});const r=function(e){return JSON.parse((0,s.d)(e))}(e.authority);this.repoPath=r.repoPath;let n=r.ref;return null!=t&&"string"!=typeof t&&(n=t.sha),void(!(0,g.rD)(n)&&(0,g.l3)(n)||(this.sha=n))}if((0,p.pt)(e)){i(e);const[,r,n]=e.path.split("/",3);this.repoPath=e.with({path:`/${r}/${n}`}).toString();const o=function(e){const[t,i]=e.authority.split("+");let r;if(i)try{r=JSON.parse((0,s.d)(i))}catch{}return{scheme:t,metadata:r}}(e);let a=o.metadata?.ref?.id;return null!=t&&"string"!=typeof t&&(a=t.sha),void(!a||!(0,g.rD)(a)&&(0,g.l3)(a)||(this.sha=a))}if(void 0===t)return void i(e);if("string"==typeof t)return i(e),void(this.repoPath=t);let r,n=e.authority,c=(0,d.AH)(a.W.instance.git.getAbsoluteUri(t.fileName??e.fsPath,t.repoPath).fsPath);if(47===c.charCodeAt(0)&&47===c.charCodeAt(1)){const e=c.indexOf("/",2);-1===e?(n=c.substring(2),c="/"):(n=c.substring(2,e),c=c.substring(e)||"/")}switch(e.scheme){case"https":case"http":case"file":r=c?47!==c.charCodeAt(0)?`/${c}`:c:"/";break;default:r=47!==c.charCodeAt(0)?`/${c}`:c}i({scheme:e.scheme,authority:n,path:r,query:e.query,fragment:e.fragment}),this.repoPath=t.repoPath,!(0,g.rD)(t.sha)&&(0,g.l3)(t.sha)||(this.sha=t.sha)}get directory(){return(0,d.Fd)(this.relativePath)}get fileName(){return(0,d.EZ)(this.relativePath)}get isUncommitted(){return(0,g.l3)(this.sha)}get isUncommittedStaged(){return(0,g.rD)(this.sha)}get relativePath(){return(0,d.uo)((0,d.M)(this.fsPath),this.repoPath)[0]}get shortSha(){return(0,g.zL)(this.sha)}documentUri(){return r.Uri.from({scheme:this.scheme,authority:this.authority,path:this.path,query:this.query,fragment:this.fragment})}equals(e){return!!c.n.equals(this,e)&&this.sha===(A(e)?e.sha:void 0)}getFormattedFileName(e){return(0,u.d)(this.fsPath,{...e,fileOnly:!0})}toFileUri(){return a.W.instance.git.getAbsoluteUri(this.fsPath,this.repoPath)}static fromFile(e,t,i,r=!1){const s=a.W.instance.git.getAbsoluteUri("string"==typeof e?e:r&&e.originalPath||e.path,t);return new y(s,i?{repoPath:t,sha:"string"!=typeof e&&"?"===e.status?`${i}^3`:i}:t)}static fromRepoPath(e,t){return new y(a.W.instance.git.getAbsoluteUri(e,e),t?{repoPath:e,sha:t}:e)}static fromRevisionUri(e){return new y(e)}static async fromUri(e){if(A(e))return e;if(!a.W.instance.git.isTrackable(e))return new y(e);if(e.scheme===o.sN.GitLens)return new y(e);if(e.scheme===o.sN.Git){const t=(0,n.h)(e);if(t?.path){const i=await a.W.instance.git.getOrOpenRepository(r.Uri.file(t.path));if(null==i)throw new Error(`Unable to find repository for uri=${r.Uri.file(t.path).toString(!0)}`);let s;switch(t.ref){case"":case"~":s=m.pw;break;case null:s=void 0;break;default:s=t.ref}const n={fileName:t.path,repoPath:i.path,sha:s};return new y(e,n)}}if(e.scheme===o.sN.PRs){let t;try{t=JSON.parse(e.query)}catch{}if(t?.fileName){const i=await a.W.instance.git.getOrOpenRepository(e);if(null==i)throw new Error(`Unable to find repository for uri=${r.Uri.file(t.fileName).toString(!0)}`);const s={fileName:t.fileName,repoPath:i.path,sha:t.isBase?t.baseCommit:t.headCommit};return new y(e,s)}}const t=await a.W.instance.git.getOrOpenRepository(e);return new y(e,t?.path)}};let b=y;v([(0,h.H)()],b.prototype,"directory",1),v([(0,h.H)()],b.prototype,"fileName",1),v([(0,h.H)()],b.prototype,"isUncommitted",1),v([(0,h.H)()],b.prototype,"isUncommittedStaged",1),v([(0,h.H)()],b.prototype,"relativePath",1),v([(0,h.H)()],b.prototype,"shortSha",1),v([(0,h.H)()],b.prototype,"documentUri",1),v([(0,h.H)()],b.prototype,"toFileUri",1),v([(0,l.fF)({exit:!0})],b,"fromUri",1);const C=Object.freeze(new b);function A(e){return e instanceof b}},5367:(e,t,i)=>{i.d(t,{BF:()=>R,Iq:()=>C,Lo:()=>S,S3:()=>P,Vx:()=>b,XI:()=>GitBranch,YF:()=>_,Yu:()=>y,fb:()=>T,g2:()=>k,uz:()=>D});var r=i(2540),s=i(5567),n=i(5148),o=i(7512),a=i(4241),c=i(4488),l=i(4336),h=i(7469),u=i(3620),d=i(4321),p=i(827),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&m(t,i,n),n};const w=/\s/,v=/^(?=.*\bHEAD\b)?(?=.*\bdetached\b).*$/;var y=(e=>(e.Ahead="ahead",e.Behind="behind",e.Diverged="diverged",e.Local="local",e.MissingUpstream="missingUpstream",e.Remote="remote",e.UpToDate="upToDate",e.Unpublished="unpublished",e))(y||{});function b(e,t,i){return`${e}|${t?"remotes/":"heads/"}${i}`}class GitBranch{constructor(e,t,i,r,s,n,o,a=0,c=0,l=!1,h=!1){this.repoPath=e,this.name=t,this.remote=i,this.current=r,this.date=s,this.sha=n,this.rebasing=h,this.refType="branch",this.id=b(e,i,t),this.detached=l||!!this.current&&D(t),this.detached&&(this.name=C(this.sha)),this.upstream=null==o?.name||0===o.name.length?void 0:o,this.state={ahead:a,behind:c}}toString(){return`${(0,l.q4)(this)}(${this.id})`}get formattedDate(){return s.W.instance.BranchDateFormatting.dateStyle===r.Dn.Absolute?this.formatDate(s.W.instance.BranchDateFormatting.dateFormat):this.formatDateFromNow()}get ref(){return this.detached?this.sha:this.name}formatDate(e){return null!=this.date?(0,o.p6)(this.date,e??"MMMM Do, YYYY h:mma"):""}formatDateFromNow(){return null!=this.date?(0,o.Zh)(this.date):""}async getAssociatedPullRequest(e){if(null==this._pullRequest){async function t(){const t=await this.getRemoteWithProvider();if(null==t)return;const i=this.getTrackingWithoutRemote()??this.getNameWithoutRemote();return s.W.instance.git.getPullRequestForBranch(i,t,e)}this._pullRequest=t.call(this)}return(0,h.HO)(this._pullRequest,e?.timeout)}getBasename(){const e=this.getNameWithoutRemote(),t=e.lastIndexOf("/");return-1!==t?e.substring(t+1):e}getNameWithoutRemote(){return this.remote?this.name.substring(A(this.name)+1):this.name}getTrackingWithoutRemote(){return this.upstream?.name.substring(A(this.upstream.name)+1)}async getRemote(){const e=this.getRemoteName();if(null==e)return;const t=await s.W.instance.git.getRemotes(this.repoPath);return 0!==t.length?t.find((t=>t.name===e)):void 0}async getRemoteWithProvider(){const e=this.getRemoteName();if(null==e)return;const t=await s.W.instance.git.getRemotesWithProviders(this.repoPath);return 0!==t.length?t.find((t=>t.name===e)):void 0}getRemoteName(){return this.remote?S(this.name):null!=this.upstream?S(this.upstream.name):void 0}async getStatus(){if(this.remote)return"remote";if(null!=this.upstream)return this.upstream.missing?"missingUpstream":this.state.ahead&&this.state.behind?"diverged":this.state.ahead?"ahead":this.state.behind?"behind":"upToDate";return(await s.W.instance.git.getRemotesWithProviders(this.repoPath)).length>0?"unpublished":"local"}getTrackingStatus(e){return(0,p.JP)(this.upstream,this.state,e)}get starred(){const e=s.W.instance.storage.getWorkspace("starred:branches");return void 0!==e&&!0===e[this.id]}star(){return s.W.instance.git.getRepository(this.repoPath)?.star(this)}unstar(){return s.W.instance.git.getRepository(this.repoPath)?.unstar(this)}}function C(e){return`(${(0,d.zL)(e)}...)`}function A(e){return e.startsWith("remotes/")?e.indexOf("/",8):e.indexOf("/")}function P(e){return e.substring(A(e)+1)}function S(e){return e.substring(0,A(e))}function R(e){return e instanceof GitBranch}function D(e){return w.test(e)||v.test(e)}function k(e){const t=A(e);return-1===t?[e,void 0]:[e.substring(t+1),e.substring(0,t)]}function _(e,t){switch((t={current:!0,orderBy:n.D.get("sortBranchesBy"),...t}).orderBy){case r.Vz.DateAsc:return e.sort(((e,i)=>(t.missingUpstream?(e.upstream?.missing?-1:1)-(i.upstream?.missing?-1:1):0)||(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(e.starred?-1:1)-(i.starred?-1:1)||(i.remote?-1:1)-(e.remote?-1:1)||(null==e.date?-1:e.date.getTime())-(null==i.date?-1:i.date.getTime())));case r.Vz.NameAsc:return e.sort(((e,i)=>(t.missingUpstream?(e.upstream?.missing?-1:1)-(i.upstream?.missing?-1:1):0)||(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(e.starred?-1:1)-(i.starred?-1:1)||("main"===e.name?-1:1)-("main"===i.name?-1:1)||("master"===e.name?-1:1)-("master"===i.name?-1:1)||("develop"===e.name?-1:1)-("develop"===i.name?-1:1)||(i.remote?-1:1)-(e.remote?-1:1)||(0,u.dm)(e.name,i.name)));case r.Vz.NameDesc:return e.sort(((e,i)=>(t.missingUpstream?(e.upstream?.missing?-1:1)-(i.upstream?.missing?-1:1):0)||(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(e.starred?-1:1)-(i.starred?-1:1)||("main"===e.name?-1:1)-("main"===i.name?-1:1)||("master"===e.name?-1:1)-("master"===i.name?-1:1)||("develop"===e.name?-1:1)-("develop"===i.name?-1:1)||(i.remote?-1:1)-(e.remote?-1:1)||(0,u.dm)(i.name,e.name)));case r.Vz.DateDesc:default:return e.sort(((e,i)=>(t.missingUpstream?(e.upstream?.missing?-1:1)-(i.upstream?.missing?-1:1):0)||(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(e.starred?-1:1)-(i.starred?-1:1)||(i.remote?-1:1)-(e.remote?-1:1)||(null==i.date?-1:i.date.getTime())-(null==e.date?-1:e.date.getTime())))}}async function T(e,t,i){let r;null==i||Array.isArray(i)||(i=[i]);do{r=await e.getBranches(null!=r?{paging:r.paging}:void 0);for(const e of r.values)if(e.name===t||null!=i&&null!=e.upstream?.name&&(i.includes(e.upstream?.name)||e.upstream.name.startsWith("remotes/")&&i.includes(e.upstream.name.substring(8))))return e}while(r.paging?.more)}f([(0,c.H)((e=>e??"MMMM Do, YYYY h:mma"))],GitBranch.prototype,"formatDate",1),f([(0,a.fF)()],GitBranch.prototype,"getAssociatedPullRequest",1),f([(0,c.H)()],GitBranch.prototype,"getBasename",1),f([(0,c.H)()],GitBranch.prototype,"getNameWithoutRemote",1),f([(0,c.H)()],GitBranch.prototype,"getTrackingWithoutRemote",1),f([(0,c.H)()],GitBranch.prototype,"getRemote",1),f([(0,c.H)()],GitBranch.prototype,"getRemoteWithProvider",1),f([(0,c.H)()],GitBranch.prototype,"getRemoteName",1),f([(0,c.H)()],GitBranch.prototype,"getStatus",1)},6450:(e,t,i)=>{i.d(t,{By:()=>R,G2:()=>S,_j:()=>GitCommitIdentity,aM:()=>A,f_:()=>P,yp:()=>D});var r=i(9496),s=i(8388),n=i(2540),o=i(5255),a=i(7512),c=i(5432),l=i(4488),h=i(4336),u=i(7469),d=i(3620),p=i(7462),m=i(439),g=i(7881),f=i(4321),w=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?v(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&w(t,i,n),n};const b=/stash@{(\d+)}/,C=class{constructor(e,t,i,r,s,n,a,c,l,h,u,d,p,m){this.container=e,this.repoPath=t,this.sha=i,this.author=r,this.committer=s,this.parents=a,this._stashUntrackedFilesLoaded=!1,this._recomputeStats=!1,this.ref=this.sha,this.shortSha=this.sha.substring(0,this.container.CommitShaFormatting.length),this.tips=d,p?(this.refType="stash",this.stashName=p||void 0,this.stashOnRef=m||void 0,this.number=b.exec(p)?.[1]):this.refType="revision",null!=c?(this._message=c,this._summary=n!==c?`${n} ${o.NE.Ellipsis}`:n):this._summary=`${n} ${o.NE.Ellipsis}`,null!=h&&(this._stats=h),null!=l&&(Array.isArray(l)?this._files=l:l instanceof g.K8?this._file=l:(null!=l.file&&(this._file=l.file),null!=l.files&&(this._files=l.files)),this._recomputeStats=!0),null!=u?Array.isArray(u)?this.lines=u:this.lines=[u]:this.lines=[]}toString(){return`${(0,h.q4)(this)}(${this.repoPath}|${this.shortSha})`}get date(){return this.container.CommitDateFormatting.dateSource===n.Vn.Committed?this.committer.date:this.author.date}get file(){return this._file}get files(){return this._files}get formattedDate(){return this.container.CommitDateFormatting.dateStyle===n.Dn.Absolute?this.formatDate(this.container.CommitDateFormatting.dateFormat):this.formatDateFromNow()}get isUncommitted(){return(0,f.l3)(this.sha)}get isUncommittedStaged(){return(0,f.rD)(this.sha)}get message(){return this._message}get name(){return this.stashName?this.stashName:this.shortSha}get stats(){return this._recomputeStats&&this.computeFileStats(),this._stats}get summary(){return this._summary}get unresolvedPreviousSha(){const e=this._resolvedPreviousSha??(null!=this.file?this.file.previousSha:this.parents[0])??`${this.sha}^`;return(0,f.j$)(e)?"HEAD":e}hasFullDetails(){return null!=this.message&&null!=this.files&&(this.isUncommitted&&this._etagFileSystem===this.container.git.getRepository(this.repoPath)?.etagFileSystem||0!==this.parents.length)&&("stash"!==this.refType||this._stashUntrackedFilesLoaded)}async ensureFullDetails(){if(this.hasFullDetails())return;if(this.isUncommitted){this._message="Uncommitted Changes";const e=this.container.git.getRepository(this.repoPath);if(this._etagFileSystem=e?.etagFileSystem,null!=this._etagFileSystem){const t=await this.container.git.getStatusForRepo(this.repoPath);null!=t&&(this._files=t.files.map((e=>new g.K8(this.repoPath,e.path,e.status,e.originalPath)))),this._etagFileSystem=e?.etagFileSystem}return void(null==this._files&&(this._files=null!=this.file?[this.file]:[]))}const[e,t]=await Promise.allSettled(["stash"!==this.refType?this.container.git.getCommit(this.repoPath,this.sha):void 0,"stash"!==this.refType||this._stashUntrackedFilesLoaded?void 0:this.container.git.getCommit(this.repoPath,`${this.stashName}^3`),this.getPreviousSha()]);let i;if("fulfilled"===e.status&&null!=e.value&&(i=e.value,this.parents.push(...i.parents??[]),this._summary=i.summary,this._message=i.message,this._files=i.files,null!=this._file)){const e=this._files.find((e=>e.path===this._file.path));null!=e&&(this._file=new g.K8(e.repoPath,e.path,e.status,e.originalPath??this._file.originalPath,e.previousSha??this._file.previousSha,e.stats??this._file.stats))}if("fulfilled"===t.status&&null!=t.value&&(this._stashUntrackedFilesLoaded=!0,i=t.value,null!=i?.files&&0!==i.files.length)){const e=i.files.map((e=>new g.K8(this.repoPath,e.path,g.Bh.Untracked,e.originalPath)));null==this._files?this._files=e:this._files.push(...e)}this._recomputeStats=!0}computeFileStats(){if(!this._recomputeStats||null==this._files)return;this._recomputeStats=!1;const e={added:0,deleted:0,changed:0};let t=0,i=0;for(const r of this._files)switch(null!=r.stats&&(t+=r.stats.additions,i+=r.stats.deletions),r.status){case"A":case"?":e.added++;break;case"D":e.deleted++;break;default:e.changed++}null!=this._stats&&(0===t&&0!==this._stats.additions&&(t=this._stats.additions),0===i&&0!==this._stats.deletions&&(i=this._stats.deletions)),this._stats={...this._stats,changedFiles:e,additions:t,deletions:i}}async findFile(e){if(!this.hasFullDetails()&&(await this.ensureFullDetails(),null==this._files))return;const t=this.container.git.getRelativePath(e,this.repoPath);return this._files?.find((e=>e.path===t))}formatDate(e){return this.container.CommitDateFormatting.dateSource===n.Vn.Committed?this.committer.formatDate(e):this.author.formatDate(e)}formatDateFromNow(e){return this.container.CommitDateFormatting.dateSource===n.Vn.Committed?this.committer.fromNow(e):this.author.fromNow(e)}formatStats(e){const t=this.stats;if(null==t)return e?.empty??"";const{changedFiles:i,additions:r,deletions:s}=t;if(R(i)<=0&&r<=0&&s<=0)return e?.empty??"";const{compact:n=!1,expand:a=!1,prefix:c="",sectionSeparator:l=` ${(0,d.vk)(o.NE.Dot,1,1,o.NE.Space)} `,separator:h=" ",suffix:u=""}=e??{};let p=c;if("number"==typeof i)i&&(p+=a?`${(0,d._6)("file",i)} changed`:`~${i}`);else{const{added:e,changed:t,deleted:s}=i;e?p+=a?`${(0,d._6)("file",e)} added`:`+${e}`:a||n||(p+="+0"),t?p+=`${e?h:""}${a?`${(0,d._6)("file",t)} changed`:`~${t}`}`:a||n||(p+="~0"),s?p+=`${t|r?h:""}${a?`${(0,d._6)("file",s)} deleted`:`-${s}`}`:a||n||(p+="-0")}return a&&(r&&(p+=`${i?l:""}${(0,d._6)("addition",r)}`),s&&(p+=`${i||r?h:""}${(0,d._6)("deletion",s)}`)),p+=u,p}async getAssociatedPullRequest(e){if(null==this._pullRequest){async function t(){const t=e?.remote??await this.container.git.getBestRemoteWithRichProvider(this.repoPath);if(null!=t?.provider)return this.container.git.getPullRequestForCommit(this.ref,t,e)}this._pullRequest=t.call(this)}return(0,u.HO)(this._pullRequest,e?.timeout)}getAvatarUri(e){return this.author.getAvatarUri(this,e)}getCachedAvatarUri(e){return this.author.getCachedAvatarUri(e)}async getCommitForFile(e){const t="string"==typeof e?this.container.git.getRelativePath(e,this.repoPath):e.path,i=await this.findFile(t);if(null==i)return;return this.with({files:{file:i}})}async getCommitsForFiles(){if(!this.hasFullDetails()&&(await this.ensureFullDetails(),null==this._files))return[];const e=this._files?.map((e=>this.with({files:{file:e}})));return e??[]}getGitUri(e=!1){const t=this._file?.uri??this.container.git.getAbsoluteUri(this.repoPath,this.repoPath);return e?new p.YY(this._file?.originalUri??t,{repoPath:this.repoPath,sha:this.unresolvedPreviousSha}):new p.YY(t,this)}getPreviousComparisonUrisForLine(e,t){return null!=this.file?this.container.git.getPreviousComparisonUrisForLine(this.repoPath,this.file.uri,e,t??(this.sha===m.CL?void 0:this.sha)):Promise.resolve(void 0)}async getPreviousSha(){if(null==this._previousShaPromise){async function e(){if(null!=this.file){if(null!=this.file.previousSha&&(0,f.D3)(this.file.previousSha))return this.file.previousSha;const e=await this.container.git.resolveReference(this.repoPath,(0,f.l3)(this.sha,!0)?"HEAD":`${this.sha}^`,this.file.originalPath??this.file.path);return this._resolvedPreviousSha=e,e}const e=this.parents[0];if(null!=e&&(0,f.D3)(e))return e;const t=await this.container.git.resolveReference(this.repoPath,(0,f.l3)(this.sha,!0)?"HEAD":`${this.sha}^`);return this._resolvedPreviousSha=t,t}this._previousShaPromise=e.call(this)}return this._previousShaPromise}getRepository(){return this.container.git.getRepository(this.repoPath)}async isPushed(){return this.container.git.hasCommitBeenPushed(this.repoPath,this.ref)}with(e){let t;return null!=e.files?(t={file:this._file,files:this._files},null!=e.files.file?t.file=e.files.file:null===e.files.file&&(t.file=void 0),null!=e.files.files?t.files=e.files.files:null===e.files.files&&(t.files=void 0)):null===e.files&&(t=void 0),new C(this.container,this.repoPath,e.sha??this.sha,this.author,this.committer,this.summary,this.getChangedValue(e.parents,this.parents)??[],this.message,t,this.stats,this.getChangedValue(e.lines,this.lines),this.tips,this.stashName,this.stashOnRef)}getChangedValue(e,t){return void 0===e?t:null!==e?e:void 0}};let A=C;function P(e){return e instanceof A}function S(e){return e instanceof A&&"stash"===e.refType&&Boolean(e.stashName)}y([(0,l.H)()],A.prototype,"isUncommitted",1),y([(0,l.H)()],A.prototype,"isUncommittedStaged",1),y([(0,c.H)()],A.prototype,"ensureFullDetails",1),y([(0,l.H)()],A.prototype,"getGitUri",1),y([(0,l.H)(((e,t)=>`${e}|${t??""}`))],A.prototype,"getPreviousComparisonUrisForLine",1),y([(0,c.H)()],A.prototype,"isPushed",1);class GitCommitIdentity{constructor(e,t,i,r){this.name=e,this.email=t,this.date=i,this.avatarUrl=r}formatDate(e){return(0,a.p6)(this.date,e??"MMMM Do, YYYY h:mma")}fromNow(e){return(0,a.Zh)(this.date,e)}getAvatarUri(e,t){return null!=this.avatarUrl?r.Uri.parse(this.avatarUrl):(0,s.oP)(this.email,e,t)}getCachedAvatarUri(e){return null!=this.avatarUrl?r.Uri.parse(this.avatarUrl):(0,s.x4)(this.email,e)}}function R(e){return null==e?0:"number"==typeof e?e:e.added+e.changed+e.deleted}function D(e){if(!e.hasFullDetails())throw new Error(`GitCommit(${e.sha}) is not fully loaded`)}y([(0,l.H)((e=>e??"MMMM Do, YYYY h:mma"))],GitCommitIdentity.prototype,"formatDate",1)},439:(e,t,i)=>{i.d(t,{CL:()=>s,Ii:()=>r,pw:()=>n});const r="0000000000000000000000000000000000000000-",s="0000000000000000000000000000000000000000",n="0000000000000000000000000000000000000000:"},1719:(e,t,i)=>{i.d(t,{V:()=>p});var r=i(9496),s=i(8388),n=i(2540),o=i(5148),a=i(7512),c=i(4488),l=i(3620),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor;const d=class{constructor(e,t,i,r,s,n=!1,o,a,c,l){this.repoPath=e,this.name=t,this.email=i,this.count=r,this.date=s,this.current=n,this.stats=o,this.username=a,this.avatarUrl=c,this.id=l}static is(e){return e instanceof d}static sort(e,t){switch((t={current:!0,orderBy:o.D.get("sortContributorsBy"),...t}).orderBy){case n.iP.CountAsc:return e.sort(((e,t)=>(e.current?-1:1)-(t.current?-1:1)||e.count-t.count||(e.date?.getTime()??0)-(t.date?.getTime()??0)));case n.iP.DateDesc:return e.sort(((e,i)=>(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(i.date?.getTime()??0)-(e.date?.getTime()??0)||i.count-e.count));case n.iP.DateAsc:return e.sort(((e,i)=>(t.current?(e.current?-1:1)-(i.current?-1:1):0)||(e.date?.getTime()??0)-(i.date?.getTime()??0)||i.count-e.count));case n.iP.NameAsc:return e.sort(((e,t)=>(e.current?-1:1)-(t.current?-1:1)||(0,l.dm)(e.name??e.username,t.name??t.username)));case n.iP.NameDesc:return e.sort(((e,t)=>(e.current?-1:1)-(t.current?-1:1)||(0,l.dm)(t.name??t.username,e.name??e.username)));case n.iP.CountDesc:default:return e.sort(((e,t)=>(e.current?-1:1)-(t.current?-1:1)||t.count-e.count||(t.date?.getTime()??0)-(e.date?.getTime()??0)))}}get label(){return this.name??this.username}formatDate(e){return null!=this.date?(0,a.p6)(this.date,e??"MMMM Do, YYYY h:mma"):""}formatDateFromNow(e){return null!=this.date?(0,a.Zh)(this.date,e):""}getAvatarUri(e){return null!=this.avatarUrl?r.Uri.parse(this.avatarUrl):(0,s.oP)(this.email,void 0,e)}getCoauthor(){return`${this.name}${this.email?` <${this.email}>`:""}`}};let p=d;((e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&h(t,i,n)})([(0,c.H)((e=>e??"MMMM Do, YYYY h:mma"))],p.prototype,"formatDate",1)},7881:(e,t,i)=>{i.d(t,{Bh:()=>m,Gv:()=>w,K8:()=>D,K9:()=>S,NV:()=>p,OC:()=>g,PM:()=>f,Qw:()=>A,Vz:()=>d,W5:()=>v,tK:()=>b});var r=i(5255),s=i(5567),n=i(4488),o=i(1774),a=i(3700),c=i(3620),l=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?h(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&l(t,i,n),n},d=(e=>(e.AddedByBoth="AA",e.AddedByUs="AU",e.AddedByThem="UA",e.DeletedByBoth="DD",e.DeletedByUs="DU",e.DeletedByThem="UD",e.ModifiedByBoth="UU",e))(d||{}),p=(e=>(e.Modified="M",e.Added="A",e.Deleted="D",e.Renamed="R",e.Copied="C",e.Unchanged=".",e.Untracked="?",e.Ignored="!",e.UpdatedButUnmerged="U",e))(p||{}),m=(e=>(e.Modified="M",e.Added="A",e.Deleted="D",e.Untracked="?",e.Ignored="!",e))(m||{});function g(e,t=!1,i){const s=(0,a.Fd)(e.path,i);return t&&("R"===e.status||"C"===e.status)&&e.originalPath?`${s} ${(0,c.vk)(r.NE.ArrowLeft,1,1)} ${e.originalPath}`:s}function f(e,t={}){return(0,o.d)(e.path,t)}function w(e,t){return e.originalPath?(0,a.uo)(e.originalPath,t)[0]:""}function v(e,t){return(0,a.uo)(e.path,t)[0]}const y={".":void 0,"!":"icon-status-ignored.svg","?":"icon-status-untracked.svg",A:"icon-status-added.svg",D:"icon-status-deleted.svg",M:"icon-status-modified.svg",R:"icon-status-renamed.svg",C:"icon-status-copied.svg",AA:"icon-status-conflict.svg",AU:"icon-status-conflict.svg",UA:"icon-status-conflict.svg",DD:"icon-status-conflict.svg",DU:"icon-status-conflict.svg",UD:"icon-status-conflict.svg",UU:"icon-status-conflict.svg",T:"icon-status-modified.svg",U:"icon-status-modified.svg"};function b(e){return y[e]??"icon-status-unknown.svg"}const C={".":void 0,"!":"$(diff-ignored)","?":"$(diff-added)",A:"$(diff-added)",D:"$(diff-removed)",M:"$(diff-modified)",R:"$(diff-renamed)",C:"$(diff-added)",AA:"$(warning)",AU:"$(warning)",UA:"$(warning)",DD:"$(warning)",DU:"$(warning)",UD:"$(warning)",UU:"$(warning)",T:"$(diff-modified)",U:"$(diff-modified)"};function A(e,t=r.NE.Space.repeat(4)){return C[e]??t}const P={".":"Unchanged","!":"Ignored","?":"Untracked",A:"Added",D:"Deleted",M:"Modified",R:"Renamed",C:"Copied",AA:"Conflict",AU:"Conflict",UA:"Conflict",DD:"Conflict",DU:"Conflict",UD:"Conflict",UU:"Conflict",T:"Modified",U:"Updated but Unmerged"};function S(e){return P[e]??"Unknown"}const R=class{constructor(e,t,i,r,s,n){this.repoPath=e,this.path=t,this.status=i,this.originalPath=r,this.previousSha=s,this.stats=n}static is(e){return e instanceof R}get hasConflicts(){switch(this.status){case"UA":case"AU":case"AA":case"UD":case"DU":case"DD":case"UU":return!0;default:return!1}}get uri(){return s.W.instance.git.getAbsoluteUri(this.path,this.repoPath)}get originalUri(){return this.originalPath?s.W.instance.git.getAbsoluteUri(this.originalPath,this.repoPath):void 0}getWorkingUri(){return s.W.instance.git.getWorkingUri(this.repoPath,this.uri)}formatStats(e){if(null==this.stats)return e?.empty??"";const{additions:t,deletions:i}=this.stats;if(t<0&&i<0)return e?.empty??"";const{compact:r=!1,expand:s=!1,prefix:n="",separator:o=" ",suffix:a=""}=e??{};let l=n;return t?l+=s?`${(0,c._6)("line",t)} added`:`+${t}`:s||r||(l+="+0"),i?l+=`${t?o:""}${s?`${(0,c._6)("line",i)} deleted`:`-${i}`}`:s||r||(l+="-0"),l+=a,l}};let D=R;u([(0,n.H)()],D.prototype,"uri",1),u([(0,n.H)()],D.prototype,"originalUri",1),u([(0,n.H)()],D.prototype,"getWorkingUri",1)},5069:(e,t,i)=>{i.d(t,{e:()=>r});var r=(e=>(e.Commit="commit-node",e.MergeCommit="merge-node",e.Stash="stash-node",e.Working="work-dir-changes",e.Conflict="merge-conflict-node",e.Rebase="unsupported-rebase-warning-node",e))(r||{})},8452:(e,t,i)=>{i.d(t,{$9:()=>Issue,Gj:()=>n,Ty:()=>o,mX:()=>s,sy:()=>a,xX:()=>c,y$:()=>l});var r=i(9496),s=(e=>(e.Issue="Issue",e.PullRequest="PullRequest",e))(s||{});function n(e){return{type:e.type,provider:{id:e.provider.id,name:e.provider.name,domain:e.provider.domain,icon:e.provider.icon},id:e.id,title:e.title,url:e.url,date:e.date,closedDate:e.closedDate,closed:e.closed}}function o(e){return"PullRequest"===e.type?e.closed?`<span class="codicon codicon-git-pull-request" style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#a371f7":"#8250df"};"></span>`:`<span class="codicon codicon-git-pull-request" style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#3fb950":"#1a7f37"};"></span>`:e.closed?`<span class="codicon codicon-pass" style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#a371f7":"#8250df"};"></span>`:`<span class="codicon codicon-issues" style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#3fb950":"#1a7f37"};"></span>`}function a(e){return"PullRequest"===e.type?e.closed?`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#a371f7":"#8250df"};">$(git-pull-request)</span>`:`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#3fb950":"#1a7f37"};">$(git-pull-request)</span>`:e.closed?`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#a371f7":"#8250df"};">$(pass)</span>`:`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#3fb950":"#1a7f37"};">$(issues)</span>`}function c(e){return"PullRequest"===e.type?e.closed?new r.ThemeIcon("git-pull-request",new r.ThemeColor("gitlens.mergedPullRequestIconColor")):new r.ThemeIcon("git-pull-request",new r.ThemeColor("gitlens.openPullRequestIconColor")):e.closed?new r.ThemeIcon("pass",new r.ThemeColor("gitlens.closedAutolinkedIssueIconColor")):new r.ThemeIcon("issues",new r.ThemeColor("gitlens.openAutolinkedIssueIconColor"))}function l(e){return{type:e.type,provider:{id:e.provider.id,name:e.provider.name,domain:e.provider.domain,icon:e.provider.icon},id:e.id,title:e.title,url:e.url,date:e.date,closedDate:e.closedDate,closed:e.closed,updatedDate:e.updatedDate,author:{name:e.author.name,avatarUrl:e.author.avatarUrl,url:e.author.url},repository:{owner:e.repository.owner,repo:e.repository.repo},assignees:e.assignees.map((e=>({name:e.name,avatarUrl:e.avatarUrl,url:e.url}))),labels:null==e.labels?void 0:e.labels.map((e=>({color:e.color,name:e.name}))),commentsCount:e.commentsCount,thumbsUpCount:e.thumbsUpCount}}class Issue{constructor(e,t,i,r,s,n,o,a,c,l,h,u,d,p){this.provider=e,this.id=t,this.title=i,this.url=r,this.date=s,this.closed=n,this.updatedDate=o,this.author=a,this.repository=c,this.assignees=l,this.closedDate=h,this.labels=u,this.commentsCount=d,this.thumbsUpCount=p,this.type="Issue"}}},4092:(e,t,i)=>{i.d(t,{Cz:()=>m,i7:()=>w,l1:()=>g,o0:()=>d,pD:()=>p});var r=i(9496),s=i(2540),n=i(5567),o=i(7512),a=i(4488),c=i(8452),l=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?h(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&l(t,i,n),n},d=(e=>(e.Open="Open",e.Closed="Closed",e.Merged="Merged",e))(d||{}),p=(e=>(e.Approved="Approved",e.ChangesRequested="ChangesRequested",e.ReviewRequired="ReviewRequired",e))(p||{}),m=(e=>(e.Unknown="Unknown",e.Mergeable="Mergeable",e.Conflicting="Conflicting",e))(m||{});function g(e){return{type:e.type,provider:{id:e.provider.id,name:e.provider.name,domain:e.provider.domain,icon:e.provider.icon},id:e.id,title:e.title,url:e.url,date:e.date,closedDate:e.closedDate,closed:e.closed,author:{name:e.author.name,avatarUrl:e.author.avatarUrl,url:e.author.url},state:e.state,mergedDate:e.mergedDate,mergeableState:e.mergeableState,refs:e.refs?{head:{exists:e.refs.head.exists,owner:e.refs.head.owner,repo:e.refs.head.repo,sha:e.refs.head.sha,branch:e.refs.head.branch,url:e.refs.head.url},base:{exists:e.refs.base.exists,owner:e.refs.base.owner,repo:e.refs.base.repo,sha:e.refs.base.sha,branch:e.refs.base.branch,url:e.refs.base.url},isCrossRepository:e.refs.isCrossRepository}:void 0,isDraft:e.isDraft,additions:e.additions,deletions:e.deletions,comments:e.comments,reviewDecision:e.reviewDecision,reviewRequests:e.reviewRequests,assignees:e.assignees}}const f=class{constructor(e,t,i,r,s,n,o,a,l,h,u,d,p,m,g,f,w,v){this.provider=e,this.author=t,this.id=i,this.title=r,this.url=s,this.state=n,this.date=o,this.closedDate=a,this.mergedDate=l,this.mergeableState=h,this.refs=u,this.isDraft=d,this.additions=p,this.deletions=m,this.comments=g,this.reviewDecision=f,this.reviewRequests=w,this.assignees=v,this.type=c.mX.PullRequest}static is(e){return e instanceof f}static getMarkdownIcon(e){switch(e.state){case"Open":return`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#3fb950":"#1a7f37"};">$(git-pull-request)</span>`;case"Closed":return`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#f85149":"#cf222e"};">$(git-pull-request-closed)</span>`;case"Merged":return`<span style="color:${r.window.activeColorTheme.kind===r.ColorThemeKind.Dark?"#a371f7":"#8250df"};">$(git-merge)</span>`;default:return"$(git-pull-request)"}}static getThemeIcon(e){switch(e.state){case"Open":return new r.ThemeIcon("git-pull-request",new r.ThemeColor("gitlens.openPullRequestIconColor"));case"Closed":return new r.ThemeIcon("git-pull-request-closed",new r.ThemeColor("gitlens.closedPullRequestIconColor"));case"Merged":return new r.ThemeIcon("git-merge",new r.ThemeColor("gitlens.mergedPullRequestIconColor"));default:return new r.ThemeIcon("git-pull-request")}}get closed(){return"Closed"===this.state}get formattedDate(){return n.W.instance.PullRequestDateFormatting.dateStyle===s.Dn.Absolute?this.formatDate(n.W.instance.PullRequestDateFormatting.dateFormat):this.formatDateFromNow()}formatDate(e){return(0,o.p6)(this.mergedDate??this.closedDate??this.date,e??"MMMM Do, YYYY h:mma")}formatDateFromNow(){return(0,o.Zh)(this.mergedDate??this.closedDate??this.date)}formatClosedDate(e){return null==this.closedDate?"":(0,o.p6)(this.closedDate,e??"MMMM Do, YYYY h:mma")}formatClosedDateFromNow(){return null==this.closedDate?"":(0,o.Zh)(this.closedDate)}formatMergedDate(e){return null==this.mergedDate?"":(0,o.p6)(this.mergedDate,e??"MMMM Do, YYYY h:mma")??""}formatMergedDateFromNow(){return null==this.mergedDate?"":(0,o.Zh)(this.mergedDate)}formatUpdatedDate(e){return(0,o.p6)(this.date,e??"MMMM Do, YYYY h:mma")??""}formatUpdatedDateFromNow(){return(0,o.Zh)(this.date)}};let w=f;u([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],w.prototype,"formatDate",1),u([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],w.prototype,"formatClosedDate",1),u([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],w.prototype,"formatMergedDate",1),u([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],w.prototype,"formatUpdatedDate",1)},4321:(e,t,i)=>{i.d(t,{Av:()=>k,D3:()=>w,FT:()=>F,LB:()=>R,Nn:()=>E,UR:()=>T,Wh:()=>x,Yn:()=>_,gA:()=>O,j$:()=>b,l3:()=>y,oI:()=>g,pZ:()=>$,qj:()=>D,rD:()=>C,t6:()=>P,xB:()=>S,yk:()=>f,yo:()=>v,zL:()=>A});var r=i(5255),s=i(5148),n=i(5367),o=i(439);const a=/^(\S*?)(\.\.\.?)(\S*)\s*$/,c=/(^[0-9a-f]{40}([\^@~:]\S*)?$)|(^[0]{40}(:|-)$)/,l=/(^[0-9a-f]{40}$)|(^[0]{40}(:|-)$)/,h=/(^[0-9a-f]{40})\^[0-3]?$/,u=/^(.*?)([\^@~:].*)?$/,d=/^[0]{40}(?:[\^@~:]\S*)?:?$/,p=/^[0]{40}([\^@~]\S*)?:$/;function m(e,t){return!!t&&e.test(t)}function g(e,t,i=".."){return`${e??""}${i}${t??""}`}function f(e){return e?.includes("..")??!1}function w(e){return m(l,e)}function v(e){return m(c,e)}function y(e,t=!1){return e===o.CL||e===o.pw||!t&&m(d,e)}function b(e){return e===`${o.CL}^`||e===`${o.pw}^`}function C(e,t=!1){return e===o.pw||!t&&m(p,e)}function A(e,t){if(e===o.Ii)return"(deleted)";if(!e)return t?.strings?.working??"";if(y(e))return C(e)?t?.strings?.uncommittedStaged??"Index":t?.strings?.uncommitted??"Working Tree";if(f(e))return e;if(!t?.force&&!v(e))return e;const i=Math.max(5,s.D.get("advanced.abbreviatedShaLength")),r=u.exec(e);if(null!=r){const[,e,t]=r;if(null!=t)return`${e.substr(0,i)}${t}`}return e.substr(0,i)}function P(e){const t=a.exec(e);if(null==t)return;const[,i,r,s]=t;return{ref1:i,notation:r,ref2:s}}function S(e,t,i={refType:"revision"}){switch(i.refType){case"branch":return{refType:"branch",repoPath:t,ref:e,name:i.name,id:i.id,remote:i.remote,upstream:i.upstream};case"stash":return{refType:"stash",repoPath:t,ref:e,name:i.name,number:i.number,message:i.message,stashOnRef:i.stashOnRef};case"tag":return{refType:"tag",repoPath:t,ref:e,name:i.name,id:i.id};default:return{refType:"revision",repoPath:t,ref:e,name:i.name??A(e,{force:!0,strings:{working:"Working Tree"}}),message:i.message}}}function R(e){return S(e.ref,e.repoPath,{id:e.id,refType:e.refType,name:e.name,remote:e.remote,upstream:e.upstream})}function D(e){return"stash"===e.refType?S(e.ref,e.repoPath,{refType:e.refType,name:e.name,number:e.number,message:e.message}):S(e.ref,e.repoPath,{refType:e.refType,name:e.name,message:e.message})}function k(e){return"branch"===e.refType&&e.remote?(0,n.S3)(e.name):e.name}function _(e){if(null==e||"object"!=typeof e)return!1;const t=e;return"string"==typeof t.refType&&"string"==typeof t.repoPath&&"string"==typeof t.ref&&"string"==typeof t.name}function T(e){return"branch"===e?.refType}function F(e){return"revision"===e?.refType}function E(e){return"revision"===e?.refType&&f(e.ref)}function $(e){return"stash"===e?.refType||"revision"===e?.refType&&Boolean(e?.stashName)}function O(e){return"tag"===e?.refType}function x(e,t){if(null==e)return"";let i;if(t=!1===t?{}:{expand:!0,icon:!0,label:t?.label??t?.expand??!0,...t},!Array.isArray(e)||1===e.length){const s=Array.isArray(e)?e[0]:e;let o=t?.quoted?`'${s.name}'`:s.name;switch(s.refType){case"branch":s.remote&&(o=`${(0,n.Lo)(o)}: ${(0,n.S3)(o)}`,o=t?.quoted?`'${o}'`:o),i=`${t.label?(s.remote?"remote ":"")+"branch ":""}${t.icon?`$(git-branch)${r.NE.Space}${o}`:o}`;break;case"tag":i=`${t.label?"tag ":""}${t.icon?`$(tag)${r.NE.Space}${o}`:o}`;break;default:if($(s)){let e;t.expand&&s.message&&(e=`${null!=s.number?`#${s.number}: `:""}${s.message.length>20?`${s.message.substring(0,20).trimRight()}${r.NE.Ellipsis}`:s.message}`),i=`${t.label?"stash ":""}${t.icon?`$(archive)${r.NE.Space}${e??s.name}`:`${e??(s.number?`#${s.number}`:s.name)}`}`}else if(f(s.ref))i=o;else{let e,n;t.expand&&s.message&&(e=s.message.length>20?` (${s.message.substring(0,20).trimRight()}${r.NE.Ellipsis})`:` (${s.message})`),t.expand&&t.label&&function(e){return m(h,e)}(s.ref)?(o=s.name.endsWith("^")?s.name.substr(0,s.name.length-1):s.name,t?.quoted&&(o=`'${o}'`),n="before "):n="",i=`${t.label?`${n}commit `:""}${t.icon?`$(git-commit)${r.NE.Space}${o}${e??""}`:`${o}${e??""}`}`}}return t.capitalize&&t.expand&&!1!==t.label?`${i[0].toLocaleUpperCase()}${i.substring(1)}`:i}const s=t.expand?` (${e.map((e=>e.name)).join(", ")})`:"";switch(e[0].refType){case"branch":return`${e.length} branches${s}`;case"tag":return`${e.length} tags${s}`;default:return`${e.length} ${$(e[0])?"stashes":"commits"}${s}`}}},3050:(e,t,i)=>{i.d(t,{XG:()=>d,Ym:()=>w,dM:()=>f,jv:()=>g,ss:()=>m});var r=i(9496),s=i(5255),n=i(5567),o=i(4488),a=i(3620),c=i(2509),l=i(4794),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d=(e=>(e.Fetch="fetch",e.Push="push",e))(d||{});const p=class{constructor(e,t,i,r,s,n,o,a){this.repoPath=e,this.id=t,this.name=i,this.scheme=r,this.domain=s,this.path=n,this.provider=o,this.urls=a}static getHighlanderProviders(e){if(0===e.length)return;const t=1===e.length?e[0]:e.find((e=>e.default));if(null!=t)return[t.provider];const i=e[0].provider.name;return e.every((e=>e.provider.name===i))?e.map((e=>e.provider)):void 0}static getHighlanderProviderName(e){if(0===e.length)return;const t=1===e.length?e[0]:e.find((e=>e.default));if(null!=t)return t.provider.name;const i=e[0].provider.name;return e.every((e=>e.provider.name===i))?i:void 0}static is(e){return e instanceof p}static sort(e){return e.sort(((e,t)=>(e.default?-1:1)-(t.default?-1:1)||("origin"===e.name?-1:1)-("origin"===t.name?-1:1)||("upstream"===e.name?-1:1)-("upstream"===t.name?-1:1)||(0,a.dm)(e.name,t.name)))}get default(){const e=n.W.instance.storage.getWorkspace("remote:default");return this.id===e}get url(){let e;for(const t of this.urls){if("push"===t.type)return t.url;null==e&&(e=t.url)}return e}hasRichProvider(){return this.provider?.hasRichIntegration()??!1}matches(e,t){if(null==t){if((0,a.qq)(e,this.url))return!0;[,e,t]=(0,l.Sk)(e)}return(0,a.qq)(e,this.domain)&&(0,a.qq)(t,this.path)}async setAsDefault(e=!0){const t=n.W.instance.git.getRepository(this.repoPath);await(t?.setRemoteAsDefault(this,e))}};let m=p;function g(e){const t=function(e){let t,i,r;for(const{type:t}of e.urls)if("fetch"===t){if(i=!0,r)break}else if("push"===t&&(r=!0,i))break;return t=i&&r?s.NE.ArrowsRightLeft:r?s.NE.ArrowRight:i?s.NE.ArrowLeft:s.NE.Dash,t}(e),{provider:i}=e;return null!=i?`${t}${s.NE.Space} ${i.name} ${s.NE.Space}${s.NE.Dot}${s.NE.Space} ${i.displayPath}`:`${t}${s.NE.Space} ${e.domain?`${e.domain} ${s.NE.Space}${s.NE.Dot}${s.NE.Space} `:""}${e.path}`}function f(e,t,i,s=r.window.activeColorTheme){if(null==t.provider?.icon)return;const n=r.Uri.joinPath(e.context.extensionUri,`images/${(0,c.GC)(s)?"light":"dark"}/icon-${t.provider.icon}.svg`);return null!=i?i(n):n}function w(e){return Array.isArray(e)?e.map((e=>e.id)).sort().join(","):e.id}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&h(t,i,n)})([(0,o.H)()],m.prototype,"url",1)},6503:(e,t,i)=>{i.d(t,{C:()=>s,J:()=>r});var r=(e=>(e.Branch="branch",e.Branches="branches",e.Commit="commit",e.Comparison="comparison",e.CreatePullRequest="createPullRequest",e.File="file",e.Repo="repo",e.Revision="revision",e))(r||{});function s(e){switch(e.type){case"branch":return"Branch";case"branches":return"Branches";case"commit":return"Commit";case"comparison":return"Comparison";case"createPullRequest":return"Create Pull Request";case"file":case"revision":return"File";case"repo":return"Repository";default:return""}}},3646:(e,t,i)=>{i.d(t,{I6:()=>I,_j:()=>W,du:()=>B,uC:()=>L});var r=i(9496),s=i(4290),n=i(5640),o=i(5255),a=i(7925),c=i(2133),l=i(2800),h=i(9529),u=i(5148),d=i(7512),p=i(5432),m=i(4241),g=i(9796),f=i(3105),w=i(4336),v=i(6004),y=i(9967),b=i(3700),C=i(7552),A=i(5367),P=i(4321),S=Object.defineProperty,R=Object.getOwnPropertyDescriptor,D=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?R(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&S(t,i,n),n};const k=Object.freeze([]),_=36e5,T=864e5,F="index,HEAD,*_HEAD,MERGE_*,rebase-merge/**,sequencer/**",E="worktrees/**/index,worktrees/**/HEAD,worktrees/**/*_HEAD,worktrees/**/MERGE_*,worktrees/**/rebase-merge/**,worktrees/**/sequencer/**",$=`{${F}}`,O=`{config,refs/**,${E}}`,x=`{${F},config,refs/**,${E}}`;var I=(e=>(e[e.Unknown=-1]="Unknown",e[e.Index=0]="Index",e[e.Head=1]="Head",e[e.Heads=2]="Heads",e[e.Tags=3]="Tags",e[e.Stash=4]="Stash",e[e.Remotes=5]="Remotes",e[e.Worktrees=6]="Worktrees",e[e.Config=7]="Config",e[e.Status=8]="Status",e[e.CherryPick=9]="CherryPick",e[e.Merge=10]="Merge",e[e.Rebase=11]="Rebase",e[e.Closed=100]="Closed",e[e.Ignores=101]="Ignores",e[e.RemoteProviders=102]="RemoteProviders",e[e.Starred=103]="Starred",e[e.Opened=104]="Opened",e))(I||{}),B=(e=>(e[e.Any=0]="Any",e[e.All=1]="All",e[e.Exclusive=2]="Exclusive",e))(B||{});class RepositoryChangeEvent{constructor(e,t){this.repository=e,this._changes=new Set(t)}toString(e=!1){return e?`changes=${(0,f.v_)(this._changes,", ")}`:`{ repository: ${this.repository?.name??""}, changes: ${(0,f.v_)(this._changes,", ")} }`}changed(...e){const t=e.slice(0,-1),i=e[e.length-1];if(0===i)return(0,f.G)(this._changes,(e=>t.includes(e)));let r=this._changes;2===i&&(t.includes(9)||t.includes(10)||t.includes(11)?t.includes(8)||t.push(8):t.includes(8)&&(r=new Set(r),r.delete(9),r.delete(10),r.delete(11)));const s=[...(0,f.hX)(r,(e=>t.includes(e)))];return 2===i?s.length===r.size:s.length===t.length}with(e){return new RepositoryChangeEvent(this.repository,[...this._changes,...e])}}let W=class{constructor(e,t,i,s,n,o,a,l=!1){if(this.container=e,this.onDidRepositoryChange=t,this.provider=i,this.folder=s,this.uri=n,this.root=o,this._onDidChange=new r.EventEmitter,this._onDidChangeFileSystem=new r.EventEmitter,this._fireChangeDebounced=void 0,this._fireFileSystemChangeDebounced=void 0,this._fsWatchCounter=0,this._updatedAt=0,this._closed=!1,null!=(s=r.workspace.getWorkspaceFolder(n)??s))if(o)this.name=s.name;else{const t=e.git.getRelativePath(n,s.uri);this.name=t||s.name}else this.name=(0,b.EZ)(n.path);this.index=s?.index??e.git.repositoryCount,this.id=(0,c.YW)(n),this._suspended=a,this._closed=l,this._disposable=r.Disposable.from(this.setupRepoWatchers(),u.D.onDidChange(this.onConfigurationChanged,this)),this.onConfigurationChanged()}static formatLastFetched(e,t=!0){const i=new Date(e);if(Date.now()-e<T)return(0,d.Zh)(i);if(t)return(0,d.p6)(i,u.D.get("defaultDateShortFormat")??"short");let r=u.D.get("defaultDateFormat")??`dddd, MMMM Do, YYYY [at] ${u.D.get("defaultTimeFormat")??"h:mma"}`;return/[hHm]/.test(r)||(r+=` [at] ${u.D.get("defaultTimeFormat")??"h:mma"}`),(0,d.p6)(i,r)}static getLastFetchedUpdateInterval(e){const t=Date.now()-e;return t<T?(t<_?6e4:_)/2:0}static sort(e){return e.sort(((e,t)=>(e.starred?-1:1)-(t.starred?-1:1)||e.index-t.index))}get onDidChange(){return this._onDidChange.event}get onDidChangeFileSystem(){return this._onDidChangeFileSystem.event}get formattedName(){return this.name}get idHash(){return void 0===this._idHash&&(this._idHash=(0,s.FB)(this.id)),this._idHash}setupRepoWatchers(){let e;return this.setupRepoWatchersCore().then((t=>e=t)),{dispose:()=>{e?.dispose()}}}async setupRepoWatchersCore(){const e=[];e.push(this.container.events.on("git:cache:reset",(e=>{e.data.repoPath&&e.data.repoPath!==this.path||this.resetCaches(...e.data.caches??k)})));const t=r.workspace.createFileSystemWatcher(new r.RelativePattern(this.uri,"**/.gitignore"));function i(t,i){const s=r.workspace.createFileSystemWatcher(new r.RelativePattern(t,i));return e.push(s,s.onDidChange((e=>this.onRepositoryChanged(e,t))),s.onDidCreate((e=>this.onRepositoryChanged(e,t))),s.onDidDelete((e=>this.onRepositoryChanged(e,t)))),s}e.push(t,t.onDidChange(this.onGitIgnoreChanged,this),t.onDidCreate(this.onGitIgnoreChanged,this),t.onDidDelete(this.onGitIgnoreChanged,this));const s=await this.getGitDir();return null!=s&&(null==s?.commonUri?i.call(this,s.uri,x):(i.call(this,s.uri,$),i.call(this,s.commonUri,O))),r.Disposable.from(...e)}dispose(){this.stopWatchingFileSystem(),this._remotesDisposable?.dispose(),this._disposable.dispose()}toString(){return`${(0,w.q4)(this)}(${this.id})`}get virtual(){return this.provider.virtual}get path(){return this.uri.scheme===o.sN.File?(0,b.AH)(this.uri.fsPath):this.uri.toString()}get etag(){return this._updatedAt}get updatedAt(){return this._updatedAt}onConfigurationChanged(e){u.D.changed(e,"remotes",this.folder?.uri)&&(this._providers=(0,C.v)(u.D.get("remotes",this.folder?.uri??null)),null!=e&&(this.resetCaches("remotes"),this.fireChange(5)))}onFileSystemChanged(e){/\.git(?:\/|\\|$)/.test(e.fsPath)||(this._etagFileSystem=Date.now(),this.fireFileSystemChange(e))}onGitIgnoreChanged(e){this.fireChange(101)}onRepositoryChanged(e,t){if(e?.path.includes("/fsmonitor--daemon/"))return;this._lastFetched=void 0;const i=null!=e?/(worktrees|index|HEAD|FETCH_HEAD|ORIG_HEAD|CHERRY_PICK_HEAD|MERGE_HEAD|REBASE_HEAD|rebase-merge|config|refs\/(?:heads|remotes|stash|tags))/.exec(this.container.git.getRelativePath(e,t)):void 0;if(null!=i)switch(i[1]){case"config":return this.resetCaches(),void this.fireChange(7,5);case"index":return void this.fireChange(0);case"FETCH_HEAD":return;case"HEAD":return this.resetCaches("branches"),void this.fireChange(1,2);case"ORIG_HEAD":case"refs/heads":return this.resetCaches("branches"),void this.fireChange(2);case"CHERRY_PICK_HEAD":return void this.fireChange(9,8);case"MERGE_HEAD":return void this.fireChange(10,8);case"REBASE_HEAD":case"rebase-merge":return void this.fireChange(11,8);case"refs/remotes":return this.resetCaches(),void this.fireChange(5);case"refs/stash":return void this.fireChange(4);case"refs/tags":return void this.fireChange(3);case"worktrees":return void this.fireChange(6)}this.fireChange(-1)}get closed(){return this._closed}set closed(e){const t=this._closed!==e;this._closed=e,t&&this.fireChange(this._closed?100:104)}access(e){return this.container.git.access(e,this.uri)}supports(e){return this.container.git.supports(this.uri,e)}async addRemote(e,t,i){await this.container.git.addRemote(this.path,e,t,i);const[r]=await this.getRemotes({filter:e=>e.url===t});return r}pruneRemote(e){return this.container.git.pruneRemote(this.path,e)}removeRemote(e){return this.container.git.removeRemote(this.path,e)}branch(...e){this.runTerminalCommand("branch",...e)}branchDelete(e,t){Array.isArray(e)||(e=[e]);const i=e.filter((e=>!e.remote));if(0!==i.length){const r=["--delete"];if(t?.force&&r.push("--force"),this.runTerminalCommand("branch",...r,...e.map((e=>e.ref))),t?.remote){const e=i.filter((e=>null!=e.upstream));if(0!==e.length){const t=(0,l.XI)(e,(e=>(0,A.Lo)(e.upstream.name)));for(const[e,i]of t.entries())this.runTerminalCommand("push","-d",e,...i.map((e=>(0,A.S3)(e.upstream.name))))}}}const r=e.filter((e=>e.remote));if(0!==r.length){const e=(0,l.XI)(r,(e=>(0,A.Lo)(e.name)));for(const[t,i]of e.entries())this.runTerminalCommand("push","-d",t,...i.map((e=>(0,P.Av)(e))))}}cherryPick(...e){this.runTerminalCommand("cherry-pick",...e)}containsUri(e){return this===this.container.git.getRepository(e)}async fetch(e){const{progress:t,...i}={progress:!0,...e};return t?r.window.withProgress({location:r.ProgressLocation.Notification,title:null!=i.branch?`${i.pull?"Pulling":"Fetching"} ${i.branch.name}...`:`Fetching ${i.remote?`${i.remote} of `:""}${this.formattedName}...`},(()=>this.fetchCore(i))):this.fetchCore(i)}async fetchCore(e){try{!0===u.D.getAny("gitlens.experimental.nativeGit")||null!=e?.branch?await this.container.git.fetch(this.path,e):await(0,h.Zv)("git.fetch",this.path),this.fireChange(-1)}catch(e){w.Yd.error(e),(0,a.W8)("Unable to fetch repository")}}async getBranch(e){if(e){const{values:[t]}=await this.getBranches({filter:t=>t.name===e});return t}return null==this._branch&&(this._branch=this.container.git.getBranch(this.path)),this._branch}getBranches(e){return this.container.git.getBranches(this.path,e)}getChangedFilesCount(e){return this.container.git.getChangedFilesCount(this.path,e)}getCommit(e){return this.container.git.getCommit(this.path,e)}getContributors(e){return this.container.git.getContributors(this.path,e)}getGitDir(){return null==this._gitDirPromise&&(this._gitDirPromise=this.container.git.getGitDir(this.path).then((e=>this._gitDir=e))),this._gitDirPromise}async getLastFetched(){if(null==this._lastFetched&&!await this.hasRemotes())return 0;try{const e=await this.container.git.getLastFetchedTimestamp(this.path);null!=e&&(this._lastFetched=e)}catch{this._lastFetched=void 0}return this._lastFetched??0}async getMainRepository(){const e=await this.getGitDir();return null==e?.commonUri?this:this.container.git.getOrOpenRepository(e.commonUri,{detectNested:!1,force:!0,closeOnOpen:!0})}getMergeStatus(){return this.container.git.getMergeStatus(this.path)}getRebaseStatus(){return this.container.git.getRebaseStatus(this.path)}async getRemote(e){return(await this.getRemotes()).find((t=>t.name===e))}async getRemotes(e){if(null==this._remotes){if(null==this._providers){const e=u.D.get("remotes",this.folder?.uri??null);this._providers=(0,C.v)(e)}this._remotes=this.container.git.getRemotes(this.path,{providers:this._providers,sort:!0}),this.subscribeToRemotes(this._remotes)}return null!=e?.filter?(await this._remotes).filter(e.filter):this._remotes}async getRichRemote(e=!1){return this.container.git.getBestRemoteWithRichProvider(await this.getRemotes(),{includeDisconnected:!e})}async subscribeToRemotes(e){this._remotesDisposable?.dispose(),this._remotesDisposable=void 0,this._remotesDisposable=r.Disposable.from(...(0,l.DZ)(await e,(e=>{if(e.provider?.hasRichIntegration())return e.provider.onDidChange((()=>this.fireChange(102)))})))}getStash(){return this.container.git.getStash(this.path)}getStatus(){return this.container.git.getStatusForRepo(this.path)}async getTag(e){const{values:[t]}=await this.getTags({filter:t=>t.name===e});return t}getTags(e){return this.container.git.getTags(this.path,e)}async createWorktree(e,t){await this.container.git.createWorktree(this.path,e.fsPath,t);const i=e.toString();return this.container.git.getWorktree(this.path,(e=>e.uri.toString()===i))}getWorktrees(){return this.container.git.getWorktrees(this.path)}async getWorktreesDefaultUri(){return this.container.git.getWorktreesDefaultUri(this.path)}deleteWorktree(e,t){return this.container.git.deleteWorktree(this.path,e.fsPath,t)}async hasRemotes(){const e=await this.getRemotes();return e?.length>0}async hasRichRemote(e=!1){const t=await this.getRichRemote(e);return null!=t?.provider}async hasUpstreamBranch(){const e=await this.getBranch();return null!=e?.upstream}isMaybeWorktree(){if(null!=this._gitDir)return null!=this._gitDir.commonUri}async isWorktree(){return null!=(await this.getGitDir())?.commonUri}merge(...e){this.runTerminalCommand("merge",...e)}async pull(e){const{progress:t,...i}={progress:!0,...e};return t?r.window.withProgress({location:r.ProgressLocation.Notification,title:`Pulling ${this.formattedName}...`},(()=>this.pullCore(i))):this.pullCore()}async pullCore(e){try{await this.hasUpstreamBranch()?await(0,h.Zv)(e?.rebase?"git.pullRebase":"git.pull",this.path):u.D.getAny("git.fetchOnPull",r.Uri.file(this.path))&&await this.container.git.fetch(this.path),this.fireChange(-1)}catch(e){w.Yd.error(e),(0,a.W8)("Unable to pull repository")}}async push(e){const{progress:t,...i}={progress:!0,...e};return t?r.window.withProgress({location:r.ProgressLocation.Notification,title:(0,P.UR)(i.reference)?`${null!=i.publish?"Publishing ":"Pushing "}${i.reference.name}...`:`Pushing ${this.formattedName}...`},(()=>this.pushCore(i))):this.pushCore(i)}async showCreatePullRequestPrompt(e,t){if(!this.container.actionRunners.count("createPullRequest"))return;if(!await(0,a.B8)(t.name))return;const i=await this.getRemote(e);(0,h.SI)("createPullRequest",{repoPath:this.path,remote:null!=i?{name:i.name,provider:null!=i.provider?{id:i.provider.id,name:i.provider.name,domain:i.provider.domain}:void 0,url:i.url}:{name:e},branch:{name:t.name,isRemote:t.remote,upstream:t.upstream?.name}})}async pushCore(e){try{if((0,P.UR)(e?.reference)){const t=await this.container.git.getOrOpenScmRepository(this.path);if(null==t)return;if(null!=e?.publish)await(t?.push(e.publish.remote,e.reference.name,!0)),this.showCreatePullRequestPrompt(e.publish.remote,e.reference);else{const i=await this.getBranch(e?.reference.name);if(null==i)return;await(t?.push(i.getRemoteName(),i.name,void 0,e?.force?n.QO.ForceWithLease:void 0))}}else if(null!=e?.reference){const t=await this.container.git.getOrOpenScmRepository(this.path);if(null==t)return;const i=await this.getBranch();if(null==i)return;await(t?.push(i.getRemoteName(),`${e.reference.ref}:${i.getNameWithoutRemote()}`,void 0,e?.force?n.QO.ForceWithLease:void 0))}else await(0,h.Zv)(e?.force?"git.pushForce":"git.push",this.path);this.fireChange(-1)}catch(e){w.Yd.error(e),(0,a.W8)("Unable to push repository")}}rebase(e,...t){this.runTerminalCommand(null!=e&&0!==e.length?`${e.join(" ")} rebase`:"rebase",...t)}reset(...e){this.runTerminalCommand("reset",...e)}resetCaches(...e){(0===e.length||e.includes("branches"))&&(this._branch=void 0),(0===e.length||e.includes("remotes"))&&(this._remotes=void 0,this._remotesDisposable?.dispose(),this._remotesDisposable=void 0)}resume(){this._suspended&&(this._suspended=!1,null!=this._pendingRepoChange&&this._fireChangeDebounced(),null!=this._pendingFileSystemChange&&this._fireFileSystemChangeDebounced())}revert(...e){this.runTerminalCommand("revert",...e)}richSearchCommits(e,t){return this.container.git.richSearchCommits(this.path,e,t)}searchCommits(e,t){return this.container.git.searchCommits(this.path,e,t)}async setRemoteAsDefault(e,t=!0){await this.container.storage.storeWorkspace("remote:default",t?e.id:void 0),this.fireChange(5,102)}get starred(){const e=this.container.storage.getWorkspace("starred:repositories");return null!=e&&!0===e[this.id]}star(e){return this.updateStarred(!0,e)}async stashApply(e,t){await this.container.git.stashApply(this.path,e,t),this.fireChange(4)}async stashDelete(e,t){await this.container.git.stashDelete(this.path,e,t),this.fireChange(4)}async stashRename(e,t,i,r){await this.container.git.stashRename(this.path,e,t,i,r),this.fireChange(4)}async stashSave(e,t,i){await this.container.git.stashSave(this.path,e,t,i),this.fireChange(4)}async switch(e,t){const{progress:i,...s}={progress:!0,...t};return i?r.window.withProgress({location:r.ProgressLocation.Notification,title:`Switching ${this.formattedName} to ${e}...`,cancellable:!1},(()=>this.switchCore(e,s))):this.switchCore(e,s)}async switchCore(e,t){try{await this.container.git.checkout(this.path,e,t),this.fireChange(-1)}catch(e){w.Yd.error(e),(0,a.W8)("Unable to switch to reference")}}toAbsoluteUri(e,t){const i=this.container.git.getAbsoluteUri(e,this.path);return!(t?.validate??1)||this.containsUri(i)?i:void 0}unstar(e){return this.updateStarred(!1,e)}async updateStarred(e,t){null!=t?await this.updateStarredCore("branches",t.id,e):await this.updateStarredCore("repositories",this.id,e),this.fireChange(103)}async updateStarredCore(e,t,i){const r=`starred:${e}`;let s=this.container.storage.getWorkspace(r);s=(0,y.iC)(s,t,i),await this.container.storage.storeWorkspace(r,s),this.fireChange(103)}get etagFileSystem(){return this._etagFileSystem}startWatchingFileSystem(){if(this._fsWatchCounter++,null==this._fsWatcherDisposable){const e=r.workspace.createFileSystemWatcher(new r.RelativePattern(this.uri,"**"));this._fsWatcherDisposable=r.Disposable.from(e,e.onDidChange(this.onFileSystemChanged,this),e.onDidCreate(this.onFileSystemChanged,this),e.onDidDelete(this.onFileSystemChanged,this)),this._etagFileSystem=Date.now()}return{dispose:()=>this.stopWatchingFileSystem()}}stopWatchingFileSystem(e=!1){null!=this._fsWatcherDisposable&&(--this._fsWatchCounter>0&&!e||(this._etagFileSystem=void 0,this._fsWatchCounter=0,this._fsWatcherDisposable.dispose(),this._fsWatcherDisposable=void 0))}suspend(){this._suspended=!0}tag(...e){this.runTerminalCommand("tag",...e)}tagDelete(e){Array.isArray(e)||(e=[e]);this.runTerminalCommand("tag","--delete",...e.map((e=>e.ref)))}fireChange(...e){const t=(0,v.UH)();this._updatedAt=Date.now(),null==this._fireChangeDebounced&&(this._fireChangeDebounced=(0,g.Ds)(this.fireChangeCore.bind(this),250)),this._pendingRepoChange=this._pendingRepoChange?.with(e)??new RepositoryChangeEvent(this,e),this.onDidRepositoryChange(this,new RepositoryChangeEvent(this,e)),this._suspended?w.Yd.debug(t,`queueing suspended ${this._pendingRepoChange.toString(!0)}`):this._fireChangeDebounced()}fireChangeCore(){const e=this._pendingRepoChange;null!=e&&(this._pendingRepoChange=void 0,w.Yd.debug(`Repository(${this.id}) firing ${e.toString(!0)}`),this._onDidChange.fire(e))}fireFileSystemChange(e){const t=(0,v.UH)();this._updatedAt=Date.now(),null==this._fireFileSystemChangeDebounced&&(this._fireFileSystemChangeDebounced=(0,g.Ds)(this.fireFileSystemChangeCore.bind(this),2500)),null==this._pendingFileSystemChange&&(this._pendingFileSystemChange={repository:this,uris:[]});const i=this._pendingFileSystemChange;i.uris.push(e),this._suspended?w.Yd.debug(t,`queueing suspended fs changes=${i.uris.map((e=>e.fsPath)).join(", ")}`):this._fireFileSystemChangeDebounced()}async fireFileSystemChangeCore(){let e=this._pendingFileSystemChange;if(null==e)return;this._pendingFileSystemChange=void 0;const t=await this.container.git.excludeIgnoredUris(this.path,e.uris);0!==t.length&&(t.length!==e.uris.length&&(e={...e,uris:t}),w.Yd.debug(`Repository(${this.id}) firing fs changes=${e.uris.map((e=>e.fsPath)).join(", ")}`),this._onDidChangeFileSystem.fire(e))}async runTerminalCommand(e,...t){await(this.container.git.runGitCommandViaTerminal?.(this.uri,e,t,{execute:!0})),setTimeout((()=>this.fireChange(-1)),2500)}};function L(e){return e instanceof W}D([(0,m.fF)()],W.prototype,"onGitIgnoreChanged",1),D([(0,m.fF)()],W.prototype,"onRepositoryChanged",1),D([(0,m.cM)()],W.prototype,"access",1),D([(0,m.cM)()],W.prototype,"supports",1),D([(0,m.cM)()],W.prototype,"addRemote",1),D([(0,m.cM)()],W.prototype,"pruneRemote",1),D([(0,m.cM)()],W.prototype,"removeRemote",1),D([(0,m.cM)()],W.prototype,"branch",1),D([(0,m.cM)()],W.prototype,"branchDelete",1),D([(0,m.cM)()],W.prototype,"cherryPick",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"fetch",1),D([(0,p.H)()],W.prototype,"getLastFetched",1),D([(0,p.H)(),(0,m.cM)({exit:!0})],W.prototype,"getMainRepository",1),D([(0,m.cM)()],W.prototype,"createWorktree",1),D([(0,m.cM)()],W.prototype,"merge",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"pull",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"push",1),D([(0,m.cM)()],W.prototype,"rebase",1),D([(0,m.cM)()],W.prototype,"reset",1),D([(0,m.cM)({singleLine:!0})],W.prototype,"resetCaches",1),D([(0,m.cM)()],W.prototype,"revert",1),D([(0,m.fF)()],W.prototype,"richSearchCommits",1),D([(0,m.fF)()],W.prototype,"searchCommits",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"stashApply",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"stashDelete",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"stashRename",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"stashSave",1),D([(0,p.H)(),(0,m.cM)()],W.prototype,"switch",1),D([(0,m.cM)()],W.prototype,"tag",1),D([(0,m.cM)()],W.prototype,"tagDelete",1),D([(0,m.fF)()],W.prototype,"fireChange",1),D([(0,m.fF)()],W.prototype,"fireFileSystemChange",1),W=D([(0,m.hJ)(((e,t)=>`${t}(${e.id})`))],W)},827:(e,t,i)=>{i.d(t,{Hk:()=>GitStatus,JP:()=>m});var r=i(5255),s=i(5567),n=i(4488),o=i(3620),a=i(5367),c=i(6450),l=i(439),h=i(7881),u=Object.defineProperty,d=Object.getOwnPropertyDescriptor,p=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?d(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&u(t,i,n),n};class GitStatus{constructor(e,t,i,r,s,n,o=!1){this.repoPath=e,this.branch=t,this.sha=i,this.files=r,this.state=s,this.upstream=n,this.rebasing=o,this.detached=(0,a.uz)(t),this.detached&&(this.branch=(0,a.Iq)(this.sha))}get conflicts(){return this.files.filter((e=>e.conflicted))}get hasChanges(){return 0!==this.files.length}get hasConflicts(){return this.files.some((e=>e.conflicted))}get ref(){return this.detached?this.sha:this.branch}computeWorkingTreeStatus(){let e=0,t=0,i=0,r=0,s=0,n=0,o=0,a=0,c=0;const l=[],u=[],d=[];for(const p of this.files){switch(p.conflictStatus){case void 0:break;case h.Vz.AddedByBoth:case h.Vz.AddedByUs:case h.Vz.AddedByThem:e++,u.push(p);break;case h.Vz.DeletedByBoth:case h.Vz.DeletedByUs:case h.Vz.DeletedByThem:t++;break;default:i++,l.push(p)}switch(p.indexStatus){case void 0:break;case h.NV.Added:r++,u.push(p);break;case h.NV.Deleted:a++;break;default:n++,u.push(p)}switch(p.workingTreeStatus){case void 0:case h.Bh.Ignored:break;case h.Bh.Added:case h.Bh.Untracked:s++,d.push(p);break;case h.Bh.Deleted:c++;break;default:o++,d.push(p)}}const p=e+i+t,m=r+n+a,g=s+o+c;return{conflicted:p,conflictedAddsAndChanges:l,conflictedStatus:p>0?`+${e} ~${i} -${t}`:"",staged:m,stagedStatus:m>0?`+${r} ~${n} -${a}`:"",stagedAddsAndChanges:u,unstaged:g,unstagedStatus:g>0?`+${s} ~${o} -${c}`:"",unstagedAddsAndChanges:d}}getDiffStatus(){const e={added:0,deleted:0,changed:0};if(0===this.files.length)return e;for(const t of this.files)switch(t.status){case"A":case"?":e.added++;break;case"D":e.deleted++;break;default:e.changed++}return e}getFormattedDiffStatus({compact:e,empty:t,expand:i,prefix:r="",separator:s=" ",suffix:n=""}={}){const{added:a,changed:c,deleted:l}=this.getDiffStatus();if(0===a&&0===c&&0===l)return t??"";if(i){let e="";return a&&(e+=`${(0,o._6)("file",a)} added`),c&&(e+=`${0===e.length?"":s}${(0,o._6)("file",c)} changed`),l&&(e+=`${0===e.length?"":s}${(0,o._6)("file",l)} deleted`),`${r}${e}${n}`}let h="";return e?(0!==a&&(h+=`+${a}`),0!==c&&(h+=`${0===h.length?"":s}~${c}`),0!==l&&(h+=`${0===h.length?"":s}-${l}`)):h+=`+${a}${s}~${c}${s}-${l}`,`${r}${h}${n}`}async getRemote(){if(null==this.upstream)return;const e=await s.W.instance.git.getRemotesWithProviders(this.repoPath);if(0===e.length)return;const t=(0,a.Lo)(this.upstream);return e.find((e=>e.name===t))}getUpstreamStatus(e){return m(this.upstream?{name:this.upstream,missing:!1}:void 0,this.state,e)}}function m(e,t,i){let s=!0,n=!1,a=!1,c="",l=" ",h="";if(null!=i&&({count:s=!0,expand:n=!1,icons:a=!1,prefix:c="",separator:l=" ",suffix:h=""}=i),null==e||0===t.behind&&0===t.ahead)return i?.empty??"";if(n){let i="";return e.missing?i="missing":(t.behind&&(i+=`${(0,o._6)("commit",t.behind,{infix:a?"$(arrow-down) ":void 0})} behind`),t.ahead&&(i+=`${0===i.length?"":l}${(0,o._6)("commit",t.ahead,{infix:a?"$(arrow-up) ":void 0})} ahead`,h.startsWith(` ${e.name.split("/")[0]}`)&&(i+=" of"))),`${c}${i}${h}`}const u=s&&!e.missing;return`${c}${u?t.behind:""}${u||0!==t.behind?r.NE.ArrowDown:""}${l}${u?t.ahead:""}${u||0!==t.ahead?r.NE.ArrowUp:""}${h}`}p([(0,n.H)()],GitStatus.prototype,"conflicts",1),p([(0,n.H)()],GitStatus.prototype,"hasConflicts",1),p([(0,n.H)()],GitStatus.prototype,"computeWorkingTreeStatus",1),p([(0,n.H)()],GitStatus.prototype,"getDiffStatus",1),p([(0,n.H)()],GitStatus.prototype,"getRemote",1);p([(0,n.H)()],class GitStatusFile{constructor(e,t,i,r,s){if(this.repoPath=e,this.path=r,this.originalPath=s,null!=t&&null!=i)switch(t+i){case"??":this.workingTreeStatus=h.Bh.Untracked;break;case"!!":this.workingTreeStatus=h.Bh.Ignored;break;case"AA":this.conflictStatus=h.Vz.AddedByBoth;break;case"AU":this.conflictStatus=h.Vz.AddedByUs;break;case"UA":this.conflictStatus=h.Vz.AddedByThem;break;case"DD":this.conflictStatus=h.Vz.DeletedByBoth;break;case"DU":this.conflictStatus=h.Vz.DeletedByUs;break;case"UD":this.conflictStatus=h.Vz.DeletedByThem;break;case"UU":this.conflictStatus=h.Vz.ModifiedByBoth}if(null==this.conflictStatus){switch(t){case"A":this.indexStatus=h.NV.Added;break;case"D":this.indexStatus=h.NV.Deleted;break;case"M":this.indexStatus=h.NV.Modified;break;case"R":this.indexStatus=h.NV.Renamed;break;case"C":this.indexStatus=h.NV.Copied}switch(i){case"A":case"?":this.workingTreeStatus=h.Bh.Added;break;case"D":this.workingTreeStatus=h.Bh.Deleted;break;case"M":this.workingTreeStatus=h.Bh.Modified}}}get conflicted(){return null!=this.conflictStatus}get edited(){return null!=this.workingTreeStatus}get staged(){return null!=this.indexStatus}get status(){return this.conflictStatus??this.indexStatus??this.workingTreeStatus}get uri(){return s.W.instance.git.getAbsoluteUri(this.path,this.repoPath)}getFormattedDirectory(e=!1){return(0,h.OC)(this,e)}getFormattedPath(e={}){return(0,h.PM)(this,e)}getOcticon(){return(0,h.Qw)(this.status)}getStatusText(){return(0,h.K9)(this.status)}getPseudoCommits(e,t){const i=[],r=new Date;if(null!=this.conflictStatus)return i.push(new c.aM(e,this.repoPath,l.CL,new c._j("You",t?.email??void 0,r),new c._j("You",t?.email??void 0,r),"Uncommitted changes",[l.pw],"Uncommitted changes",new h.K8(this.repoPath,this.path,this.status,this.originalPath,l.pw),void 0,[])),i;if(null==this.workingTreeStatus&&null==this.indexStatus)return i;if(null!=this.workingTreeStatus&&null!=this.indexStatus){const s=new Date(r);s.setMilliseconds(s.getMilliseconds()-1),i.push(new c.aM(e,this.repoPath,l.CL,new c._j("You",t?.email??void 0,r),new c._j("You",t?.email??void 0,r),"Uncommitted changes",[l.pw],"Uncommitted changes",new h.K8(this.repoPath,this.path,this.status,this.originalPath,l.pw),void 0,[]),new c.aM(e,this.repoPath,l.pw,new c._j("You",t?.email??void 0,s),new c._j("You",t?.email??void 0,s),"Uncommitted changes",["HEAD"],"Uncommitted changes",new h.K8(this.repoPath,this.path,this.status,this.originalPath,"HEAD"),void 0,[]))}else i.push(new c.aM(e,this.repoPath,null!=this.workingTreeStatus?l.CL:l.pw,new c._j("You",t?.email??void 0,r),new c._j("You",t?.email??void 0,r),"Uncommitted changes",["HEAD"],"Uncommitted changes",new h.K8(this.repoPath,this.path,this.status,this.originalPath,"HEAD"),void 0,[]));return i}}.prototype,"uri",1)},9502:(e,t,i)=>{i.d(t,{Pj:()=>g,YR:()=>m,YU:()=>p,gE:()=>GitTag});var r=i(2540),s=i(5567),n=i(5148),o=i(7512),a=i(4488),c=i(4336),l=i(3620),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&h(t,i,n),n};function p(e,t){return`${e}|tag/${t}`}class GitTag{constructor(e,t,i,r,s,n){this.repoPath=e,this.name=t,this.sha=i,this.message=r,this.date=s,this.commitDate=n,this.refType="tag",this.id=p(e,t)}toString(){return`${(0,c.q4)(this)}(${this.id})`}get formattedDate(){return s.W.instance.TagDateFormatting.dateStyle===r.Dn.Absolute?this.formatDate(s.W.instance.TagDateFormatting.dateFormat):this.formatDateFromNow()}get ref(){return this.name}formatCommitDate(e){return null!=this.commitDate?(0,o.p6)(this.commitDate,e??"MMMM Do, YYYY h:mma"):""}formatCommitDateFromNow(){return null!=this.commitDate?(0,o.Zh)(this.commitDate):""}formatDate(e){return null!=this.date?(0,o.p6)(this.date,e??"MMMM Do, YYYY h:mma"):""}formatDateFromNow(){return null!=this.date?(0,o.Zh)(this.date):""}getBasename(){const e=this.name.lastIndexOf("/");return-1!==e?this.name.substring(e+1):this.name}}function m(e){return e instanceof GitTag}function g(e,t){switch((t={orderBy:n.D.get("sortTagsBy"),...t}).orderBy){case r.RV.DateAsc:return e.sort(((e,t)=>(e.date?.getTime()??0)-(t.date?.getTime()??0)));case r.RV.NameAsc:return e.sort(((e,t)=>(0,l.dm)(e.name,t.name)));case r.RV.NameDesc:return e.sort(((e,t)=>(0,l.dm)(t.name,e.name)));case r.RV.DateDesc:default:return e.sort(((e,t)=>(t.date?.getTime()??0)-(e.date?.getTime()??0)))}}d([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],GitTag.prototype,"formatCommitDate",1),d([(0,a.H)((e=>e??"MMMM Do, YYYY h:mma"))],GitTag.prototype,"formatDate",1),d([(0,a.H)()],GitTag.prototype,"getBasename",1)},2674:(e,t,i)=>{i.d(t,{K:()=>p,e:()=>d});var r=i(9496),s=i(5567),n=i(4488),o=i(3700),a=i(4321),c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,h=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?l(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&c(t,i,n),n};const u=class{constructor(e,t,i,r,s,n,o,a){this.main=e,this.type=t,this.repoPath=i,this.uri=r,this.locked=s,this.prunable=n,this.sha=o,this.branch=a}static is(e){return e instanceof u}get opened(){return this.workspaceFolder?.uri.toString()===this.uri.toString()}get name(){switch(this.type){case"bare":return"(bare)";case"detached":return(0,a.zL)(this.sha);default:return this.branch||this.friendlyPath}}get friendlyPath(){return u.getFriendlyPath(this.uri)}get workspaceFolder(){return r.workspace.getWorkspaceFolder(this.uri)}getBranch(){return"branch"!==this.type||null==this.branch?Promise.resolve(void 0):(null==this._branch&&(this._branch=s.W.instance.git.getBranches(this.repoPath,{filter:e=>e.name===this.branch}).then((e=>e.values[0]))),this._branch)}getStatus(e){return"bare"===this.type?Promise.resolve(void 0):((null==this._status||e?.force)&&(this._status=s.W.instance.git.getStatusForRepo(this.uri.fsPath)),this._status)}static getFriendlyPath(e){const t=r.workspace.getWorkspaceFolder(e);if(null==t)return(0,o.AH)(e.fsPath);const i=(0,o.AH)((0,o.Gf)(t.uri.fsPath,e.fsPath));return 0===i.length?t.name:i}};let d=u;async function p(e,t,i){null==i||Array.isArray(i)||(i=[i]);const r=await e.getWorktrees();for(const s of r){if(s.branch===t)return s;if(null==i||null==s.branch)continue;const r=await e.getBranch(s.branch);if(null!=r?.upstream?.name&&(i.includes(r.upstream.name)||r.upstream.name.startsWith("remotes/")&&i.includes(r.upstream.name.substring(8))))return s}}h([(0,n.H)()],d.prototype,"friendlyPath",1),h([(0,n.H)()],d.prototype,"workspaceFolder",1)},4794:(e,t,i)=>{i.d(t,{Sk:()=>h,gK:()=>l});var r=i(4241),s=i(3050),n=Object.defineProperty,o=Object.getOwnPropertyDescriptor;const a="",c=/^(.*)\t(.*)\s\((.*)\)$/gm;((e,t,i,r)=>{for(var s,a=r>1?void 0:r?o(t,i):t,c=e.length-1;c>=0;c--)(s=e[c])&&(a=(r?s(t,i,a):s(a))||a);r&&a&&n(t,i,a)})([(0,r.fF)({args:!1,singleLine:!0})],class GitRemoteParser{static parse(e,t,i){if(!e)return;const r=[],n=Object.create(null);let o,a,l,u,d,p,m,g,f;for(;;){if(f=c.exec(e),null==f)break;if([,o,a,l]=f,a=` ${a}`.substr(1),[u,d,p]=h(a),m=`${d?`${d}/`:""}${p}`,g=n[m],void 0===g){const e=i(a,d,p);g=new s.ss(t,m,` ${o}`.substr(1),u,void 0!==e?e.domain:d,void 0!==e?e.path:p,e,[{url:a,type:` ${l}`.substr(1)}]),r.push(g),n[m]=g}else g.urls.push({url:a,type:` ${l}`.substr(1)})}return r}},"parse",1);const l=/^(?:(git:\/\/)(.*?)\/|(https?:\/\/)(?:.*?@)?(.*?)\/|git@(.*):|(ssh:\/\/)(?:.*@)?(.*?)(?::.*?)?(?:\/|(?=~))|(?:.*?@)(.*?):)(.*)$/;function h(e){const t=l.exec(e);return null==t?[a,a,e]:[t[1]||t[3]||t[6],t[2]||t[4]||t[5]||t[7]||t[8],t[9].replace(/\.git\/?$/,a)]}},2075:(e,t,i)=>{i.d(t,{at:()=>C,gu:()=>GitHubRemote,z4:()=>GitHubAuthenticationProvider});var r=i(9496),s=i(4241),n=i(4488),o=i(8786),a=i(3620),c=i(2509),l=i(4321),h=i(3084),u=Object.defineProperty,d=Object.getOwnPropertyDescriptor,p=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?d(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&u(t,i,n),n};const m=/\b(?<repo>[^/\s]+\/[^/\s]+)#(?<num>[0-9]+)\b(?!]\()/g,g=/^\/([^/]+)\/([^/]+?)\/blob(.+)$/i,f=/^L(\d+)(?:-L(\d+))?$/,w=Object.freeze({id:"github",scopes:["repo","read:user","user:email"]}),v=Object.freeze({id:"github-enterprise",scopes:["repo","read:user","user:email"]});function y(e){return(0,a.qq)(e,"github.com")}class GitHubRemote extends h.D{constructor(e,t,i,r,s,n=!1){super(e,t,i,r,s,n)}get authProvider(){return y(this.domain)?w:v}get apiBaseUrl(){return this.custom?`${this.protocol}://${this.domain}/api/v3`:`https://api.${this.domain}`}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"#",url:`${this.baseUrl}/issues/<num>`,title:`Open Issue or Pull Request #<num> on ${this.name}`,description:`${this.name} Issue or Pull Request #<num>`},{prefix:"gh-",url:`${this.baseUrl}/issues/<num>`,title:`Open Issue or Pull Request #<num> on ${this.name}`,ignoreCase:!0,description:`${this.name} Issue or Pull Request #<num>`},{tokenize:(e,t,i)=>"plaintext"===t?e:e.replace(m,((e,r,s)=>{const n=(0,o.M)(`${this.protocol}://${this.domain}/${r}/issues/${s}`),a=` "Open Issue or Pull Request #${s} from ${r} on ${this.name}"`,c=`\0${i.size}\0`;return"markdown"===t?i.set(c,`[${e}](${n}${a})`):"html"===t&&i.set(c,`<a href="${n}" title=${a}>${e}</a>`),c})),parse:(e,t)=>{let i,r,s;for(;;){if(s=m.exec(e),null==s?.groups)break;({repo:i,num:r}=s.groups),t.set(r,{provider:this,id:r,prefix:`${i}#`,url:`${this.protocol}://${this.domain}/${i}/issues/${r}`,title:`Open Issue or Pull Request #<num> from ${i} on ${this.name}`,description:`${this.name} Issue or Pull Request ${i}#${r}`})}}}]),this._autolinks}get avatarUri(){const[e]=this.splitPath();return r.Uri.parse(`https://avatars.githubusercontent.com/${e}`)}get icon(){return"github"}get id(){return"github"}get name(){return this.formatName("GitHub")}async connect(){return!(!y(this.domain)&&!await(0,h.e)("GitHub Enterprise instance",this.container))&&super.connect()}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r,s;if(t.fragment){const e=f.exec(t.fragment);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=g.exec(t.path);if(null==n)return;const[,,,o]=n;let a,c=o.indexOf("/",1);if(-1!==c){const t=o.substring(1,c);if((0,l.D3)(t)){const t=e.toAbsoluteUri(o.substr(c),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r,endLine:s}}}const h=new Map;c=o.length;do{c=o.lastIndexOf("/",c-1),a=o.substring(1,c),h.set(a,o.substr(c))}while(c>0);if(0!==h.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&h.has(e.getNameWithoutRemote())});for(const n of t){const t=h.get(n.getNameWithoutRemote());if(null==t)continue;const o=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=o)return{uri:o,startLine:r,endLine:s}}}}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/tree/${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/commit/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/compare/${e}${i}${t}`)}getUrlForCreatePullRequest(e,t){if(e.remote.url===t.remote.url)return this.encodeUrl(`${this.baseUrl}/pull/new/${e.branch??"HEAD"}...${t.branch}`);const[i]=t.remote.path.split("/",1);return this.encodeUrl(`${this.baseUrl}/pull/new/${e.branch??"HEAD"}...${i}:${t.branch}`)}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`#L${r.start.line}`:`#L${r.start.line}-L${r.end.line}`:"",i?`${this.encodeUrl(`${this.baseUrl}/blob/${i}/${e}`)}${s}`:t?`${this.encodeUrl(`${this.baseUrl}/blob/${t}/${e}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}?path=${e}`)}${s}`}async getProviderAccountForCommit({accessToken:e},t,i){const[r,s]=this.splitPath();return(await this.container.github)?.getAccountForCommit(this,e,r,s,t,{...i,baseUrl:this.apiBaseUrl})}async getProviderAccountForEmail({accessToken:e},t,i){const[r,s]=this.splitPath();return(await this.container.github)?.getAccountForEmail(this,e,r,s,t,{...i,baseUrl:this.apiBaseUrl})}async getProviderDefaultBranch({accessToken:e}){const[t,i]=this.splitPath();return(await this.container.github)?.getDefaultBranch(this,e,t,i,{baseUrl:this.apiBaseUrl})}async getProviderIssueOrPullRequest({accessToken:e},t){const[i,r]=this.splitPath();return(await this.container.github)?.getIssueOrPullRequest(this,e,i,r,Number(t),{baseUrl:this.apiBaseUrl})}async getProviderPullRequestForBranch({accessToken:e},t,r){const[s,n]=this.splitPath(),{include:o,...a}=r??{},c=(await Promise.resolve().then(i.bind(i,3878))).toGitHubPullRequestState;return(await this.container.github)?.getPullRequestForBranch(this,e,s,n,t,{...a,include:o?.map((e=>c(e))),baseUrl:this.apiBaseUrl})}async getProviderPullRequestForCommit({accessToken:e},t){const[i,r]=this.splitPath();return(await this.container.github)?.getPullRequestForCommit(this,e,i,r,t,{baseUrl:this.apiBaseUrl})}async getProviderRepositoryMetadata({accessToken:e}){const[t,i]=this.splitPath();return(await this.container.github)?.getRepositoryMetadata(this,e,t,i,{baseUrl:this.apiBaseUrl})}async searchProviderMyPullRequests({accessToken:e}){return(await this.container.github)?.searchMyPullRequests(this,e,{repos:[this.path],baseUrl:this.apiBaseUrl})}async searchProviderMyIssues({accessToken:e}){return(await this.container.github)?.searchMyIssues(this,e,{repos:[this.path],baseUrl:this.apiBaseUrl})}}p([(0,n.H)()],GitHubRemote.prototype,"authProvider",1),p([(0,s.cM)()],GitHubRemote.prototype,"connect",1);const b=/^(?:(\d+)\+)?([a-zA-Z\d-]{1,39})@users\.noreply\.(.*)$/i;function C(e){const t=b.exec(e);if(null==t)return;const[,i,r,s]=t;return{userId:i,login:r,authority:s}}class GitHubAuthenticationProvider{constructor(e){this._disposable=e.integrationAuthentication.registerProvider("github-enterprise",this)}dispose(){this._disposable.dispose()}getSessionId(e){return e?.domain??""}async createSession(e){const t=r.window.createInputBox();t.ignoreFocusOut=!0;const i=[];let s;try{const n={iconPath:new r.ThemeIcon("link-external"),tooltip:"Open the GitHub Access Tokens Page"};s=await new Promise((s=>{i.push(t.onDidHide((()=>s(void 0))),t.onDidChangeValue((()=>t.validationMessage=void 0)),t.onDidAccept((()=>{const e=t.value.trim();e?s(e):t.validationMessage="A personal access token is required"})),t.onDidTriggerButton((t=>{t===n&&r.env.openExternal(r.Uri.parse(`https://${e?.domain??"github.com"}/settings/tokens`))}))),t.password=!0,t.title="GitHub Authentication"+(e?.domain?`  • ${e.domain}`:""),t.placeholder=`Requires ${e?.scopes.join(", ")??"all"} scopes`,t.prompt=(0,c.gn)("input-prompt-links")?`Paste your [GitHub Personal Access Token](https://${e?.domain??"github.com"}/settings/tokens "Get your GitHub Access Token")`:"Paste your GitHub Personal Access Token",t.buttons=[n],t.show()}))}finally{t.dispose(),i.forEach((e=>{e.dispose()}))}if(s)return{id:this.getSessionId(e),accessToken:s,scopes:[],account:{id:"",label:""}}}}},5542:(e,t,i)=>{i.d(t,{E:()=>GitLabRemote,h:()=>GitLabAuthenticationProvider});var r=i(9496),s=i(2540),n=i(4241),o=i(8786),a=i(3620),c=i(2509),l=i(4321),h=i(3084),u=Object.defineProperty,d=Object.getOwnPropertyDescriptor;const p=/\b(?<repo>[^/\s]+\/[^/\s]+)#(?<num>[0-9]+)\b(?!]\()/g,m=/\b(?<repo>[^/\s]+\/[^/\s]+)!(?<num>[0-9]+)\b(?!]\()/g,g=/^\/([^/]+)\/([^/]+?)\/-\/blob(.+)$/i,f=/^L(\d+)(?:-(\d+))?$/,w=Object.freeze({id:"gitlab",scopes:["read_api","read_user","read_repository"]});class GitLabRemote extends h.D{constructor(e,t,i,r,s,n=!1){super(e,t,i,r,s,n)}get authProvider(){return w}get apiBaseUrl(){return this.custom?`${this.protocol}://${this.domain}/api`:`https://${this.domain}/api`}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"#",url:`${this.baseUrl}/-/issues/<num>`,title:`Open Issue #<num> on ${this.name}`,type:s.fH.Issue,description:`${this.name} Issue #<num>`},{prefix:"!",url:`${this.baseUrl}/-/merge_requests/<num>`,title:`Open Merge Request !<num> on ${this.name}`,type:s.fH.PullRequest,description:`${this.name} Merge Request !<num>`},{tokenize:(e,t,i)=>"plaintext"===t?e:e.replace(p,((e,r,s)=>{const n=(0,o.M)(`${this.protocol}://${this.domain}/${r}/-/issues/${s}`),a=` "Open Issue #${s} from ${r} on ${this.name}"`,c=`\0${i.size}\0`;return"markdown"===t?i.set(c,`[${e}](${n}${a})`):"html"===t&&i.set(c,`<a href="${n}" title=${a}>${e}</a>`),c})),parse:(e,t)=>{let i,r,n;for(;;){if(n=p.exec(e),null==n?.groups)break;({repo:i,num:r}=n.groups),t.set(r,{provider:this,id:r,prefix:`${i}#`,url:`${this.protocol}://${this.domain}/${i}/-/issues/${r}`,title:`Open Issue #<num> from ${i} on ${this.name}`,type:s.fH.Issue,description:`${this.name} Issue ${i}#${r}`})}}},{tokenize:(e,t,i)=>"plaintext"===t?e:e.replace(m,((e,r,s)=>{const n=(0,o.M)(`${this.protocol}://${this.domain}/${r}/-/merge_requests/${s}`),a=` "Open Merge Request !${s} from ${r} on ${this.name}"`,c=`\0${i.size}\0`;return"markdown"===t?i.set(c,`[${e}](${n}${a})`):"html"===t&&i.set(c,`<a href="${n}" title=${a}>${e}</a>`),c})),parse:(e,t)=>{let i,r,n;for(;;){if(n=m.exec(e),null==n?.groups)break;({repo:i,num:r}=n.groups),t.set(r,{provider:this,id:r,prefix:`${i}!`,url:`${this.protocol}://${this.domain}/${i}/-/merge_requests/${r}`,title:`Open Merge Request !<num> from ${i} on ${this.name}`,type:s.fH.PullRequest,description:`Merge Request !${r} from ${i} on ${this.name}`})}}}]),this._autolinks}get icon(){return"gitlab"}get id(){return"gitlab"}get name(){return this.formatName("GitLab")}async connect(){return!(!(0,a.qq)(this.domain,"gitlab.com")&&!await(0,h.e)("GitLab self-managed instance",this.container))&&super.connect()}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r,s;if(t.fragment){const e=f.exec(t.fragment);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=g.exec(t.path);if(null==n)return;const[,,,o]=n;let a,c=o.indexOf("/",1);if(-1!==c){const t=o.substring(1,c);if((0,l.D3)(t)){const t=e.toAbsoluteUri(o.substr(c),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r,endLine:s}}}const h=new Map;c=o.length;do{c=o.lastIndexOf("/",c-1),a=o.substring(1,c),h.set(a,o.substr(c))}while(c>0);if(0!==h.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&h.has(e.getNameWithoutRemote())});for(const n of t){const t=h.get(n.getNameWithoutRemote());if(null==t)continue;const o=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=o)return{uri:o,startLine:r,endLine:s}}}}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/-/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/-/tree/${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/-/commit/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/-/compare/${e}${i}${t}`)}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`#L${r.start.line}`:`#L${r.start.line}-${r.end.line}`:"",i?`${this.encodeUrl(`${this.baseUrl}/-/blob/${i}/${e}`)}${s}`:t?`${this.encodeUrl(`${this.baseUrl}/-/blob/${t}/${e}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}?path=${e}`)}${s}`}async getProviderAccountForCommit({accessToken:e},t,i){const[r,s]=this.splitPath();return(await this.container.gitlab)?.getAccountForCommit(this,e,r,s,t,{...i,baseUrl:this.apiBaseUrl})}async getProviderAccountForEmail({accessToken:e},t,i){const[r,s]=this.splitPath();return(await this.container.gitlab)?.getAccountForEmail(this,e,r,s,t,{...i,baseUrl:this.apiBaseUrl})}async getProviderDefaultBranch({accessToken:e}){const[t,i]=this.splitPath();return(await this.container.gitlab)?.getDefaultBranch(this,e,t,i,{baseUrl:this.apiBaseUrl})}async getProviderIssueOrPullRequest({accessToken:e},t){const[i,r]=this.splitPath();return(await this.container.gitlab)?.getIssueOrPullRequest(this,e,i,r,Number(t),{baseUrl:this.apiBaseUrl})}async getProviderPullRequestForBranch({accessToken:e},t,r){const[s,n]=this.splitPath(),{include:o,...a}=r??{},c=(await Promise.resolve().then(i.bind(i,6630))).toGitLabMergeRequestState;return(await this.container.gitlab)?.getPullRequestForBranch(this,e,s,n,t,{...a,include:o?.map((e=>c(e))),baseUrl:this.apiBaseUrl})}async getProviderPullRequestForCommit({accessToken:e},t){const[i,r]=this.splitPath();return(await this.container.gitlab)?.getPullRequestForCommit(this,e,i,r,t,{baseUrl:this.apiBaseUrl})}async getProviderRepositoryMetadata({accessToken:e}){const[t,i]=this.splitPath();return(await this.container.gitlab)?.getRepositoryMetadata(this,e,t,i,{baseUrl:this.apiBaseUrl})}async searchProviderMyPullRequests(e){return Promise.resolve(void 0)}async searchProviderMyIssues(e){return Promise.resolve(void 0)}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?d(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&u(t,i,n)})([(0,n.cM)()],GitLabRemote.prototype,"connect",1);class GitLabAuthenticationProvider{constructor(e){this._disposable=e.integrationAuthentication.registerProvider("gitlab",this)}dispose(){this._disposable.dispose()}getSessionId(e){return e?.domain??""}async createSession(e){const t=r.window.createInputBox();t.ignoreFocusOut=!0;const i=[];let s;try{const n={iconPath:new r.ThemeIcon("link-external"),tooltip:"Open the GitLab Access Tokens Page"};s=await new Promise((s=>{i.push(t.onDidHide((()=>s(void 0))),t.onDidChangeValue((()=>t.validationMessage=void 0)),t.onDidAccept((()=>{const e=t.value.trim();e?s(e):t.validationMessage="A personal access token is required"})),t.onDidTriggerButton((t=>{t===n&&r.env.openExternal(r.Uri.parse(`https://${e?.domain??"gitlab.com"}/-/profile/personal_access_tokens`))}))),t.password=!0,t.title="GitLab Authentication"+(e?.domain?`  • ${e.domain}`:""),t.placeholder=`Requires ${e?.scopes.join(", ")??"all"} scopes`,t.prompt=t.prompt=(0,c.gn)("input-prompt-links")?`Paste your [GitLab Personal Access Token](https://${e?.domain??"gitlab.com"}/-/profile/personal_access_tokens "Get your GitLab Access Token")`:"Paste your GitLab Personal Access Token",t.buttons=[n],t.show()}))}finally{t.dispose(),i.forEach((e=>{e.dispose()}))}if(s)return{id:this.getSessionId(e),accessToken:s,scopes:[],account:{id:"",label:""}}}}},2795:(e,t,i)=>{i.d(t,{x:()=>RemoteProvider});var r=i(9496),s=i(8786),n=i(6503);class RemoteProvider{constructor(e,t,i="https",r,s=!1){this.domain=e,this.path=t,this.protocol=i,this.custom=s,this.type="simple",this._name=r}get autolinks(){return[]}get avatarUri(){}get displayPath(){return this.path}get icon(){return"remote"}get owner(){return this.path.split("/")[0]}async copy(e){const t=this.url(e);null!=t&&await r.env.clipboard.writeText(t)}hasRichIntegration(){return"rich"===this.type}get maybeConnected(){return!1}open(e){return this.openUrl(this.url(e))}url(e){switch(e.type){case n.J.Branch:return this.getUrlForBranch(e.branch);case n.J.Branches:return this.getUrlForBranches();case n.J.Commit:return this.getUrlForCommit(e.sha);case n.J.Comparison:return this.getUrlForComparison?.(e.base,e.compare,e.notation??"...");case n.J.CreatePullRequest:return this.getUrlForCreatePullRequest?.(e.base,e.compare);case n.J.File:return this.getUrlForFile(e.fileName,null!=e.branchOrTag?e.branchOrTag:void 0,void 0,e.range);case n.J.Repo:return this.getUrlForRepository();case n.J.Revision:return this.getUrlForFile(e.fileName,null!=e.branchOrTag?e.branchOrTag:void 0,null!=e.sha?e.sha:void 0,e.range);default:return}}get baseUrl(){return`${this.protocol}://${this.domain}/${this.path}`}formatName(e){return null!=this._name?this._name:`${e}${this.custom?` (${this.domain})`:""}`}splitPath(){const e=this.path.indexOf("/");return[this.path.substring(0,e),this.path.substring(e+1)]}getUrlForRepository(){return this.baseUrl}async openUrl(e){if(null!=e)return r.env.openExternal(e)}encodeUrl(e){return(0,s.M)(e)?.replace(/#/g,"%23")}}},7552:(e,t,i)=>{i.d(t,{B:()=>_,v:()=>D});var r=i(2540),s=i(4336),n=i(2795);const o=/\/_git\/?/i,a=/^DefaultCollection\//i,c=/^(.*?)\/(.*?)\/(.*)/,l=/^(ssh|vs-ssh)\./i,h=/^\/?v\d\//i,u=/path=([^&]+)/i,d=/line=(\d+)(?:&lineEnd=(\d+))?/;class AzureDevOpsRemote extends n.x{constructor(e,t,i,r,s=!1){if(l.test(e)){t=t.replace(h,""),e=e.replace(l,"");const i=c.exec(t);if(null!=i){const[,r,n,o]=i;s?(e=`${r}.${e}`,t=`${n}/_git/${o}`):t=`${r}/${n}/_git/${o}`}}super(e,t=decodeURIComponent(t),i,r)}get autolinks(){if(void 0===this._autolinks){const e=this.baseUrl.replace(o,"/");this._autolinks=[{prefix:"#",url:`${e}/_workitems/edit/<num>`,title:`Open Work Item #<num> on ${this.name}`,type:r.fH.Issue,description:`${this.name} Work Item #<num>`},{prefix:"Merged PR ",url:`${this.baseUrl}/pullrequest/<num>`,title:`Open Pull Request #<num> on ${this.name}`,type:r.fH.PullRequest,description:`${this.name} Pull Request #<num>`}]}return this._autolinks}get icon(){return"azdo"}get id(){return"azure-devops"}get name(){return"Azure DevOps"}get displayPath(){return void 0===this._displayPath&&(this._displayPath=this.path.replace(o,"/").replace(a,"")),this._displayPath}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return Promise.resolve(void 0);let r,s;if(t.query){const e=d.exec(t.query);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=u.exec(t.query);if(null==n)return Promise.resolve(void 0);const[,o]=n,a=e.toAbsoluteUri(o,{validate:i?.validate});return Promise.resolve(null!=a?{uri:a,startLine:r,endLine:s}:void 0)}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/?version=GB${e}&_a=history`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/commit/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/branchCompare?baseVersion=GB${e}&targetVersion=GB${t}`)}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`&line=${r.start.line}&lineStartColumn=${r.start.character+1}&lineEndColumn=${r.end.character+1}`:`&line=${r.start.line}&lineEnd=${r.end.line}&lineStartColumn=${r.start.character+1}&lineEndColumn=${r.end.character+1}`:"",i?this.encodeUrl(`${this.baseUrl}?path=${e}&version=GC${i}${s}&_a=contents`):t?this.encodeUrl(`${this.baseUrl}/?path=/${e}&version=GB${t}&_a=contents${s}`):this.encodeUrl(`${this.baseUrl}?path=/${e}${s}`)}}var p=i(4321);const m=/^\/([^/]+)\/([^/]+?)\/src(.+)$/i,g=/^lines-(\d+)(?::(\d+))?$/;class BitbucketRemote extends n.x{constructor(e,t,i,r,s=!1){super(e,t,i,r,s)}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"issue #",url:`${this.baseUrl}/issues/<num>`,title:`Open Issue #<num> on ${this.name}`,type:r.fH.Issue,description:`${this.name} Issue #<num>`},{prefix:"pull request #",url:`${this.baseUrl}/pull-requests/<num>`,title:`Open Pull Request #<num> on ${this.name}`,type:r.fH.PullRequest,description:`${this.name} Pull Request #<num>`}]),this._autolinks}get icon(){return"bitbucket"}get id(){return"bitbucket"}get name(){return this.formatName("Bitbucket")}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r,s;if(t.fragment){const e=g.exec(t.fragment);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=m.exec(t.path);if(null==n)return;const[,,,o]=n;let a,c=o.indexOf("/",1);if(-1!==c){const t=o.substring(1,c);if((0,p.D3)(t)){const t=e.toAbsoluteUri(o.substr(c),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r,endLine:s}}}const l=new Map;c=o.length;do{c=o.lastIndexOf("/",c-1),a=o.substring(1,c),l.set(a,o.substr(c))}while(c>0);if(0!==l.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&l.has(e.getNameWithoutRemote())});for(const n of t){const t=l.get(n.getNameWithoutRemote());if(null==t)continue;const o=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=o)return{uri:o,startLine:r,endLine:s}}}}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/branch/${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/commits/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/branches/compare/${e}%0D${t}`).replace("%250D","%0D")}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`#${e}-${r.start.line}`:`#${e}-${r.start.line}:${r.end.line}`:"",i?`${this.encodeUrl(`${this.baseUrl}/src/${i}/${e}`)}${s}`:t?`${this.encodeUrl(`${this.baseUrl}/src/${t}/${e}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}?path=${e}`)}${s}`}}const f=/^\/([^/]+)\/([^/]+?)\/src(.+)$/i,w=/^lines-(\d+)(?::(\d+))?$/;class BitbucketServerRemote extends n.x{constructor(e,t,i,r,s=!1){super(e,t,i,r,s)}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"issue #",url:`${this.baseUrl}/issues/<num>`,title:`Open Issue #<num> on ${this.name}`,type:r.fH.Issue,description:`${this.name} Issue #<num>`},{prefix:"pull request #",ignoreCase:!0,url:`${this.baseUrl}/pull-requests/<num>`,title:`Open Pull Request #<num> on ${this.name}`,type:r.fH.PullRequest,description:`${this.name} Pull Request #<num>`}]),this._autolinks}get baseUrl(){const[e,t]=this.path.startsWith("scm/")?this.path.replace("scm/","").split("/"):this.splitPath();return`${this.protocol}://${this.domain}/projects/${e}/repos/${t}`}get icon(){return"bitbucket"}get id(){return"bitbucket-server"}get name(){return this.formatName("Bitbucket Server")}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r,s;if(t.fragment){const e=w.exec(t.fragment);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=f.exec(t.path);if(null==n)return;const[,,,o]=n;let a,c=o.indexOf("/",1);if(-1!==c){const t=o.substring(1,c);if((0,p.D3)(t)){const t=e.toAbsoluteUri(o.substr(c),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r,endLine:s}}}const l=new Map;c=o.length;do{c=o.lastIndexOf("/",c-1),a=o.substring(1,c),l.set(a,o.substr(c))}while(c>0);if(0!==l.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&l.has(e.getNameWithoutRemote())});for(const n of t){const t=l.get(n.getNameWithoutRemote());if(null==t)continue;const o=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=o)return{uri:o,startLine:r,endLine:s}}}}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/commits?until=${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/commits/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/branches/compare/${e}%0D${t}`).replace("%250D","%0D")}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`#${r.start.line}`:`#${r.start.line}-${r.end.line}`:"",i?`${this.encodeUrl(`${this.baseUrl}/browse/${e}?at=${i}`)}${s}`:t?`${this.encodeUrl(`${this.baseUrl}/browse/${e}?at=${t}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}/browse/${e}`)}${s}`}}var v=i(3620);class CustomRemote extends n.x{constructor(e,t,i,r,s){super(e,t,r,s,!0),this.urls=i}get id(){return"custom"}get name(){return this.formatName("Custom")}getLocalInfoFromRemoteUri(e,t){return Promise.resolve(void 0)}getUrlForRepository(){return this.getUrl(this.urls.repository,this.getContext())}getUrlForBranches(){return this.getUrl(this.urls.branches,this.getContext())}getUrlForBranch(e){return this.getUrl(this.urls.branch,this.getContext({branch:e}))}getUrlForCommit(e){return this.getUrl(this.urls.commit,this.getContext({id:e}))}getUrlForComparison(e,t,i){if(null!=this.urls.comparison)return this.getUrl(this.urls.comparison,this.getContext({ref1:e,ref2:t,notation:i}))}getUrlForFile(e,t,i,r){let s,n,o;s=null!=r?r.start.line===r.end.line?(0,v.sX)(this.urls.fileLine,{line:r.start.line,line_encoded:r.start.line}):(0,v.sX)(this.urls.fileRange,{start:r.start.line,start_encoded:r.start.line,end:r.end.line,end_encoded:r.end.line}):"",i?(n=this.urls.fileInCommit,o=this.getContext({id:i,file:e,line:s})):t?(n=this.urls.fileInBranch,o=this.getContext({branch:t,file:e,line:s})):(n=this.urls.file,o=this.getContext({file:e,line:s}));let a=(0,v.sX)(n,o);if((0,v.Gg)(n).some((e=>e.key.endsWith("_encoded"))))return a;const c=a.includes("#");if(a=this.encodeUrl(a),c){const e=a.lastIndexOf("%23");-1!==e&&(a=`${a.substring(0,e)}#${a.substring(e+3)}`)}return a}getUrl(e,t){const i=(0,v.sX)(e,t);return(0,v.Gg)(e).some((e=>e.key.endsWith("_encoded")))?i:this.encodeUrl(i)}getContext(e){const[t,i]=this.splitPath(),r={repo:this.path,repoBase:t,repoPath:i,...e??{}};for(const[e,t]of Object.entries(r))r[`${e}_encoded`]=encodeURIComponent(t);return r}}const y=/^\/([^/]+)\/\+(.+)$/i,b=/^(\d+)$/;class GerritRemote extends n.x{constructor(e,t,i,r,s=!1,n=!0){n&&"ssh"!==i&&(t=t.replace(/^a\//,"")),super(e,t,i,r,s)}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"Change-Id: ",url:`${this.baseReviewUrl}/q/<num>`,title:`Open Change #<num> on ${this.name}`,alphanumeric:!0,description:`${this.name} Change #<num>`}]),this._autolinks}get icon(){return"gerrit"}get id(){return"gerrit"}get name(){return this.formatName("Gerrit")}get baseUrl(){return`${this.protocol}://${this.domain}/plugins/gitiles/${this.path}`}get baseReviewUrl(){return`${this.protocol}://${this.domain}`}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r;if(t.fragment){const e=b.exec(t.fragment);if(null!=e){const[,t]=e;t&&(r=parseInt(t,10))}}const s=y.exec(t.path);if(null==s)return;const[,,n]=s;let o=n.indexOf("/",1);if(-1!==o){const t=n.substring(1,o);if((0,p.D3)(t)||"HEAD"==t){const t=e.toAbsoluteUri(n.substr(o),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r}}}if(n.startsWith("/refs/heads/")){const t=n.substr(12);let s;const a=new Map;o=t.length;do{o=t.lastIndexOf("/",o-1),s=t.substring(1,o),a.set(s,t.substr(o))}while(o>0);if(0!==a.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&a.has(e.getNameWithoutRemote())});for(const s of t){const t=a.get(s.getNameWithoutRemote());if(null==t)continue;const n=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=n)return{uri:n,startLine:r}}}}else if(n.startsWith("/refs/tags/")){const t=n.substr(11);let s;const a=new Map;o=t.length;do{o=t.lastIndexOf("/",o-1),s=t.substring(1,o),a.set(s,t.substr(o))}while(o>0);if(0!==a.size){const{values:t}=await e.getTags({filter:e=>a.has(e.name)});for(const s of t){const t=a.get(s.name);if(null==t)continue;const n=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=n)return{uri:n,startLine:r}}}}else;}getUrlForBranches(){return this.encodeUrl(`${this.baseReviewUrl}/admin/repos/${this.path},branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/+/refs/heads/${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseReviewUrl}/q/${e}`)}getUrlForFile(e,t,i,r){const s=null!=r?`#${r.start.line}`:"";return i?`${this.encodeUrl(`${this.baseUrl}/+/${i}/${e}`)}${s}`:t?`${this.encodeUrl(`${this.getUrlForBranch(t)}/${e}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}/+/HEAD/${e}`)}${s}`}}const C=/^\/([^/]+)\/([^/]+?)\/src(.+)$/i,A=/^L(\d+)(?:-L(\d+))?$/;class GiteaRemote extends n.x{constructor(e,t,i,r,s=!1){super(e,t,i,r,s)}get autolinks(){return void 0===this._autolinks&&(this._autolinks=[{prefix:"#",url:`${this.baseUrl}/issues/<num>`,title:`Open Issue #<num> on ${this.name}`,type:r.fH.Issue,description:`${this.name} Issue #<num>`}]),this._autolinks}get icon(){return"gitea"}get id(){return"gitea"}get name(){return this.formatName("Gitea")}async getLocalInfoFromRemoteUri(e,t,i){if(t.authority!==this.domain)return;if((i?.validate??1)&&!t.path.startsWith(`/${this.path}/`))return;let r,s;if(t.fragment){const e=A.exec(t.fragment);if(null!=e){const[,t,i]=e;t&&(r=parseInt(t,10),i&&(s=parseInt(i,10)))}}const n=C.exec(t.path);if(null==n)return;const[,,,o]=n;let a,c;if(o.startsWith("/commit/")&&(a=8,c=o.indexOf("/",a),-1!==c)){const t=o.substring(a,c);if((0,p.D3)(t)){const t=e.toAbsoluteUri(o.substr(c),{validate:i?.validate});if(null!=t)return{uri:t,startLine:r,endLine:s}}}if(o.startsWith("/branch/")){let t;const n=new Map;a=8,c=a;do{t=o.substring(a,c),n.set(t,o.substr(c)),c=o.indexOf("/",c+1)}while(c<o.length&&-1!==c);if(0!==n.size){const{values:t}=await e.getBranches({filter:e=>e.remote&&n.has(e.getNameWithoutRemote())});for(const o of t){const t=n.get(o.getNameWithoutRemote());if(null==t)continue;const a=e.toAbsoluteUri(t,{validate:i?.validate});if(null!=a)return{uri:a,startLine:r,endLine:s}}}}}getUrlForBranches(){return this.encodeUrl(`${this.baseUrl}/branches`)}getUrlForBranch(e){return this.encodeUrl(`${this.baseUrl}/src/branch/${e}`)}getUrlForCommit(e){return this.encodeUrl(`${this.baseUrl}/commit/${e}`)}getUrlForComparison(e,t,i){return this.encodeUrl(`${this.baseUrl}/compare/${e}...${t}`)}getUrlForFile(e,t,i,r){let s;return s=null!=r?r.start.line===r.end.line?`#L${r.start.line}`:`#L${r.start.line}-L${r.end.line}`:"",i?`${this.encodeUrl(`${this.baseUrl}/src/commit/${i}/${e}`)}${s}`:t?`${this.encodeUrl(`${this.baseUrl}/src/branch/${t}/${e}`)}${s}`:`${this.encodeUrl(`${this.baseUrl}/src/${e}`)}${s}`}}var P=i(2075),S=i(5542);class GoogleSourceRemote extends GerritRemote{constructor(e,t,i,r,s=!1){super(e,t,i,r,s,!1)}get id(){return"google-source"}get name(){return this.formatName("Google Source")}get baseUrl(){return`${this.protocol}://${this.domain}/${this.path}`}get reviewDomain(){const[e,...t]=this.domain.split(".");return[`${e}-review`,...t].join(".")}get baseReviewUrl(){return`${this.protocol}://${this.reviewDomain}`}}const R=[{custom:!1,matcher:"bitbucket.org",creator:(e,t,i)=>new BitbucketRemote(t,i)},{custom:!1,matcher:"github.com",creator:(e,t,i)=>new P.gu(e,t,i)},{custom:!1,matcher:"gitlab.com",creator:(e,t,i)=>new S.E(e,t,i)},{custom:!1,matcher:/\bdev\.azure\.com$/i,creator:(e,t,i)=>new AzureDevOpsRemote(t,i)},{custom:!0,matcher:/^(.+\/(?:bitbucket|stash))\/scm\/(.+)$/i,creator:(e,t,i)=>new BitbucketServerRemote(t,i)},{custom:!1,matcher:/\bgitlab\b/i,creator:(e,t,i)=>new S.E(e,t,i)},{custom:!1,matcher:/\bvisualstudio\.com$/i,creator:(e,t,i)=>new AzureDevOpsRemote(t,i,void 0,void 0,!0)},{custom:!1,matcher:/\bgitea\b/i,creator:(e,t,i)=>new GiteaRemote(t,i)},{custom:!1,matcher:/\bgerrithub\.io$/i,creator:(e,t,i)=>new GerritRemote(t,i)},{custom:!1,matcher:/\bgooglesource\.com$/i,creator:(e,t,i)=>new GoogleSourceRemote(t,i)}];function D(e){const t=[];if(e?.length)for(const i of e){const e=k(i);if(null==e)continue;let r;try{if(r=i.regex?new RegExp(i.regex,"i"):i.domain?.toLowerCase(),null==r)throw new Error("No matcher found")}catch(e){s.Yd.error(e,`Loading remote provider '${i.name??""}' failed`)}t.push({custom:!0,matcher:r,creator:e})}return t.push(...R),t}function k(e){switch(e.type){case r.zW.AzureDevOps:return(t,i,r)=>new AzureDevOpsRemote(i,r,e.protocol,e.name,!0);case r.zW.Bitbucket:return(t,i,r)=>new BitbucketRemote(i,r,e.protocol,e.name,!0);case r.zW.BitbucketServer:return(t,i,r)=>new BitbucketServerRemote(i,r,e.protocol,e.name,!0);case r.zW.Custom:return(t,i,r)=>new CustomRemote(i,r,e.urls,e.protocol,e.name);case r.zW.Gerrit:return(t,i,r)=>new GerritRemote(i,r,e.protocol,e.name,!0);case r.zW.GoogleSource:return(t,i,r)=>new GoogleSourceRemote(i,r,e.protocol,e.name,!0);case r.zW.Gitea:return(t,i,r)=>new GiteaRemote(i,r,e.protocol,e.name,!0);case r.zW.GitHub:return(t,i,r)=>new P.gu(t,i,r,e.protocol,e.name,!0);case r.zW.GitLab:return(t,i,r)=>new S.E(t,i,r,e.protocol,e.name,!0);default:return}}function _(e,t){return(i,r,n)=>function(e,t,i,r,n){try{const s=r.toLowerCase();for(const{custom:o,matcher:a,creator:c}of t){if("string"==typeof a){if(a===s)return c(e,r,n);continue}if(a.test(s))return c(e,r,n);if(!o)continue;const t=a.exec(i);if(null!=t)return c(e,t[1],t[2])}return}catch(e){return void s.Yd.error(e,"createRemoteProvider")}}(e,t,i,r,n)}},3084:(e,t,i)=>{i.d(t,{D:()=>RichRemoteProvider,e:()=>y});var r=i(9496),s=i(9827),n=i(429),o=i(4575),a=i(7925),c=i(4968),l=i(5148),h=i(5432),u=i(4241),d=i(4336),p=i(6004),m=i(7469),g=i(2795),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor,v=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&f(t,i,n),n};class RichRemoteProvider extends g.x{constructor(e,t,i,s,n,o){super(t,i,s,n,o),this.container=e,this.type="rich",this._onDidChange=new r.EventEmitter,this.requestExceptionCount=0,this._ignoreSSLErrors=new Map,this._prsByCommit=new Map,e.context.subscriptions.push(l.D.onDidChange((e=>{l.D.changed(e,"remotes")&&this._ignoreSSLErrors.clear()})),e.richRemoteProviders.onDidChangeConnectionState((e=>{e.key===this.key&&("disconnected"===e.reason?this.disconnect({silent:!0}):"connected"===e.reason&&this.ensureSession(!1))})),r.authentication.onDidChangeSessions(this.onAuthenticationSessionsChanged,this))}get onDidChange(){return this._onDidChange.event}get authProviderDescriptor(){return{domain:this.domain,scopes:this.authProvider.scopes}}get key(){return this.custom?`${this.name}:${this.domain}`:this.name}get connectedKey(){return`connected:${this.key}`}get maybeConnected(){return void 0===this._session?void 0:null!==this._session}session(){return void 0===this._session?this.ensureSession(!1):this._session??void 0}onAuthenticationSessionsChanged(e){e.provider.id===this.authProvider.id&&this.ensureSession(!1)}async connect(){try{const e=await this.ensureSession(!0);return Boolean(e)}catch(e){return!1}}async disconnect(e){if(e?.currentSessionOnly&&null===this._session)return;const t=null!=this._session;if(t&&!e?.silent)if(e?.currentSessionOnly)(0,a.mm)(this.name);else{const e={title:"Disable"},t={title:"Disable & Sign Out"},i={title:"Cancel",isCloseAffordance:!0};let s;if(s=this.container.integrationAuthentication.hasProvider(this.authProvider.id)?await r.window.showWarningMessage(`Are you sure you want to disable the rich integration with ${this.name}?\n\nNote: signing out clears the saved authentication.`,{modal:!0},e,t,i):await r.window.showWarningMessage(`Are you sure you want to disable the rich integration with ${this.name}?`,{modal:!0},e,i),null==s||s===i)return;s===t&&this.container.integrationAuthentication.deleteSession(this.authProvider.id,this.authProviderDescriptor)}this.resetRequestExceptionCount(),this._repoMetadata=void 0,this._prsByCommit.clear(),this._session=null,t&&(e?.currentSessionOnly||this.container.storage.storeWorkspace(this.connectedKey,!1),this._onDidChange.fire(),e?.silent||e?.currentSessionOnly||this.container.richRemoteProviders.disconnected(this.key))}async reauthenticate(){void 0!==this._session&&(this._session=void 0,await this.ensureSession(!0,!0))}resetRequestExceptionCount(){this.requestExceptionCount=0}trackRequestException(){this.requestExceptionCount++,this.requestExceptionCount>=5&&null!==this._session&&this.disconnect({currentSessionOnly:!0})}async isConnected(){return null!=await this.session()}async getAccountForCommit(e,t){const i=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const i=await this.getProviderAccountForCommit(this._session,e,t);return this.resetRequestExceptionCount(),i}catch(e){return d.Yd.error(e,i),void((e instanceof o._7||e instanceof o.Bn)&&this.trackRequestException())}}async getAccountForEmail(e,t){const i=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const i=await this.getProviderAccountForEmail(this._session,e,t);return this.resetRequestExceptionCount(),i}catch(e){return d.Yd.error(e,i),void((e instanceof o._7||e instanceof o.Bn)&&this.trackRequestException())}}async getDefaultBranch(){const e=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const e=await this.getProviderDefaultBranch(this._session);return this.resetRequestExceptionCount(),e}catch(t){return d.Yd.error(t,e),void((t instanceof o._7||t instanceof o.Bn)&&this.trackRequestException())}}async getRepositoryMetadata(){if(null!=this._repoMetadata)return this._repoMetadata;const e=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const e=await this.getProviderRepositoryMetadata(this._session);return this._repoMetadata=e,this.resetRequestExceptionCount(),e}catch(t){return d.Yd.error(t,e),void((t instanceof o._7||t instanceof o.Bn)&&this.trackRequestException())}}async searchMyPullRequests(){const e=(0,p.UH)();try{const e=await this.searchProviderMyPullRequests(this._session);return this.resetRequestExceptionCount(),e}catch(t){return d.Yd.error(t,e),void((t instanceof o._7||t instanceof o.Bn)&&this.trackRequestException())}}async searchMyIssues(){const e=(0,p.UH)();try{const e=await this.searchProviderMyIssues(this._session);return this.resetRequestExceptionCount(),e}catch(t){return d.Yd.error(t,e),void((t instanceof o._7||t instanceof o.Bn)&&this.trackRequestException())}}async getIssueOrPullRequest(e){const t=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const t=await this.getProviderIssueOrPullRequest(this._session,e);return this.resetRequestExceptionCount(),t}catch(e){return d.Yd.error(e,t),void((e instanceof o._7||e instanceof o.Bn)&&this.trackRequestException())}}getIgnoreSSLErrors(){if(n.$L)return!1;let e=this._ignoreSSLErrors.get(this.id);if(void 0===e){const t=l.D.get("remotes")?.find((e=>e.type.toLowerCase()===this.id&&e.domain===this.domain));e=t?.ignoreSSLErrors??!1,this._ignoreSSLErrors.set(this.id,e)}return e}async getPullRequestForBranch(e,t){const i=(0,p.UH)();if(this.maybeConnected??await this.isConnected())try{const i=await this.getProviderPullRequestForBranch(this._session,e,t);return this.resetRequestExceptionCount(),i}catch(e){return d.Yd.error(e,i),void((e instanceof o._7||e instanceof o.Bn)&&this.trackRequestException())}}getPullRequestForCommit(e){let t=this._prsByCommit.get(e);return void 0===t&&(t=this.getPullRequestForCommitCore(e),this._prsByCommit.set(e,t)),null!=t&&(0,m.tI)(t)?t.then((e=>e??void 0)):t??void 0}async getPullRequestForCommitCore(e){const t=(0,p.UH)();if(!(this.maybeConnected??await this.isConnected()))return null;try{const t=await this.getProviderPullRequestForCommit(this._session,e)??null;return this._prsByCommit.set(e,t),this.resetRequestExceptionCount(),t}catch(i){return d.Yd.error(i,t),this._prsByCommit.delete(e),(i instanceof o._7||i instanceof o.Bn)&&this.trackRequestException(),null}}async ensureSession(e,t=!1){if(null!=this._session)return this._session;if(!l.D.get("integrations.enabled"))return;if(e)await this.container.storage.deleteWorkspace(this.connectedKey);else if(!1===this.container.storage.getWorkspace(this.connectedKey))return;let i;try{i=this.container.integrationAuthentication.hasProvider(this.authProvider.id)?await this.container.integrationAuthentication.getSession(this.authProvider.id,this.authProviderDescriptor,{createIfNeeded:e,forceNewSession:t}):await(0,s.a_)(this.getIgnoreSSLErrors(),(()=>r.authentication.getSession(this.authProvider.id,this.authProvider.scopes,{createIfNone:t?void 0:e,silent:!e&&!t||void 0,forceNewSession:!!t||void 0})))}catch(e){if(await this.container.storage.deleteWorkspace(this.connectedKey),e instanceof Error&&e.message.includes("User did not consent"))return;i=null}return void 0!==i||e||await this.container.storage.deleteWorkspace(this.connectedKey),this._session=i??null,this.resetRequestExceptionCount(),null!=i&&(await this.container.storage.storeWorkspace(this.connectedKey,!0),queueMicrotask((()=>{this._onDidChange.fire(),this.container.richRemoteProviders.connected(this.key)}))),i??void 0}}async function y(e,t){const i=`Connecting to a ${e} instance for rich integration features requires a trial or paid plan.`;for(;;){const e=await t.subscription.getSubscription();if(!1===e.account?.verified){const e={title:"Resend Verification"},s={title:"Cancel",isCloseAffordance:!0};if(await r.window.showWarningMessage(`${i}\n\nYou must verify your email before you can continue.`,{modal:!0},e,s)===e&&await t.subscription.resendVerification())continue;return!1}const s=e.plan.effective.id;if((0,c.aG)(s))break;if(null==e.account&&!(0,c.gA)(e)){const e={title:"Preview Pro"},s={title:"Cancel",isCloseAffordance:!0};if(await r.window.showWarningMessage(`${i}\n\nDo you want to preview ✨ features for 3 days?`,{modal:!0},e,s)!==e)return!1;t.subscription.startPreviewTrial();break}if(null==e.account){const e={title:"Start Free Pro Trial"},s={title:"Cancel",isCloseAffordance:!0};if(await r.window.showWarningMessage(`${i}\n\nDo you want to continue to use ✨ features on privately hosted repos, free for an additional 7 days?`,{modal:!0},e,s)===e&&await t.subscription.loginOrSignUp())continue}else{const e={title:"Upgrade to Pro"},s={title:"Cancel",isCloseAffordance:!0};await r.window.showWarningMessage(`${i}\n\nDo you want to continue to use ✨ features on privately hosted repos?`,{modal:!0},e,s)===e&&t.subscription.purchase()}return!1}return!0}v([(0,u.cM)()],RichRemoteProvider.prototype,"connect",1),v([(0,h.H)(),(0,u.cM)()],RichRemoteProvider.prototype,"disconnect",1),v([(0,u.cM)()],RichRemoteProvider.prototype,"reauthenticate",1),v([(0,u.fF)()],RichRemoteProvider.prototype,"trackRequestException",1),v([(0,h.H)(),(0,u.fF)({exit:!0})],RichRemoteProvider.prototype,"isConnected",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getAccountForCommit",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getAccountForEmail",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getDefaultBranch",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getRepositoryMetadata",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"searchMyPullRequests",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"searchMyIssues",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getIssueOrPullRequest",1),v([(0,h.H)(),(0,u.fF)()],RichRemoteProvider.prototype,"getPullRequestForBranch",1),v([(0,u.fF)()],RichRemoteProvider.prototype,"getPullRequestForCommit",1),v([(0,u.fF)()],RichRemoteProvider.prototype,"getPullRequestForCommitCore",1),v([(0,h.H)()],RichRemoteProvider.prototype,"ensureSession",1)},6934:(e,t,i)=>{i.d(t,{FL:()=>a,KQ:()=>o,WY:()=>s,pD:()=>u,pU:()=>c,uP:()=>n});var r=i(4321);const s=new Set(["","=:","message:","@:","author:","#:","commit:","?:","file:","~:","change:"]);function n(e){return{query:e.pattern,matchAll:e.matchAll,matchCase:e.matchCase,matchRegex:e.matchRegex}}function o(e){return{pattern:e.query,matchAll:e.matchAll,matchCase:e.matchCase,matchRegex:e.matchRegex}}function a(e){return`${"query"in e?e.query:e.pattern}|${e.matchAll?"A":""}${e.matchCase?"C":""}${e.matchRegex?"R":""}`}function c(e){return e.map((e=>`#:${"string"==typeof e?(0,r.zL)(e):e.name}`)).join(" ")}const l=new Map([["","message:"],["=:","message:"],["message:","message:"],["@:","author:"],["author:","author:"],["#:","commit:"],["commit:","commit:"],["?:","file:"],["file:","file:"],["~:","change:"],["change:","change:"]]),h=/(?:(?<op>=:|message:|@:|author:|#:|commit:|\?:|file:|~:|change:)\s?(?<value>".+?"|\S+}?))|(?<text>\S+)(?!(?:=|message|@|author|#|commit|\?|file|~|change):)/gi;function u(e){const t=new Map;let i,s,n,o;do{if(o=h.exec(e.query),null==o?.groups)break;if(i=l.get(o.groups.op),({value:s,text:n}=o.groups),n&&(i="@me"===n?"author:":(0,r.D3)(n)?"commit:":"message:",s=n),i&&s){const e=t.get(i);null==e?t.set(i,[s]):e.push(s)}}while(null!=o);return t}},1062:(e,t,i)=>{i.d(t,{jw:()=>y,nN:()=>C,yq:()=>b});var r=i(9496),s=i(9376),n=i(9152),o=i(5255),a=i(5567),c=i(9338),l=i(7462),h=i(439),u=i(4321),d=i(5148),p=i(3105),m=i(4336),g=i(8227),f=i(6004),w=i(7469),v=i(3620);async function y(e,t,i,s){const c=t.sha;let l=null;const p=await async function(){if(null==e.file)return;let r;if(e.isUncommitted)(0,u.rD)(c)&&(r=c);else if(l=await e.getPreviousSha(),r=l,null==r)return`\`\`\`diff\n+ ${s.lineAt(i).text}\n\`\`\``;const n=i+1,o=e.lines.find((e=>e.line===n))??e.lines[0];let p=e.file.originalPath;null==p&&t.fsPath!==e.file.uri.fsPath&&(p=e.file.path),i=o.line-1;let m=await a.W.instance.git.getDiffForLine(t,i,r,c);return null==m&&null==r&&c!==h.pw&&(m=await a.W.instance.git.getDiffForLine(t,i,void 0,h.pw)),null!=m?function(e,t){if("hunk"===t||null==t&&"hunk"===d.D.get("hovers.changesDiff"))return A(e.hunk);return`\`\`\`diff${null==e.previous?"":`\n- ${e.previous.line.trim()}`}${null==e.current?"":`\n+ ${e.current.line.trim()}`}\n\`\`\``}(m):void 0}();if(null==p)return;let m,g,f;if(e.isUncommitted){const t=await e.getPreviousComparisonUrisForLine(i,c);if(null==t?.previous)return;m=`[$(compare-changes)](${n.V.getMarkdownCommandArgs({lhs:{sha:t.previous.sha??"",uri:t.previous.documentUri()},rhs:{sha:t.current.sha??"",uri:t.current.documentUri()},repoPath:e.repoPath,line:i})} "Open Changes")`,g=null==t.previous.sha||t.previous.isUncommitted?`  &nbsp;_${(0,u.zL)(t.previous.sha,{strings:{working:"Working Tree"}})}_ &nbsp;${o.NE.ArrowLeftRightLong}&nbsp; `:`  &nbsp;[$(git-commit) ${(0,u.zL)(t.previous.sha||"")}](${n.oc.getMarkdownCommandArgs(t.previous.sha||"")} "Show Commit") &nbsp;${o.NE.ArrowLeftRightLong}&nbsp; `,f=null==t.current.sha||t.current.isUncommitted?`_${(0,u.zL)(t.current.sha,{strings:{working:"Working Tree"}})}_`:`[$(git-commit) ${(0,u.zL)(t.current.sha||"")}](${n.oc.getMarkdownCommandArgs(t.current.sha||"")} "Show Commit")`}else m=`[$(compare-changes)](${n.V.getMarkdownCommandArgs(e,i)} "Open Changes")`,null===l&&(l=await e.getPreviousSha()),l&&(g=`  &nbsp;[$(git-commit) ${(0,u.zL)(l)}](${n.oc.getMarkdownCommandArgs(l)} "Show Commit") &nbsp;${o.NE.ArrowLeftRightLong}&nbsp;`),f=`[$(git-commit) ${e.shortSha}](${n.oc.getMarkdownCommandArgs(e.sha)} "Show Commit")`;m=`${p}\n---\n\nChanges${g??" added in "}${f} &nbsp;&nbsp;|&nbsp;&nbsp; ${m}`;const w=new r.MarkdownString(m,!0);return w.supportHtml=!0,w.isTrusted=!0,w}async function b(e,t,i,s){const a=A(s);let c,h,u;if(null==e)h="_Working Tree_",u="_Unsaved_";else{const r=await e.findFile(t);if(null==r)return;c=`[$(compare-changes)](${n.V.getMarkdownCommandArgs({lhs:{sha:e.sha,uri:l.YY.fromFile(r,t.repoPath,void 0,!0).toFileUri()},rhs:{sha:"",uri:t.toFileUri()},repoPath:t.repoPath,line:i})} "Open Changes")`,h=`[$(git-commit) ${e.shortSha}](${n.oc.getMarkdownCommandArgs(e.sha)} "Show Commit")`,u="_Working Tree_"}c=`${a}\n---\n\nLocal Changes  &nbsp;${h} &nbsp;${o.NE.ArrowLeftRightLong}&nbsp; ${u}${null==c?"":` &nbsp;&nbsp;|&nbsp;&nbsp; ${c}`}`;const d=new r.MarkdownString(c,!0);return d.supportHtml=!0,d.isTrusted=!0,d}async function C(e,t,i,s){let n=e.message??e.summary;if(null==e.message&&!e.isUncommitted&&(await e.ensureFullDetails(),n=e.message??e.summary,s?.cancellationToken?.isCancellationRequested))return new r.MarkdownString;const o=await a.W.instance.git.getRemotesWithProviders(e.repoPath,{sort:!0});if(s?.cancellationToken?.isCancellationRequested)return new r.MarkdownString;const[l,h,u,d]=await Promise.allSettled([e.isUncommitted?e.getPreviousComparisonUrisForLine(i,t.sha):void 0,P(n,o),s?.pullRequests?.pr??S(e.ref,o,{pullRequests:!1!==s?.pullRequests?.enabled&&c.i.has(s.format,"pullRequest","pullRequestAgo","pullRequestAgoOrDate","pullRequestDate","pullRequestState")}),a.W.instance.vsls.maybeGetPresence(e.author.email)]);if(s?.cancellationToken?.isCancellationRequested)return new r.MarkdownString;const p=(0,w.Sb)(l),m=(0,w.Sb)(h),g=(0,w.Sb)(u),f=(0,w.Sb)(d);null==g||g instanceof w.PK||m?.delete(g.id);const v=await c.i.fromTemplateAsync(s.format,e,{autolinkedIssuesOrPullRequests:m,dateFormat:null===s.dateFormat?"MMMM Do, YYYY h:mma":s.dateFormat,editor:{line:i,uri:t},getBranchAndTagTips:s?.getBranchAndTagTips,messageAutolinks:s?.autolinks,pullRequestOrRemote:g,presence:f,previousLineComparisonUris:p,outputFormat:"markdown",remotes:o}),y=new r.MarkdownString(v,!0);return y.supportHtml=!0,y.isTrusted=!0,y}function A(e){return`\`\`\`diff\n${e.diff.trim()}\n\`\`\``}async function P(e,t){const i=(0,f.QR)("Hovers.getAutoLinkedIssuesOrPullRequests");m.Yd.debug(i,`${o.NE.Dash} message=<message>`);const r=(0,s.a)(),n=d.D.get("hovers");if(!n.autolinks.enabled||!n.autolinks.enhanced||!c.i.has(n.detailsMarkdownFormat,"message"))return void m.Yd.debug(i,`completed [${(0,v.qk)(r)}ms]`);const l=await a.W.instance.git.getBestRemoteWithRichProvider(t);if(null==l?.provider)return void m.Yd.debug(i,`completed [${(0,v.qk)(r)}ms]`);try{const t=await a.W.instance.autolinks.getLinkedIssuesAndPullRequests(e,l,{timeout:250});if(null!=t&&m.Yd.enabled(g.i.Debug)){const e=(0,p.QX)(t.values(),(e=>e instanceof w.PK));if(0!==e)return m.Yd.debug(i,`timed out ${o.NE.Dash} ${e} issue/pull request queries took too long (over 250 ms) [${(0,v.qk)(r)}ms]`),t}return m.Yd.debug(i,`completed [${(0,v.qk)(r)}ms]`),t}catch(e){return void m.Yd.error(e,i,`failed [${(0,v.qk)(r)}ms]`)}}async function S(e,t,i){const r=(0,f.QR)("Hovers.getPullRequestForCommit");m.Yd.debug(r,`${o.NE.Dash} ref=${e}`);const n=(0,s.a)();if(!i?.pullRequests)return void m.Yd.debug(r,`completed [${(0,v.qk)(n)}ms]`);const c=await a.W.instance.git.getBestRemoteWithRichProvider(t,{includeDisconnected:!0});if(null==c?.provider)return void m.Yd.debug(r,`completed [${(0,v.qk)(n)}ms]`);const{provider:l}=c;if(!(l.maybeConnected??await l.isConnected()))return m.Yd.debug(r,`completed [${(0,v.qk)(n)}ms]`),c;try{const t=await a.W.instance.git.getPullRequestForCommit(e,l,{timeout:250});return m.Yd.debug(r,`completed [${(0,v.qk)(n)}ms]`),t}catch(e){return e instanceof w.PK?(m.Yd.debug(r,`timed out [${(0,v.qk)(n)}ms]`),e):void m.Yd.error(e,r,`failed [${(0,v.qk)(n)}ms]`)}}},7925:(e,t,i)=>{i.d(t,{B8:()=>d,EB:()=>p,G:()=>u,Nl:()=>f,QP:()=>y,RR:()=>h,W8:()=>m,bi:()=>v,f3:()=>w,mm:()=>b,s$:()=>A,vF:()=>C,xs:()=>P,zk:()=>g});var r=i(9496),s=i(2540),n=i(5255),o=i(9529),a=i(5148),c=i(4336),l=i(8227);function h(e){return S("info",null==e?"There is no previous commit.":`Commit ${e.shortSha} (${e.author.name}, ${e.formattedDate}) has no previous commit.`,s.kl.CommitHasNoPreviousCommitWarning)}function u(e){return S("warn",`${e}. The commit could not be found.`,s.kl.CommitNotFoundWarning)}async function d(e){const t={title:"Create Pull Request..."};return await S("info",`Would you like to create a Pull Request for branch '${e}'?`,s.kl.CreatePullRequestPrompt,{title:"Don't Show Again"},t)===t}async function p(){const e={title:"Disable Debug Logging"};return await S("warn","GitLens debug logging is currently enabled. Unless you are reporting an issue, it is recommended to be disabled. Would you like to disable it?",s.kl.SuppressDebugLoggingWarning,{title:"Don't Show Again"},e)===e}async function m(e){if(c.Yd.enabled(l.i.Error)){null!=await S("error",`${e}. See output channel for more details.`,void 0,null,{title:"Open Output Channel"})&&c.Yd.showOutputChannel()}else{null!=await S("error",`${e}. If the error persists, please enable debug logging and try again.`,void 0,null,{title:"Enable Debug Logging"})&&(0,o.P0)(n.Gh.EnableDebugLogging)}}function g(e){return S("warn",`${e}. The file is probably not under source control.`,s.kl.FileNotUnderSourceControlWarning)}function f(e){return S("error",`This GitLens pre-release version (${e}) has expired. Please upgrade to a more recent version.`)}function w(e){return S("warn",`${e}. The line has uncommitted changes.`,s.kl.LineUncommittedWarning)}function v(e){return S("warn",`${e}. No repository could be found.`,s.kl.NoRepositoryWarning)}function y(){return S("warn","Closing either the git-rebase-todo file or the Rebase Editor will start the rebase.",s.kl.RebaseSwitchToTextWarning)}function b(e){return S("error",`Rich integration with ${e} has been disconnected for this session, because of too many failed requests.`,s.kl.IntegrationDisconnectedTooManyFailedRequestsWarning,void 0,{title:"OK"})}function C(e){return S("error",e,s.kl.IntegrationRequestFailed500Warning,void 0,{title:"OK"})}function A(e){return S("error",`${e} request timed out.`,s.kl.IntegrationRequestTimedOutWarning,void 0,{title:"OK"})}async function P(e){const t={title:"Switch to New Layout"};await S("info",`Upgraded to GitLens ${e} — [see what's new](https://help.gitkraken.com/gitlens/gitlens-release-notes-current/ "See what's new in GitLens ${e}").\nWe've reimagined and rearranged our views for greater focus and productivity, and recommend switching to the new layout — [learn more and tell us what you think](https://github.com/gitkraken/vscode-gitlens/discussions/2721 "Learn more about what's changed")!`,void 0,null,t)===t&&(0,o.P0)(n.Gh.ResetViewsLayout)}async function S(e,t,i,s={title:"Don't Show Again"},...n){if(c.Yd.log(`ShowMessage(${e}, '${t}', ${i}, ${JSON.stringify(s)})`),null!=i&&a.D.get(`advanced.messages.${i}`))return void c.Yd.log(`ShowMessage(${e}, '${t}', ${i}, ${JSON.stringify(s)}) skipped`);let o;switch(null!=i&&null!==s&&n.push(s),e){case"info":o=await r.window.showInformationMessage(t,...n);break;case"warn":o=await r.window.showWarningMessage(t,...n);break;case"error":o=await r.window.showErrorMessage(t,...n)}return null==i||null!==s&&o!==s||(c.Yd.log(`ShowMessage(${e}, '${t}', ${i}, ${JSON.stringify(s)}) don't show again requested`),await function(e){const t={...a.D.get("advanced.messages")};t[e]=!0;for(const[e,i]of Object.entries(t))!0!==i&&delete t[e];return a.D.update("advanced.messages",t,r.ConfigurationTarget.Global)}(i),o!==s)?(c.Yd.log(`ShowMessage(${e}, '${t}', ${i}, ${JSON.stringify(s)}) returned ${null!=o?o.title:o}`),o):void 0}},9616:(e,t,i)=>{function r(){return"object"==typeof navigator&&"userAgent"in navigator?navigator.userAgent:"object"==typeof process&&"version"in process?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}i.r(t),i.d(t,{GitHubApi:()=>GitHubApi});var s=i(5186);function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function o(e){var t,i;return!1!==n(e)&&(void 0===(t=e.constructor)||!1!==n(i=t.prototype)&&!1!==i.hasOwnProperty("isPrototypeOf"))}function a(e,t){const i=Object.assign({},e);return Object.keys(t).forEach((r=>{o(t[r])?r in e?i[r]=a(e[r],t[r]):Object.assign(i,{[r]:t[r]}):Object.assign(i,{[r]:t[r]})})),i}function c(e){for(const t in e)void 0===e[t]&&delete e[t];return e}function l(e,t,i){if("string"==typeof t){let[e,r]=t.split(" ");i=Object.assign(r?{method:e,url:r}:{url:e},i)}else i=Object.assign({},t);var r;i.headers=(r=i.headers)?Object.keys(r).reduce(((e,t)=>(e[t.toLowerCase()]=r[t],e)),{}):{},c(i),c(i.headers);const s=a(e||{},i);return e&&e.mediaType.previews.length&&(s.mediaType.previews=e.mediaType.previews.filter((e=>!s.mediaType.previews.includes(e))).concat(s.mediaType.previews)),s.mediaType.previews=s.mediaType.previews.map((e=>e.replace(/-preview/,""))),s}var h=/\{[^}]+\}/g;function u(e){return e.replace(/^\W+|\W+$/g,"").split(/,/)}function d(e,t){return Object.keys(e).filter((e=>!t.includes(e))).reduce(((t,i)=>(t[i]=e[i],t)),{})}function p(e){return e.split(/(%[0-9A-Fa-f]{2})/g).map((function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e})).join("")}function m(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function g(e,t,i){return t="+"===e||"#"===e?p(t):m(t),i?m(i)+"="+t:t}function f(e){return null!=e}function w(e){return";"===e||"&"===e||"?"===e}function v(e,t){var i=["+","#",".","/",";","?","&"];return e.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,(function(e,r,s){if(r){let e="";const s=[];if(-1!==i.indexOf(r.charAt(0))&&(e=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach((function(i){var r=/([^:\*]*)(?::(\d+)|(\*))?/.exec(i);s.push(function(e,t,i,r){var s=e[i],n=[];if(f(s)&&""!==s)if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)s=s.toString(),r&&"*"!==r&&(s=s.substring(0,parseInt(r,10))),n.push(g(t,s,w(t)?i:""));else if("*"===r)Array.isArray(s)?s.filter(f).forEach((function(e){n.push(g(t,e,w(t)?i:""))})):Object.keys(s).forEach((function(e){f(s[e])&&n.push(g(t,s[e],e))}));else{const e=[];Array.isArray(s)?s.filter(f).forEach((function(i){e.push(g(t,i))})):Object.keys(s).forEach((function(i){f(s[i])&&(e.push(m(i)),e.push(g(t,s[i].toString())))})),w(t)?n.push(m(i)+"="+e.join(",")):0!==e.length&&n.push(e.join(","))}else";"===t?f(s)&&n.push(m(i)):""!==s||"&"!==t&&"?"!==t?""===s&&n.push(""):n.push(m(i)+"=");return n}(t,e,r[1],r[2]||r[3]))})),e&&"+"!==e){var n=",";return"?"===e?n="&":"#"!==e&&(n=e),(0!==s.length?e:"")+s.join(n)}return s.join(",")}return p(s)}))}function y(e){let t,i=e.method.toUpperCase(),r=(e.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),s=Object.assign({},e.headers),n=d(e,["method","baseUrl","url","headers","request","mediaType"]);const o=function(e){const t=e.match(h);return t?t.map(u).reduce(((e,t)=>e.concat(t)),[]):[]}(r);var a;r=(a=r,{expand:v.bind(null,a)}).expand(n),/^http/.test(r)||(r=e.baseUrl+r);const c=d(n,Object.keys(e).filter((e=>o.includes(e))).concat("baseUrl"));if(!/application\/octet-stream/i.test(s.accept)&&(e.mediaType.format&&(s.accept=s.accept.split(/,/).map((t=>t.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${e.mediaType.format}`))).join(",")),e.mediaType.previews.length)){const t=s.accept.match(/[\w-]+(?=-preview)/g)||[];s.accept=t.concat(e.mediaType.previews).map((t=>`application/vnd.github.${t}-preview${e.mediaType.format?`.${e.mediaType.format}`:"+json"}`)).join(",")}return["GET","HEAD"].includes(i)?r=function(e,t){const i=/\?/.test(e)?"&":"?",r=Object.keys(t);return 0===r.length?e:e+i+r.map((e=>"q"===e?"q="+t.q.split("+").map(encodeURIComponent).join("+"):`${e}=${encodeURIComponent(t[e])}`)).join("&")}(r,c):"data"in c?t=c.data:Object.keys(c).length&&(t=c),s["content-type"]||void 0===t||(s["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(i)&&void 0===t&&(t=""),Object.assign({method:i,url:r,headers:s},void 0!==t?{body:t}:null,e.request?{request:e.request}:null)}function b(e,t,i){return y(l(e,t,i))}var C=function e(t,i){const r=l(t,i),s=b.bind(null,r);return Object.assign(s,{DEFAULTS:r,defaults:e.bind(null,r),merge:l.bind(null,r),parse:y})}(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":`octokit-endpoint.js/7.0.6 ${r()}`},mediaType:{format:"",previews:[]}}),A=i(3300),P=i.n(A);class Deprecation extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}var S=i(778),R=i.n(S);const D=R()((e=>console.warn(e))),k=R()((e=>console.warn(e)));class RequestError extends Error{constructor(e,t,i){let r;super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=t,"headers"in i&&void 0!==i.headers&&(r=i.headers),"response"in i&&(this.response=i.response,r=i.response.headers);const s=Object.assign({},i.request);i.request.headers.authorization&&(s.headers=Object.assign({},i.request.headers,{authorization:i.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),s.url=s.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=s,Object.defineProperty(this,"code",{get:()=>(D(new Deprecation("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),t)}),Object.defineProperty(this,"headers",{get:()=>(k(new Deprecation("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),r||{})})}}function _(e){const t=e.request&&e.request.log?e.request.log:console;(o(e.body)||Array.isArray(e.body))&&(e.body=JSON.stringify(e.body));let i,r,s={};return(e.request&&e.request.fetch||globalThis.fetch||P())(e.url,Object.assign({method:e.method,body:e.body,headers:e.headers,redirect:e.redirect,...e.body&&{duplex:"half"}},e.request)).then((async n=>{r=n.url,i=n.status;for(const e of n.headers)s[e[0]]=e[1];if("deprecation"in s){const i=s.link&&s.link.match(/<([^>]+)>; rel="deprecation"/),r=i&&i.pop();t.warn(`[@octokit/request] "${e.method} ${e.url}" is deprecated. It is scheduled to be removed on ${s.sunset}${r?`. See ${r}`:""}`)}if(204!==i&&205!==i){if("HEAD"===e.method){if(i<400)return;throw new RequestError(n.statusText,i,{response:{url:r,status:i,headers:s,data:void 0},request:e})}if(304===i)throw new RequestError("Not modified",i,{response:{url:r,status:i,headers:s,data:await T(n)},request:e});if(i>=400){const t=await T(n),o=new RequestError(function(e){if("string"==typeof e)return e;if("message"in e)return Array.isArray(e.errors)?`${e.message}: ${e.errors.map(JSON.stringify).join(", ")}`:e.message;return`Unknown error: ${JSON.stringify(e)}`}(t),i,{response:{url:r,status:i,headers:s,data:t},request:e});throw o}return T(n)}})).then((e=>({status:i,url:r,headers:s,data:e}))).catch((t=>{if(t instanceof RequestError)throw t;if("AbortError"===t.name)throw t;throw new RequestError(t.message,500,{request:e})}))}async function T(e){const t=e.headers.get("content-type");return/application\/json/.test(t)?e.json():!t||/^text\/|charset=utf-8$/.test(t)?e.text():function(e){return e.arrayBuffer()}(e)}var F=function e(t,i){const r=t.defaults(i);return Object.assign((function(t,i){const s=r.merge(t,i);if(!s.request||!s.request.hook)return _(r.parse(s));const n=(e,t)=>_(r.parse(r.merge(e,t)));return Object.assign(n,{endpoint:r,defaults:e.bind(null,r)}),s.request.hook(n,s)}),{endpoint:r,defaults:e.bind(null,r)})}(C,{headers:{"user-agent":`octokit-request.js/6.2.8 ${r()}`}});var E=class extends Error{constructor(e,t,i){super("Request failed due to following response errors:\n"+i.errors.map((e=>` - ${e.message}`)).join("\n")),this.request=e,this.headers=t,this.response=i,this.name="GraphqlResponseError",this.errors=i.errors,this.data=i.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},$=["method","baseUrl","url","headers","request","query","mediaType"],O=["query","method","url"],x=/\/api\/v3\/?$/;function I(e,t){const i=e.defaults(t);return Object.assign(((e,t)=>function(e,t,i){if(i){if("string"==typeof t&&"query"in i)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const e in i)if(O.includes(e))return Promise.reject(new Error(`[@octokit/graphql] "${e}" cannot be used as variable name`))}const r="string"==typeof t?Object.assign({query:t},i):t,s=Object.keys(r).reduce(((e,t)=>$.includes(t)?(e[t]=r[t],e):(e.variables||(e.variables={}),e.variables[t]=r[t],e)),{}),n=r.baseUrl||e.endpoint.DEFAULTS.baseUrl;return x.test(n)&&(s.url=n.replace(x,"/api/graphql")),e(s).then((e=>{if(e.data.errors){const t={};for(const i of Object.keys(e.headers))t[i]=e.headers[i];throw new E(s,t,e.data)}return e.data.data}))}(i,e,t)),{defaults:I.bind(null,i),endpoint:i.endpoint})}I(F,{headers:{"user-agent":`octokit-graphql.js/5.0.6 ${r()}`},method:"POST",url:"/graphql"});var B=/^v1\./,W=/^ghs_/,L=/^ghu_/;async function M(e){const t=3===e.split(/\./).length,i=B.test(e)||W.test(e),r=L.test(e);return{type:"token",token:e,tokenType:t?"app":i?"installation":r?"user-to-server":"oauth"}}async function U(e,t,i,r){const s=t.endpoint.merge(i,r);return s.headers.authorization=function(e){return 3===e.split(/\./).length?`bearer ${e}`:`token ${e}`}(e),t(s)}var N=function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if("string"!=typeof e)throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(M.bind(null,e),{hook:U.bind(null,e)})},G="4.2.4",H=class{static defaults(e){return class extends(this){constructor(...t){const i=t[0]||{};super("function"!=typeof e?Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null):e(i))}}}static plugin(...e){var t;const i=this.plugins;return(t=class extends(this){}).plugins=i.concat(e.filter((e=>!i.includes(e)))),t}constructor(e={}){const t=new s.Collection,i={baseUrl:F.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:t.bind(null,"request")}),mediaType:{previews:[],format:""}};var n;if(i.headers["user-agent"]=[e.userAgent,`octokit-core.js/${G} ${r()}`].filter(Boolean).join(" "),e.baseUrl&&(i.baseUrl=e.baseUrl),e.previews&&(i.mediaType.previews=e.previews),e.timeZone&&(i.headers["time-zone"]=e.timeZone),this.request=F.defaults(i),this.graphql=(n=this.request,I(n,{method:"POST",url:"/graphql"})).defaults(i),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=t,e.authStrategy){const{authStrategy:i,...r}=e,s=i(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:r},e.auth));t.wrap("request",s.hook),this.auth=s}else if(e.auth){const i=N(e.auth);t.wrap("request",i.hook),this.auth=i}else this.auth=async()=>({type:"unauthenticated"});this.constructor.plugins.forEach((t=>{Object.assign(this,t(this,e))}))}};H.VERSION=G,H.plugins=[];var V=i(9496),q=i(9827),Q=i(429),Y=i(4575),j=i(2380),z=i(4321),K=i(2075),J=i(7925),X=i(2800),Z=i(5148),ee=i(4241),te=i(4336),ie=i(8227),re=i(6004),se=i(6398),ne=i(3620),oe=i(4550),ae=i(3878),ce=Object.defineProperty,le=Object.getOwnPropertyDescriptor,he=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?le(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&ce(t,i,n),n};const ue=Object.freeze({values:[]}),de=Object.freeze({ranges:[]}),pe="\nassignees(first: 10) {\n\tnodes {\n\t\tlogin\n\t\tavatarUrl\n\t\turl\n\t}\n}\nauthor {\n\tlogin\n\tavatarUrl\n\turl\n}\nbaseRefName\nbaseRefOid\nbaseRepository {\n\tname\n\towner {\n\t\tlogin\n\t}\n\turl\n}\nchecksUrl\nisDraft\nisCrossRepository\nisReadByViewer\nheadRefName\nheadRefOid\nheadRepository {\n\tname\n\towner {\n\t\tlogin\n\t}\n\turl\n}\npermalink\nnumber\ntitle\nstate\nadditions\ndeletions\nupdatedAt\nclosedAt\nmergeable\nmergedAt\nmergedBy {\n\tlogin\n}\nrepository {\n\tisFork\n\towner {\n\t\tlogin\n\t}\n}\nreviewDecision\nreviewRequests(first: 10) {\n\tnodes {\n\t\tasCodeOwner\n\t\tid\n\t\trequestedReviewer {\n\t\t\t... on User {\n\t\t\t\tlogin\n\t\t\t\tavatarUrl\n\t\t\t\turl\n\t\t\t}\n\t\t}\n\t}\n}\ntotalCommentsCount\n",me="\n... on Issue {\n\tassignees(first: 100) {\n\t\tnodes {\n\t\t\tlogin\n\t\t\turl\n\t\t\tavatarUrl\n\t\t}\n\t}\n\tauthor {\n\t\tlogin\n\t\tavatarUrl\n\t\turl\n\t}\n\tcomments {\n\t  totalCount\n\t}\n\tnumber\n\ttitle\n\turl\n\tcreatedAt\n\tclosedAt\n\tclosed\n\tupdatedAt\n\tlabels(first: 20) {\n\t\tnodes {\n\t\t\tcolor\n\t\t\tname\n\t\t}\n\t}\n\treactions(content: THUMBS_UP) {\n\t  totalCount\n\t}\n\trepository {\n\t\tname\n\t\towner {\n\t\t\tlogin\n\t\t}\n\t}\n}\n";class GitHubApi{constructor(e){this._onDidReauthenticate=new V.EventEmitter,this._proxyAgent=null,this._enterpriseVersions=new Map,this._octokits=new Map,this._disposable=Z.D.onDidChangeAny((e=>{(Z.D.changedAny(e,["http.proxy","http.proxyStrictSSL"])||Z.D.changed(e,["outputLevel","proxy"]))&&this.resetCaches()}))}get onDidReauthenticate(){return this._onDidReauthenticate.event}dispose(){this._disposable.dispose()}resetCaches(){this._proxyAgent=null,this._octokits.clear(),this._enterpriseVersions.clear()}get proxyAgent(){if(!Q.$L)return null===this._proxyAgent&&(this._proxyAgent=(0,q.Nx)()),this._proxyAgent}async getAccountForCommit(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getAccountForCommit(\n\t$owner: String!\n\t$repo: String!\n\t$ref: GitObjectID!\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(oid: $ref) {\n\t\t\t... on Commit {\n\t\t\t\tauthor {\n\t\t\t\t\tname\n\t\t\t\t\temail\n\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(e,t,a,{...n,owner:i,repo:r,ref:s},o),l=c?.repository?.object?.author;if(null==l)return;return{provider:e,name:l.name??void 0,email:l.email??void 0,avatarUrl:!l.avatarUrl||ge(n)?l.avatarUrl??void 0:l.email&&null!=n?.baseUrl?await this.createEnterpriseAvatarUrl(e,t,n.baseUrl,l.email,n.avatarSize):void 0}}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,o)}}async getAccountForEmail(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getAccountForEmail(\n\t$emailQuery: String!\n\t$avatarSize: Int\n) {\n\tsearch(type: USER, query: $emailQuery, first: 1) {\n\t\tnodes {\n\t\t\t... on User {\n\t\t\t\tname\n\t\t\t\temail\n\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(e,t,a,{...n,owner:i,repo:r,emailQuery:`in:email ${s}`},o),l=c?.search?.nodes?.[0];if(null==l)return;return{provider:e,name:l.name??void 0,email:l.email??void 0,avatarUrl:!l.avatarUrl||ge(n)?l.avatarUrl??void 0:l.email&&null!=n?.baseUrl?await this.createEnterpriseAvatarUrl(e,t,n.baseUrl,l.email,n.avatarSize):void 0}}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,o)}}async getDefaultBranch(e,t,i,r,s){const n=(0,re.UH)();try{const o="query getDefaultBranch(\n\t$owner: String!\n\t$repo: String!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tdefaultBranchRef {\n\t\t\tname\n\t\t}\n\t}\n}",a=await this.graphql(e,t,o,{...s,owner:i,repo:r},n),c=a?.repository?.defaultBranchRef?.name??void 0;if(null==c)return;return{provider:e,name:c}}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,n)}}async getIssueOrPullRequest(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getIssueOrPullRequest(\n\t$owner: String!\n\t$repo: String!\n\t$number: Int!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tissueOrPullRequest(number: $number) {\n\t\t\t__typename\n\t\t\t... on Issue {\n\t\t\t\tcreatedAt\n\t\t\t\tclosed\n\t\t\t\tclosedAt\n\t\t\t\ttitle\n\t\t\t\turl\n\t\t\t}\n\t\t\t... on PullRequest {\n\t\t\t\tcreatedAt\n\t\t\t\tclosed\n\t\t\t\tclosedAt\n\t\t\t\ttitle\n\t\t\t\turl\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(e,t,a,{...n,owner:i,repo:r,number:s},o),l=c?.repository?.issueOrPullRequest;if(null==l)return;return{provider:e,type:l.type,id:String(s),date:new Date(l.createdAt),title:l.title,closed:l.closed,closedDate:null==l.closedAt?void 0:new Date(l.closedAt),url:l.url}}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,o)}}async getPullRequestForBranch(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getPullRequestForBranch(\n\t$owner: String!\n\t$repo: String!\n\t$branch: String!\n\t$limit: Int!\n\t$include: [PullRequestState!]\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tref(qualifiedName: $branch) {\n\t\t\tassociatedPullRequests(first: $limit, orderBy: {field: UPDATED_AT, direction: DESC}, states: $include) {\n\t\t\t\tnodes {\n\t\t\t\t\tauthor {\n\t\t\t\t\t\tlogin\n\t\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t\t\turl\n\t\t\t\t\t}\n\t\t\t\t\tpermalink\n\t\t\t\t\tnumber\n\t\t\t\t\ttitle\n\t\t\t\t\tstate\n\t\t\t\t\tupdatedAt\n\t\t\t\t\tclosedAt\n\t\t\t\t\tmergedAt\n\t\t\t\t\trepository {\n\t\t\t\t\t\tisFork\n\t\t\t\t\t\towner {\n\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(e,t,a,{...n,owner:i,repo:r,branch:`refs/heads/${s}`,limit:10},o),l=c?.repository?.ref?.associatedPullRequests?.nodes?.filter((e=>null!=e&&(!e.repository.isFork||e.repository.owner.login===i)));if(null==l||0===l.length)return;return l.length>1&&l.sort(((e,t)=>(e.repository.owner.login===i?-1:1)-(t.repository.owner.login===i?-1:1)||("OPEN"===e.state?-1:1)-("OPEN"===t.state?-1:1)||new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime())),(0,ae.fromGitHubPullRequest)(l[0],e)}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,o)}}async getPullRequestForCommit(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getPullRequestForCommit(\n\t$owner: String!\n\t$repo: String!\n\t$ref: GitObjectID!\n\t$avatarSize: Int\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(oid: $ref) {\n\t\t\t... on Commit {\n\t\t\t\tassociatedPullRequests(first: 2, orderBy: {field: UPDATED_AT, direction: DESC}) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\tauthor {\n\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\tavatarUrl(size: $avatarSize)\n\t\t\t\t\t\t\turl\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpermalink\n\t\t\t\t\t\tnumber\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tstate\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\tclosedAt\n\t\t\t\t\t\tmergedAt\n\t\t\t\t\t\trepository {\n\t\t\t\t\t\t\tisFork\n\t\t\t\t\t\t\towner {\n\t\t\t\t\t\t\t\tlogin\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(e,t,a,{...n,owner:i,repo:r,ref:s},o),l=c?.repository?.object?.associatedPullRequests?.nodes?.filter((e=>null!=e&&(!e.repository.isFork||e.repository.owner.login===i)));if(null==l||0===l.length)return;return l.length>1&&l.sort(((e,t)=>(e.repository.owner.login===i?-1:1)-(t.repository.owner.login===i?-1:1)||("MERGED"===e.state?-1:1)-("MERGED"===t.state?-1:1)||new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime())),(0,ae.fromGitHubPullRequest)(l[0],e)}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,o)}}async getRepositoryMetadata(e,t,i,r,s){const n=(0,re.UH)();try{const o="query getRepositoryMetadata(\n\t$owner: String!\n\t$repo: String!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\towner {\n\t\t\tlogin\n\t\t}\n\t\tname\n\t\tparent {\n\t\t\towner {\n\t\t\t\tlogin\n\t\t\t}\n\t\t\tname\n\t\t}\n\t}\n}",a=await this.graphql(e,t,o,{...s,owner:i,repo:r},n),c=a?.repository??void 0;if(null==c)return;return{provider:e,owner:c.owner.login,name:c.name,isFork:null!=c.parent,parent:null!=c.parent?{owner:c.parent.owner.login,name:c.parent.name}:void 0}}catch(t){if(t instanceof Y.Ww)return;throw this.handleException(t,e,n)}}async getBlame(e,t,i,r,s){const n=(0,re.UH)();try{const o="query getBlameRanges(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n\t$path: String!\n) {\n\tviewer { name }\n\trepository(owner: $owner, name: $repo) {\n\t\tobject(expression: $ref) {\n\t\t\t...on Commit {\n\t\t\t\tblame(path: $path) {\n\t\t\t\t\tranges {\n\t\t\t\t\t\tstartingLine\n\t\t\t\t\t\tendingLine\n\t\t\t\t\t\tcommit {\n\t\t\t\t\t\t\toid\n\t\t\t\t\t\t\tparents(first: 3) { nodes { oid } }\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t\tadditions\n\t\t\t\t\t\t\tchangedFiles\n\t\t\t\t\t\t\tdeletions\n\t\t\t\t\t\t\tauthor {\n\t\t\t\t\t\t\t\tavatarUrl\n\t\t\t\t\t\t\t\tdate\n\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcommitter {\n\t\t\t\t\t\t\t\tdate\n\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",a=await this.graphql(void 0,e,o,{owner:t,repo:i,ref:r,path:s},n);if(null==a)return de;const c=a.repository?.object?.blame?.ranges;return null==c||0===c.length?{ranges:[],viewer:a.viewer?.name}:{ranges:c,viewer:a.viewer?.name}}catch(e){if(e instanceof Y.Ww)return de;throw this.handleException(e,void 0,n)}}async getBranches(e,t,i,r){const s=(0,re.UH)();try{const n='query getBranches(\n\t$owner: String!\n\t$repo: String!\n\t$branchQuery: String\n\t$cursor: String\n\t$limit: Int = 100\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\trefs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {\n\t\t\tpageInfo {\n\t\t\t\tendCursor\n\t\t\t\thasNextPage\n\t\t\t}\n\t\t\tnodes {\n\t\t\t\tname\n\t\t\t\ttarget {\n\t\t\t\t\toid\n\t\t\t\t\t...on Commit {\n\t\t\t\t\t\tauthoredDate\n\t\t\t\t\t\tcommittedDate\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}',o=await this.graphql(void 0,e,n,{owner:t,repo:i,branchQuery:r?.query,cursor:r?.cursor,limit:Math.min(100,r?.limit??100)},s);if(null==o)return ue;const a=o.repository?.refs;return null==a?ue:{paging:{cursor:a.pageInfo.endCursor,more:a.pageInfo.hasNextPage},values:a.nodes}}catch(e){if(e instanceof Y.Ww)return ue;throw this.handleException(e,void 0,s)}}async getCommit(e,t,i,r){const s=(0,re.UH)();try{const n=await this.request(void 0,e,"GET /repos/{owner}/{repo}/commits/{ref}",{owner:t,repo:i,ref:r},s),o=n?.data;if(null==o)return;const{commit:a}=o;return{oid:o.sha,parents:{nodes:o.parents.map((e=>({oid:e.sha})))},message:a.message,additions:o.stats?.additions,changedFiles:o.files?.length,deletions:o.stats?.deletions,author:{avatarUrl:o.author?.avatar_url??void 0,date:a.author?.date??(new Date).toString(),email:a.author?.email??void 0,name:a.author?.name??""},committer:{date:a.committer?.date??(new Date).toString(),email:a.committer?.email??void 0,name:a.committer?.name??""},files:o.files}}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,s)}}async getCommitForFile(e,t,i,r,s){if((0,z.D3)(r))return this.getCommit(e,t,i,r);const n=await this.getCommits(e,t,i,r,{limit:1,path:s});if(0===n.values.length)return;return{...await this.getCommit(e,t,i,n.values[0].oid)??n.values[0],viewer:n.viewer}}async getCommitBranches(e,t,i,r,s){const n=(0,re.UH)();try{const o='query getCommitBranches(\n\t$owner: String!\n\t$repo: String!\n\t$since: GitTimestamp!\n\t$until: GitTimestamp!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\trefs(first: 20, refPrefix: "refs/heads/") {\n\t\t\tnodes {\n\t\t\t\tname\n\t\t\t\ttarget {\n\t\t\t\t\t... on Commit {\n\t\t\t\t\t\thistory(first: 3, since: $since until: $until) {\n\t\t\t\t\t\t\tnodes { oid }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}',a=await this.graphql(void 0,e,o,{owner:t,repo:i,since:s.toISOString(),until:s.toISOString()},n),c=a?.repository?.refs?.nodes;if(null==c)return[];const l=[];for(const e of c)for(const t of e.target.history.nodes)if(t.oid===r){l.push(e.name);break}return l}catch(e){if(e instanceof Y.Ww)return[];throw this.handleException(e,void 0,n)}}async getCommitCount(e,t,i,r){const s=(0,re.UH)();try{const n="query getCommitCount(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tref(qualifiedName: $ref) {\n\t\t\ttarget {\n\t\t\t\t... on Commit {\n\t\t\t\t\thistory(first: 1) {\n\t\t\t\t\t\ttotalCount\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",o=await this.graphql(void 0,e,n,{owner:t,repo:i,ref:r},s),a=o?.repository?.ref?.target.history.totalCount;return a}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,s)}}async getCommitOnBranch(e,t,i,r,s,n){const o=(0,re.UH)();try{const a="query getCommitOnBranch(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n\t$since: GitTimestamp!\n\t$until: GitTimestamp!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tref(qualifiedName: $ref) {\n\t\t\ttarget {\n\t\t\t\t... on Commit {\n\t\t\t\t\thistory(first: 3, since: $since until: $until) {\n\t\t\t\t\t\tnodes { oid }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",c=await this.graphql(void 0,e,a,{owner:t,repo:i,ref:`refs/heads/${r}`,since:n.toISOString(),until:n.toISOString()},o),l=c?.repository?.ref.target.history.nodes;if(null==l)return[];const h=[];for(const e of l)if(e.oid===s){h.push(r);break}return h}catch(e){if(e instanceof Y.Ww)return[];throw this.handleException(e,void 0,o)}}async getCommits(e,t,i,r,s){const n=(0,re.UH)();if(1===s?.limit&&null==s?.path)return this.getCommitsCoreSingle(e,t,i,r);try{const o="query getCommits(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n\t$path: String\n\t$author: CommitAuthor\n\t$after: String\n\t$before: String\n\t$limit: Int = 100\n\t$since: GitTimestamp\n\t$until: GitTimestamp\n) {\n\tviewer { name }\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(expression: $ref) {\n\t\t\t... on Commit {\n\t\t\t\thistory(first: $limit, author: $author, path: $path, after: $after, before: $before, since: $since, until: $until) {\n\t\t\t\t\tpageInfo {\n\t\t\t\t\t\tstartCursor\n\t\t\t\t\t\tendCursor\n\t\t\t\t\t\thasNextPage\n\t\t\t\t\t\thasPreviousPage\n\t\t\t\t\t}\n\t\t\t\t\tnodes {\n\t\t\t\t\t\t... on Commit {\n\t\t\t\t\t\t\toid\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t\tparents(first: 3) { nodes { oid } }\n\t\t\t\t\t\t\tadditions\n\t\t\t\t\t\t\tchangedFiles\n\t\t\t\t\t\t\tdeletions\n\t\t\t\t\t\t\tauthor {\n\t\t\t\t\t\t\t\tavatarUrl\n\t\t\t\t\t\t\t\tdate\n\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcommitter {\n\t\t\t\t\t\t\t\t date\n\t\t\t\t\t\t\t\t email\n\t\t\t\t\t\t\t\t name\n\t\t\t\t\t\t\t }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}";let a;if(null!=s?.authors)if(1===s.authors.length){const[e]=s.authors;a={id:e.id,emails:e.email?[e.email]:void 0}}else{const e=s.authors.filter((e=>e.email)).map((e=>e.email));a=e.length?{emails:e}:void 0}const c=await this.graphql(void 0,e,o,{owner:t,repo:i,ref:r,after:s?.after,before:s?.before,path:s?.path,author:a,limit:Math.min(100,s?.limit??100),since:"string"==typeof s?.since?s?.since:s?.since?.toISOString(),until:"string"==typeof s?.until?s?.until:s?.until?.toISOString()},n),l=c?.repository?.object?.history;return null==l?ue:{paging:null!=l.pageInfo.endCursor?{cursor:l.pageInfo.endCursor??void 0,more:l.pageInfo.hasNextPage}:void 0,values:l.nodes,viewer:c?.viewer.name}}catch(e){if(e instanceof Y.Ww)return ue;throw this.handleException(e,void 0,n)}}async getCommitsCoreSingle(e,t,i,r){const s=(0,re.UH)();try{const n="query getCommit(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n) {\n\tviewer { name }\n\trepository(name: $repo owner: $owner) {\n\t\tobject(expression: $ref) {\n\t\t\t...on Commit {\n\t\t\t\toid\n\t\t\t\tparents(first: 3) { nodes { oid } }\n\t\t\t\tmessage\n\t\t\t\tadditions\n\t\t\t\tchangedFiles\n\t\t\t\tdeletions\n\t\t\t\tauthor {\n\t\t\t\t\tavatarUrl\n\t\t\t\t\tdate\n\t\t\t\t\temail\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t\tcommitter {\n\t\t\t\t\tdate\n\t\t\t\t\temail\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",o=await this.graphql(void 0,e,n,{owner:t,repo:i,ref:r},s);if(null==o)return ue;const a=o.repository?.object;return null!=a?{values:[a],viewer:o.viewer.name}:ue}catch(e){if(e instanceof Y.Ww)return ue;throw this.handleException(e,void 0,s)}}async getCommitRefs(e,t,i,r,s){const n=(0,re.UH)();try{const o="query getCommitRefs(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n\t$after: String\n\t$before: String\n\t$first: Int\n\t$last: Int\n\t$path: String\n\t$since: GitTimestamp\n\t$until: GitTimestamp\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(expression: $ref) {\n\t\t\t... on Commit {\n\t\t\t\thistory(first: $first, last: $last, path: $path, since: $since, until: $until, after: $after, before: $before) {\n\t\t\t\t\tpageInfo { startCursor, endCursor, hasNextPage, hasPreviousPage }\n\t\t\t\t\ttotalCount\n\t\t\t\t\tnodes { oid }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",a=await this.graphql(void 0,e,o,{owner:t,repo:i,ref:r,path:s?.path,first:s?.first,last:s?.last,after:s?.after,before:s?.before,since:s?.since,until:s?.until},n),c=a?.repository?.object?.history;if(null==c)return;return{pageInfo:c.pageInfo,totalCount:c.totalCount,values:c.nodes}}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,n)}}async getNextCommitRefs(e,t,i,r,s,n){const o=await this.getCommitDate(e,t,i,n);if(null==o)return[];let a=await this.getCommitRefs(e,t,i,r,{path:s,first:1,since:o});if(null==a)return[];const c=`${a.pageInfo.startCursor.split(" ",1)[0]} ${a.totalCount}`;let l;if([,l]=c.split(" ",2),l=Math.min(parseInt(l,10),5),a=await this.getCommitRefs(e,t,i,r,{path:s,last:l,before:c}),null==a)return[];const h=[];for(const{oid:e}of a.values){if(e===n)break;h.push(e)}return h.reverse()}async getCommitDate(e,t,i,r){const s=(0,re.UH)();try{const n="query getCommitDate(\n\t$owner: String!\n\t$repo: String!\n\t$sha: GitObjectID!\n) {\n\trepository(name: $repo, owner: $owner) {\n\t\tobject(oid: $sha) {\n\t\t\t... on Commit { committer { date } }\n\t\t}\n\t}\n}",o=await this.graphql(void 0,e,n,{owner:t,repo:i,sha:r},s),a=o?.repository?.object?.committer.date;return a}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,s)}}async getContributors(e,t,i){const r=(0,re.UH)();try{const s=await this.request(void 0,e,"GET /repos/{owner}/{repo}/contributors",{owner:t,repo:i,per_page:100},r),n=s?.data;return null==n?[]:s.data}catch(e){if(e instanceof Y.Ww)return[];throw this.handleException(e,void 0,r)}}async getDefaultBranchName(e,t,i){const r=(0,re.UH)();try{const s="query getDefaultBranch(\n\t$owner: String!\n\t$repo: String!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tdefaultBranchRef {\n\t\t\tname\n\t\t}\n\t}\n}",n=await this.graphql(void 0,e,s,{owner:t,repo:i},r);if(null==n)return;return n.repository?.defaultBranchRef?.name??void 0}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,r)}}async getCurrentUser(e,t,i){const r=(0,re.UH)();try{const s="query getCurrentUser(\n\t$owner: String!\n\t$repo: String!\n) {\n\tviewer { name, email, login, id }\n\trepository(owner: $owner, name: $repo) { viewerPermission }\n}",n=await this.graphql(void 0,e,s,{owner:t,repo:i},r);if(null==n)return;return{name:n.viewer?.name,email:n.viewer?.email,username:n.viewer?.login,id:n.viewer?.id}}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,r)}}async getRepositoryVisibility(e,t,i){const r=(0,re.UH)();try{const s="query getRepositoryVisibility(\n\t$owner: String!\n\t$repo: String!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tvisibility\n\t}\n}",n=await this.graphql(void 0,e,s,{owner:t,repo:i},r);if(null==n?.repository?.visibility)return;return"PUBLIC"===n.repository.visibility?j.q4.Public:j.q4.Private}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,r)}}async getTags(e,t,i,r){const s=(0,re.UH)();try{const n='query getTags(\n\t$owner: String!\n\t$repo: String!\n\t$tagQuery: String\n\t$cursor: String\n\t$limit: Int = 100\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\trefs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {\n\t\t\tpageInfo {\n\t\t\t\tendCursor\n\t\t\t\thasNextPage\n\t\t\t}\n\t\t\tnodes {\n\t\t\t\tname\n\t\t\t\ttarget {\n\t\t\t\t\toid\n\t\t\t\t\t...on Tag {\n\t\t\t\t\t\tmessage\n\t\t\t\t\t\ttagger { date }\n\t\t\t\t\t\ttarget {\n\t\t\t\t\t...on Commit {\n\t\t\t\t\t\t\t\toid\n\t\t\t\t\t\tauthoredDate\n\t\t\t\t\t\tcommittedDate\n\t\t\t\t\t\tmessage\n\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}',o=await this.graphql(void 0,e,n,{owner:t,repo:i,tagQuery:r?.query,cursor:r?.cursor,limit:Math.min(100,r?.limit??100)},s);if(null==o)return ue;const a=o.repository?.refs;return null==a?ue:{paging:{cursor:a.pageInfo.endCursor,more:a.pageInfo.hasNextPage},values:a.nodes}}catch(e){if(e instanceof Y.Ww)return ue;throw this.handleException(e,void 0,s)}}async resolveReference(e,t,i,r,s){const n=(0,re.UH)();try{if(!s){const s="query resolveReference(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tobject(expression: $ref) {\n\t\t\toid\n\t\t}\n\t}\n}",o=await this.graphql(void 0,e,s,{owner:t,repo:i,ref:r},n);return o?.repository?.object?.oid??void 0}const o="query resolveReference(\n\t$owner: String!\n\t$repo: String!\n\t$ref: String!\n\t$path: String!\n) {\n\trepository(owner: $owner, name: $repo) {\n\t\tobject(expression: $ref) {\n\t\t\t... on Commit {\n\t\t\t\thistory(first: 1, path: $path) {\n\t\t\t\t\tnodes { oid }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}",a=await this.graphql(void 0,e,o,{owner:t,repo:i,ref:r,path:s},n);return a?.repository?.object?.history.nodes?.[0]?.oid??void 0}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,n)}}async searchCommits(e,t,i){const r=(0,re.UH)(),s=Math.min(100,i?.limit??100);let n,o,a;null!=i?.cursor?([n,o,a]=i.cursor.split(" ",3),n=parseInt(n,10),o=parseInt(o,10),a=parseInt(a,10)):(n=1,o=s,a=0);try{const s=await this.request(void 0,e,"GET /search/commits",{q:t,sort:i?.sort,order:i?.order,per_page:o,page:n},r),c=s?.data;if(null==c||0===c.items.length)return;const l=c.items.map((e=>({oid:e.sha,parents:{nodes:e.parents.map((e=>({oid:e.sha})))},message:e.commit.message,author:{avatarUrl:e.author?.avatar_url??void 0,date:e.commit.author?.date??e.commit.author?.date??(new Date).toString(),email:e.author?.email??e.commit.author?.email??void 0,name:e.author?.name??e.commit.author?.name??""},committer:{date:e.commit.committer?.date??e.committer?.date??(new Date).toString(),email:e.committer?.email??e.commit.committer?.email??void 0,name:e.committer?.name??e.commit.committer?.name??""}}))),h=a+c.items.length,u=c.incomplete_results||c.total_count>h;return{pageInfo:{startCursor:`${n} ${o} ${a}`,endCursor:u?`${n+1} ${o} ${h}`:void 0,hasPreviousPage:c.total_count>0&&n>1,hasNextPage:u},totalCount:c.total_count,values:l}}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,r)}}async searchCommitShas(e,t,i){const r=(0,re.UH)(),s=Math.min(100,i?.limit??100);let n,o,a;null!=i?.cursor?([n,o,a]=i.cursor.split(" ",3),n=parseInt(n,10),o=parseInt(o,10),a=parseInt(a,10)):(n=1,o=s,a=0);try{const s=await this.request(void 0,e,"GET /search/commits",{q:t,sort:i?.sort,order:i?.order,per_page:o,page:n},r),c=s?.data;if(null==c||0===c.items.length)return;const l=a+c.items.length,h=c.incomplete_results||c.total_count>l;return{pageInfo:{startCursor:`${n} ${o} ${a}`,endCursor:h?`${n+1} ${o} ${l}`:void 0,hasPreviousPage:c.total_count>0&&n>1,hasNextPage:h},totalCount:c.total_count,values:c.items.map((e=>({sha:e.sha,authorDate:new Date(e.commit.author.date).getTime(),committerDate:new Date(e.commit.committer?.date??e.commit.author.date).getTime()})))}}catch(e){if(e instanceof Y.Ww)return;throw this.handleException(e,void 0,r)}}async getEnterpriseVersion(e,t,i){let r=this._enterpriseVersions.get(t);if(null!=r)return r;if(null===r)return;const s=(0,re.UH)();try{const n=await this.request(e,t,"GET /meta",i,s),o=n?.data?.installed_version;r=o?(0,oe.mL)(o):null}catch(e){r=null}return this._enterpriseVersions.set(t,r),r??void 0}octokit(e,t){let i=this._octokits.get(e);if(null==i){let r;if(Q.$L){let t=function(e,t){if(null!=t.headers){const{"user-agent":e,...i}=t.headers;e&&(t.headers=i)}return(0,q.he)(e,t)};r=H.defaults({auth:`token ${e}`,request:{fetch:t}})}else r=H.defaults({auth:`token ${e}`,request:{agent:this.proxyAgent}});i=new r(t),this._octokits.set(e,i),(te.Yd.logLevel===ie.i.Debug||te.Yd.isDebugging)&&i.hook.wrap("request",(async(e,t)=>{const i=new se.u(`[GITHUB] ${t.method} ${t.url}`,{log:!1});try{return await e(t)}finally{let e;try{if("string"==typeof t.query){const i=/(^[^({\n]+)/.exec(t.query);e=` ${i?.[1].trim()??t.query}`}}catch{}i.stop({message:e})}}))}return i}async graphql(e,t,i,r,s){try{return await(0,q.a_)(e?.getIgnoreSSLErrors()??!1,(()=>this.octokit(t).graphql(i,r)))}catch(i){if(i instanceof E){switch(i.errors?.[0]?.type){case"NOT_FOUND":throw new Y.Ww(i);case"FORBIDDEN":throw new Y._7("github",Y.Jx.Forbidden,i);case"RATE_LIMITED":{let e;const r=i.headers?.["x-ratelimit-reset"];throw null!=r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=void 0)),new Y.yx(i,t,e)}}te.Yd.isDebugging&&V.window.showErrorMessage(`GitHub request failed: ${i.errors?.[0]?.message??i.message}`)}else i instanceof RequestError?this.handleRequestError(e,t,i,s):te.Yd.isDebugging&&V.window.showErrorMessage(`GitHub request failed: ${i.message}`);throw i}}async request(e,t,i,r,s){try{return await(0,q.a_)(e?.getIgnoreSSLErrors()??!1,(()=>this.octokit(t).request(i,r)))}catch(i){throw i instanceof RequestError?this.handleRequestError(e,t,i,s):te.Yd.isDebugging&&V.window.showErrorMessage(`GitHub request failed: ${i.message}`),i}}handleRequestError(e,t,i,r){switch(i.status){case 404:case 410:case 422:throw new Y.Ww(i);case 401:throw new Y._7("github",Y.Jx.Unauthorized,i);case 403:if(i.message.includes("rate limit")){let e;const r=i.response?.headers?.["x-ratelimit-reset"];throw null!=r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=void 0)),new Y.yx(i,t,e)}throw new Y._7("github",Y.Jx.Forbidden,i);case 500:return te.Yd.error(i,r),void(null!=i.response&&(e?.trackRequestException(),(0,J.vF)(`${e?.name??"GitHub"} failed to respond and might be experiencing issues.${e?.custom?"":" Please visit the [GitHub status page](https://githubstatus.com) for more information."}`)));case 502:if(te.Yd.error(i,r),i.message.includes("timeout"))return e?.trackRequestException(),void(0,J.s$)(e?.name??"GitHub");break;default:if(i.status>=400&&i.status<500)throw new Y.Bn(i)}te.Yd.error(i,r),te.Yd.isDebugging&&V.window.showErrorMessage(`GitHub request failed: ${i.response?.errors?.[0]?.message??i.message}`)}handleException(e,t,i){return te.Yd.error(e,i),e instanceof Y._7&&this.showAuthenticationErrorMessage(e,t),e}async showAuthenticationErrorMessage(e,t){if(e.reason===Y.Jx.Unauthorized||e.reason===Y.Jx.Forbidden){const i="Reauthenticate";await V.window.showErrorMessage(`${e.message}. Would you like to try reauthenticating${e.reason===Y.Jx.Forbidden?" to provide additional access":""}?`,i)===i&&(await(t?.reauthenticate()),this._onDidReauthenticate.fire())}else V.window.showErrorMessage(e.message)}async createEnterpriseAvatarUrl(e,t,i,r,s){s=s??16;const n=await this.getEnterpriseVersion(e,t,{baseUrl:i});if((0,oe.L5)(n,">= 3.0.0")){let n;const o=(0,K.at)(r);null!=o&&V.Uri.parse(i).authority===o.authority&&(null!=o.userId?n=`${i}/enterprise/avatars/u/${encodeURIComponent(o.userId)}?s=${s}`:null!=o.login&&(n=`${i}/enterprise/avatars/${encodeURIComponent(o.login)}?s=${s}`)),null==n&&(n=`${i}/enterprise/avatars/u/e?email=${encodeURIComponent(r)}&s=${s}`);const a=await(0,q.a_)(e?.getIgnoreSSLErrors()??!1,(()=>(0,q.he)(n,{method:"GET",headers:{Authorization:`Bearer ${t}`}})));if(a.ok){const e=(0,ne.US)(new Uint8Array(await a.arrayBuffer()));return`data:${a.headers.get("content-type")};base64,${e}`}}return`https://avatars.githubusercontent.com/u/e?email=${encodeURIComponent(r)}&s=${s}`}async searchMyPullRequests(e,t,i){const r=(0,re.UH)();try{let s=function(t,i){return{pullRequest:(0,ae.fromGitHubPullRequestDetailed)(t,e),reasons:i?[i]:[]}};const n=`query searchPullRequests(\n\t$authored: String!\n\t$assigned: String!\n\t$reviewRequested: String!\n\t$mentioned: String!\n) {\n\tauthored: search(first: 100, query: $authored, type: ISSUE) {\n\t\tnodes {\n\t\t\t...on PullRequest {\n\t\t\t\t${pe}\n\t\t\t}\n\t\t}\n\t}\n\tassigned: search(first: 100, query: $assigned, type: ISSUE) {\n\t\tnodes {\n\t\t\t...on PullRequest {\n\t\t\t\t${pe}\n\t\t\t}\n\t\t}\n\t}\n\treviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {\n\t\tnodes {\n\t\t\t...on PullRequest {\n\t\t\t\t${pe}\n\t\t\t}\n\t\t}\n\t}\n\tmentioned: search(first: 100, query: $mentioned, type: ISSUE) {\n\t\tnodes {\n\t\t\t...on PullRequest {\n\t\t\t\t${pe}\n\t\t\t}\n\t\t}\n\t}\n}`;let o=i?.search?.trim()??"";if(i?.user&&(o+=` user:${i.user}`),null!=i?.repos&&i.repos.length>0){const e="  repo:";o+=`${e}${i.repos.join(e)}`}const a="is:pr is:open archived:false",c=await this.graphql(e,t,n,{authored:`${o} ${a} author:@me`.trim(),assigned:`${o} ${a} assignee:@me`.trim(),reviewRequested:`${o} ${a} review-requested:@me`.trim(),mentioned:`${o} ${a} mentions:@me`.trim(),baseUrl:i?.baseUrl},r);if(void 0===c)return[];return fe([...c.assigned.nodes.map((e=>s(e,"assigned"))),...c.reviewRequested.nodes.map((e=>s(e,"review-requested"))),...c.mentioned.nodes.map((e=>s(e,"mentioned"))),...c.authored.nodes.map((e=>s(e,"authored")))],(e=>e.pullRequest.url))}catch(t){throw this.handleException(t,e,r)}}async searchMyIssues(e,t,i){const r=(0,re.UH)(),s=`query searchIssues(\n\t\t\t\t$authored: String!\n\t\t\t\t$assigned: String!\n\t\t\t\t$mentioned: String!\n\t\t\t) {\n\t\t\t\tauthored: search(first: 100, query: $authored, type: ISSUE) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\t${me}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tassigned: search(first: 100, query: $assigned, type: ISSUE) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\t${me}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmentioned: search(first: 100, query: $mentioned, type: ISSUE) {\n\t\t\t\t\tnodes {\n\t\t\t\t\t\t${me}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}`;let n=i?.search?.trim()??"";if(i?.user&&(n+=` user:${i.user}`),null!=i?.repos&&i.repos.length>0){const e="  repo:";n+=`${e}${i.repos.join(e)}`}const o="type:issue is:open archived:false";try{let a=function(t,i){return{issue:(0,ae.fromGitHubIssueDetailed)(t,e),reasons:i?[i]:[]}};const c=await this.graphql(e,t,s,{authored:`${n} ${o} author:@me`.trim(),assigned:`${n} ${o} assignee:@me`.trim(),mentioned:`${n} ${o} mentions:@me`.trim(),baseUrl:i?.baseUrl},r);if(void 0===c)return[];return fe([...c.assigned.nodes.map((e=>a(e,"assigned"))),...c.mentioned.nodes.map((e=>a(e,"mentioned"))),...c.authored.nodes.map((e=>a(e,"authored")))],(e=>e.issue.url))}catch(t){throw this.handleException(t,e,r)}}}function ge(e){return null==e?.baseUrl||"https://api.github.com"===e.baseUrl}function fe(e,t){return(0,X.uw)(e,t,((e,t)=>(0!==t.reasons.length&&e.reasons.push(...t.reasons),e)))}he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getAccountForCommit",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getAccountForEmail",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getDefaultBranch",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getIssueOrPullRequest",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getPullRequestForBranch",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getPullRequestForCommit",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"getRepositoryMetadata",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getBlame",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getBranches",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommit",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommitForFile",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommitBranches",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommitCount",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommitOnBranch",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommits",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCommitRefs",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getNextCommitRefs",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getContributors",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getDefaultBranchName",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getCurrentUser",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getRepositoryVisibility",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getTags",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"resolveReference",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"searchCommits",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"searchCommitShas",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"getEnterpriseVersion",1),he([(0,ee.fF)({args:{0:e=>e.name,1:"<token>"}})],GitHubApi.prototype,"searchMyPullRequests",1),he([(0,ee.fF)({args:{0:"<token>"}})],GitHubApi.prototype,"searchMyIssues",1)},3878:(e,t,i)=>{i.r(t),i.d(t,{fromCommitFileStatus:()=>g,fromGitHubIssueDetailed:()=>m,fromGitHubPullRequest:()=>o,fromGitHubPullRequestDetailed:()=>p,fromGitHubPullRequestMergeableState:()=>u,fromGitHubPullRequestReviewDecision:()=>l,fromGitHubPullRequestState:()=>a,toGitHubPullRequestMergeableState:()=>d,toGitHubPullRequestReviewDecision:()=>h,toGitHubPullRequestState:()=>c});var r=i(7881),s=i(8452),n=i(4092);function o(e,t){return new n.i7(t,{name:e.author.login,avatarUrl:e.author.avatarUrl,url:e.author.url},String(e.number),e.title,e.permalink,a(e.state),new Date(e.updatedAt),null==e.closedAt?void 0:new Date(e.closedAt),null==e.mergedAt?void 0:new Date(e.mergedAt))}function a(e){return"MERGED"===e?n.o0.Merged:"CLOSED"===e?n.o0.Closed:n.o0.Open}function c(e){return e===n.o0.Merged?"MERGED":e===n.o0.Closed?"CLOSED":"OPEN"}function l(e){switch(e){case"APPROVED":return n.pD.Approved;case"CHANGES_REQUESTED":return n.pD.ChangesRequested;case"REVIEW_REQUIRED":return n.pD.ReviewRequired}}function h(e){switch(e){case n.pD.Approved:return"APPROVED";case n.pD.ChangesRequested:return"CHANGES_REQUESTED";case n.pD.ReviewRequired:return"REVIEW_REQUIRED"}}function u(e){switch(e){case"MERGEABLE":return n.Cz.Mergeable;case"CONFLICTING":return n.Cz.Conflicting;case"UNKNOWN":return n.Cz.Unknown}}function d(e){switch(e){case n.Cz.Mergeable:return"MERGEABLE";case n.Cz.Conflicting:return"CONFLICTING";case n.Cz.Unknown:return"UNKNOWN"}}function p(e,t){return new n.i7(t,{name:e.author.login,avatarUrl:e.author.avatarUrl,url:e.author.url},String(e.number),e.title,e.permalink,a(e.state),new Date(e.updatedAt),null==e.closedAt?void 0:new Date(e.closedAt),null==e.mergedAt?void 0:new Date(e.mergedAt),u(e.mergeable),{head:{exists:null!=e.headRepository,owner:e.headRepository?.owner.login,repo:e.baseRepository?.name,sha:e.headRefOid,branch:e.headRefName,url:e.headRepository?.url},base:{exists:null!=e.baseRepository,owner:e.baseRepository?.owner.login,repo:e.baseRepository?.name,sha:e.baseRefOid,branch:e.baseRefName,url:e.baseRepository?.url},isCrossRepository:e.isCrossRepository},e.isDraft,e.additions,e.deletions,e.totalCommentsCount,l(e.reviewDecision),e.reviewRequests.nodes.map((e=>({isCodeOwner:e.asCodeOwner,reviewer:{name:e.requestedReviewer.login,avatarUrl:e.requestedReviewer.avatarUrl,url:e.requestedReviewer.url}}))),e.assignees.nodes.map((e=>({name:e.login,avatarUrl:e.avatarUrl,url:e.url}))))}function m(e,t){return new s.$9({id:t.id,name:t.name,domain:t.domain,icon:t.icon},String(e.number),e.title,e.url,new Date(e.createdAt),e.closed,new Date(e.updatedAt),{name:e.author.login,avatarUrl:e.author.avatarUrl,url:e.author.url},{owner:e.repository.owner.login,repo:e.repository.name},e.assignees.nodes.map((e=>({name:e.name,avatarUrl:e.avatarUrl,url:e.url}))),null==e.closedAt?void 0:new Date(e.closedAt),null==e.labels?.nodes?void 0:e.labels.nodes.map((e=>({color:e.color,name:e.name}))),e.comments?.totalCount,e.reactions?.totalCount)}function g(e){switch(e){case"added":return r.NV.Added;case"changed":case"modified":return r.NV.Modified;case"removed":return r.NV.Deleted;case"renamed":return r.NV.Renamed;case"copied":return r.NV.Copied}}},1848:(e,t,i)=>{i.r(t),i.d(t,{GitLabApi:()=>GitLabApi});var r=i(9496),s=i(9827),n=i(429),o=i(4575),a=i(8452),c=i(4092),l=i(7925),h=i(5148),u=i(4241),d=i(4336),p=i(8227),m=i(6004),g=i(6398),f=i(3620),w=i(6630),v=Object.defineProperty,y=Object.getOwnPropertyDescriptor,b=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?y(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&v(t,i,n),n};class GitLabApi{constructor(e){this._projectIds=new Map,this._proxyAgents=new Map,this._disposable=h.D.onDidChangeAny((e=>{(h.D.changedAny(e,["http.proxy","http.proxyStrictSSL"])||h.D.changed(e,["proxy","remotes"]))&&this.resetCaches()}))}dispose(){this._disposable.dispose()}resetCaches(){this._projectIds.clear(),this._proxyAgents.clear()}getProxyAgent(e){if(n.$L)return;let t=this._proxyAgents.get(e.id);if(void 0===t){const i=e.getIgnoreSSLErrors();t=(0,s.Nx)(!0!==i&&"force"!==i&&void 0),this._proxyAgents.set(e.id,t??null)}return t??void 0}async getAccountForCommit(e,t,i,s,n,a){const c=(0,m.UH)(),l=await this.getProjectId(e,t,i,s,a?.baseUrl);if(l)try{const i=await this.request(e,t,a?.baseUrl,`v4/projects/${l}/repository/commits/${n}?stats=false`,{method:"GET"},c);let s;const o=await this.findUser(e,t,i.author_name,a);for(const e of o)if(e.name===i.author_name||e.publicEmail&&e.publicEmail===i.author_email){if(s=e,"active"===e.state)break}else((0,f.qq)(e.name,i.author_name)||e.publicEmail&&(0,f.qq)(e.publicEmail,i.author_email))&&(s=e);if(null==s)return;return s.avatarUrl&&!/^([a-zA-Z][\w+.-]+):/.test(s.avatarUrl)&&(s.avatarUrl=r.Uri.joinPath(r.Uri.parse(s.webUrl),"..",s.avatarUrl).toString()),{provider:e,name:s.name||void 0,email:i.author_email||void 0,avatarUrl:s.avatarUrl||void 0}}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,c)}}async getAccountForEmail(e,t,i,r,s,n){const a=(0,m.UH)();try{const[i]=await this.findUser(e,t,s,n);if(null==i)return;return{provider:e,name:i.name||void 0,email:i.publicEmail||void 0,avatarUrl:i.avatarUrl||void 0}}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,a)}}async getDefaultBranch(e,t,i,r,s){const n=(0,m.UH)();try{const o="query getDefaultBranch(\n\t$fullPath: ID!\n) {\n\tproject(fullPath: $fullPath) {\n\t\trepository {\n\t\t\trootRef\n\t\t}\n}",a=await this.graphql(e,t,s?.baseUrl,o,{fullPath:`${i}/${r}`},n),c=a?.data?.project?.repository?.rootRef??void 0;if(null==c)return;return{provider:e,name:c}}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,n)}}async getIssueOrPullRequest(e,t,i,r,s,n){const c=(0,m.UH)();try{const o="query getIssueOrMergeRequest(\n\t$fullPath: ID!\n\t$iid: String!\n) {\n\tproject(fullPath: $fullPath) {\n\t\tmergeRequest(iid: $iid) {\n\t\t\tauthor {\n\t\t\t\tname\n\t\t\t\tavatarUrl\n\t\t\t\twebUrl\n\t\t\t}\n\t\t\tiid\n\t\t\ttitle\n\t\t\tdescription\n\t\t\tstate\n\t\t\tcreatedAt\n\t\t\tupdatedAt\n\t\t\tmergedAt\n\t\t\twebUrl\n\t\t}\n\t\tissue(iid: $iid) {\n\t\t\tauthor {\n\t\t\t\tname\n\t\t\t\tavatarUrl\n\t\t\t\twebUrl\n\t\t\t}\n\t\t\tiid\n\t\t\ttitle\n\t\t\tdescription\n\t\t\tstate\n\t\t\tcreatedAt\n\t\t\tupdatedAt\n\t\t\tclosedAt\n\t\t\twebUrl\n\t\t}\n\t}\n}",l=await this.graphql(e,t,n?.baseUrl,o,{fullPath:`${i}/${r}`,iid:String(s)},c);if(null!=l?.data?.project?.issue){const t=l.data.project.issue;return{provider:e,type:a.mX.Issue,id:t.iid,date:new Date(t.createdAt),title:t.title,closed:"closed"===t.state,closedDate:null==t.closedAt?void 0:new Date(t.closedAt),url:t.webUrl}}if(null!=l?.data?.project?.mergeRequest){const t=l.data.project.mergeRequest;return{provider:e,type:a.mX.PullRequest,id:t.iid,date:new Date(t.createdAt),title:t.title,closed:"closed"===t.state,closedDate:"closed"===t.state?new Date(t.updatedAt):void 0,url:t.webUrl}}return}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,c)}}async getPullRequestForBranch(e,t,i,r,s,n){const a=(0,m.UH)();try{const o="\n\t\t\tnodes {\n\t\t\t\tiid\n\t\t\t\tauthor {\n\t\t\t\t\tname\n\t\t\t\t\tavatarUrl\n\t\t\t\t\twebUrl\n\t\t\t\t}\n\t\t\t\ttitle\n\t\t\t\tdescription\n\t\t\t\tstate\n\t\t\t\tcreatedAt\n\t\t\t\tupdatedAt\n\t\t\t\tmergedAt\n\t\t\t\twebUrl\n\t\t\t}",l=`query getMergeRequestForBranch(\n\t$fullPath: ID!\n\t$branches: [String!]\n) {\n\tproject(fullPath: $fullPath) {\n\t\t${null==n?.include?`mergeRequests(sourceBranches: $branches sort: UPDATED_DESC first: 1) {\n\t\t\t${o}\n\t\t}`:""}\n\t\t${n?.include?.includes(w.GitLabMergeRequestState.OPEN)?`opened: mergeRequests(sourceBranches: $branches state: opened sort: UPDATED_DESC first: 1) {\n\t\t\t${o}\n\t\t}`:""}\n\t\t${n?.include?.includes(w.GitLabMergeRequestState.MERGED)?`merged: mergeRequests(sourceBranches: $branches state: merged sort: UPDATED_DESC first: 1) {\n\t\t\t${o}\n\t\t}`:""}\n\t\t${n?.include?.includes(w.GitLabMergeRequestState.CLOSED)?`closed: mergeRequests(sourceBranches: $branches state: closed sort: UPDATED_DESC first: 1) {\n\t\t\t${o}\n\t\t}`:""}\n\t}\n}`,h=await this.graphql(e,t,n?.baseUrl,l,{fullPath:`${i}/${r}`,branches:[s],state:n?.include},a);let u;if(null==n?.include)u=h?.data?.project?.mergeRequests?.nodes?.[0];else for(const e of n.include){let t;e===w.GitLabMergeRequestState.OPEN?t=h?.data?.project?.opened?.nodes?.[0]:e===w.GitLabMergeRequestState.MERGED?t=h?.data?.project?.merged?.nodes?.[0]:e===w.GitLabMergeRequestState.CLOSED&&(t=h?.data?.project?.closed?.nodes?.[0]),null!=t&&(null==u||new Date(t.updatedAt)>new Date(u.updatedAt))&&(u=t)}if(null==u)return;return new c.i7(e,{name:u.author?.name??"Unknown",avatarUrl:u.author?.avatarUrl??"",url:u.author?.webUrl??""},String(u.iid),u.title,u.webUrl,(0,w.fromGitLabMergeRequestState)(u.state),new Date(u.updatedAt),u.state!==w.GitLabMergeRequestState.CLOSED?void 0:new Date(u.updatedAt),null==u.mergedAt?void 0:new Date(u.mergedAt))}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,a)}}async getPullRequestForCommit(e,t,i,r,s,n){const a=(0,m.UH)(),c=await this.getProjectId(e,t,i,r,n?.baseUrl);if(c)try{const i=await this.request(e,t,n?.baseUrl,`v4/projects/${c}/repository/commits/${s}/merge_requests`,{method:"GET"},a);if(null==i||0===i.length)return;return i.length>1&&i.sort(((e,t)=>(e.state===w.GitLabMergeRequestState.OPEN?-1:1)-(t.state===w.GitLabMergeRequestState.OPEN?-1:1)||new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime())),(0,w.fromGitLabMergeRequestREST)(i[0],e)}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,a)}}async getRepositoryMetadata(e,t,i,r,s){const n=(0,m.UH)(),a=await this.getProjectId(e,t,i,r,s?.baseUrl);if(a)try{const i=await this.request(e,t,s?.baseUrl,`v4/projects/${a}`,{method:"GET"},n);if(null==i)return;return{provider:e,owner:i.namespace.full_path,name:i.path,isFork:null!=i.forked_from_project,parent:null!=i.forked_from_project?{owner:i.forked_from_project.namespace.full_path,name:i.forked_from_project.path}:void 0}}catch(t){if(t instanceof o.Ww)return;throw this.handleException(t,e,n)}}async findUser(e,t,i,r){const s=(0,m.UH)();try{const n="query findUser(\n$search: String!\n) {\n\tusers(search: $search) {\n\t\tnodes {\n\t\t\tid\n\t\t\tname\n\t\t\tusername,\n\t\t\tpublicEmail,\n\t\t\tstate\n\t\t\tavatarUrl\n\t\t\twebUrl\n\t\t}\n\t}\n}",o=await this.graphql(e,t,r?.baseUrl,n,{search:i},s),a=o?.data?.users?.nodes;if(null==a||0===a.length)return[];const c=[];for(const e of a){const t=/gid:\/\/gitlab\/User\/([0-9]+)\b/.exec(e.id);null!=t&&c.push({id:parseInt(t[1],10),name:e.name,username:e.username,publicEmail:e.publicEmail||void 0,state:e.state,avatarUrl:e.avatarUrl,webUrl:e.webUrl})}return c}catch(t){return t instanceof o.Ww||this.handleException(t,e,s),[]}}getProjectId(e,t,i,r,s){const n=`${t}|${i}/${r}`;let o=this._projectIds.get(n);return null==o&&(o=this.getProjectIdCore(e,t,i,r,s),this._projectIds.set(n,o)),o}async getProjectIdCore(e,t,i,r,s){const n=(0,m.UH)();try{const o="query getProjectId(\n\t$fullPath: ID!\n) {\n\tproject(fullPath: $fullPath) {\n\t\tid\n\t}\n}",a=await this.graphql(e,t,s,o,{fullPath:`${i}/${r}`},n),c=a?.data?.project?.id;if(null==c)return;const l=/gid:\/\/gitlab\/Project\/([0-9]+)\b/.exec(c);if(null==l)return;const h=l[1];return(0,m.lH)(n,` • projectId=${h}`),h}catch(t){if(t instanceof o.Ww)return;return void this.handleException(t,e,n)}}async graphql(e,t,i,n,a,c){let l;try{const r=d.Yd.logLevel===p.i.Debug||d.Yd.isDebugging?new g.u(`[GITLAB] POST ${i}`,{log:!1}):void 0,c=this.getProxyAgent(e);try{if(l=await(0,s.a_)(e.getIgnoreSSLErrors(),(()=>(0,s.he)(`${i??"https://gitlab.com/api"}/graphql`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},agent:c,body:JSON.stringify({query:n,variables:a})}))),l.ok){const e=await l.json();if("errors"in e)throw new o.Xq("GitLab",l,e.errors);return e}throw new o.Xq("GitLab",l)}finally{const e=/(^[^({\n]+)/.exec(n),t=` ${e?.[1].trim()??n}`;r?.stop({message:t})}}catch(i){throw i instanceof o.Xq?this.handleRequestError(e,t,i,c):d.Yd.isDebugging&&r.window.showErrorMessage(`GitLab request failed: ${i.message}`),i}}async request(e,t,i,n,a,c){const l=`${i??"https://gitlab.com/api"}/${n}`;let h;try{const i=d.Yd.logLevel===p.i.Debug||d.Yd.isDebugging?new g.u(`[GITLAB] ${a?.method??"GET"} ${l}`,{log:!1}):void 0,r=this.getProxyAgent(e);try{if(h=await(0,s.a_)(e.getIgnoreSSLErrors(),(()=>(0,s.he)(l,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},agent:r,...a}))),h.ok){return await h.json()}throw new o.Xq("GitLab",h)}finally{i?.stop()}}catch(i){throw i instanceof o.Xq?this.handleRequestError(e,t,i,c):d.Yd.isDebugging&&r.window.showErrorMessage(`GitLab request failed: ${i.message}`),i}}handleRequestError(e,t,i,s){switch(i.status){case 404:case 410:case 422:throw new o.Ww(i);case 401:throw new o._7("gitlab",o.Jx.Unauthorized,i);case 403:if(i.message.includes("rate limit exceeded")){let e;const r=i.response?.headers?.get("x-ratelimit-reset");throw null!=r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=void 0)),new o.yx(i,t,e)}throw new o._7("gitlab",o.Jx.Forbidden,i);case 500:return d.Yd.error(i,s),void(null!=i.response&&(e?.trackRequestException(),(0,l.vF)(`${e?.name??"GitLab"} failed to respond and might be experiencing issues.${e?.custom?"":" Please visit the [GitLab status page](https://status.gitlab.com) for more information."}`)));case 502:if(d.Yd.error(i,s),i.message.includes("timeout"))return e?.trackRequestException(),void(0,l.s$)(e?.name??"GitLab");break;default:if(i.status>=400&&i.status<500)throw new o.Bn(i)}d.Yd.error(i,s),d.Yd.isDebugging&&r.window.showErrorMessage(`GitLab request failed: ${i.response?.errors?.[0]?.message??i.message}`)}handleException(e,t,i){return d.Yd.error(e,i),e instanceof o._7&&this.showAuthenticationErrorMessage(e,t),e}async showAuthenticationErrorMessage(e,t){if(e.reason===o.Jx.Unauthorized||e.reason===o.Jx.Forbidden){const i="Reauthenticate";await r.window.showErrorMessage(`${e.message}. Would you like to try reauthenticating${e.reason===o.Jx.Forbidden?" to provide additional access":""}?`,i)===i&&await t.reauthenticate()}else r.window.showErrorMessage(e.message)}}b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getAccountForCommit",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getAccountForEmail",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getDefaultBranch",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getIssueOrPullRequest",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getPullRequestForBranch",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getPullRequestForCommit",1),b([(0,u.fF)({args:{0:e=>e.name,1:"<token>"}})],GitLabApi.prototype,"getRepositoryMetadata",1)},6630:(e,t,i)=>{i.r(t),i.d(t,{GitLabMergeRequestState:()=>s,fromGitLabMergeRequestREST:()=>a,fromGitLabMergeRequestState:()=>n,toGitLabMergeRequestState:()=>o});var r=i(4092),s=(e=>(e.OPEN="opened",e.CLOSED="closed",e.MERGED="merged",e.LOCKED="locked",e))(s||{});function n(e){return"merged"===e?r.o0.Merged:"closed"===e||"locked"===e?r.o0.Closed:r.o0.Open}function o(e){return e===r.o0.Merged?"merged":e===r.o0.Closed?"closed":"opened"}function a(e,t){return new r.i7(t,{name:e.author?.name??"Unknown",avatarUrl:e.author?.avatar_url??"",url:e.author?.web_url??""},String(e.iid),e.title,e.web_url,n(e.state),new Date(e.updated_at),null==e.closed_at?void 0:new Date(e.closed_at),null==e.merged_at?void 0:new Date(e.merged_at))}},2215:(e,t,i)=>{i.d(t,{C:()=>a,L:()=>o});var r=i(9496),s=i(5148),n=i(2061);function o(){return(0,n.fw)("gitlens:plus:enabled",s.D.get("plusFeatures.enabled",void 0,!0))}async function a(){if(o())return!0;const e={title:"Enable"};return await r.window.showInformationMessage("Pro features are currently disabled. Would you like to enable them?",{modal:!0},e,{title:"Cancel",isCloseAffordance:!0})===e&&(await s.D.updateEffective("plusFeatures.enabled",!0),!0)}},420:(e,t,i)=>{i.d(t,{AccountWebviewProvider:()=>AccountWebviewProvider});var r=i(9496),s=i(8388),n=i(9529),o=i(9796);const a=new(i(5798).jH)("subscription/didChange");class AccountWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._validateSubscriptionDebounced=void 0,this._disposable=r.Disposable.from(this.container.subscription.onDidChange(this.onSubscriptionChanged,this))}dispose(){this._disposable.dispose()}onSubscriptionChanged(e){this.notifyDidChangeSubscription(e.current)}registerCommands(){return[(0,n.xR)(`${this.host.id}.refresh`,(()=>this.host.refresh(!0)),this)]}includeBootstrap(){return this.getState()}onReloaded(){this.notifyDidChangeSubscription()}onVisibilityChanged(e){e?queueMicrotask((()=>{this.validateSubscription()})):this._validateSubscriptionDebounced?.cancel()}onWindowFocusChanged(e){e&&this.host.visible?queueMicrotask((()=>{this.validateSubscription()})):this._validateSubscriptionDebounced?.cancel()}async getRepoVisibility(){return await this.container.git.visibility()}async getSubscription(e){const t=e??await this.container.subscription.getSubscription(!0);let i;return i=t.account?.email?(0,s.GV)(t.account.email,34).toString():`${this.host.getWebRoot()??""}/media/gitlens-logo.webp`,{subscription:t,avatar:i}}async getState(e){const t=await this.getSubscription(e);return{timestamp:Date.now(),webroot:this.host.getWebRoot(),subscription:t.subscription,avatar:t.avatar}}notifyDidChangeSubscription(e){return r.window.withProgress({location:{viewId:this.host.id}},(async()=>{const t=await this.getSubscription(e);return this.host.notify(a,{...t})}))}async validateSubscription(){null==this._validateSubscriptionDebounced&&(this._validateSubscriptionDebounced=(0,o.Ds)(this.validateSubscriptionCore,1e3)),await this._validateSubscriptionDebounced()}async validateSubscriptionCore(){if(null==this._validating){this._validating=this.container.subscription.validate();try{await this._validating}finally{this._validating=void 0}}}}},1629:(e,t,i)=>{i.d(t,{FocusWebviewProvider:()=>FocusWebviewProvider});var r=i(9496),s=i(5255),n=i(8887),o=i(4155),a=i(8834),c=i(5367),l=i(8452),h=i(4092),u=i(4321),d=i(3646),p=i(2674),m=i(4794),g=i(9529),f=i(2061),w=i(7469),v=i(5798);const y=new v.ke("focus/pr/openWorktree"),b=new v.ke("focus/pr/switchToBranch"),C=new v.jH("focus/didChange",!0);class FocusWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._pullRequests=[],this._issues=[],this._disposable=r.Disposable.from(this.container.subscription.onDidChange(this.onSubscriptionChanged,this),this.container.git.onDidChangeRepositories((()=>{this.host.refresh(!0)})))}dispose(){this._disposable.dispose()}registerCommands(){return[(0,g.xR)(s.Gh.RefreshFocus,(()=>this.host.refresh(!0)))]}onFocusChanged(e){e?setTimeout((()=>{(0,f.v)("gitlens:focus:focused",e)}),0):(0,f.v)("gitlens:focus:focused",e)}onMessageReceived(e){switch(e.method){case b.method:(0,v.mq)(b,e,(e=>this.onSwitchBranch(e)));break;case y.method:(0,v.mq)(y,e,(e=>this.onOpenWorktree(e)))}}findSearchedPullRequest(e){return this._pullRequests?.find((t=>t.pullRequest.id===e.id))}async getRemoteBranch(e){const t=e.pullRequest,i=e.repoAndRemote,s=i.repo.folder.uri,n=await i.repo.getMainRepository();if(null==n)return void r.window.showWarningMessage(`Unable to find main repository(${s.toString()}) for PR #${t.id}`);const a=t.refs.base.owner,c=r.Uri.parse(t.refs.base.url),l=t.refs.head.branch,h=r.Uri.parse(t.refs.head.url),d=h.toString(),[,p,g]=(0,m.Sk)(d);let f,w;if([f]=await n.getRemotes({filter:e=>e.matches(p,g)}),null!=f)w=`${f.name}/${l}`,await this.container.git.fetch(n.path,{remote:f.name});else{const e=await r.window.showInformationMessage(`Unable to find a remote for '${d}'. Would you like to add a new remote?`,{modal:!0},{title:"Yes"},{title:"No",isCloseAffordance:!0});if("Yes"!==e?.title)return;const i=t.refs.head.owner;if(await(0,o.IH)(n,i,d,{confirm:!1,fetch:!0,reveal:!1}),[f]=await n.getRemotes({filter:e=>e.url===d}),null==f)return;w=`${f.name}/${l}`;const s=t.refs.base.repo,u=`pr/${c.toString()===h.toString()?l:w}`;this.container.git.setConfig(n.path,`branch.${u}.github-pr-owner-number`,`${a}#${s}#${t.id}`)}return{remote:f,reference:(0,u.xB)(w,n.path,{refType:"branch",name:w,remote:!0})}}async onSwitchBranch({pullRequest:e}){const t=this.findSearchedPullRequest(e);if(null==t||t.isCurrentBranch)return Promise.resolve();if(null!=t.branch)return a.gu(t.branch.repoPath,t.branch);const i=await this.getRemoteBranch(t);return null==i?Promise.resolve():a.gu(i.remote.repoPath,i.reference)}async onOpenWorktree({pullRequest:e}){const t=this.findSearchedPullRequest(e);if(null==t?.repoAndRemote)return;const i=r.Uri.parse(e.refs.base.url),n=t.repoAndRemote.repo.folder;return(0,g.P0)(s.Gh.OpenOrCreateWorktreeForGHPR,{base:{repositoryCloneUrl:{repositoryName:e.refs.base.repo,owner:e.refs.base.owner,url:i}},githubRepository:{rootUri:n.uri},head:{ref:e.refs.head.branch,sha:e.refs.head.sha,repositoryCloneUrl:{repositoryName:e.refs.head.repo,owner:e.refs.head.owner,url:r.Uri.parse(e.refs.head.url)}},item:{number:parseInt(e.id,10)}})}onSubscriptionChanged(e){e.etag!==this._etagSubscription&&(this._etagSubscription=e.etag,this.notifyDidChangeState(!0))}async getState(e){const t=await this.container.git.access(n.x.Focus);if(!0!==t.allowed)return{timestamp:Date.now(),access:t};const i=await this.getRichRepos(),r=i.filter((e=>e.isGitHub));const s=function(e){return e.filter((e=>e.isConnected&&e.isGitHub))}(r);if(!(s.length>0))return{timestamp:Date.now(),access:t,repos:r.map((e=>A(e)))};const o=s.map((e=>A(e))),a=Promise.allSettled([this.getMyPullRequests(s),this.getMyIssues(s)]);async function c(){const[e,i]=await a;return{timestamp:Date.now(),access:t,repos:o,pullRequests:(0,w.Sb)(e)?.map((e=>({pullRequest:(0,h.l1)(e.pullRequest),reasons:e.reasons,isCurrentBranch:e.isCurrentBranch??!1,isCurrentWorktree:e.isCurrentWorktree??!1,hasWorktree:e.hasWorktree??!1,hasLocalBranch:e.hasLocalBranch??!1}))),issues:(0,w.Sb)(i)?.map((e=>({issue:(0,l.y$)(e.issue),reasons:e.reasons})))}}if(e)return queueMicrotask((async()=>{const e=await c();this.host.notify(C,{state:e})})),{timestamp:Date.now(),access:t,repos:o};return await c()}async includeBootstrap(){return this.getState(!0)}async getRichRepos(e){if(null==this._repos||!0===e){const e=[],t=[];for(const i of this.container.git.openRepositories){const r=await i.getRichRemote();null==r||e.findIndex((e=>e.remote===r))>-1||(t.push(i.onDidChange(this.onRepositoryChanged,this)),e.push({repo:i,remote:r,isConnected:await r.provider.isConnected(),isGitHub:"github"===r.provider.id}))}this._repositoryEventsDisposable&&(this._repositoryEventsDisposable.dispose(),this._repositoryEventsDisposable=void 0),this._repositoryEventsDisposable=r.Disposable.from(...t),this._repos=e}return this._repos}async onRepositoryChanged(e){e.changed(d.I6.RemoteProviders,d.du.Any)&&(await this.getRichRepos(!0),this.notifyDidChangeState())}async getMyPullRequests(e){const t=[];for(const i of e){const e=(await i.repo.getRemotes()).map((e=>e.name)),r=i.remote,s=await this.container.git.getMyPullRequests(r);if(null!=s)for(const r of s){if(0===r.reasons.length)continue;const s={...r,repoAndRemote:i,isCurrentWorktree:!1,isCurrentBranch:!1},n=e.map((e=>`${e}/${s.pullRequest.refs.head.branch}`)),o=await(0,p.K)(s.repoAndRemote.repo,s.pullRequest.refs.head.branch,n);s.hasWorktree=null!=o,s.isCurrentWorktree=!0===o?.opened;const a=await(0,c.fb)(i.repo,s.pullRequest.refs.head.branch,n);a&&(s.branch=a,s.hasLocalBranch=!0,s.isCurrentBranch=a.current),t.push(s)}}function i(e){let t=0;return e.reasons.includes("authored")?t+=1e3:e.reasons.includes("assigned")?t+=900:e.reasons.includes("review-requested")?t+=800:e.reasons.includes("mentioned")&&(t+=700),e.pullRequest.reviewDecision===h.pD.Approved?e.pullRequest.mergeableState===h.Cz.Mergeable?t+=100:e.pullRequest.mergeableState===h.Cz.Conflicting?t+=90:t+=80:e.pullRequest.reviewDecision===h.pD.ChangesRequested&&(t+=70),t}return this._pullRequests=t.sort(((e,t)=>{const r=i(e),s=i(t);return r===s?e.pullRequest.date.getTime()-t.pullRequest.date.getTime():(s??0)-(r??0)})),this._pullRequests}async getMyIssues(e){const t=[];for(const{remote:i}of e){const e=await this.container.git.getMyIssues(i);null!=e&&t.push(...e.filter((e=>e.reasons.length>0)))}return this._issues=t.sort(((e,t)=>t.issue.updatedDate.getTime()-e.issue.updatedDate.getTime())),this._issues}async notifyDidChangeState(e){this.host.notify(C,{state:await this.getState(e)})}}function A(e){return{repo:e.repo.path,isGitHub:e.isGitHub,isConnected:e.isConnected}}},1302:(e,t,i)=>{i.d(t,{GraphWebviewProvider:()=>GraphWebviewProvider});var r=i(9496),s=i(8388),n=i(7139),o=i(5255),a=i(8887),c=i(3401),l=i(6897),h=i(7445),u=i(8834),d=i(252),p=i(6713),m=i(5025),g=i(6592),f=i(5367),w=i(439),v=i(1719),y=i(5069),b=i(4321),C=i(3050),A=i(6503),P=i(3646),S=i(6934),R=i(635),D=i(9529),k=i(5148),_=i(2061),T=i(5432),F=i(4241),E=i(9796),$=i(3105),O=i(9967),x=i(7469),I=i(2509),B=i(9701),W=i(6922),L=i(5798),M=i(1753),U=(e=>(e.Upstream="upstream",e.PullRequest="pullRequest",e))(U||{});const N=Object.values(U),G=new L.ke("graph/chooseRepository"),H=new L.ke("graph/dimMergeCommits"),V=new L.ke("graph/dblclick"),q=new L.ke("graph/rows/ensure"),Q=new L.ke("graph/avatars/get"),Y=new L.ke("graph/refs/metadata/get"),j=new L.ke("graph/rows/get"),z=new L.ke("graph/search"),K=new L.ke("graph/search/openInView"),J=new L.ke("graph/columns/update"),X=new L.ke("graph/refs/update/visibility"),Z=new L.ke("graph/fitlers/update/excludeType"),ee=new L.ke("graph/configuration/update"),te=new L.ke("graph/fitlers/update/includeOnlyRefs"),ie=new L.ke("graph/selection/update"),re=new L.jH("graph/didChange",!0),se=new L.jH("graph/configuration/didChange"),ne=new L.jH("graph/subscription/didChange"),oe=new L.jH("graph/avatars/didChange"),ae=new L.jH("graph/refs/didChangeMetadata"),ce=new L.jH("graph/columns/didChange"),le=new L.jH("graph/scrollMarkers/didChange"),he=new L.jH("graph/focus/didChange"),ue=new L.jH("graph/window/focus/didChange"),de=new L.jH("graph/refs/didChangeVisibility"),pe=new L.jH("graph/rows/didChange"),me=new L.jH("graph/rows/stats/didChange"),ge=new L.jH("graph/selection/didChange"),fe=new L.jH("graph/workingTree/didChange"),we=new L.jH("graph/rows/didEnsure"),ve=new L.jH("graph/didSearch"),ye=new L.jH("graph/didFetch");var be=Object.defineProperty,Ce=Object.getOwnPropertyDescriptor,Ae=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?Ce(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&be(t,i,n),n};const Pe={ref:{width:130,isHidden:!1,order:0},graph:{width:150,mode:void 0,isHidden:!1,order:1},message:{width:300,isHidden:!1,order:2},author:{width:130,isHidden:!1,order:3},changes:{width:200,isHidden:!1,order:4},datetime:{width:130,isHidden:!1,order:5},sha:{width:130,isHidden:!1,order:6}},Se={ref:{width:32,isHidden:!1},graph:{width:150,mode:"compact",isHidden:!1},author:{width:32,isHidden:!1,order:2},message:{width:500,isHidden:!1,order:3},changes:{width:200,isHidden:!1,order:4},datetime:{width:130,isHidden:!0,order:5},sha:{width:130,isHidden:!1,order:6}};class GraphWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._firstSelection=!0,this._ipcNotificationMap=new Map([[ce,this.notifyDidChangeColumns],[se,this.notifyDidChangeConfiguration],[re,this.notifyDidChangeState],[de,this.notifyDidChangeRefsVisibility],[le,this.notifyDidChangeScrollMarkers],[ge,this.notifyDidChangeSelection],[ne,this.notifyDidChangeSubscription],[fe,this.notifyDidChangeWorkingTree],[ue,this.notifyDidChangeWindowFocus],[ye,this.notifyDidFetch]]),this.isWindowFocused=!0,this._showActiveSelectionDetailsDebounced=void 0,this._fireSelectionChangedDebounced=void 0,this._notifyDidChangeStateDebounced=void 0,this._notifyDidChangeAvatarsDebounced=void 0,this._notifyDidChangeRefsMetadataDebounced=void 0,this._showDetailsView=k.D.get("graph.showDetailsView"),this._theme=r.window.activeColorTheme,this.ensureRepositorySubscriptions(),this.host.isView()&&(this.host.description="✨"),this._disposable=r.Disposable.from(k.D.onDidChange(this.onConfigurationChanged,this),this.container.subscription.onDidChange(this.onSubscriptionChanged,this),this.container.git.onDidChangeRepositories((()=>{this.host.refresh(!0)})),r.window.onDidChangeActiveColorTheme(this.onThemeChanged,this),{dispose:()=>{null!=this._repositoryEventsDisposable&&(this._repositoryEventsDisposable.dispose(),this._repositoryEventsDisposable=void 0)}})}get repository(){return this._repository}set repository(e){this._repository!==e?(this._repository=e,this.resetRepositoryState(),this.ensureRepositorySubscriptions(!0),this.host.ready&&this.updateState()):this.ensureRepositorySubscriptions()}get activeSelection(){return this._selection?.[0]}dispose(){this._disposable.dispose()}async onShowing(e,t,...i){this._firstSelection=!0;const[r]=i;if((0,P.uC)(r))this.repository=r;else if(null!=(s=r)&&"object"==typeof s&&"ref"in s&&(0,b.Yn)(s.ref)){this.repository=this.container.git.getRepository(r.ref.repoPath);let e=r.ref.ref;if((0,b.D3)(e)||(e=await this.container.git.resolveReference(r.ref.repoPath,e,void 0,{force:!0})),this.setSelectedRows(e),null!=this._graph){if(this._graph?.ids.has(e))return this.notifyDidChangeSelection(),!0;this.onGetMoreRows({id:e},!0)}}else if((0,M.W)(r)&&null!=r.state.selectedRepository&&(this.repository=this.container.git.getRepository(r.state.selectedRepository)),null==this.repository&&this.container.git.repositoryCount>1){const[t]=(0,n.P)(o.Gh.ShowGraph,void 0,...i),r=Array.isArray(t)?t[0]:t;"scm"===r.type&&null!=r.scm.rootUri?this.repository=this.container.git.getRepository(r.scm.rootUri):"viewItem"===r.type&&r.node instanceof W.vb&&(this.repository=r.node.repo),null!=this.repository&&!e&&this.host.ready&&this.updateState()}var s;return!0}onRefresh(e){e&&this.resetRepositoryState()}includeBootstrap(){return this.getState(!0)}registerCommands(){return[(0,D.xR)(o.Gh.RefreshGraph,(()=>this.host.refresh(!0))),(0,D.xR)("gitlens.graph.push",this.push,this),(0,D.xR)("gitlens.graph.pull",this.pull,this),(0,D.xR)("gitlens.graph.fetch",this.fetch,this),(0,D.xR)("gitlens.graph.publishBranch",this.publishBranch,this),(0,D.xR)("gitlens.graph.switchToAnotherBranch",this.switchToAnother,this),(0,D.xR)("gitlens.graph.createBranch",this.createBranch,this),(0,D.xR)("gitlens.graph.deleteBranch",this.deleteBranch,this),(0,D.xR)("gitlens.graph.copyRemoteBranchUrl",(e=>this.openBranchOnRemote(e,!0)),this),(0,D.xR)("gitlens.graph.openBranchOnRemote",this.openBranchOnRemote,this),(0,D.xR)("gitlens.graph.mergeBranchInto",this.mergeBranchInto,this),(0,D.xR)("gitlens.graph.rebaseOntoBranch",this.rebase,this),(0,D.xR)("gitlens.graph.rebaseOntoUpstream",this.rebaseToRemote,this),(0,D.xR)("gitlens.graph.renameBranch",this.renameBranch,this),(0,D.xR)("gitlens.graph.switchToBranch",this.switchTo,this),(0,D.xR)("gitlens.graph.hideLocalBranch",this.hideRef,this),(0,D.xR)("gitlens.graph.hideRemoteBranch",this.hideRef,this),(0,D.xR)("gitlens.graph.hideRemote",(e=>this.hideRef(e,{remote:!0})),this),(0,D.xR)("gitlens.graph.hideRefGroup",(e=>this.hideRef(e,{group:!0})),this),(0,D.xR)("gitlens.graph.hideTag",this.hideRef,this),(0,D.xR)("gitlens.graph.cherryPick",this.cherryPick,this),(0,D.xR)("gitlens.graph.copyRemoteCommitUrl",(e=>this.openCommitOnRemote(e,!0)),this),(0,D.xR)("gitlens.graph.showInDetailsView",this.openInDetailsView,this),(0,D.xR)("gitlens.graph.openCommitOnRemote",this.openCommitOnRemote,this),(0,D.xR)("gitlens.graph.openSCM",this.openSCM,this),(0,D.xR)("gitlens.graph.rebaseOntoCommit",this.rebase,this),(0,D.xR)("gitlens.graph.resetCommit",this.resetCommit,this),(0,D.xR)("gitlens.graph.resetToCommit",this.resetToCommit,this),(0,D.xR)("gitlens.graph.revert",this.revertCommit,this),(0,D.xR)("gitlens.graph.switchToCommit",this.switchTo,this),(0,D.xR)("gitlens.graph.undoCommit",this.undoCommit,this),(0,D.xR)("gitlens.graph.saveStash",this.saveStash,this),(0,D.xR)("gitlens.graph.applyStash",this.applyStash,this),(0,D.xR)("gitlens.graph.stash.delete",this.deleteStash,this),(0,D.xR)("gitlens.graph.stash.rename",this.renameStash,this),(0,D.xR)("gitlens.graph.createTag",this.createTag,this),(0,D.xR)("gitlens.graph.deleteTag",this.deleteTag,this),(0,D.xR)("gitlens.graph.switchToTag",this.switchTo,this),(0,D.xR)("gitlens.graph.createWorktree",this.createWorktree,this),(0,D.xR)("gitlens.graph.createPullRequest",this.createPullRequest,this),(0,D.xR)("gitlens.graph.openPullRequestOnRemote",this.openPullRequestOnRemote,this),(0,D.xR)("gitlens.graph.compareWithUpstream",this.compareWithUpstream,this),(0,D.xR)("gitlens.graph.compareWithHead",this.compareHeadWith,this),(0,D.xR)("gitlens.graph.compareWithWorking",this.compareWorkingWith,this),(0,D.xR)("gitlens.graph.compareAncestryWithWorking",this.compareAncestryWithWorking,this),(0,D.xR)("gitlens.graph.copy",this.copy,this),(0,D.xR)("gitlens.graph.copyMessage",this.copyMessage,this),(0,D.xR)("gitlens.graph.copySha",this.copySha,this),(0,D.xR)("gitlens.graph.addAuthor",this.addAuthor,this),(0,D.xR)("gitlens.graph.columnAuthorOn",(()=>this.toggleColumn("author",!0))),(0,D.xR)("gitlens.graph.columnAuthorOff",(()=>this.toggleColumn("author",!1))),(0,D.xR)("gitlens.graph.columnDateTimeOn",(()=>this.toggleColumn("datetime",!0))),(0,D.xR)("gitlens.graph.columnDateTimeOff",(()=>this.toggleColumn("datetime",!1))),(0,D.xR)("gitlens.graph.columnShaOn",(()=>this.toggleColumn("sha",!0))),(0,D.xR)("gitlens.graph.columnShaOff",(()=>this.toggleColumn("sha",!1))),(0,D.xR)("gitlens.graph.columnChangesOn",(()=>this.toggleColumn("changes",!0))),(0,D.xR)("gitlens.graph.columnChangesOff",(()=>this.toggleColumn("changes",!1))),(0,D.xR)("gitlens.graph.columnGraphOn",(()=>this.toggleColumn("graph",!0))),(0,D.xR)("gitlens.graph.columnGraphOff",(()=>this.toggleColumn("graph",!1))),(0,D.xR)("gitlens.graph.columnMessageOn",(()=>this.toggleColumn("message",!0))),(0,D.xR)("gitlens.graph.columnMessageOff",(()=>this.toggleColumn("message",!1))),(0,D.xR)("gitlens.graph.columnRefOn",(()=>this.toggleColumn("ref",!0))),(0,D.xR)("gitlens.graph.columnRefOff",(()=>this.toggleColumn("ref",!1))),(0,D.xR)("gitlens.graph.columnGraphCompact",(()=>this.setColumnMode("graph","compact"))),(0,D.xR)("gitlens.graph.columnGraphDefault",(()=>this.setColumnMode("graph",void 0))),(0,D.xR)("gitlens.graph.scrollMarkerLocalBranchOn",(()=>this.toggleScrollMarker("localBranches",!0))),(0,D.xR)("gitlens.graph.scrollMarkerLocalBranchOff",(()=>this.toggleScrollMarker("localBranches",!1))),(0,D.xR)("gitlens.graph.scrollMarkerRemoteBranchOn",(()=>this.toggleScrollMarker("remoteBranches",!0))),(0,D.xR)("gitlens.graph.scrollMarkerRemoteBranchOff",(()=>this.toggleScrollMarker("remoteBranches",!1))),(0,D.xR)("gitlens.graph.scrollMarkerStashOn",(()=>this.toggleScrollMarker("stashes",!0))),(0,D.xR)("gitlens.graph.scrollMarkerStashOff",(()=>this.toggleScrollMarker("stashes",!1))),(0,D.xR)("gitlens.graph.scrollMarkerTagOn",(()=>this.toggleScrollMarker("tags",!0))),(0,D.xR)("gitlens.graph.scrollMarkerTagOff",(()=>this.toggleScrollMarker("tags",!1))),(0,D.xR)("gitlens.graph.copyDeepLinkToBranch",this.copyDeepLinkToBranch,this),(0,D.xR)("gitlens.graph.copyDeepLinkToCommit",this.copyDeepLinkToCommit,this),(0,D.xR)("gitlens.graph.copyDeepLinkToRepo",this.copyDeepLinkToRepo,this),(0,D.xR)("gitlens.graph.copyDeepLinkToTag",this.copyDeepLinkToTag,this),(0,D.xR)("gitlens.graph.openChangedFiles",this.openFiles,this),(0,D.xR)("gitlens.graph.openChangedFileDiffs",this.openAllChanges,this),(0,D.xR)("gitlens.graph.openChangedFileDiffsWithWorking",this.openAllChangesWithWorking,this),(0,D.xR)("gitlens.graph.openChangedFileRevisions",this.openRevisions,this),(0,D.xR)("gitlens.graph.resetColumnsDefault",(()=>this.updateColumns(Pe)),this),(0,D.xR)("gitlens.graph.resetColumnsCompact",(()=>this.updateColumns(Se)),this)]}onWindowFocusChanged(e){this.isWindowFocused=e,this.notifyDidChangeWindowFocus()}onFocusChanged(e){this.notifyDidChangeFocus(e),e&&null!=this.activeSelection&&this.container.commitDetailsView.visible?this.showActiveSelectionDetails():this._showActiveSelectionDetailsDebounced?.cancel()}onVisibilityChanged(e){if(e||this._showActiveSelectionDetailsDebounced?.cancel(),e&&(null!=this.repository&&this.repository.etag!==this._etagRepository||this.container.subscription.etag!==this._etagSubscription))this.updateState(!0);else if(e){this.host.ready&&this.host.sendPendingIpcNotifications();const{activeSelection:e}=this;if(null==e)return;this.showActiveSelectionDetails()}}onMessageReceived(e){switch(e.method){case G.method:(0,L.mq)(G,e,(()=>this.onChooseRepository()));break;case H.method:(0,L.mq)(H,e,(e=>this.dimMergeCommits(e)));break;case V.method:(0,L.mq)(V,e,(e=>this.onDoubleClick(e)));break;case q.method:(0,L.mq)(q,e,(t=>this.onEnsureRow(t,e.completionId)));break;case Q.method:(0,L.mq)(Q,e,(e=>this.onGetMissingAvatars(e)));break;case Y.method:(0,L.mq)(Y,e,(e=>this.onGetMissingRefMetadata(e)));break;case j.method:(0,L.mq)(j,e,(e=>this.onGetMoreRows(e)));break;case z.method:(0,L.mq)(z,e,(t=>this.onSearch(t,e.completionId)));break;case K.method:(0,L.mq)(K,e,(e=>this.onSearchOpenInView(e)));break;case J.method:(0,L.mq)(J,e,(e=>this.onColumnsChanged(e)));break;case ee.method:(0,L.mq)(ee,e,(e=>this.updateGraphConfig(e)));break;case X.method:(0,L.mq)(X,e,(e=>this.onRefsVisibilityChanged(e)));break;case ie.method:(0,L.mq)(ie,e,this.onSelectionChanged.bind(this));break;case Z.method:(0,L.mq)(Z,e,(e=>this.updateExcludedType(this._graph,e)));break;case te.method:(0,L.mq)(te,e,(e=>this.updateIncludeOnlyRefs(this._graph,e.refs)))}}updateGraphConfig(e){const t=this.getComponentConfig();let i;for(i in e.changes)if(t[i]!==e.changes[i])switch(i){case"minimap":k.D.updateEffective("graph.minimap.enabled",e.changes[i]);break;case"minimapDataType":k.D.updateEffective("graph.minimap.dataType",e.changes[i]);break;case"minimapMarkerTypes":{const t=[],r=e.changes[i]??[];for(const e of r)switch(e){case"localBranches":case"remoteBranches":case"stashes":case"tags":t.push(e)}k.D.updateEffective("graph.minimap.additionalTypes",t);break}}}showActiveSelectionDetails(){null==this._showActiveSelectionDetailsDebounced&&(this._showActiveSelectionDetailsDebounced=(0,E.Ds)(this.showActiveSelectionDetailsCore.bind(this),250)),this._showActiveSelectionDetailsDebounced()}showActiveSelectionDetailsCore(){const{activeSelection:e}=this;null!=e&&this.container.events.fire("commit:selected",{commit:e,interaction:"passive",preserveFocus:!0,preserveVisibility:!1===this._showDetailsView},{source:this.host.id})}onConfigurationChanged(e){k.D.changed(e,"graph.showDetailsView")&&(this._showDetailsView=k.D.get("graph.showDetailsView")),k.D.changed(e,"graph.commitOrdering")?this.updateState():(k.D.changed(e,"defaultDateFormat")||k.D.changed(e,"defaultDateStyle")||k.D.changed(e,"advanced.abbreviatedShaLength")||k.D.changed(e,"graph.avatars")||k.D.changed(e,"graph.dateFormat")||k.D.changed(e,"graph.dateStyle")||k.D.changed(e,"graph.dimMergeCommits")||k.D.changed(e,"graph.highlightRowsOnRefHover")||k.D.changed(e,"graph.scrollRowPadding")||k.D.changed(e,"graph.scrollMarkers.enabled")||k.D.changed(e,"graph.scrollMarkers.additionalTypes")||k.D.changed(e,"graph.showGhostRefsOnRowHover")||k.D.changed(e,"graph.pullRequests.enabled")||k.D.changed(e,"graph.showRemoteNames")||k.D.changed(e,"graph.showUpstreamStatus")||k.D.changed(e,"graph.minimap.enabled")||k.D.changed(e,"graph.minimap.dataType")||k.D.changed(e,"graph.minimap.additionalTypes"))&&(this.notifyDidChangeConfiguration(),(k.D.changed(e,"graph.minimap.enabled")||k.D.changed(e,"graph.minimap.dataType"))&&k.D.get("graph.minimap.enabled")&&"lines"===k.D.get("graph.minimap.dataType")&&!this._graph?.includes?.stats&&this.updateState())}onRepositoryChanged(e){e.changed(P.I6.Config,P.I6.Head,P.I6.Heads,P.I6.Remotes,P.I6.Stash,P.I6.Status,P.I6.Tags,P.I6.Unknown,P.du.Any)?(e.changed(P.I6.Head,P.du.Any)&&this.setSelectedRows(void 0),this.updateState(!e.changed(P.I6.Unknown,P.du.Exclusive))):this._etagRepository=e.repository.etag}onRepositoryFileSystemChanged(e){e.repository?.path===this.repository?.path&&this.notifyDidChangeWorkingTree()}onSubscriptionChanged(e){e.etag!==this._etagSubscription&&(this._etagSubscription=e.etag,this.notifyDidChangeSubscription())}onThemeChanged(e){null!=this._theme&&((0,I.$o)(e)&&(0,I.$o)(this._theme)||(0,I.GC)(e)&&(0,I.GC)(this._theme))||(this._theme=e,this.updateState())}dimMergeCommits(e){k.D.updateEffective("graph.dimMergeCommits",e.dim)}onColumnsChanged(e){this.updateColumns(e.config)}onRefsVisibilityChanged(e){this.updateExcludedRefs(this._graph,e.refs,e.visible)}onDoubleClick(e){if("ref"===e.type&&e.ref.context){let t=this.getGraphItemContext(e.ref.context);if(_e(t)){if(null!=e.metadata){if(t=this.getGraphItemContext(e.metadata.data.context),"upstream"===e.metadata.type&&ke(t,"upstreamStatus")){const{ahead:e,behind:i,ref:r}=t.webviewItemValue;if(i>0)return void u.X4(r.repoPath,r);if(e>0)return void u.VF(r.repoPath,!1,r)}else if("pullRequest"===e.metadata.type&&ke(t,"pullrequest"))return void this.openPullRequestOnRemote(t);return}const{ref:i}=t.webviewItemValue;return"head"===e.ref.refType&&e.ref.isCurrentHead?u.gu(i.repoPath):u.gu(i.repoPath,i,!!k.D.isUnset("gitCommands.skipConfirmations")||void 0)}}else if("row"===e.type&&e.row){const t=this.getRevisionReference(this.repository?.path,e.row.id,e.row.type);if(null!=t){this.container.events.fire("commit:selected",{commit:t,interaction:"active",preserveFocus:e.preserveFocus,preserveVisibility:!1},{source:this.host.id});const i="panel"===k.D.get("graph.layout")?this.container.graphDetailsView:this.container.commitDetailsView;i.ready||i.show({preserveFocus:e.preserveFocus},{commit:t,interaction:"active",preserveVisibility:!1})}}return Promise.resolve()}async onEnsureRow(e,t){if(null==this._graph)return;const i=this._graph.remappedIds?.get(e.id)??e.id;let r,s;this._graph.ids.has(i)?(r=e.id,s=e.id!==i?i:void 0):(await this.updateGraphWithMoreRows(this._graph,i,this._search),this.notifyDidChangeRows(),this._graph.ids.has(i)&&(r=e.id,s=e.id!==i?i:void 0)),this.host.notify(we,{id:r,remapped:s},t)}async onGetMissingAvatars(e){if(null==this._graph)return;const t=this._graph.repoPath;async function i(e,i){const r=await(0,s.oP)(e,{ref:i,repoPath:t});this._graph.avatars.set(e,r.toString(!0))}const r=[];for(const[t,s]of Object.entries(e.emails))this._graph.avatars.has(t)||r.push(i.call(this,t,s));r.length&&(await Promise.allSettled(r),this.updateAvatars())}async onGetMissingRefMetadata(e){if(null==this._graph||null===this._refsMetadata||!(0,_.fw)("gitlens:hasConnectedRemotes"))return;const t=this._graph.repoPath;async function i(e,i){null==this._refsMetadata&&(this._refsMetadata=new Map);const r=(await this.container.git.getBranches(t,{filter:t=>t.id===e}))?.values?.[0],s={...this._refsMetadata.get(e)};if(null!=r)for(const t of i)if(N.includes(t))if(t!==U.PullRequest){if(t===U.Upstream){const t=r?.upstream;if(null==t||null==t||t.missing){s.upstream=null,this._refsMetadata.set(e,s);continue}const i={name:(0,f.S3)(t.name),owner:(0,f.Lo)(t.name),ahead:r.state.ahead,behind:r.state.behind,context:(0,B.BH)({webviewItem:"gitlens:upstreamStatus",webviewItemValue:{type:"upstreamStatus",ref:(0,b.LB)(r),ahead:r.state.ahead,behind:r.state.behind}})};s.upstream=i,this._refsMetadata.set(e,s)}}else{const t=await(r?.getAssociatedPullRequest());if(null==t){void 0!==s.pullRequest&&0!==s.pullRequest?.length||(s.pullRequest=null),this._refsMetadata.set(e,s);continue}const i={hostingServiceType:t.provider.id,id:Number.parseInt(t.id)||0,title:t.title,author:t.author.name,date:(t.mergedDate??t.closedDate??t.date)?.getTime(),state:t.state,url:t.url,context:(0,B.BH)({webviewItem:"gitlens:pullrequest",webviewItemValue:{type:"pullrequest",id:t.id,url:t.url}})};s.pullRequest=[i],this._refsMetadata.set(e,s)}else s[t]=null,this._refsMetadata.set(e,s);else for(const t of i)s[t]=null,this._refsMetadata.set(e,s)}const r=[];for(const t of Object.keys(e.metadata))r.push(i.call(this,t,e.metadata[t]));r.length&&await Promise.allSettled(r),this.updateRefsMetadata()}async onGetMoreRows(e,t=!1){null!=this._graph?.paging&&(null!=this._graph?.more&&this.repository?.etag===this._etagRepository?(await this.updateGraphWithMoreRows(this._graph,e.id,this._search),this.notifyDidChangeRows(t)):this.updateState(!0))}async onSearch(e,t){if(null==e.search)return void this.resetSearchState();let i=this._search;if(e.more&&null!=i?.more&&i.comparisonKey===(0,S.FL)(e.search))return i=await i.more(e.limit??k.D.get("graph.searchItemLimit")??100),void(null!=i&&(this._search=i,await this.ensureSearchStartsInRange(this._graph,i),this.host.notify(ve,{results:i.results.size>0?{ids:Object.fromEntries((0,$.UI)(i.results,(([e,t])=>[this._graph?.remappedIds?.get(e)??e,t]))),count:i.results.size,paging:{hasMore:i.paging?.hasMore??!1}}:void 0},t)));if(null==i||i.comparisonKey!==(0,S.FL)(e.search)){if(null==this.repository)return;this.repository.etag!==this._etagRepository&&this.updateState(!0),null!=this._searchCancellation&&(this._searchCancellation.cancel(),this._searchCancellation.dispose());const s=new r.CancellationTokenSource;this._searchCancellation=s;try{i=await this.repository.searchCommits(e.search,{limit:k.D.get("graph.searchItemLimit")??100,ordering:k.D.get("graph.commitOrdering"),cancellation:s.token})}catch(e){return this._search=void 0,void this.host.notify(ve,{results:{error:e instanceof g.l0?"Invalid search pattern":"Unexpected error"}},t)}if(s.token.isCancellationRequested)return void(null!=t&&this.host.notify(ve,{results:void 0},t));this._search=i}else i=this._search;const s=await this.ensureSearchStartsInRange(this._graph,i);let n=!1;null!=s&&(n=!0,this.setSelectedRows(s)),this.host.notify(ve,{results:0===i.results.size?{count:0}:{ids:Object.fromEntries((0,$.UI)(i.results,(([e,t])=>[this._graph?.remappedIds?.get(e)??e,t]))),count:i.results.size,paging:{hasMore:i.paging?.hasMore??!1}},selectedRows:n?this._selectedRows:void 0},t)}onSearchOpenInView(e){null!=this.repository&&this.container.searchAndCompareView.search(this.repository.path,e.search,{label:{label:`for ${e.search.query}`},reveal:{select:!0,focus:!1,expand:!0}})}async onChooseRepository(){const e=this.container.git.openRepositories.sort(((e,t)=>(e===this.repository?1:-1)-(t===this.repository?1:-1)||(e.starred?-1:1)-(t.starred?-1:1)||e.index-t.index)),t=await(0,R.E2)(`Switch Repository ${o.NE.Dot} ${this.repository?.name}`,"Choose a repository to switch to",e);null!=t&&(this.repository=t.item)}onSelectionChanged(e){const t=e.selection[0];this.setSelectedRows(t?.id),null==this._fireSelectionChangedDebounced&&(this._fireSelectionChangedDebounced=(0,E.Ds)(this.fireSelectionChanged.bind(this),250)),this._fireSelectionChangedDebounced(t?.id,t?.type)}fireSelectionChanged(e,t){if(null==this.repository)return;const i=this.getRevisionReference(this.repository.path,e,t),r=null!=i?[i]:void 0;this._selection=r,null!=r&&(this.container.events.fire("commit:selected",{commit:r[0],interaction:"passive",preserveFocus:!0,preserveVisibility:this._firstSelection?!1===this._showDetailsView:"selection"!==this._showDetailsView},{source:this.host.id}),this._firstSelection=!1)}getRevisionReference(e,t,i){if(null!=e&&null!=t)switch(i){case y.e.Stash:return(0,b.xB)(t,e,{refType:"stash",name:t,number:void 0});case y.e.Working:return(0,b.xB)(w.CL,e,{refType:"revision"});default:return(0,b.xB)(t,e,{refType:"revision"})}}updateState(e=!1){this.host.clearPendingIpcNotifications(),e?this.notifyDidChangeState():(null==this._notifyDidChangeStateDebounced&&(this._notifyDidChangeStateDebounced=(0,E.Ds)(this.notifyDidChangeState.bind(this),250)),this._notifyDidChangeStateDebounced())}async notifyDidChangeFocus(e){return!(!this.host.ready||!this.host.visible)&&this.host.notify(he,{focused:e})}async notifyDidChangeWindowFocus(){return this.host.ready&&this.host.visible?this.host.notify(ue,{focused:this.isWindowFocused}):(this.host.addPendingIpcNotification(ue,this._ipcNotificationMap,this),!1)}updateAvatars(e=!1){e?this.notifyDidChangeAvatars():(null==this._notifyDidChangeAvatarsDebounced&&(this._notifyDidChangeAvatarsDebounced=(0,E.Ds)(this.notifyDidChangeAvatars.bind(this),100)),this._notifyDidChangeAvatarsDebounced())}async notifyDidChangeAvatars(){if(null==this._graph)return;const e=this._graph;return this.host.notify(oe,{avatars:Object.fromEntries(e.avatars)})}updateRefsMetadata(e=!1){e?this.notifyDidChangeRefsMetadata():(null==this._notifyDidChangeRefsMetadataDebounced&&(this._notifyDidChangeRefsMetadataDebounced=(0,E.Ds)(this.notifyDidChangeRefsMetadata.bind(this),100)),this._notifyDidChangeRefsMetadataDebounced())}async notifyDidChangeRefsMetadata(){return this.host.notify(ae,{metadata:null!=this._refsMetadata?Object.fromEntries(this._refsMetadata):this._refsMetadata})}async notifyDidChangeColumns(){if(!this.host.ready||!this.host.visible)return this.host.addPendingIpcNotification(ce,this._ipcNotificationMap,this),!1;const e=this.getColumns(),t=this.getColumnSettings(e);return this.host.notify(ce,{columns:t,context:this.getColumnHeaderContext(t),settingsContext:this.getGraphSettingsIconContext(t)})}async notifyDidChangeScrollMarkers(){if(!this.host.ready||!this.host.visible)return this.host.addPendingIpcNotification(le,this._ipcNotificationMap,this),!1;const e=this.getColumns(),t=this.getColumnSettings(e);return this.host.notify(le,{context:this.getGraphSettingsIconContext(t)})}async notifyDidChangeRefsVisibility(){return this.host.ready&&this.host.visible?this.host.notify(de,{excludeRefs:this.getExcludedRefs(this._graph),excludeTypes:this.getExcludedTypes(this._graph),includeOnlyRefs:this.getIncludeOnlyRefs(this._graph)}):(this.host.addPendingIpcNotification(de,this._ipcNotificationMap,this),!1)}async notifyDidChangeConfiguration(){return this.host.ready&&this.host.visible?this.host.notify(se,{config:this.getComponentConfig()}):(this.host.addPendingIpcNotification(se,this._ipcNotificationMap,this),!1)}async notifyDidFetch(){if(!this.host.ready||!this.host.visible)return this.host.addPendingIpcNotification(ye,this._ipcNotificationMap,this),!1;const e=await this.repository.getLastFetched();return this.host.notify(ye,{lastFetched:new Date(e)})}async notifyDidChangeRows(e=!1,t){if(null==this._graph)return;const i=this._graph;return this.host.notify(pe,{rows:i.rows,avatars:Object.fromEntries(i.avatars),downstreams:Object.fromEntries(i.downstreams),refsMetadata:null!=this._refsMetadata?Object.fromEntries(this._refsMetadata):this._refsMetadata,rowsStats:i.rowsStats?.size?Object.fromEntries(i.rowsStats):void 0,rowsStatsLoading:null!=i.rowsStatsDeferred?.isLoaded&&!i.rowsStatsDeferred.isLoaded(),selectedRows:e?this._selectedRows:void 0,paging:{startingCursor:i.paging?.startingCursor,hasMore:i.paging?.hasMore??!1}},t)}async notifyDidChangeRowsStats(e){if(null!=e.rowsStats)return this.host.notify(me,{rowsStats:Object.fromEntries(e.rowsStats),rowsStatsLoading:null!=e.rowsStatsDeferred?.isLoaded&&!e.rowsStatsDeferred.isLoaded()})}async notifyDidChangeWorkingTree(){return this.host.ready&&this.host.visible?this.host.notify(fe,{stats:await this.getWorkingTreeStats()??{added:0,deleted:0,modified:0}}):(this.host.addPendingIpcNotification(fe,this._ipcNotificationMap,this),!1)}async notifyDidChangeSelection(){return this.host.ready&&this.host.visible?this.host.notify(ge,{selection:this._selectedRows??{}}):(this.host.addPendingIpcNotification(ge,this._ipcNotificationMap,this),!1)}async notifyDidChangeSubscription(){if(!this.host.ready||!this.host.visible)return this.host.addPendingIpcNotification(ne,this._ipcNotificationMap,this),!1;const[e]=await this.getGraphAccess();return this.host.notify(ne,{subscription:e.subscription.current,allowed:!1!==e.allowed})}async notifyDidChangeState(){return this.host.ready&&this.host.visible?this.host.notify(re,{state:await this.getState()}):(this.host.addPendingIpcNotification(re,this._ipcNotificationMap,this),!1)}ensureRepositorySubscriptions(e){if(this.ensureLastFetchedSubscription(e),!e&&null!=this._repositoryEventsDisposable)return;null!=this._repositoryEventsDisposable&&(this._repositoryEventsDisposable.dispose(),this._repositoryEventsDisposable=void 0);const t=this.repository;null!=t&&(this._repositoryEventsDisposable=r.Disposable.from(t.onDidChange(this.onRepositoryChanged,this),t.startWatchingFileSystem(),t.onDidChangeFileSystem(this.onRepositoryFileSystemChanged,this),(0,_.ve)((e=>{"gitlens:hasConnectedRemotes"===e&&(this.resetRefsMetadata(),this.updateRefsMetadata())}))))}async ensureLastFetchedSubscription(e){if(!e&&null!=this._lastFetchedDisposable)return;null!=this._lastFetchedDisposable&&(this._lastFetchedDisposable.dispose(),this._lastFetchedDisposable=void 0);const t=this.repository;if(null==t)return;const i=await t.getLastFetched()??0;let r=P._j.getLastFetchedUpdateInterval(i);0!==i&&r>0&&(this._lastFetchedDisposable=(0,E.DH)((()=>{const e=P._j.getLastFetchedUpdateInterval(i);r!==P._j.getLastFetchedUpdateInterval(i)&&(r=e),this.notifyDidFetch()}),r))}async ensureSearchStartsInRange(e,t){if(0===t.results.size)return;let i;for(const r of t.results.keys()){const t=e.remappedIds?.get(r)??r;if(e.ids.has(t))return t;i=t;break}return null!=i?(await this.updateGraphWithMoreRows(e,i),this.notifyDidChangeRows(),e.ids.has(i)?i:void 0):void 0}getColumns(){return this.container.storage.getWorkspace("graph:columns")}getExcludedTypes(e){if(null!=e)return this.getFiltersByRepo(e)?.excludeTypes}getExcludedRefs(e){if(null==e)return;let t;const i=this.container.storage.getWorkspace("graph:hiddenRefs");if(null!=i&&0!==Object.keys(i).length){t=this.container.storage.getWorkspace("graph:filtersByRepo")??{};for(const e in i){const r=Te(e);t[r]=t[r]??{},t[r].excludeRefs=(0,O.iC)(t[r].excludeRefs,e,i[e])}this.container.storage.storeWorkspace("graph:filtersByRepo",t),this.container.storage.deleteWorkspace("graph:hiddenRefs")}const r=(t?.[e.repoPath]??this.getFiltersByRepo(e))?.excludeRefs;if(null==r||0===Object.keys(r).length)return;const s=k.D.get("graph.avatars",void 0,!0),n={},o=e=>this.host.asWebviewUri(e);for(const t in r){const i={...r[t]};if("remote"===i.type&&i.owner){const t=e.remotes.get(i.owner);null!=t&&(i.avatarUrl=((s?t.provider?.avatarUri:void 0)??(0,C.dM)(this.container,t,o))?.toString(!0))}n[t]=i}return n}getIncludeOnlyRefs(e){if(null==e)return;const t=this.getFiltersByRepo(e),i=t?.includeOnlyRefs;if(null==i||0===Object.keys(i).length)return;const r={};for(const[t,s]of Object.entries(i)){let i;if("HEAD"===s.id){if(i=(0,$.sE)(e.branches.values(),(e=>e.current)),null==i)continue;r[i.id]={...s,id:i.id,name:i.name}}else r[t]=s;if("head"===s.type&&(i=i??e.branches.get(s.name),null!=i?.upstream&&!i.upstream.missing)){const t=(0,f.Vx)(e.repoPath,!0,i.upstream.name);r[t]={id:t,type:"remote",name:(0,f.S3)(i.upstream.name),owner:(0,f.Lo)(i.upstream.name)}}}return r}getFiltersByRepo(e){if(null==e)return;const t=this.container.storage.getWorkspace("graph:filtersByRepo");return t?.[e.repoPath]}getColumnSettings(e){const t={...Pe};if(null!=e)for(const[i,r]of Object.entries(e))t[i]={...Pe[i],...r};return t}getColumnHeaderContext(e){return(0,B.BH)({webviewItem:"gitlens:graph:columns",webviewItemValue:this.getColumnContextItems(e).join(",")})}getGraphSettingsIconContext(e){return(0,B.BH)({webviewItem:"gitlens:graph:settings",webviewItemValue:this.getSettingsIconContextItems(e).join(",")})}getColumnContextItems(e){const t=[],i=["author","changes","datetime","graph","message","ref","sha"];let r=0;for(const[s,n]of Object.entries(e))i.includes(s)&&(n.isHidden||r++,t.push(`column:${s}:${n.isHidden?"hidden":"visible"}${n.mode?`+${n.mode}`:""}`));return r>1&&t.push("columns:canHide"),t}getSettingsIconContextItems(e){const t=null!=e?this.getColumnContextItems(e):[];if(k.D.get("graph.scrollMarkers.enabled")){const e=["localBranches","remoteBranches","stashes","tags"],i=k.D.get("graph.scrollMarkers.additionalTypes");for(const r of e)t.push(`scrollMarker:${r}:${i.includes(r)?"enabled":"disabled"}`)}return t}getComponentConfig(){return{avatars:k.D.get("graph.avatars"),dateFormat:k.D.get("graph.dateFormat")??k.D.get("defaultDateFormat")??"short+short",dateStyle:k.D.get("graph.dateStyle")??k.D.get("defaultDateStyle"),enabledRefMetadataTypes:this.getEnabledRefMetadataTypes(),dimMergeCommits:k.D.get("graph.dimMergeCommits"),enableMultiSelection:!1,highlightRowsOnRefHover:k.D.get("graph.highlightRowsOnRefHover"),minimap:k.D.get("graph.minimap.enabled"),minimapDataType:k.D.get("graph.minimap.dataType"),minimapMarkerTypes:this.getMinimapMarkerTypes(),scrollRowPadding:k.D.get("graph.scrollRowPadding"),scrollMarkerTypes:this.getScrollMarkerTypes(),showGhostRefsOnRowHover:k.D.get("graph.showGhostRefsOnRowHover"),showRemoteNamesOnRefs:k.D.get("graph.showRemoteNames"),idLength:k.D.get("advanced.abbreviatedShaLength")}}getScrollMarkerTypes(){if(!k.D.get("graph.scrollMarkers.enabled"))return[];return["selection","highlights","head","upstream",...k.D.get("graph.scrollMarkers.additionalTypes")]}getMinimapMarkerTypes(){if(!k.D.get("graph.minimap.enabled"))return[];return["selection","highlights","head","upstream",...k.D.get("graph.minimap.additionalTypes")]}getEnabledRefMetadataTypes(){const e=[];return k.D.get("graph.pullRequests.enabled")&&e.push(U.PullRequest),k.D.get("graph.showUpstreamStatus")&&e.push(U.Upstream),e}async getGraphAccess(){let e=await this.container.git.access(a.x.Graph,this.repository?.path);this._etagSubscription=this.container.subscription.etag,!1===e.allowed&&null==e.subscription.current.previewTrial&&(await this.container.subscription.startPreviewTrial(),e=await this.container.git.access(a.x.Graph,this.repository?.path));let t=e?.visibility;return null==t&&null!=this.repository&&(t=await this.container.git.visibility(this.repository?.path)),[e,t]}getGraphItemContext(e){const t="string"==typeof e?JSON.parse(e):e;return null==t||"webview"in t||(t.webview=this.host.id),t}async getWorkingTreeStats(){if(null==this.repository||0===this.container.git.repositoryCount)return;const e=await this.container.git.getStatusForRepo(this.repository.path),t=e?.getDiffStatus();return{added:t?.added??0,deleted:t?.deleted??0,modified:t?.changed??0,context:(0,B.BH)({webviewItem:"gitlens:wip",webviewItemValue:{type:"commit",ref:this.getRevisionReference(this.repository.path,w.CL,y.e.Working)}})}}async getState(e){if(0===this.container.git.repositoryCount)return{timestamp:Date.now(),allowed:!0,repositories:[]};if(null==this.repository&&(this.repository=this.container.git.getBestRepositoryOrFirst(),null==this.repository))return{timestamp:Date.now(),allowed:!0,repositories:[]};this._etagRepository=this.repository?.etag,this.host.title=`${this.host.originalTitle}: ${this.repository.formattedName}`;const{defaultItemLimit:t}=k.D.get("graph"),i=Math.max(t,this._graph?.ids.size??t),r=null==this._selectedId||this._selectedId===w.CL?"HEAD":this._selectedId,s=this.getColumns(),n=this.getColumnSettings(s),o=this.container.git.getCommitsForGraph(this.repository.path,(e=>this.host.asWebviewUri(e)),{include:{stats:k.D.get("graph.minimap.enabled")&&"lines"===k.D.get("graph.minimap.dataType")||!n.changes.isHidden},limit:i,ref:r}),a=Promise.allSettled([this.getGraphAccess(),this.getWorkingTreeStats(),this.repository.getBranch(),this.repository.getLastFetched()]);let c;e?queueMicrotask((async()=>{const e=await o;this.setGraph(e),this.setSelectedRows(e.id),this.notifyDidChangeRefsVisibility(),this.notifyDidChangeRows(!0)})):(c=await o,this.setGraph(c),this.setSelectedRows(c.id));const[l,h,u,d]=await a,[p,m]=(0,x.Sb)(l)??[];let g;const f=(0,x.Sb)(u);if(null!=f&&(g={...f.state},null!=f.upstream)){g.upstream=f.upstream.name;const e=await f.getRemote();null!=e?.provider&&(g.provider={name:e.provider.name,icon:"remote"===e.provider.icon?"cloud":e.provider.icon,url:e.provider.url({type:A.J.Repo})})}return{timestamp:Date.now(),windowFocused:this.isWindowFocused,repositories:Re(this.container.git.openRepositories),selectedRepository:this.repository.path,selectedRepositoryVisibility:m,branchName:f?.name,branchState:g,lastFetched:new Date((0,x.Sb)(d)),selectedRows:this._selectedRows,subscription:p?.subscription.current,allowed:!1!==(p?.allowed??!1),avatars:null!=c?Object.fromEntries(c.avatars):void 0,refsMetadata:null===this.resetRefsMetadata()?null:{},loading:e,rowsStatsLoading:null!=c?.rowsStatsDeferred?.isLoaded&&!c.rowsStatsDeferred.isLoaded(),rows:c?.rows,downstreams:null!=c?Object.fromEntries(c.downstreams):void 0,paging:null!=c?{startingCursor:c.paging?.startingCursor,hasMore:c.paging?.hasMore??!1}:void 0,columns:n,config:this.getComponentConfig(),context:{header:this.getColumnHeaderContext(n),settings:this.getGraphSettingsIconContext(n)},excludeRefs:null!=c?this.getExcludedRefs(c)??{}:{},excludeTypes:this.getExcludedTypes(c)??{},includeOnlyRefs:null!=c?this.getIncludeOnlyRefs(c)??{}:{},nonce:this.host.cspNonce,workingTreeStats:(0,x.Sb)(h)??{added:0,deleted:0,modified:0}}}updateColumns(e){let t=this.container.storage.getWorkspace("graph:columns");for(const[i,r]of Object.entries(e))t=(0,O.iC)(t,i,r);this.container.storage.storeWorkspace("graph:columns",t),this.notifyDidChangeColumns()}updateExcludedRefs(e,t,i){if(null==t||0===t.length)return;let r=this.getFiltersByRepo(e)?.excludeRefs??{};for(const e of t)r=(0,O.iC)(r,e.id,i?void 0:{id:e.id,type:e.type,name:e.name,owner:e.owner});this.updateFiltersByRepo(e,{excludeRefs:r}),this.notifyDidChangeRefsVisibility()}updateFiltersByRepo(e,t){if(null==e)throw new Error("Cannot save repository filters since Graph is undefined");const i=this.container.storage.getWorkspace("graph:filtersByRepo");return this.container.storage.storeWorkspace("graph:filtersByRepo",(0,O.iC)(i,e.repoPath,{...i?.[e.repoPath],...t}))}updateIncludeOnlyRefs(e,t){let i;if(null==t||0===t.length){if(null==this.getFiltersByRepo(e)?.includeOnlyRefs)return;i=void 0}else{i={};for(const e of t)i[e.id]={id:e.id,type:e.type,name:e.name,owner:e.owner}}this.updateFiltersByRepo(e,{includeOnlyRefs:i}),this.notifyDidChangeRefsVisibility()}updateExcludedType(e,{key:t,value:i}){let r=this.getFiltersByRepo(e)?.excludeTypes;(null!=r&&0!==Object.keys(r).length||!1!==i)&&(r=(0,O.iC)(r,t,i),this.updateFiltersByRepo(e,{excludeTypes:r}),this.notifyDidChangeRefsVisibility())}resetRefsMetadata(){return this._refsMetadata=(0,_.fw)("gitlens:hasConnectedRemotes")?void 0:null,this._refsMetadata}resetRepositoryState(){this.setGraph(void 0),this.setSelectedRows(void 0)}resetSearchState(){this._search=void 0,this._searchCancellation?.dispose(),this._searchCancellation=void 0}setSelectedRows(e){this._selectedId!==e&&(this._selectedId=e,e===w.CL&&(e=y.e.Working),this._selectedRows=null!=e?{[e]:!0}:void 0)}setGraph(e){this._graph=e,null==e?(this.resetRefsMetadata(),this.resetSearchState()):e.rowsStatsDeferred?.promise.then((()=>{this.notifyDidChangeRowsStats(e)}))}async updateGraphWithMoreRows(e,t,i){const{defaultItemLimit:r,pageItemLimit:s}=k.D.get("graph"),n=await(e.more?.(s??r,t));if(null!=n){if(this.setGraph(n),!i?.paging?.hasMore)return;const e=(0,$.Z$)(i.results)?.[0];if(null==e)return;const t=n.remappedIds?.get(e)??e;n.ids.has(t)&&queueMicrotask((()=>{this.onSearch({search:i.query,more:!0})}))}}fetch(e){const t=null!=e?this.getGraphItemRef(e,"branch"):void 0;u.he(this.repository,t)}pull(e){const t=null!=e?this.getGraphItemRef(e,"branch"):void 0;u.X4(this.repository,t)}push(e){const t=null!=e?this.getGraphItemRef(e):void 0;u.VF(this.repository,void 0,t)}createBranch(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():c.Ue(t.repoPath,t)}deleteBranch(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return c.Od(t.repoPath,t)}return Promise.resolve()}mergeBranchInto(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return u.TS(t.repoPath,t)}return Promise.resolve()}openBranchOnRemote(e,t){if(_e(e,"branch")){const{ref:i}=e.webviewItemValue;return(0,D.P0)(o.Gh.OpenOnRemote,{repoPath:i.repoPath,resource:{type:A.J.Branch,branch:i.name},remote:i.upstream?.name,clipboard:t})}return Promise.resolve()}publishBranch(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return u.VF(t.repoPath,void 0,t)}return Promise.resolve()}rebase(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():u.DW(t.repoPath,t)}rebaseToRemote(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;if(null!=t.upstream)return u.DW(t.repoPath,(0,b.xB)(t.upstream.name,t.repoPath,{refType:"branch",name:t.upstream.name,remote:!0}))}return Promise.resolve()}renameBranch(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return c.PQ(t.repoPath,t)}return Promise.resolve()}cherryPick(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():u.QP(t.repoPath,t)}async copy(e){const t=this.getGraphItemRef(e);if(null!=t)await r.env.clipboard.writeText("revision"===t.refType&&t.message?`${t.name}: ${t.message}`:t.name);else if(ke(e,"contributor")){const{name:t,email:i}=e.webviewItemValue;await r.env.clipboard.writeText(`${t}${i?` <${i}>`:""}`)}else if(ke(e,"pullrequest")){const{url:t}=e.webviewItemValue;await r.env.clipboard.writeText(t)}return Promise.resolve()}copyMessage(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():(0,D.P0)(o.Gh.CopyMessageToClipboard,{repoPath:t.repoPath,sha:t.ref,message:"message"in t?t.message:void 0})}async copySha(e){const t=this.getGraphItemRef(e);if(null==t)return Promise.resolve();let i=t.ref;return(0,b.D3)(i)||(i=await this.container.git.resolveReference(t.repoPath,i,void 0,{force:!0})),(0,D.P0)(o.Gh.CopyShaToClipboard,{sha:i})}openInDetailsView(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():this.host.isView()?void(0,l.E4)(t,{preserveFocus:!0,preserveVisibility:!1}):(0,D.P0)(o.Gh.ShowInDetailsView,{repoPath:t.repoPath,refs:[t.ref]})}openSCM(e){return null==this.getGraphItemRef(e,"revision")?Promise.resolve():(0,D.dO)("workbench.view.scm")}openCommitOnRemote(e,t){const i=this.getGraphItemRef(e,"revision");return null==i?Promise.resolve():(0,D.P0)(o.Gh.OpenOnRemote,{repoPath:i.repoPath,resource:{type:A.J.Commit,sha:i.ref},clipboard:t})}copyDeepLinkToBranch(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return(0,D.P0)(o.Gh.CopyDeepLinkToBranch,{refOrRepoPath:t})}return Promise.resolve()}copyDeepLinkToCommit(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():(0,D.P0)(o.Gh.CopyDeepLinkToCommit,{refOrRepoPath:t})}copyDeepLinkToRepo(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;return t.remote?(0,D.P0)(o.Gh.CopyDeepLinkToRepo,{refOrRepoPath:t.repoPath,remote:(0,f.Lo)(t.name)}):Promise.resolve()}return Promise.resolve()}copyDeepLinkToTag(e){if(_e(e,"tag")){const{ref:t}=e.webviewItemValue;return(0,D.P0)(o.Gh.CopyDeepLinkToTag,{refOrRepoPath:t})}return Promise.resolve()}resetCommit(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():u.mc(t.repoPath,(0,b.xB)(`${t.ref}^`,t.repoPath,{refType:"revision",name:`${t.name}^`,message:t.message}))}resetToCommit(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():u.mc(t.repoPath,t)}revertCommit(e){const t=this.getGraphItemRef(e,"revision");return null==t?Promise.resolve():u.CU(t.repoPath,t)}switchTo(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():u.gu(t.repoPath,t)}hideRef(e,t){let i;if(t?.group&&function(e){return null!=e&&(function(e){return null!=e&&((0,B.dH)(e)&&("gitlens.graph"===e.webview||"gitlens.views.graph"===e.webview))}(e)&&"object"==typeof e.webviewItemGroupValue&&"refGroup"===e.webviewItemGroupValue.type)}(e))({refs:i}=e.webviewItemGroupValue);else if(!t?.group&&_e(e)){const{ref:t}=e.webviewItemValue;null!=t.id&&(i=[t])}return null!=i&&this.updateExcludedRefs(this._graph,i.map((e=>{const i="branch"===e.refType&&e.remote;return{id:e.id,name:i?t?.remote?"*":(0,f.S3)(e.name):e.name,owner:i?(0,f.Lo)(e.name):void 0,type:"branch"===e.refType?e.remote?"remote":"head":"tag"}})),!1),Promise.resolve()}switchToAnother(e){const t=this.getGraphItemRef(e);return null==t?u.gu(this.repository?.path):u.gu(t.repoPath)}async undoCommit(e){const t=this.getGraphItemRef(e);if(null==t)return Promise.resolve();const i=await this.container.git.getOrOpenScmRepository(t.repoPath),s=await(i?.getCommit("HEAD"));s?.hash===t.ref?(0,D.Zv)("git.undoCommit",t.repoPath):r.window.showWarningMessage(`Commit ${(0,b.Wh)(t,{capitalize:!0,icon:!1})} cannot be undone, because it is no longer the most recent commit.`)}saveStash(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():d.VF(t.repoPath)}applyStash(e){const t=this.getGraphItemRef(e,"stash");return null==t?Promise.resolve():d.nn(t.repoPath,t)}deleteStash(e){const t=this.getGraphItemRef(e,"stash");return null==t?Promise.resolve():d.Cw(t.repoPath,t)}renameStash(e){const t=this.getGraphItemRef(e,"stash");return null==t?Promise.resolve():d.PQ(t.repoPath,t)}async createTag(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():p.Ue(t.repoPath,t)}deleteTag(e){if(_e(e,"tag")){const{ref:t}=e.webviewItemValue;return p.Od(t.repoPath,t)}return Promise.resolve()}async createWorktree(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():m.Ue(t.repoPath,void 0,t)}async createPullRequest(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue,i=this.container.git.getRepository(t.repoPath),r=await(i?.getBranch(t.name)),s=await(r?.getRemote());return(0,D.SI)("createPullRequest",{repoPath:t.repoPath,remote:null!=s?{name:s.name,provider:null!=s.provider?{id:s.provider.id,name:s.provider.name,domain:s.provider.domain}:void 0,url:s.url}:void 0,branch:{name:t.name,upstream:t.upstream?.name,isRemote:t.remote}})}return Promise.resolve()}openPullRequestOnRemote(e,t){if(De(e)&&"object"==typeof e.webviewItemValue&&"pullrequest"===e.webviewItemValue.type){const{url:i}=e.webviewItemValue;return(0,D.P0)(o.Gh.OpenPullRequestOnRemote,{pr:{url:i},clipboard:t})}return Promise.resolve()}async compareAncestryWithWorking(e){const t=this.getGraphItemRef(e);if(null==t)return Promise.resolve();const i=await this.container.git.getBranch(t.repoPath);if(null==i)return;const r=await this.container.git.getMergeBase(t.repoPath,i.ref,t.ref);return null!=r?this.container.searchAndCompareView.compare(t.repoPath,{ref:r,label:`ancestry with ${t.ref} (${(0,b.zL)(r)})`},""):void 0}compareHeadWith(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():this.container.searchAndCompareView.compare(t.repoPath,"HEAD",t.ref)}compareWithUpstream(e){if(_e(e,"branch")){const{ref:t}=e.webviewItemValue;if(null!=t.upstream)return this.container.searchAndCompareView.compare(t.repoPath,t.ref,t.upstream.name)}return Promise.resolve()}compareWorkingWith(e){const t=this.getGraphItemRef(e);return null==t?Promise.resolve():this.container.searchAndCompareView.compare(t.repoPath,"",t.ref)}async openFiles(e){const t=await this.getCommitFromGraphItemRef(e);if(null!=t)return(0,l.aE)(t)}async openAllChanges(e){const t=await this.getCommitFromGraphItemRef(e);if(null!=t)return(0,l.Gp)(t)}async openAllChangesWithWorking(e){const t=await this.getCommitFromGraphItemRef(e);if(null!=t)return(0,l.Ou)(t)}async openRevisions(e){const t=await this.getCommitFromGraphItemRef(e);if(null!=t)return(0,l.Dh)(t)}addAuthor(e){if(ke(e,"contributor")){const{repoPath:t,name:i,email:r,current:s}=e.webviewItemValue;return h.q(t,new v.V(t,i,r,0,void 0,s))}return Promise.resolve()}async toggleColumn(e,t){let i=this.container.storage.getWorkspace("graph:columns"),r=i?.[e];null!=r?r.isHidden=!t:r={isHidden:!t},i=(0,O.iC)(i,e,r),await this.container.storage.storeWorkspace("graph:columns",i),this.notifyDidChangeColumns(),"changes"!==e||r.isHidden||this._graph?.includes?.stats||this.updateState()}async toggleScrollMarker(e,t){let i=k.D.get("graph.scrollMarkers.additionalTypes"),r=!1;t&&!i.includes(e)?(i=i.concat(e),r=!0):!t&&i.includes(e)&&(i=i.filter((t=>t!==e)),r=!0),r&&(await k.D.updateEffective("graph.scrollMarkers.additionalTypes",i),this.notifyDidChangeScrollMarkers())}async setColumnMode(e,t){let i=this.container.storage.getWorkspace("graph:columns"),r=i?.[e];null!=r?r.mode=t:r={mode:t},i=(0,O.iC)(i,e,r),await this.container.storage.storeWorkspace("graph:columns",i),this.notifyDidChangeColumns()}getCommitFromGraphItemRef(e){let t=this.getGraphItemRef(e,"revision");return null!=t?this.container.git.getCommit(t.repoPath,t.ref):(t=this.getGraphItemRef(e,"stash"),null!=t?this.container.git.getCommit(t.repoPath,t.ref):Promise.resolve(void 0))}getGraphItemRef(e,t){if(null==e){const e=this.activeSelection;return null==e||null!=t&&t!==e.refType?void 0:e}switch(t){case"branch":return _e(e,"branch")||ke(e,"upstreamStatus")?e.webviewItemValue.ref:void 0;case"revision":return _e(e,"revision")?e.webviewItemValue.ref:void 0;case"stash":return _e(e,"stash")?e.webviewItemValue.ref:void 0;case"tag":return _e(e,"tag")?e.webviewItemValue.ref:void 0;default:return _e(e)?e.webviewItemValue.ref:void 0}}}function Re(e){return 0===e.length?[]:e.map((e=>({formattedName:e.formattedName,id:e.id,name:e.name,path:e.path,isVirtual:e.provider.virtual})))}function De(e){return null!=e&&((0,B.tM)(e)&&("gitlens.graph"===e.webview||"gitlens.views.graph"===e.webview))}function ke(e,t){return null!=e&&(De(e)&&"object"==typeof e.webviewItemValue&&e.webviewItemValue.type===t)}function _e(e,t){return null!=e&&(De(e)&&"object"==typeof e.webviewItemValue&&"ref"in e.webviewItemValue&&(null==t||e.webviewItemValue.ref.refType===t))}function Te(e){return e.split("|",1)[0]}Ae([(0,F.fF)({args:{0:e=>e.toString()}})],GraphWebviewProvider.prototype,"onRepositoryChanged",1),Ae([(0,F.fF)({args:!1})],GraphWebviewProvider.prototype,"onRepositoryFileSystemChanged",1),Ae([(0,F.fF)({args:!1})],GraphWebviewProvider.prototype,"onSubscriptionChanged",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"onEnsureRow",1),Ae([(0,T.H)(),(0,F.fF)()],GraphWebviewProvider.prototype,"onGetMoreRows",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"onSearch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"updateState",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeFocus",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeWindowFocus",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"updateAvatars",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeAvatars",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"updateRefsMetadata",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeRefsMetadata",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeColumns",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeScrollMarkers",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeRefsVisibility",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeConfiguration",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidFetch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeRows",1),Ae([(0,F.fF)({args:!1})],GraphWebviewProvider.prototype,"notifyDidChangeRowsStats",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeWorkingTree",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeSelection",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeSubscription",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"notifyDidChangeState",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"fetch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"pull",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"push",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"createBranch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"deleteBranch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"mergeBranchInto",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openBranchOnRemote",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"publishBranch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"rebase",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"rebaseToRemote",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"renameBranch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"cherryPick",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copy",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copyMessage",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copySha",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openInDetailsView",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openSCM",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openCommitOnRemote",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copyDeepLinkToBranch",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copyDeepLinkToCommit",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copyDeepLinkToRepo",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"copyDeepLinkToTag",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"resetCommit",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"resetToCommit",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"revertCommit",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"switchTo",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"hideRef",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"switchToAnother",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"undoCommit",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"saveStash",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"applyStash",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"deleteStash",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"renameStash",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"createTag",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"deleteTag",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"createWorktree",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"createPullRequest",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openPullRequestOnRemote",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"compareAncestryWithWorking",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"compareHeadWith",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"compareWithUpstream",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"compareWorkingWith",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openFiles",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openAllChanges",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openAllChangesWithWorking",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"openRevisions",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"addAuthor",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"toggleColumn",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"toggleScrollMarker",1),Ae([(0,F.fF)()],GraphWebviewProvider.prototype,"setColumnMode",1)},9042:(e,t,i)=>{i.d(t,{TimelineWebviewProvider:()=>TimelineWebviewProvider});var r=i(9496),s=i(5255),n=i(8887),o=i(7462),a=i(6450),c=i(3646),l=i(9529),h=i(5148),u=i(7512),d=i(4241),p=i(9796),m=i(3105),g=i(2509),f=i(6922),w=i(5798),v=i(6260),y=i(1753);const b=new w.jH("timeline/didChange"),C=new w.ke("timeline/point/open"),A=new w.ke("timeline/period/update");var P=Object.defineProperty,S=Object.getOwnPropertyDescriptor,R=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?S(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&P(t,i,n),n};class TimelineWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._bootstraping=!0,this._notifyDidChangeStateDebounced=void 0,this._context={uri:void 0,period:"3|M",etagRepositories:this.container.git.etag,etagRepository:0,etagSubscription:this.container.subscription.etag},this._context={...this._context,...this._pendingContext},this._pendingContext=void 0,this.host.isEditor()?this._disposable=r.Disposable.from(this.container.subscription.onDidChange(this.onSubscriptionChanged,this),this.container.git.onDidChangeRepository(this.onRepositoryChanged,this)):(this.host.description="✨",this._disposable=r.Disposable.from(this.container.subscription.onDidChange(this.onSubscriptionChanged,this),this.container.git.onDidChangeRepository(this.onRepositoryChanged,this),this.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this),r.window.onDidChangeActiveTextEditor((0,p.Ds)(this.onActiveEditorChanged,250),this),this.container.events.on("file:selected",(0,p.Ds)(this.onFileSelected,250),this)))}dispose(){this._disposable.dispose()}onReloaded(){this.notifyDidChangeState(!0)}onShowing(e,t,...i){const[s]=i;return null!=s?s instanceof r.Uri?this.updatePendingUri(s):(0,f.w8)(s)?this.updatePendingUri(s.uri):(0,y.W)(s)&&this.updatePendingContext({period:s.state.period,uri:null!=s.state.uri?r.Uri.parse(s.state.uri):void 0}):this.updatePendingEditor(r.window.activeTextEditor),e?(this._context={...this._context,...this._pendingContext},this._pendingContext=void 0):this.updateState(),!0}includeBootstrap(){return this._bootstraping=!0,this._context={...this._context,...this._pendingContext},this._pendingContext=void 0,this.getState(this._context)}registerCommands(){return this.host.isEditor()?[(0,l.xR)(s.Gh.RefreshTimelinePage,(()=>this.host.refresh(!0)))]:[(0,l.xR)(`${this.host.id}.refresh`,(()=>this.host.refresh(!0)),this),(0,l.xR)(`${this.host.id}.openInTab`,(()=>this.openInTab()),this)]}onVisibilityChanged(e){e&&(this.host.isView()&&this.updatePendingEditor(r.window.activeTextEditor),this._bootstraping&&(this._bootstraping=!1,null==this._pendingContext||!("uri"in this._pendingContext))||this.updateState())}onMessageReceived(e){switch(e.method){case C.method:(0,w.mq)(C,e,(async e=>{if(null==e.data||!e.data.selected||null==this._context.uri)return;const t=this.container.git.getRepository(this._context.uri);if(null==t)return;const i=await t.getCommit(e.data.id);null!=i&&(this.container.events.fire("commit:selected",{commit:i,interaction:"active",preserveFocus:!0,preserveVisibility:!1},{source:this.host.id}),this.container.commitDetailsView.ready||this.container.commitDetailsView.show({preserveFocus:!0},{commit:i,interaction:"active",preserveVisibility:!1}))}));break;case A.method:(0,w.mq)(A,e,(e=>{this.updatePendingContext({period:e.period})&&this.updateState(!0)}))}}onActiveEditorChanged(e){if(null!=e){if(!(0,g.PH)(e))return;this.container.git.isTrackable(e.document.uri)||(e=void 0)}this.updatePendingEditor(e)&&this.updateState()}onFileSelected(e){if(null==e.data)return;let t=e.data.uri;null!=t&&(this.container.git.isTrackable(t)||(t=void 0)),this.updatePendingUri(t)&&this.updateState()}onRepositoriesChanged(e){const t=this.updatePendingUri(this._context.uri);(this.updatePendingContext({etagRepositories:e.etag})||t)&&this.updateState()}onRepositoryChanged(e){e.changed(c.I6.Heads,c.I6.Index,c.du.Any)&&this.updatePendingContext({etagRepository:e.repository.etag})&&this.updateState()}onSubscriptionChanged(e){this.updatePendingContext({etagSubscription:e.etag})&&this.updateState()}async getState(e){const t=h.D.get("defaultDateFormat")??"MMMM Do, YYYY h:mma",i=h.D.get("defaultDateShortFormat")??"short",s=e.period??"3|M",c=null!=e.uri?await o.YY.fromUri(e.uri):void 0,l=c?.repoPath;this.host.isEditor()?this.host.title=null==c?this.host.originalTitle:`${this.host.originalTitle}: ${c.fileName}`:this.host.description=c?.fileName??"✨";const u=await this.container.git.access(n.x.Timeline,l);if(null==e.uri||null==c||null==l||!1===u.allowed){const r=await this.container.git.access(n.x.Timeline,l);return{timestamp:Date.now(),period:s,title:c?.relativePath,sha:c?.shortSha,uri:e.uri?.toString(),dateFormat:t,shortDateFormat:i,access:r}}const[d,p]=await Promise.all([this.container.git.getCurrentUser(l),this.container.git.getLogForFile(l,c.fsPath,{limit:0,ref:c.sha,since:D(s)?.toISOString()})]);if(null==p)return{timestamp:Date.now(),dataset:[],period:s,title:c.relativePath,sha:c.shortSha,uri:e.uri.toString(),dateFormat:t,shortDateFormat:i,access:u};let g=[...(0,m.hX)(p.commits.values(),(e=>null==e.file?.stats&&1!==(0,a.By)(e.stats?.changedFiles)))];if(0!==g.length){const t=h.D.get("visualHistory.queryLimit")??20,i=this.container.git.getRepository(e.uri),s=i?.provider.name;g.length>t&&(r.window.showWarningMessage(`Unable able to show more than the first ${t} commits for the specified time period because of ${s?`${s} `:""}rate limits.`),g=g.slice(0,20)),await Promise.allSettled(g.map((e=>e.ensureFullDetails())))}const f=d?.name?`${d.name} (you)`:"You",w=[];for(const e of p.commits.values()){const t=e.file?.stats??(1===(0,a.By)(e.stats?.changedFiles)?e.stats:void 0);w.push({author:"You"===e.author.name?f:e.author.name,additions:t?.additions,deletions:t?.deletions,commit:e.sha,date:e.date.toISOString(),message:e.message??e.summary,sort:e.date.getTime()})}return w.sort(((e,t)=>t.sort-e.sort)),{timestamp:Date.now(),dataset:w,period:s,title:c.relativePath,sha:c.shortSha,uri:e.uri.toString(),dateFormat:t,shortDateFormat:i,access:u}}updatePendingContext(e,t){const[i,r]=(0,v.OY)(this._context,this._pendingContext,e,t);return i&&(this._pendingContext=r),i}updatePendingEditor(e,t){return(null!=e||!(0,g.JM)(this._context.uri??this._pendingContext?.uri))&&(!(null!=e&&!(0,g.PH)(e))&&this.updatePendingUri(e?.document.uri,t))}updatePendingUri(e,t){let i;if(null!=e){const t=this.container.git.getRepository(e);i=t?.etag??0}else i=0;return this.updatePendingContext({uri:e,etagRepository:i},t)}updateState(e=!1){e?this.notifyDidChangeState():(null==this._notifyDidChangeStateDebounced&&(this._notifyDidChangeStateDebounced=(0,p.Ds)(this.notifyDidChangeState.bind(this),500)),this._notifyDidChangeStateDebounced())}async notifyDidChangeState(e=!1){if(this._notifyDidChangeStateDebounced?.cancel(),!e&&null==this._pendingContext)return!1;let t;null!=this._pendingContext?(t={...this._context,...this._pendingContext},this._context=t,this._pendingContext=void 0):t=this._context;const i=async()=>this.host.notify(b,{state:await this.getState(t)});return this.host.isView()?r.window.withProgress({location:{viewId:this.host.id}},i):i()}openInTab(){const e=this._context.uri;null!=e&&r.commands.executeCommand(s.Gh.ShowTimelinePage,e)}}function D(e){if("all"==e)return;const[t,i]=e.split("|");let r;switch(i){case"D":r=(0,u.IH)(new Date,{days:-parseInt(t,10)});break;case"M":r=(0,u.IH)(new Date,{months:-parseInt(t,10)});break;case"Y":r=(0,u.IH)(new Date,{years:-parseInt(t,10)});break;default:r=(0,u.IH)(new Date,{months:-3})}return r.getHours()>=12&&r.setDate(r.getDate()+1),r.setHours(0,0,0,0),r}R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"onActiveEditorChanged",1),R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"onFileSelected",1),R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"onRepositoriesChanged",1),R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"onRepositoryChanged",1),R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"onSubscriptionChanged",1),R([(0,d.fF)({args:!1})],TimelineWebviewProvider.prototype,"getState",1),R([(0,d.fF)()],TimelineWebviewProvider.prototype,"updateState",1),R([(0,d.fF)()],TimelineWebviewProvider.prototype,"notifyDidChangeState",1)},1907:(e,t,i)=>{i.d(t,{CH:()=>CloudWorkspace,CL:()=>l,EI:()=>r,Jv:()=>o,Pv:()=>a,U1:()=>c,XU:()=>s,Xu:()=>n,qP:()=>LocalWorkspace});var r=(e=>(e.Local="local",e.Cloud="cloud",e))(r||{}),s=(e=>(e.Disabled="disabled",e.Enabled="enabled",e.Prompt="prompt",e))(s||{});class CloudWorkspace{constructor(e,t,i,r,s,n,o,a){this.container=e,this.id=t,this.name=i,this.organizationId=r,this.provider=s,this.current=n,this.type="cloud",this._repositoryDescriptors=o,this._localPath=a,this._disposable=this.container.git.onDidChangeRepositories(this.resetRepositoriesByName,this)}dispose(){this._disposable.dispose()}get shared(){return null!=this.organizationId}get localPath(){return this._localPath}resetRepositoriesByName(){this._repositoriesByName=void 0}async getRepositoriesByName(e){return(null==this._repositoriesByName||e?.force)&&(this._repositoriesByName=await this.container.workspaces.resolveWorkspaceRepositoriesByName(this.id,{resolveFromPath:!0,usePathMapping:!0})),this._repositoriesByName}async getRepositoryDescriptors(e){return(null==this._repositoryDescriptors||e?.force)&&(this._repositoryDescriptors=await this.container.workspaces.getCloudWorkspaceRepositories(this.id),this.resetRepositoriesByName()),this._repositoryDescriptors}async getRepositoryDescriptor(e){return(await this.getRepositoryDescriptors()).find((t=>t.name===e))}addRepositories(e){null==this._repositoryDescriptors?this._repositoryDescriptors=e:this._repositoryDescriptors=this._repositoryDescriptors.concat(e),this.resetRepositoriesByName()}removeRepositories(e){null!=this._repositoryDescriptors&&(this._repositoryDescriptors=this._repositoryDescriptors.filter((t=>!e.includes(t.name))),this.resetRepositoriesByName())}setLocalPath(e){this._localPath=e}}var n=(e=>(e.GitHub="GITHUB",e.GitHubEnterprise="GITHUB_ENTERPRISE",e.GitLab="GITLAB",e.GitLabSelfHosted="GITLAB_SELF_HOSTED",e.Bitbucket="BITBUCKET",e.Azure="AZURE",e))(n||{});const o={azure:"azure-devops",bitbucket:"bitbucket",github:"github",github_enterprise:"github",gitlab:"gitlab",gitlab_self_hosted:"gitlab"};var a=(e=>(e.CurrentWindow="Current Window",e.ParentFolder="Parent Folder",e))(a||{});const c=100,l=100;class LocalWorkspace{constructor(e,t,i,r,s,n){this.container=e,this.id=t,this.name=i,this.repositoryDescriptors=r,this.current=s,this.type="local",this._localPath=n,this._disposable=this.container.git.onDidChangeRepositories(this.resetRepositoriesByName,this)}dispose(){this._disposable.dispose()}get shared(){return!1}get localPath(){return this._localPath}resetRepositoriesByName(){this._repositoriesByName=void 0}async getRepositoriesByName(e){return(null==this._repositoriesByName||e?.force)&&(this._repositoriesByName=await this.container.workspaces.resolveWorkspaceRepositoriesByName(this.id,{resolveFromPath:!0,usePathMapping:!0})),this._repositoriesByName}getRepositoryDescriptors(){return Promise.resolve(this.repositoryDescriptors)}getRepositoryDescriptor(e){return Promise.resolve(this.repositoryDescriptors.find((t=>t.name===e)))}setLocalPath(e){this._localPath=e}}},3931:(e,t,i)=>{i.d(t,{A1:()=>CommitOpenRevisionsCommandQuickPickItem,CV:()=>CommitOpenAllChangesCommandQuickPickItem,EE:()=>CommitOpenDetailsCommandQuickPickItem,Jw:()=>CommitCompareWithHEADCommandQuickPickItem,K6:()=>OpenChangedFilesCommandQuickPickItem,Lf:()=>CommitBrowseRepositoryFromHereCommandQuickPickItem,NC:()=>CommitCopyMessageQuickPickItem,OT:()=>CommitCopyIdQuickPickItem,PF:()=>CommitFilesQuickPickItem,QP:()=>CommitRestoreFileChangesCommandQuickPickItem,Wt:()=>CommitOpenRevisionCommandQuickPickItem,Y4:()=>CommitOpenAllChangesWithWorkingCommandQuickPickItem,ZO:()=>CommitOpenFileCommandQuickPickItem,aU:()=>CommitOpenChangesWithWorkingCommandQuickPickItem,do:()=>CommitApplyFileChangesCommandQuickPickItem,eG:()=>CommitOpenDirectoryCompareCommandQuickPickItem,lN:()=>CommitOpenFilesCommandQuickPickItem,lp:()=>CommitOpenChangesCommandQuickPickItem,m5:()=>CommitCompareWithWorkingCommandQuickPickItem,nl:()=>CommitOpenDirectoryCompareWithWorkingCommandQuickPickItem,o$:()=>CommitOpenAllChangesWithDiffToolCommandQuickPickItem,sQ:()=>CommitOpenInGraphCommandQuickPickItem,xL:()=>CommitOpenChangesWithDiffToolCommandQuickPickItem,zr:()=>CommitFileQuickPickItem});var r=i(9496),s=i(3016),n=i(5255),o=i(5567),a=i(9311),c=i(6897),l=i(9338),h=i(7881),u=i(3700),d=i(3620),p=i(9729);class CommitFilesQuickPickItem extends p.$w{constructor(e,t){super({label:e.summary,description:`${l.i.fromTemplate("${author}, ${ago}  $(git-commit)  ${id}",e)}${t?.unpublished?"  (unpublished)":""}`,detail:`${null!=t?.file?`$(file) ${(0,u.EZ)(t.file.path)}${t.file.formatStats({expand:!0,separator:", ",prefix:` ${n.NE.Dot} `})}`:`$(files) ${e.formatStats({expand:!0,separator:", ",empty:"No files changed"})}`}${null!=t?.hint?`${(0,d.vk)(n.NE.Dash,4,2,n.NE.Space)}${t.hint}`:""}`,alwaysShow:!0,picked:t?.picked??!0,buttons:[s._9,s.Nv]},void 0,void 0,{suppressKeyPress:!0}),this.commit=e}get sha(){return this.commit.sha}}class CommitFileQuickPickItem extends p.$w{constructor(e,t,i){super({label:`${(0,d.vk)((0,h.Qw)(t.status),0,2)}${(0,u.EZ)(t.path)}`,description:(0,h.OC)(t,!0),picked:i}),this.commit=e,this.file=t}get sha(){return this.commit.sha}execute(e){return c.vw(this.file,this.commit,e)}}class CommitBrowseRepositoryFromHereCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??`$(folder-opened) Browse Repository from${t?.before?" Before":""} Here${t?.openInNewWindow?" in New Window":""}`),this.commit=e,this.executeOptions=t}execute(e){return(0,a.g)(this.commit.getGitUri(),{before:this.executeOptions?.before,openInNewWindow:this.executeOptions?.openInNewWindow})}}class CommitCompareWithHEADCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(compare-changes) Compare with HEAD"),this.commit=e}execute(e){return o.W.instance.searchAndCompareView.compare(this.commit.repoPath,this.commit.ref,"HEAD")}}class CommitCompareWithWorkingCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(compare-changes) Compare with Working Tree"),this.commit=e}execute(e){return o.W.instance.searchAndCompareView.compare(this.commit.repoPath,this.commit.ref,"")}}class CommitCopyIdQuickPickItem extends p.$w{constructor(e,t){super(t??"$(copy) Copy SHA"),this.commit=e}execute(){return c.$H(this.commit)}async onDidPressKey(e){await super.onDidPressKey(e),r.window.showInformationMessage("Commit SHA copied to the clipboard")}}class CommitCopyMessageQuickPickItem extends p.$w{constructor(e,t){super(t??"$(copy) Copy Message"),this.commit=e}execute(){return c.SJ(this.commit)}async onDidPressKey(e){await super.onDidPressKey(e),r.window.showInformationMessage((this.commit.stashName?"Stash":"Commit")+" Message copied to the clipboard")}}class CommitOpenAllChangesCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(git-compare) Open All Changes"),this.commit=e}execute(e){return c.Gp(this.commit,e)}}class CommitOpenAllChangesWithDiffToolCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(git-compare) Open All Changes (difftool)"),this.commit=e}execute(){return c.wr(this.commit)}}class CommitOpenAllChangesWithWorkingCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(git-compare) Open All Changes with Working Tree"),this.commit=e}execute(e){return c.Ou(this.commit,e)}}class CommitOpenChangesCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"$(git-compare) Open Changes"),this.commit=e,this.file=t}execute(e){return c.vw(this.file,this.commit,e)}}class CommitOpenChangesWithDiffToolCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"$(git-compare) Open Changes (difftool)"),this.commit=e,this.file=t}execute(){return c.Xy(this.file,this.commit)}}class CommitOpenChangesWithWorkingCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"$(git-compare) Open Changes with Working File"),this.commit=e,this.file=t}execute(e){return c.ce(this.file,this.commit,e)}}class CommitOpenDirectoryCompareCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(git-compare) Open Directory Compare"),this.commit=e}execute(){return c.tc(this.commit)}}class CommitOpenDirectoryCompareWithWorkingCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(git-compare) Open Directory Compare with Working Tree"),this.commit=e}execute(){return c.Os(this.commit)}}class CommitOpenDetailsCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(eye) Open Details"),this.commit=e}execute(e){return c.Fw(this.commit,{preserveFocus:e?.preserveFocus})}}class CommitOpenInGraphCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(gitlens-graph) Open in Commit Graph"),this.commit=e}execute(e){return c.GM(this.commit,{preserveFocus:e?.preserveFocus})}}class CommitOpenFilesCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(files) Open Files"),this.commit=e}execute(e){return c.aE(this.commit)}}class CommitOpenFileCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"$(file) Open File"),this.commit=e,this.file=t}execute(e){return c.ZB(this.file,this.commit,e)}}class CommitOpenRevisionsCommandQuickPickItem extends p.$w{constructor(e,t){super(t??"$(files) Open Files at Revision"),this.commit=e}execute(e){return c.Dh(this.commit)}}class CommitOpenRevisionCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"$(file) Open File at Revision"),this.commit=e,this.file=t}execute(e){return c.YS(this.file,this.commit,e)}}class CommitApplyFileChangesCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??"Apply Changes"),this.commit=e,this.file=t}async execute(){return c.zb(this.file,this.commit)}}class CommitRestoreFileChangesCommandQuickPickItem extends p.$w{constructor(e,t,i){super(i??{label:"Restore",description:"aka checkout"}),this.commit=e,this.file=t}execute(){return c.Hl(this.file,this.commit)}}class OpenChangedFilesCommandQuickPickItem extends p.$w{constructor(e,t){const i={uris:e.map((e=>e.uri))};super(t??"$(files) Open All Changed Files",n.Gh.OpenChangedFiles,[i])}}},9729:(e,t,i)=>{i.d(t,{$w:()=>CommandQuickPickItem,fz:()=>s,qv:()=>ActionQuickPickItem});var r=i(9496);function s(e){return{kind:r.QuickPickItemKind.Separator,label:e??""}}class CommandQuickPickItem{constructor(e,t,i,r){this.command=t,this.args=i,this.options=r,this.command=t,this.args=i,"string"==typeof e?this.label=e:Object.assign(this,e)}static fromCommand(e,t,i){return new CommandQuickPickItem("string"==typeof e?{label:e}:e,t,null==i?[]:[i])}static is(e){return e instanceof CommandQuickPickItem}execute(e){if(void 0===this.command)return Promise.resolve(void 0);return r.commands.executeCommand(this.command,...this.args??[])}async onDidPressKey(e){if(this.options?.suppressKeyPress)return;const t=this.execute({preserveFocus:!0,preview:!1});this.options?.onDidPressKey?.(e,t),await t}}class ActionQuickPickItem extends CommandQuickPickItem{constructor(e,t){super(e,void 0,void 0),this.action=t}async execute(e){return this.action(e)}}},3599:(e,t,i)=>{i.d(t,{Gy:()=>o,Xe:()=>r,fw:()=>n,wX:()=>s});var r=(e=>(e[e.Back=0]="Back",e[e.Cancel=1]="Cancel",e[e.LoadMore=2]="LoadMore",e[e.Noop=3]="Noop",e[e.RequiresVerification=4]="RequiresVerification",e[e.ExtendTrial=5]="ExtendTrial",e[e.RequiresPaidSubscription=6]="RequiresPaidSubscription",e[e.StartPreviewTrial=7]="StartPreviewTrial",e))(r||{});function s(e){return"number"==typeof e&&null!=r[e]}function n(e,t,i){let r=i?.label,s=i?.detail;if(null==r)switch(e){case 0:r="Back";break;case 1:r="Cancel";break;case 2:r="Load more";break;case 3:r="Try again";break;case 7:r="Preview Pro",s="Preview Pro for 3-days to use this on privately hosted repos";break;case 5:r="Start Free Pro Trial",s="Continue to use this on privately hosted repos, free for an additional 7 days";break;case 4:r="Resend Verification Email",s="You must verify your email before you can continue";break;case 6:r="Upgrade to Pro",s="A paid plan is required to use this on privately hosted repos"}return{label:r,description:i?.description,detail:s,alwaysShow:!0,picked:t,directive:e}}function o(e){return null!=e&&"directive"in e}},1742:(e,t,i)=>{i.d(t,{E0:()=>b,FO:()=>v,MH:()=>y,RE:()=>p,RI:()=>g,RP:()=>f,Wv:()=>GitCommandQuickPickItem,YY:()=>m,vl:()=>w});var r=i(2967),s=i(5255),n=i(5567),o=i(3148),a=i(6450),c=i(4321),l=i(3050),h=i(7512),u=i(3620),d=i(9729);class GitCommandQuickPickItem extends d.$w{constructor(e,t){super(e,s.Gh.GitCommands,[t],{suppressKeyPress:!0})}executeSteps(e){return(0,r.I)(n.W.instance,this.args[0],e)}}async function p(e,t,i){let r="";if(!0===i?.type?r=!0===i.current&&e.current?"current branch":"branch":"remote"===i?.type?e.remote&&(r="remote branch"):!0===i?.current&&e.current&&(r="current branch"),i?.status&&!e.remote&&null!=e.upstream){let t=s.NE.Dash;if(e.upstream.missing)t=s.NE.Warning;else{const i=await e.getRemote();if(null!=i){let e,r;for(const{type:t}of i.urls)if(t===l.XG.Fetch){if(e=!0,r)break}else if(t===l.XG.Push&&(r=!0,e))break;e&&r?t=s.NE.ArrowsRightLeft:r?t=s.NE.ArrowRight:e&&(t=s.NE.ArrowLeft)}}const i=`${e.getTrackingStatus({suffix:`${s.NE.Space} `})}${t}${s.NE.Space} ${e.upstream.name}`;r=`${r?`${r}${s.NE.Space.repeat(2)}${i}`:i}`}i?.ref&&(e.sha&&(r=r?`${r} $(git-commit)${s.NE.Space}${(0,c.zL)(e.sha)}`:`$(git-commit)${s.NE.Space}${(0,c.zL)(e.sha)}`),void 0!==e.date&&(r=r?`${r}${(0,u.vk)(s.NE.Dot,2,2)}${e.formattedDate}`:e.formattedDate));const n=i?.checked||null==i?.checked&&"checkmark"===i?.current&&e.current;return{label:`$(git-branch)${s.NE.Space}${e.starred?`$(star-full)${s.NE.Space}`:""}${e.name}${n?(0,u.vk)("$(check)",2):""}`,description:r,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t??e.current,item:e,current:e.current,ref:e.name,remote:e.remote}}function m(e,t,i){if((0,a.G2)(e)){const r=null==e.number?"":`${e.number}: `;if(i?.compact){return{label:`${i.icon?`$(archive)${s.NE.Space}`:""}${r}${e.summary}`,description:`${e.formattedDate}${(0,u.vk)(s.NE.Dot,2,2)}${e.formatStats({compact:!0})}`,alwaysShow:i.alwaysShow,buttons:i.buttons,picked:t,item:e}}return{label:`${i?.icon?`$(archive)${s.NE.Space}`:""}${r}${e.summary}`,description:"",detail:`${s.NE.Space.repeat(2)}${e.formattedDate}${(0,u.vk)(s.NE.Dot,2,2)}${e.formatStats({compact:!0})}`,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e}}if(i?.compact){return{label:`${i.icon?`$(git-commit)${s.NE.Space}`:""}${e.summary}`,description:`${e.author.name}, ${e.formattedDate}${(0,u.vk)("$(git-commit)",2,1)}${e.shortSha}${(0,u.vk)(s.NE.Dot,2,2)}${e.formatStats({compact:!0})}`,alwaysShow:i.alwaysShow,buttons:i.buttons,picked:t,item:e}}return{label:`${i?.icon?`$(git-commit)${s.NE.Space}`:""}${e.summary}`,description:"",detail:`${s.NE.Space.repeat(2)}${e.author.name}, ${e.formattedDate}${(0,u.vk)("$(git-commit)",2,1)}${e.shortSha}${(0,u.vk)(s.NE.Dot,2,2)}${e.formatStats({compact:!0})}`,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e}}function g(e,t,i){return{label:e.label,description:e.email,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e}}function f(e,t,i,r){if(""===e)return{label:(r?.icon?`$(file-directory)${s.NE.Space}`:"")+"Working Tree",description:"",alwaysShow:r?.alwaysShow,buttons:r?.buttons,picked:i,item:(0,c.xB)(e,t,{refType:"revision",name:"Working Tree"}),current:!1,ref:e,remote:!1};if("HEAD"===e)return{label:(r?.icon?`$(git-branch)${s.NE.Space}`:"")+"HEAD",description:"",alwaysShow:r?.alwaysShow,buttons:r?.buttons,picked:i,item:(0,c.xB)(e,t,{refType:"revision",name:"HEAD"}),current:!1,ref:e,remote:!1};let n;if("string"==typeof e?n=(0,c.xB)(e,t):(n=e,e=n.ref),(0,c.yk)(e))return{label:`Range ${n.name}`,description:"",alwaysShow:r?.alwaysShow,buttons:r?.buttons,picked:i,item:n,current:!1,ref:e,remote:!1};return{label:`Commit ${n.name}`,description:r?.ref?`$(git-commit)${s.NE.Space}${e}`:"",alwaysShow:r?.alwaysShow,buttons:r?.buttons,picked:i,item:n,current:!1,ref:e,remote:!1}}function w(e,t,i){let r="";if(i?.type&&(r="remote"),i?.upstream){const t=(0,l.jv)(e);r=r?`${r}${(0,u.vk)(s.NE.Dot,2,2)}${t}`:t}return{label:`$(cloud)${s.NE.Space}${e.name}${i?.checked?(0,u.vk)("$(check)",2):""}`,description:r,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e}}async function v(e,t,i){let r;(i?.branch||i?.status)&&(r=await e.getStatus());let n="";if(i?.branch&&null!=r&&(n=r.branch),i?.status&&null!=r){let e="";0!==r.files.length&&(e=r.getFormattedDiffStatus({compact:!0,prefix:(0,u.vk)(s.NE.Dot,2,2)}));const t=`${r.getUpstreamStatus({prefix:n?`${s.NE.Space} `:""})}${e}`;t&&(n=`${n?`${n}${t}`:t}`)}if(i?.fetched){const t=await e.getLastFetched();if(0!==t){const e=`Last fetched ${(0,h.Zh)(new Date(t))}`;n=`${n?`${n}${(0,u.vk)(s.NE.Dot,2,2)}${e}`:e}`}}return{label:e.formattedName,description:n,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e,repoPath:e.path}}function y(e,t,i){let r="";if(i?.type&&(r="tag"),i?.ref&&(r=`${r}${(0,u.vk)("$(git-commit)",r?2:0,1)}${(0,c.zL)(e.sha)}`,r=`${r?`${r}${(0,u.vk)(s.NE.Dot,2,2)}`:""}${e.formattedDate}`),i?.message){const t=(0,o.X)(e.message);r=r?`${r}${(0,u.vk)(s.NE.Dot,2,2)}${t}`:t}return{label:`$(tag)${s.NE.Space}${e.name}${i?.checked?(0,u.vk)("$(check)",2):""}`,description:r,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e,current:!1,ref:e.name,remote:!1}}function b(e,t,i){let r,n,o="";switch(i?.type&&(o="worktree"),null!=i?.status&&(o+=i.status.hasChanges?(0,u.vk)(`Uncommited changes (${i.status.getFormattedDiffStatus()})`,o?2:0,0):(0,u.vk)("No changes",o?2:0,0)),e.type){case"bare":n="(bare)",r="$(folder)";break;case"branch":n=e.branch,r="$(git-branch)";break;case"detached":n=(0,c.zL)(e.sha),r="$(git-commit)"}return{label:`${r}${s.NE.Space}${n}${i?.checked?(0,u.vk)("$(check)",2):""}`,description:o,detail:i?.path?`In $(folder) ${e.friendlyPath}`:void 0,alwaysShow:i?.alwaysShow,buttons:i?.buttons,picked:t,item:e,opened:e.opened,hasChanges:i?.status?.hasChanges}}},3636:(e,t,i)=>{i.d(t,{H:()=>p,V:()=>m});var r=i(9496),s=i(6270),n=i(5255),o=i(5567),a=i(3401),c=i(6897),l=i(6713),h=i(4321),u=i(2509),d=i(1742),p=(e=>(e[e.Branches=1]="Branches",e[e.Tags=2]="Tags",e[e.WorkingTree=4]="WorkingTree",e[e.HEAD=8]="HEAD",e[e.BranchesAndTags=3]="BranchesAndTags",e))(p||{});async function m(e,t,i,p={}){const m=r.window.createQuickPick();m.ignoreFocusOut=(0,u.hE)(),m.title=t,m.placeholder=null!=p.allowEnteringRefs?`${i}${n.NE.Space.repeat(3)}(or enter a reference using #)`:i,m.matchOnDescription=!0;const g=[];let f;null!=p?.keys&&0!==p.keys.length&&null!==p?.onDidPressKey&&(f=o.W.instance.keyboard.createScope(Object.fromEntries(p.keys.map((e=>[e,{onDidPressKey:e=>{0!==m.activeItems.length&&p.onDidPressKey(e,m)}}])))),f.start(),g.push(f));const w=new r.CancellationTokenSource;let v,y=async function(e,{picked:t,filter:i,include:r,sort:n}){r=r??3;const a=await(0,s.B$)(o.W.instance.git.getRepository(e),r?["branches","tags"]:r?["branches"]:r?["tags"]:[],{buttons:[s.Nv],filter:i,picked:t,sort:n??{branches:{current:!1},tags:{}}});if(t){const e=a.findIndex((e=>e.ref===t));-1!==e&&a.unshift(...a.splice(e,1))}8&r&&a.unshift((0,d.RP)("HEAD",e,void 0,{icon:!0}));4&r&&a.unshift((0,d.RP)("",e,void 0,{icon:!0}));return a}(e,p);p.autoPick&&(y=y.then((e=>(e.length<=1&&(v=e[0],w.cancel()),e)))),m.busy=!0,m.show();const b=(0,s.v$)(o.W.instance.git.getRepository(e),{buttons:[s.Nv],ranges:p?.allowEnteringRefs&&"boolean"!=typeof p.allowEnteringRefs?p.allowEnteringRefs.ranges:void 0});m.items=await y,m.busy=!1;try{let e=await new Promise((e=>{g.push(w.token.onCancellationRequested((()=>m.hide())),m.onDidHide((()=>e(void 0))),m.onDidAccept((()=>{0!==m.activeItems.length&&e(m.activeItems[0])})),m.onDidChangeValue((async e=>{p.allowEnteringRefs&&(await b(m,e)||(m.items=await y)),null!=f&&(0!==e.length?await f.pause(["left","right"]):await f.resume())})),m.onDidTriggerItemButton((({button:e,item:{item:t}})=>{e===s.Nv&&((0,h.UR)(t)?(0,a.ay)(t,{select:!0,expand:!0}):(0,h.gA)(t)?(0,l.ay)(t,{select:!0,expand:!0}):(0,h.FT)(t)&&(0,c.Fw)(t,{pin:!1,preserveFocus:!0}))})))}));if(null==e&&null!=v&&(e=v),null==e)return;return e.item}finally{m.dispose(),g.forEach((e=>{e.dispose()}))}}},5009:(e,t,i)=>{i.d(t,{az:()=>OpenRemoteResourceCommandQuickPickItem,cY:()=>p,eO:()=>CopyRemoteResourceCommandQuickPickItem});var r=i(9496),s=i(3016),n=i(5255),o=i(5567),a=i(5367),c=i(3050),l=i(6503),h=i(7469),u=i(2509),d=i(9729);class ConfigureCustomRemoteProviderCommandQuickPickItem extends d.$w{constructor(){super({label:"See how to configure a custom remote provider..."})}async execute(){await r.env.openExternal(r.Uri.parse("https://help.gitkraken.com/gitlens/gitlens-settings/#remote-provider-integration-settings"))}}class CopyOrOpenRemoteCommandQuickPickItem extends d.$w{constructor(e,t,i,r){super({label:`$(repo) ${e.provider.path}`,description:e.name,buttons:r}),this.remote=e,this.resource=t,this.clipboard=i}async execute(){let e=this.resource;if(e.type===l.J.Comparison)(0,a.Lo)(e.base)===this.remote.name&&(e={...e,base:(0,a.S3)(e.base)}),(0,a.Lo)(e.compare)===this.remote.name&&(e={...e,compare:(0,a.S3)(e.compare)});else if(e.type===l.J.CreatePullRequest){let t=e.base.branch;if(null==t&&(t=await o.W.instance.git.getDefaultBranchName(this.remote.repoPath,this.remote.name),null==t&&this.remote.hasRichProvider())){const e=await(this.remote.provider.getDefaultBranch?.());t=e?.name}e={...e,base:{branch:t,remote:{path:this.remote.path,url:this.remote.url}}}}else if(e.type===l.J.File&&null!=e.branchOrTag&&("bitbucket"===this.remote.provider.id||"bitbucket-server"===this.remote.provider.id)){const{branchOrTag:t}=e,[i,r]=await Promise.allSettled([o.W.instance.git.getBranches(this.remote.repoPath,{filter:e=>e.name===t||e.getNameWithoutRemote()===t}),o.W.instance.git.getTags(this.remote.repoPath,{filter:e=>e.name===t})]),s=(0,h.Sb)(i)?.values[0]?.sha??(0,h.Sb)(r)?.values[0]?.sha;s&&(e={...e,type:l.J.Revision,sha:s})}await(this.clipboard?this.remote.provider.copy(e):this.remote.provider.open(e))}setAsDefault(){return this.remote.setAsDefault(!0)}}class CopyRemoteResourceCommandQuickPickItem extends d.$w{constructor(e,t){const i=c.ss.getHighlanderProviders(e),r={resource:t,remotes:e,clipboard:!0};super(`$(copy) Copy Link to ${(0,l.C)(t)} for ${i?.length?i[0].name:"Remote"}${1===i?.length?"":n.NE.Ellipsis}`,n.Gh.OpenOnRemote,[r])}async onDidPressKey(e){await super.onDidPressKey(e),r.window.showInformationMessage("URL copied to the clipboard")}}class OpenRemoteResourceCommandQuickPickItem extends d.$w{constructor(e,t){const i=c.ss.getHighlanderProviders(e),r={resource:t,remotes:e,clipboard:!1};super(`$(link-external) Open ${(0,l.C)(t)} on ${1===i?.length?i[0].name:`${i?.length?i[0].name:"Remote"}${n.NE.Ellipsis}`}`,n.Gh.OpenOnRemote,[r])}}async function p(e,t,i,n,o){const{autoPick:a,clipboard:c,setDefault:l}={autoPick:!1,clipboard:!1,setDefault:!0,...o};let h;if(0===n.length)h=[new ConfigureCustomRemoteProviderCommandQuickPickItem],t="No auto-detected or configured remote providers found";else{if("default"===a&&n.length>1){const e=n.find((e=>e.default));null!=e&&(n=[e])}h=n.map((e=>new CopyOrOpenRemoteCommandQuickPickItem(e,i,c,l?[s.ip]:void 0)))}if(a&&1===n.length)return h[0];const d=r.window.createQuickPick();d.ignoreFocusOut=(0,u.hE)();const p=[];try{const i=await new Promise((i=>{p.push(d.onDidHide((()=>i(void 0))),d.onDidAccept((()=>{0!==d.activeItems.length&&i(d.activeItems[0])})),d.onDidTriggerItemButton((async e=>{e.button===s.ip&&e.item instanceof CopyOrOpenRemoteCommandQuickPickItem&&(await e.item.setAsDefault(),i(e.item))}))),d.title=e,d.placeholder=t,d.matchOnDetail=!0,d.items=h,d.show()}));if(null==i)return;return i}finally{d.dispose(),p.forEach((e=>{e.dispose()}))}}},635:(e,t,i)=>{i.d(t,{E2:()=>d,hM:()=>h,rf:()=>p,vJ:()=>u});var r=i(9496),s=i(5567),n=i(2800),o=i(3105),a=i(2509),c=i(9729),l=i(1742);async function h(e,t,i,r){let n=s.W.instance.git.getBestRepository(e,t);if(null!=n&&null!=r?.filter&&(await r.filter(n)||(n=void 0)),null!=n)return n;const o=await d(i,void 0,r);if(!(o instanceof c.$w))return o?.item;await o.execute()}async function u(e,t,i){let r;if(r=null==t?s.W.instance.git.highlander:await s.W.instance.git.getOrOpenRepository(t),null!=r&&null!=i?.filter&&(await i.filter(r)||(r=void 0)),null!=r)return r;const n=await d(e,void 0,i);if(!(n instanceof c.$w))return n?.item;await n.execute()}async function d(e,t="Choose a repository",i){let c;if(null==i||Array.isArray(i)||null!=i.filter||(i=void 0),null==i||Array.isArray(i))c=await Promise.all([...(0,o.UI)(i??s.W.instance.git.openRepositories,(e=>(0,l.FO)(e,void 0,{branch:!0,status:!0})))]);else{const{filter:e}=i;c=await(0,n.sj)(s.W.instance.git.openRepositories,(async t=>await e(t)?(0,l.FO)(t,void 0,{branch:!0,status:!0}):void 0))}if(0===c.length)return;const h=r.window.createQuickPick();h.ignoreFocusOut=(0,a.hE)();const u=[];try{const i=await new Promise((i=>{u.push(h.onDidHide((()=>i(void 0))),h.onDidAccept((()=>{0!==h.activeItems.length&&i(h.activeItems[0])}))),h.title=e,h.placeholder=t,h.matchOnDescription=!0,h.matchOnDetail=!0,h.items=c,h.show()}));if(null==i)return;return i}finally{h.dispose(),u.forEach((e=>{e.dispose()}))}}async function p(e,t="Choose a repository",i){let c;if(null==i||Array.isArray(i)||null!=i.filter||(i=void 0),null==i||Array.isArray(i))c=await Promise.all([...(0,o.UI)(i??s.W.instance.git.openRepositories,(e=>(0,l.FO)(e,void 0,{branch:!0,status:!0})))]);else{const{filter:e}=i;c=await(0,n.sj)(s.W.instance.git.openRepositories,(async t=>await e(t)?(0,l.FO)(t,void 0,{branch:!0,status:!0}):void 0))}if(0===c.length)return[];const h=r.window.createQuickPick();h.ignoreFocusOut=(0,a.hE)();const u=[];try{const i=await new Promise((i=>{u.push(h.onDidHide((()=>i(void 0))),h.onDidAccept((()=>i(h.selectedItems)))),h.title=e,h.placeholder=t,h.matchOnDescription=!0,h.matchOnDetail=!0,h.items=c,h.canSelectMany=!0,h.selectedItems=c,h.show()}));return i??[]}finally{h.dispose(),u.forEach((e=>{e.dispose()}))}}},2133:(e,t,i)=>{i.d(t,{YW:()=>c,x8:()=>Repositories});var r=i(429),s=i(5255),n=i(3700),o=i(1526);const a=47;function c(e){const{path:t}=l(e);return t}function l(e){let t;switch(e.scheme.toLowerCase()){case s.sN.File:return t=(0,n.AH)(e.fsPath),{path:t,ignoreCase:!r.IJ};case s.sN.Git:case s.sN.GitLens:return t=e.path,t=t.charCodeAt(t.length-1)===a?t.slice(1,-1):t.slice(1),{path:t,ignoreCase:!r.IJ};case s.sN.Virtual:case s.sN.GitHub:{t=e.path,t=t.charCodeAt(t.length-1)===a?t.slice(1,-1):t.slice(1);const i=e.authority?.split("+",1)[0];return{path:i?`${i}/${t}`:t,ignoreCase:!1}}case s.sN.Vsls:case s.sN.VslsScc:return t=(0,n.IC)(e.path),t=t.charCodeAt(t.length-1)===a?t.slice(1,-1):t.slice(1),{path:t,ignoreCase:!1};case s.sN.PRs:{t=e.path,t=t.charCodeAt(t.length-1)===a?t.slice(1,-1):t.slice(1);const i=e.authority?.split("+",1)[0];return i===s.sN.GitHub?{path:i?`${i}/${t}`:t,ignoreCase:!1}:{path:t,ignoreCase:!r.IJ}}default:return t=e.path,t=t.charCodeAt(t.length-1)===a?t.slice(1,-1):t.slice(1),{path:t,ignoreCase:!1}}}class Repositories{constructor(){this._count=0,this._trie=new o.QF(l)}get count(){return this._count}add(e){const t=this._trie.set(e.uri,e);return t&&this._count++,t}clear(){this._count=0,this._trie.clear()}forEach(e,t){for(const i of this._trie.getDescendants())e.call(t,i)}get(e){return this._trie.get(e)}getClosest(e){return this._trie.getClosest(e)}has(e){return this._trie.has(e)}remove(e,t=!0){const i=this._trie.delete(e,t);return i&&this._count--,i}values(){return this._trie.getDescendants()}}},4968:(e,t,i)=>{i.d(t,{Cx:()=>s,EE:()=>d,PY:()=>u,RE:()=>o,Z1:()=>g,_n:()=>w,aG:()=>m,dz:()=>f,fV:()=>a,gA:()=>v,jc:()=>n,kU:()=>h,tL:()=>c,ww:()=>p});var r=i(7512),s=(e=>(e.Free="free",e.FreePlus="free+",e.Pro="pro",e.Teams="teams",e.Enterprise="enterprise",e))(s||{}),n=(e=>(e[e.VerificationRequired=-1]="VerificationRequired",e[e.Free=0]="Free",e[e.FreeInPreviewTrial=1]="FreeInPreviewTrial",e[e.FreePreviewTrialExpired=2]="FreePreviewTrialExpired",e[e.FreePlusInTrial=3]="FreePlusInTrial",e[e.FreePlusTrialExpired=4]="FreePlusTrialExpired",e[e.Paid=5]="Paid",e))(n||{});function o(e){const{account:t,plan:{actual:i,effective:r},previewTrial:s}=e;if(!1===t?.verified)return-1;if(i.id===r.id)switch(r.id){case"free":return null==s?0:2;case"free+":return 4;case"pro":case"teams":case"enterprise":return 5}switch(r.id){case"free":return null==s?0:1;case"free+":return 4;case"pro":return"free"===i.id?1:3;case"teams":case"enterprise":return 5}}function a(e,t,i,r,s,n=!1){return{id:e,name:c(e),bundle:t,cancelled:n,organizationId:i,startedOn:(r??new Date).toISOString(),expiresOn:null!=s?s.toISOString():void 0}}function c(e){switch(e){case"free+":return"GitLens Free";case"pro":return"GitLens Pro";case"teams":return"GitLens Teams";case"enterprise":return"GitLens Enterprise";default:return"GitLens"}}const l=new Map([[void 0,-1],["free",0],["free+",1],["pro",2],["teams",3],["enterprise",4]]);function h(e){return l.get(e)??-1}function u(e,t){return d(e.plan.effective.expiresOn,t)}function d(e,t){return null!=e?(0,r.hM)(Date.now(),new Date(e),t):void 0}function p(e){return m(e.plan.effective.id)}function m(e){return"free"!==e&&"free+"!==e}function g(e){const t=u(e);return null!=t&&t<=0}function f(e){return e.plan.actual.id!==e.plan.effective.id}function w(e){if(null==e.account||!f(e)||!1===v(e))return!1;const t=u(e);return null==t||t<=0}function v(e){const t=d(e.previewTrial?.expiresOn);return null!=t?t<=0:void 0}},2800:(e,t,i)=>{i.d(t,{DZ:()=>n,GI:()=>d,Mo:()=>p,Qy:()=>h,XI:()=>l,h8:()=>g,jV:()=>u,qr:()=>a,sj:()=>o,uw:()=>f,vM:()=>c,zx:()=>s});var r=i(3105);function s(e){return null==e?void 0:Array.isArray(e)?e:[e]}function n(e,t){let i=0;return e.reduce(((e,r)=>{const s=t(r,i++);return null!=s&&e.push(s),e}),[])}async function o(e,t){const i=[];for(const r of e){const e=await t(r);null!=e&&i.push(e)}return i}function a(e,t){let i=e.length;for(;i--;)if(t(e[i],i,e))return i;return-1}function c(e,t){return e.reduce(((e,i)=>{const r=t(i),s=e[r];return void 0===s?e[r]=[i]:s.push(i),e}),Object.create(null))}function l(e,t){return e.reduce(((e,i)=>{const r=t(i),s=e.get(r);return void 0===s?e.set(r,[i]):s.push(i),e}),new Map)}function h(e,t,i){return e.reduce(((e,r)=>{const s=i(r);if(null!=s){const i=t(r),n=e.get(i);void 0===n?e.set(i,[s]):n.push(s)}return e}),new Map)}function u(e,t){const i=[],r=e.length;e:for(const s of e[0]){let n=r-1;for(;n--;)if(!e[n+1].some((e=>t(e,s))))break e;i.some((e=>t(e,s)))||i.push(s)}return i}function d(e){return"string"==typeof e[0]}function p(e,t,i,r=!1,s){const n={name:"",relativePath:"",children:new Map,descendants:[]};let o=e.reduce(((e,r)=>{let s=e,n="";for(const e of t(r)){n=i(n,e),void 0===s.children&&(s.children=new Map);let t=s.children.get(e);void 0===t&&(t={name:e,relativePath:n,parent:s,children:void 0,descendants:void 0},s.children.set(e,t)),void 0===s.descendants&&(s.descendants=[]),s.descendants.push(r),s=t}return s.value=r,e}),n);return r&&(o=m(o,i,!0,s)),o}function m(e,t,i=!0,r){if(void 0===e.children)return e;const s=[...e.children.values()];for(const e of s)m(e,t,!1,r);if(!i&&1===s.length){const i=s[0];(void 0===i.value||r?.(i.value))&&(e.name=t(e.name,i.name),e.relativePath=i.relativePath,e.children=i.children,e.descendants=i.descendants,e.value=i.value)}return e}function g(e,t){return(0,r.v_)(new Set(e),t)}function f(e,t,i){return[...e.reduce(((e,r)=>{const s=t(r),n=e.get(s);if(void 0===n)e.set(s,r);else{const t=i(n,r);void 0!==t&&e.set(s,t)}return e}),new Map).values()]}},9529:(e,t,i)=>{i.d(t,{$$:()=>l,P0:()=>p,SI:()=>u,WD:()=>a,Zv:()=>f,_N:()=>h,b2:()=>w,dO:()=>g,fA:()=>d,j$:()=>m,xR:()=>c});var r=i(9496),s=i(5255),n=i(5567);const o=[];function a(){return e=>{o.push(e)}}function c(e,t,i){return r.commands.registerCommand(e,(function(...i){n.W.instance.telemetry.sendEvent("command",{command:e}),t.call(this,...i)}),i)}function l(e){return o.map((t=>new t(e)))}function h(e){return e}function u(e,t){return r.commands.executeCommand(`${s.Gh.ActionPrefix}${e}`,{...t,type:e})}function d(e,t,...i){return{command:e,title:t,arguments:i}}function p(e,...t){return r.commands.executeCommand(e,...t)}function m(e,t,...i){return{command:e,title:t,arguments:i}}function g(e,...t){return"setContext"!=e&&"vscode.executeDocumentSymbolProvider"!==e&&n.W.instance.telemetry.sendEvent("command/core",{command:e}),r.commands.executeCommand(e,...t)}function f(e,...t){return n.W.instance.telemetry.sendEvent("command/core",{command:e}),r.commands.executeCommand(e,...t)}function w(e,t,i){return r.commands.executeCommand(e,t,i)}},4298:(e,t,i)=>{i.d(t,{n:()=>r});class Comparer{}new class TextEditorComparer extends Comparer{equals(e,t,i={usePosition:!1}){return e===t||null!=e&&null!=t&&((!i.usePosition||e.viewColumn===t.viewColumn)&&e.document===t.document)}};const r=new class UriComparer extends Comparer{equals(e,t,i={exact:!1}){return e===t||null!=e&&null!=t&&(i.exact?e.toString()===t.toString():e.scheme===t.scheme&&e.fsPath===t.fsPath)}}},5148:(e,t,i)=>{i.d(t,{D:()=>o,V:()=>Configuration});var r=i(9496),s=i(5255),n=i(9967);class Configuration{constructor(){this._onDidChange=new r.EventEmitter,this._onDidChangeAny=new r.EventEmitter}static configure(e){e.subscriptions.push(r.workspace.onDidChangeConfiguration(o.onConfigurationChanged,o))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){this._onDidChangeAny.fire(e),e.affectsConfiguration(s.m1)&&(null!=this._overrides?.onDidChange&&(e=this._overrides.onDidChange(e)),this._onDidChange.fire(e))}applyOverrides(e){this._overrides=e}clearOverrides(){null!=this._overrides&&(this._overrides.get=void 0,this._overrides.getAll=void 0,queueMicrotask((()=>this._overrides=void 0)))}get(e,t,i,n){const o=void 0===i?r.workspace.getConfiguration(s.m1,t).get(e):r.workspace.getConfiguration(s.m1,t).get(e,i);return n||null==this._overrides?.get?o:this._overrides.get(e,o)}getAll(e){const t=r.workspace.getConfiguration().get(s.m1);return e||null==this._overrides?.getAll?t:this._overrides.getAll(t)}getAny(e,t,i){return void 0===i?r.workspace.getConfiguration(void 0,t).get(e):r.workspace.getConfiguration(void 0,t).get(e,i)}changed(e,t,i){return null==e||(Array.isArray(t)?t.some((t=>e.affectsConfiguration(`${s.m1}.${t}`,i))):e.affectsConfiguration(`${s.m1}.${t}`,i))}changedAny(e,t,i){return null==e||(Array.isArray(t)?t.some((t=>e.affectsConfiguration(t,i))):e.affectsConfiguration(t,i))}inspect(e,t){return r.workspace.getConfiguration(s.m1,t).inspect(void 0===e?s.m1:e)}inspectAny(e,t){return r.workspace.getConfiguration(void 0,t).inspect(e)}isUnset(e,t){const i=this.inspect(e,t);return void 0===i.workspaceFolderValue&&(void 0===i.workspaceValue&&void 0===i.globalValue)}async migrate(e,t,i){const s=this.inspect(e);if(void 0===s)return!1;let n=!1;return void 0!==s.globalValue&&(await this.update(t,null!=i.migrationFn?i.migrationFn(s.globalValue):s.globalValue,r.ConfigurationTarget.Global),n=!0),void 0!==s.workspaceValue&&(await this.update(t,null!=i.migrationFn?i.migrationFn(s.workspaceValue):s.workspaceValue,r.ConfigurationTarget.Workspace),n=!0),void 0!==s.workspaceFolderValue&&(await this.update(t,null!=i.migrationFn?i.migrationFn(s.workspaceFolderValue):s.workspaceFolderValue,r.ConfigurationTarget.WorkspaceFolder),n=!0),n||void 0===i.fallbackValue||(await this.update(t,i.fallbackValue,r.ConfigurationTarget.Global),n=!0),n}async migrateIfMissing(e,t,i){const s=this.inspect(e);if(void 0===s)return;const n=this.inspect(t);void 0!==s.globalValue&&void 0===n?.globalValue&&await this.update(t,null!=i.migrationFn?i.migrationFn(s.globalValue):s.globalValue,r.ConfigurationTarget.Global),void 0!==s.workspaceValue&&void 0===n?.workspaceValue&&await this.update(t,null!=i.migrationFn?i.migrationFn(s.workspaceValue):s.workspaceValue,r.ConfigurationTarget.Workspace),void 0!==s.workspaceFolderValue&&void 0===n?.workspaceFolderValue&&await this.update(t,null!=i.migrationFn?i.migrationFn(s.workspaceFolderValue):s.workspaceFolderValue,r.ConfigurationTarget.WorkspaceFolder)}matches(e,t,i){return e===t}name(e){return e}update(e,t,i){return r.workspace.getConfiguration(s.m1).update(e,t,i)}updateAny(e,t,i,s){return r.workspace.getConfiguration(void 0,i===r.ConfigurationTarget.Global?void 0:s).update(e,t,i)}updateEffective(e,t){const i=this.inspect(e);return void 0!==i.workspaceFolderValue?t===i.workspaceFolderValue?Promise.resolve(void 0):this.update(e,t,r.ConfigurationTarget.WorkspaceFolder):void 0!==i.workspaceValue?t===i.workspaceValue?Promise.resolve(void 0):this.update(e,t,r.ConfigurationTarget.Workspace):i.globalValue===t||void 0===i.globalValue&&t===i.defaultValue?Promise.resolve(void 0):this.update(e,(0,n.wy)(t,i.defaultValue)?void 0:t,r.ConfigurationTarget.Global)}}const o=new Configuration},2061:(e,t,i)=>{i.d(t,{fw:()=>c,v:()=>l,ve:()=>a});var r=i(9496),s=i(9529);const n=new Map,o=new r.EventEmitter,a=o.event;function c(e,t){return n.get(e)??t}async function l(e,t){n.set(e,t),await(0,s.dO)("setContext",e,t),o.fire(e)}},7512:(e,t,i)=>{i.d(t,{Cz:()=>d,IH:()=>p,Zh:()=>m,hM:()=>f,p6:()=>g});const r=/(?<literal>\[.*?\])|(?<year>YYYY|YY)|(?<month>M{1,4})|(?<day>Do|DD?)|(?<weekday>d{2,4})|(?<hour>HH?|hh?)|(?<minute>mm?)|(?<second>ss?)|(?<fractionalSecond>SSS)|(?<dayPeriod>A|a)|(?<timeZoneName>ZZ?)/g,s=/(?<dateStyle>full|long|medium|short)(?:\+(?<timeStyle>full|long|medium|short))?/,n=[["year",629856e5,31536e6,"yr"],["month",2628e6,2628e6,"mo"],["week",6048e5,6048e5,"wk"],["day",864e5,864e5,"d"],["hour",36e5,36e5,"h"],["minute",6e4,6e4,"m"],["second",1e3,1e3,"s"]];let o;const a=new Map;let c,l,h;const u=new Map;function d(e){c="string"==typeof e?"system"===e||0===e.trim().length?void 0:[e]:e??void 0,l=void 0,h=void 0,a.clear(),u.clear(),o=void 0}function p(e,t){const i=new Date(e.getTime());for(const[e,r]of Object.entries(t))if(r)switch(e){case"years":i.setFullYear(i.getFullYear()+r);break;case"months":i.setMonth(i.getMonth()+r);break;case"days":i.setDate(i.getDate()+r);break;case"hours":i.setHours(i.getHours()+r);break;case"minutes":i.setMinutes(i.getMinutes()+r);break;case"seconds":i.setSeconds(i.getSeconds()+r)}return i}function m(e,t){const i=("number"==typeof e?e:e.getTime())-(new Date).getTime();for(const[e,r,s,a]of n){const n=Math.abs(i);if(n>=r||1e3===r){if(t){if(null==o&&(null!=h?o=h.resolvedOptions().locale:null!=l?o=l.resolvedOptions().locale:(h=new Intl.RelativeTimeFormat(c,{localeMatcher:"best fit",numeric:"always",style:"narrow"}),o=h.resolvedOptions().locale)),"en"===o||o?.startsWith("en-")){return`${Math.round(n/s)}${a}`}return null==h&&(h=new Intl.RelativeTimeFormat(c,{localeMatcher:"best fit",numeric:"always",style:"narrow"})),h.format(Math.round(i/s),e)}return null==l&&(l=new Intl.RelativeTimeFormat(c,{localeMatcher:"best fit",numeric:"auto",style:"long"})),l.format(Math.round(i/s),e)}}return""}function g(e,t,i,n=!0){const o=`${i??""}:${t=t??void 0}`;let l=a.get(o);if(null==l){const e=function(e){if(null==e)return{localeMatcher:"best fit",dateStyle:"full",timeStyle:"short"};const t=s.exec(e);if(null!=t?.groups){const{dateStyle:e,timeStyle:i}=t.groups;return{localeMatcher:"best fit",dateStyle:e||"full",timeStyle:i||void 0}}const i={localeMatcher:"best fit"};for(const{groups:t}of e.matchAll(r))if(null!=t)for(const e in t){const r=t[e];if(null!=r)switch(e){case"year":i.year=4===r.length?"numeric":"2-digit";break;case"month":switch(r.length){case 4:i.month="long";break;case 3:i.month="short";break;case 2:i.month="2-digit";break;case 1:i.month="numeric"}break;case"day":i.day="DD"===r?"2-digit":"numeric";break;case"weekday":switch(r.length){case 4:i.weekday="long";break;case 3:i.weekday="short";break;case 2:i.weekday="narrow"}break;case"hour":i.hour=2===r.length?"2-digit":"numeric",i.hour12="hh"===r||"h"===r;break;case"minute":i.minute=2===r.length?"2-digit":"numeric";break;case"second":i.second=2===r.length?"2-digit":"numeric";break;case"fractionalSecond":i.fractionalSecondDigits=3;break;case"dayPeriod":i.dayPeriod="narrow",i.hour12=!0,i.hourCycle="h12";break;case"timeZoneName":i.timeZoneName=2===r.length?"long":"short"}}return i}(t);let h;h=null==i?c:"system"===i?void 0:[i],l=new Intl.DateTimeFormat(h,e),n&&a.set(o,l)}if(null==t||s.test(t))return l.format(e);function h(e){const t=`${i??""}:time:${e}`;let r=a.get(t);if(null==r){const s={localeMatcher:"best fit",timeStyle:e};let o;o=null==i?c:"system"===i?void 0:[i],r=new Intl.DateTimeFormat(o,s),n&&a.set(t,r)}return r}const u=l.formatToParts(e);return t.replace(r,((t,i,r,s,n,o,a,c,l,d,p,m,g,f,w)=>{if(null!=i)return i.substring(1,i.length-1);for(const t in w){const i=w[t];if(null==i)continue;const r=u.find((e=>e.type===t));if("Do"===i&&"day"===r?.type)return v(Number(r.value));if("a"===i&&"dayPeriod"===r?.type){const t=h("short").formatToParts(e).find((e=>"dayPeriod"===e.type));return` ${(t??r)?.value??""}`}return r?.value??""}return""}))}function f(e,t,i){const r=("number"==typeof t?t:t.getTime())-("number"==typeof e?e:e.getTime());switch(i){case"days":return Math.floor(r/864e5);case"hours":return Math.floor(r/36e5);case"minutes":return Math.floor(r/6e4);case"seconds":return Math.floor(r/1e3);default:return r}}const w=["th","st","nd","rd"];function v(e){const t=e%100;return`${e}${w[(t-20)%10]??w[t]??w[0]}`}},5432:(e,t,i)=>{i.d(t,{H:()=>n});var r=i(7469),s=i(9610);function n(e){return(t,i,n)=>{let o;if("function"==typeof n.value?o=n.value:"function"==typeof n.get&&(o=n.get),null==o)throw new Error("Not supported");const a=`$gate$${i}`;n.value=function(...t){const i=(0,s.S)(a,e,...t);Object.prototype.hasOwnProperty.call(this,i)||Object.defineProperty(this,i,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let n=this[i];if(void 0===n){let e;try{if(e=o.apply(this,t),null==e||!(0,r.tI)(e))return e;this[i]=n=e.then((e=>(this[i]=void 0,e))).catch((e=>{throw this[i]=void 0,e}))}catch(e){throw this[i]=void 0,e}}return n}}}},4241:(e,t,i)=>{i.d(t,{cM:()=>m,fF:()=>p,hJ:()=>d});var r=i(9376),s=i(9796),n=i(4336),o=i(8227),a=i(6004),c=i(7469),l=i(3620);const h="",u=Symbol("logInstanceNameFn");function d(e){return t=>{t[u]=e}}function p(e){return m(e,!0)}function m(e,t=!1){let i,d,p,m,g,f,w=0,v=!1,y=!1,b=!0;null!=e&&({args:i,condition:d,enter:p,exit:m,prefix:g,sanitize:f,logThreshold:w=0,scoped:v=!0,singleLine:y=!1,timed:b=!0}=e),w>0&&(y=!0,b=!0),b&&(v=!0);const C=t?n.Yd.debug.bind(n.Yd):n.Yd.log.bind(n.Yd),A=n.Yd.warn.bind(n.Yd);return(e,P,S)=>{let R,D;if("function"==typeof S.value?(R=S.value,D="value"):"function"==typeof S.get&&(R=S.get,D="get"),null==R||null==D)throw new Error("Not supported");const k=(0,s.ZS)(R);S[D]=function(...s){const S=(0,a.OD)();if(!n.Yd.isDebugging&&!n.Yd.enabled(o.i.Debug)&&(!n.Yd.enabled(o.i.Info)||t)||null!=d&&!d(...s))return R.apply(this,s);let D;null!=this?(D=(0,n.q4)(this),this.constructor?.[u]&&(D=e.constructor[u](this,D))):D=h;let _,T=`${v?`[${S.toString(16).padStart(5)}] `:h}${D?`${D}.`:h}${P}`;null!=g&&(T=g({id:S,instance:this,instanceName:D,name:P,prefix:T},...s)),v&&(_={scopeId:S,prefix:T},(0,a.DS)(S,_));const F=null!=p?p(...s):h;let E;if(!1===i||0===s.length)E=h,y||C(`${T}${F}`);else{let e;E="";let r,a,c,l=-1;for(c of s){if(r=k[++l],e=i?.[l],null!=e){if("boolean"==typeof e)continue;if(E.length>0&&(E+=", "),"string"==typeof e){E+=e;continue}a=String(e(c))}else E.length>0&&(E+=", "),a=n.Yd.toLoggable(c,f);E+=r?`${r}=${a}`:a}y||C(`${T}${F}${E&&(t||n.Yd.enabled(o.i.Debug)||n.Yd.isDebugging)?`(${E})`:h}`)}if(y||b||null!=m){const e=b?(0,r.a)():void 0,i=t=>{const i=void 0!==e?` [${(0,l.qk)(e)}ms]`:h;y?n.Yd.error(t,`${T}${F}${E?`(${E})`:h}`,`failed${_?.exitDetails?_.exitDetails:h}${i}`):n.Yd.error(t,T,`failed${_?.exitDetails?_.exitDetails:h}${i}`),v&&(0,a.Fp)(S)};let u;try{u=R.apply(this,s)}catch(e){throw i(e),e}const d=i=>{let r,s,c,u;if(null!=e?(r=(0,l.qk)(e),r>o.O?(s=A,c=` [*${r}ms] (slow)`):(s=C,c=` [${r}ms]`)):(c=h,s=C),null!=m)if("function"==typeof m)try{u=m(i)}catch(e){u=`@log.exit error: ${e}`}else!0===m&&(u=`returned ${n.Yd.toLoggable(i)}`);else u="completed";y?(0===w||r>w)&&s(`${T}${F}${E&&(t||n.Yd.enabled(o.i.Debug)||n.Yd.isDebugging)?`(${E})`:h} ${u}${_?.exitDetails?_.exitDetails:h}${c}`):s(`${T}${E&&(t||n.Yd.enabled(o.i.Debug)||n.Yd.isDebugging)?`(${E})`:h} ${u}${_?.exitDetails?_.exitDetails:h}${c}`),v&&(0,a.Fp)(S)};if(null!=u&&(0,c.tI)(u)){u.then(d).catch(i)}else d(u);return u}return R.apply(this,s)}}}},4488:(e,t,i)=>{i.d(t,{H:()=>s});var r=i(9610);function s(e){return(t,i,s)=>{let n,o;if("function"==typeof s.value)n=s.value,o="value";else{if("function"!=typeof s.get)throw new Error("Not supported");n=s.get,o="get"}if(null==n)throw new Error("Not supported");const a=`$memoize$${i}`;let c;s[o]=function(...t){const i=(0,r.S)(a,e,...t);return Object.prototype.hasOwnProperty.call(this,i)?(c=this[i],c):(c=n.apply(this,t),Object.defineProperty(this,i,{configurable:!1,enumerable:!1,writable:!1,value:c}),c)}}}},9610:(e,t,i)=>{i.d(t,{S:()=>u});var r=i(9496),s=i(5567),n=i(5367),o=i(6450),a=i(9502),c=i(6922);function l(e,t){return""===e||null==t||"object"!=typeof t?t:t instanceof Error?String(t):t instanceof r.Uri?"sha"in t&&t.sha?`${t.sha}:${t.toString()}`:t.toString():(0,n.BF)(t)||(0,o.f_)(t)||(0,a.YR)(t)||(0,c.Jc)(t)?t.toString():(0,s.N)(t)?"<container>":t}function h(...e){if(0===e.length)return"";if(1!==e.length)return JSON.stringify(e,l);const t=e[0];if(null==t)return"";switch(typeof t){case"string":return t;case"number":case"boolean":case"undefined":case"symbol":case"bigint":return String(t);default:return t instanceof Error?String(t):t instanceof r.Uri?"sha"in t&&"string"==typeof t.sha&&t.sha?`${t.sha}:${t.toString()}`:t.toString():(0,n.BF)(t)||(0,o.f_)(t)||(0,a.YR)(t)||(0,c.Jc)(t)?t.toString():(0,s.N)(t)?"<container>":JSON.stringify(t,l)}}function u(e,t,...i){if(0===i.length)return e;let r;if(null!=t)try{r=t(...i)}catch{r=h(...i)}else r=h(...i);return`${e}$${r}`}},6767:(e,t,i)=>{i.d(t,{V:()=>s});var r=i(7469);function s(e,t){let i,s=!1;return"boolean"==typeof e?s=e:i=e,(e,n,o)=>{let a;if("function"==typeof o.value&&(a=o.value),null==a)throw new Error("Not supported");o.value=function(...e){if(s){const r=e[e.length-1];i=null!=r&&"number"==typeof r?r:t}const n=a?.apply(this,e);return null==i||i<1||!(0,r.tI)(n)?n:(0,r.HO)(n,i,{onDidCancel:e=>e(void 0)})}}}},8786:(e,t,i)=>{function r(e){if(null!=e)return encodeURI(e.replace(/%20/g," "))}i.d(t,{M:()=>r})},2185:(e,t,i)=>{function r(e){return(t,i,r)=>{const s=e((e=>(s.dispose(),t.call(i,e))),null,r);return s}}i.d(t,{IH:()=>r,ue:()=>n});const s=(e,t)=>t(e);function n(e,t=s){let i,r,n=!0;return{get pending(){return n},promise:new Promise(((s,o)=>{i=()=>{n=!1,i=void 0,o()},r=e((async e=>{try{await t(e,s,o),n=!1}catch(e){n=!1,o(e)}}))})).then((e=>(r.dispose(),e)),(e=>{throw r.dispose(),e})),cancel:()=>i?.()}}},1774:(e,t,i)=>{i.d(t,{d:()=>n});var r=i(3700),s=i(3620);function n(e,t){const i=(0,r.M)(e);let n=(0,r.EZ)(i);if(null!=t?.truncateTo&&n.length>=t.truncateTo)return(0,s.ro)(n,t.truncateTo);if(t?.suffix){if(null!=t.truncateTo&&n.length+t.suffix.length>=t.truncateTo)return`${(0,s.ro)(n,t.truncateTo-t.suffix.length)}${t.suffix}`;n+=t.suffix}if(t?.fileOnly)return n;const o=(0,r.Fd)(i,t?.relativeTo);return o?(n=`/${n}`,null!=t?.truncateTo&&n.length+o.length>=t.truncateTo?`${(0,s.AO)(o,t.truncateTo-n.length)}${n}`:`${o}${n}`):n}},9796:(e,t,i)=>{function r(e,t){let i,r,s,n,o;function a(e){const i=e-(r??0);return null==r||i>=t||i<0}function c(){const e=Date.now();if(a(e))l();else{o=setTimeout(c,t-(e-(r??0)))}}function l(){return o=void 0,i?function(){const t=i,r=s;return i=s=void 0,n=e.apply(r,t),n}():(i=s=void 0,n)}function h(...e){const l=Date.now(),h=a(l);return i=e,s=this,r=l,h&&null==o?(o=setTimeout(c,t),n):(null==o&&(o=setTimeout(c,t)),n)}return h.cancel=function(){null!=o&&clearTimeout(o),i=r=s=o=void 0},h.flush=function(){return null!=o?l():n},h.pending=function(){return null!=o},h}i.d(t,{DH:()=>f,Ds:()=>r,IH:()=>g,NX:()=>v,ZS:()=>p,df:()=>w,is:()=>m});const s=",",n="",o="=",a="{",c="(",l=")",h=/\(([\s\S]*)\)/,u=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,d=/\s?=.*$/;function p(e){if("function"!=typeof e)throw new Error("Not supported");if(0===e.length)return[];let t=Function.prototype.toString.call(e);t=t.replace(u,n)||t,t=t.slice(0,t.indexOf(a));let i=t.indexOf(c),r=t.indexOf(l);i=i>=0?i+1:0,r=r>0?r:t.indexOf(o),t=t.slice(i,r),t=`(${t})`;const p=h.exec(t);return null!=p?p[1].split(s).map((e=>e.trim().replace(d,n))):[]}function m(e,t,i){return null==t?null!=e:"function"==typeof t?t(e):void 0===i?void 0!==e[t]:e[t]===i}function g(e){let t,i=!1;return function(...r){return i||(i=!0,t=e.apply(this,r),e=void 0),t}}function f(e,t){let i;const r={dispose:()=>{null!=i&&(clearInterval(i),i=void 0)}};return i=setInterval(e,t),r}async function w(e,t,i){for(const r of t)try{await e.apply(i,r)}catch{}}function v(e,t){return e>=t?e*e+e+t:e+t*t}},3105:(e,t,i)=>{function r(e,t){let i,r=0;for(;i=e.next(),!i.done;)(void 0===t||t(i.value))&&r++;return r}function s(e,t){for(const i of e)if(!t(i))return!1;return!0}function*n(e,t){if(void 0===t)for(const t of e)null!=t&&(yield t);else for(const i of e)t(i)&&(yield i)}function*o(e,t){for(const i of e){const e=t(i);null!=e&&(yield e)}}function a(e,t){for(const i of e)if(t(i))return i;return null}function c(e){return e[Symbol.iterator]().next().value}function*l(e,t){for(const i of e)yield*t(i)}function h(e,t){const i=e[Symbol.iterator]();let r=i.next();if(r.done)return"";let s=String(r.value);for(;r=i.next(),!r.done;)s+=`${t}${r.value}`;return s}function u(e){let t;for(t of e);return t}function*d(e,t){for(const i of e)yield t(i)}function p(e,t){for(const i of e)if(t(i))return!0;return!1}function*m(...e){for(const t of e)for(const e of t)yield e}function g(e,t,i){const r=new Map;for(const s of e){const e=t(s),n=r.get(e);if(void 0===n)r.set(e,s);else{const t=i(n,s);void 0!==t&&r.set(e,t)}}return r.values()}i.d(t,{DZ:()=>o,G:()=>p,G0:()=>m,Ps:()=>c,QX:()=>r,UI:()=>d,VS:()=>l,Z$:()=>u,hX:()=>n,sE:()=>a,uw:()=>g,v_:()=>h,yW:()=>s})},8227:(e,t,i)=>{i.d(t,{O:()=>r,i:()=>s});const r=500;var s=(e=>(e.Off="off",e.Error="error",e.Warn="warn",e.Info="info",e.Debug="debug",e))(s||{})},6004:(e,t,i)=>{i.d(t,{DS:()=>h,Fp:()=>o,OD:()=>l,QR:()=>c,UH:()=>a,lH:()=>u});const r=2**30,s=new Map;let n=0;function o(e){s.delete(e)}function a(){return s.get(n)}function c(e){const t=l();return{scopeId:t,prefix:`[${String(t).padStart(5)}] ${e}`}}function l(){return n===r&&(n=0),++n}function h(e,t){s.set(e,t)}function u(e,t){null!=e&&(e.exitDetails=t)}},4336:(e,t,i)=>{i.d(t,{Nu:()=>c,Yd:()=>n,q4:()=>a});var r=i(8227);const s="";const n=new class Logger2{constructor(){this._isDebugging=!1,this.level=0,this._logLevel=r.i.Off}configure(e,t,i=!1){this.provider=e,this._isDebugging=i,this.logLevel=t}enabled(e){return this.level>=o(e)}get isDebugging(){return this._isDebugging}get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e,this.level=o(this._logLevel),e===r.i.Off?(this.output?.dispose?.(),this.output=void 0):this.output=this.output??this.provider.createChannel(this.provider.name)}get timestamp(){return`[${(new Date).toISOString().replace(/T/," ").slice(0,-1)}]`}debug(e,...t){if(this.level<4&&!this.isDebugging)return;let i;"string"==typeof e?i=e:(i=t.shift(),null!=e&&(i=`${e.prefix} ${i??s}`)),this.isDebugging&&console.log(this.timestamp,`[${this.provider.name}]`,i??s,...t),null==this.output||this.level<4||this.output.appendLine(`${this.timestamp} ${i??s}${this.toLoggableParams(!0,t)}`)}error(e,t,...i){if(this.level<1&&!this.isDebugging)return;let r;if(r=null==t||"string"==typeof t?t:`${t.prefix} ${i.shift()??s}`,null==r){const t=e instanceof Error?e.stack:void 0;if(t){const e=/.*\s*?at\s(.+?)\s/.exec(t);null!=e&&(r=e[1])}}this.isDebugging&&console.error(this.timestamp,`[${this.provider.name}]`,r??s,...i,e),null==this.output||this.level<1||this.output.appendLine(`${this.timestamp} ${r??s}${this.toLoggableParams(!1,i)}\n${String(e)}`)}log(e,...t){if(this.level<3&&!this.isDebugging)return;let i;"string"==typeof e?i=e:(i=t.shift(),null!=e&&(i=`${e.prefix} ${i??s}`)),this.isDebugging&&console.log(this.timestamp,`[${this.provider.name}]`,i??s,...t),null==this.output||this.level<3||this.output.appendLine(`${this.timestamp} ${i??s}${this.toLoggableParams(!1,t)}`)}warn(e,...t){if(this.level<2&&!this.isDebugging)return;let i;"string"==typeof e?i=e:(i=t.shift(),null!=e&&(i=`${e.prefix} ${i??s}`)),this.isDebugging&&console.warn(this.timestamp,`[${this.provider.name}]`,i??s,...t),null==this.output||this.level<2||this.output.appendLine(`${this.timestamp} ${i??s}${this.toLoggableParams(!1,t)}`)}showOutputChannel(e){this.output?.show?.(e)}toLoggable(e,t){if("object"!=typeof e)return String(e);if(Array.isArray(e))return`[${e.map((e=>this.toLoggable(e,t))).join(", ")}]`;const i=this.provider.toLoggable?.(e);if(null!=i)return i;try{return JSON.stringify(e,t)}catch{return"<error>"}}toLoggableParams(e,t){if(0===t.length||e&&this.level<4&&!this.isDebugging)return s;const i=t.map((e=>this.toLoggable(e))).join(", ");return 0!==i.length?` — ${i}`:s}};function o(e){switch(e){case r.i.Off:return 0;case r.i.Error:return 1;case r.i.Warn:return 2;case r.i.Info:return 3;case r.i.Debug:return 4;default:return 0}}function a(e){let t;if("function"==typeof e){if(null==e.prototype?.constructor)return e.name;t=e.prototype.constructor.name??s}else t=e.constructor?.name??s;const i=t.indexOf("_");return-1===i?t:t.substr(i+1)}const c={enabled:e=>n.enabled(e),log:(e,t,i,...s)=>{switch(e){case r.i.Error:n.error("",t,i,...s);break;case r.i.Warn:n.warn(t,i,...s);break;case r.i.Info:n.log(t,i,...s);break;default:n.debug(t,i,...s)}}}},9967:(e,t,i)=>{function r(e,t){if(e===t)return!0;if(null==e||null==t)return!1;const i=typeof e;return(i!==typeof t||"string"!==i&&"number"!==i&&"boolean"!==i)&&JSON.stringify(e)===JSON.stringify(t)}function s(e,t){const i=t?.skipPaths?.length?t?.prefix?t.skipPaths.map((e=>`${t.prefix}.${e}`)):t.skipPaths:void 0,r=t?.skipNulls??!1,s=t?.stringify??!1;const n=Object.create(null);return function e(n,o,a){if(!i?.includes(o))if(Object(a)!==a)if(null==a){if(r)return;n[o]=s?"all"==s?JSON.stringify(a):a??null:a}else n[o]="string"==typeof a?a:s?"number"==typeof a||"boolean"==typeof a?a:JSON.stringify(a):a;else if(Array.isArray(a)){const i=a.length;if(0===i)return;if("join"===t?.arrays)n[o]=a.join(",");else for(let t=0;t<i;t++)e(n,`${o}[${t}]`,a[t])}else{const t=Object.entries(a);if(0===t.length)return;for(const[i,r]of t)e(n,o?`${o}.${i}`:i,r)}}(n,t?.prefix??"",e),n}function n(e,t,i){if(null==e&&(e=Object.create(null)),null==i||"boolean"==typeof i&&!i){const{[t]:i,...r}=e;e=r}else e[t]="object"==typeof i?{...i}:i;return e}i.d(t,{iC:()=>n,wy:()=>r,xH:()=>s})},3700:(e,t,i)=>{i.d(t,{$d:()=>y,AH:()=>P,DZ:()=>r.extname,EZ:()=>r.basename,Fd:()=>R,Gf:()=>S,IC:()=>p,M:()=>w,Mh:()=>C,RQ:()=>r.join,UG:()=>v,XX:()=>r.dirname,YP:()=>b,tD:()=>g,tE:()=>A,uo:()=>D});var r=i(6470),s=i(9496),n=i(429),o=i(5255);const a=47,c=/(?<=^\/?)([A-Z])(?=:\/)/,l=/^([a-zA-Z][\w+.-]+):/,h=/\\/g,u=/^[/|\\]~(?:\d+?|external)(?:[/|\\]|$)/,d=/^[/|\\]~(?:\d+?|external)(?:[/|\\]|$)/;function p(e){if("string"==typeof e&&A(e)&&(e=s.Uri.parse(e)),"string"==typeof e)return m(e)?e:`/~0${(e=P(e)).charCodeAt(0)===a?e:`/${e}`}`;let t=e.fsPath;return m(t)?e:(t=P(t),e.with({path:`/~0${t.charCodeAt(0)===a?t:`/${t}`}`}))}function m(e){return u.test(e)}function g(e){return d.test(e)}function f(e,t,i,r){if(0===e.length||0===t.length)return 0;let s;(r??!n.IJ)&&(e=e.toLowerCase(),t=t.toLowerCase());let o=0;for(let r=0;r<e.length&&(s=e[r],s===t[r]);r++)s===i&&(o=r);return o}function w(e){if("string"==typeof e){if(!l.test(e))return P(e);e=s.Uri.parse(e,!0)}return P(e.scheme===o.sN.File?e.fsPath:e.path)}function v(e){return l.exec(e)?.[1]}function y(e,t){return"string"==typeof t&&(t=P(t)).charCodeAt(0)!==a&&(t=`/${t}`),"string"==typeof e&&(e=P(e)).charCodeAt(0)!==a&&(e=`/${e}`),"string"==typeof t?1===t.length||("string"==typeof e?e:e.path).startsWith(t.charCodeAt(t.length-1)===a?t:`${t}/`):"string"==typeof e?1===t.path.length||e.startsWith(t.path.charCodeAt(t.path.length-1)===a?t.path:`${t.path}/`):t.scheme===e.scheme&&t.authority===e.authority&&(1===t.path.length||e.path.startsWith(t.path.charCodeAt(t.path.length-1)===a?t.path:`${t.path}/`))}function b(e){return!A(e)&&(0,r.isAbsolute)(e)}function C(e){return"*"===(0,r.basename)(e)}function A(e){return l.test(e)}function P(e){return e?((e=e.replace(h,"/")).charCodeAt(e.length-1)===a&&(n.ED&&3===e.length&&":"===e[1]||(e=e.slice(0,-1))),n.ED&&(e=e.replace(c,(e=>e.toLowerCase()))),e):e}function S(e,t,i){e=l.test(e)?s.Uri.parse(e,!0).path:P(e);const r=f(`${t=l.test(t)?s.Uri.parse(t,!0).path:P(t)}/`,`${e}/`,"/",i);return r>0?t.substring(r+1):t}function R(e,t){const i=(0,r.dirname)(e);if(!i||"."===i||i===t)return"";if(!t)return i;const[s]=D(i,t);return s}function D(e,t,i=!1,n){if(e=w(e),t){let i;l.test(t)?(i=s.Uri.parse(t,!0),t=w(i)):t=P(t);const r=f(`${t}/`,`${e}/`,"/",n);r>0?(t=e.substring(0,r),e=e.substring(r+1)):e.charCodeAt(0)===a&&(e=e.slice(1)),null!=i&&(t=i.with({path:t}).toString())}else t=P(i?(0,r.dirname)(e):""),e=i?(0,r.basename)(e):e;return[e,t]}},7469:(e,t,i)=>{i.d(t,{HO:()=>n,PK:()=>PromiseCancelledError,PQ:()=>o,Sb:()=>a,ag:()=>h,rX:()=>s,tI:()=>c,xu:()=>l});var r=i(3105);async function*s(e){const t=new Map(e.map(((e,t)=>[t,e.then((e=>({index:t,value:e,status:"fulfilled"})),(e=>({index:t,reason:e,status:"rejected"})))])));for(;t.size;){const e=await Promise.race(t.values());t.delete(e.index),yield e}}class PromiseCancelledError extends Error{constructor(e,t){super(t),this.promise=e}}class PromiseCancelledErrorWithId extends PromiseCancelledError{constructor(e,t,i){super(t,i),this.id=e}}function n(e,t,i={}){return null==t||"number"==typeof t&&t<=0?e:new Promise(((r,s)=>{let n,o,a=!1;"number"==typeof t?n=setTimeout((()=>{"function"==typeof i.onDidCancel?i.onDidCancel(r,s):s(new PromiseCancelledError(e,i.cancelMessage??"TIMED OUT"))}),t):o=t.onCancellationRequested((()=>{o?.dispose(),a||("function"==typeof i.onDidCancel?i.onDidCancel(r,s):s(new PromiseCancelledError(e,i.cancelMessage??"CANCELLED")))})),e.then((()=>{a=!0,null!=n&&clearTimeout(n),o?.dispose(),r(e)}),(e=>{a=!0,null!=n&&clearTimeout(n),o?.dispose(),s(e)}))}))}function o(){const e={pending:!0,promise:void 0,fulfill:void 0,cancel:void 0};return e.promise=new Promise(((t,i)=>{e.fulfill=function(i){e.pending=!1,t(i)},e.cancel=function(){e.pending=!1,i()}})),e}function a(e,t=void 0){return"fulfilled"===e.status?e.value:t}function c(e){return e instanceof Promise||"function"==typeof e?.then}async function l(e,t,i){let s;return null!=t&&"number"!=typeof t?s=new Map((0,r.UI)(e,(e=>[e,t(e)]))):(i=t,s=e),s instanceof Map?new Map(await Promise.all((0,r.UI)(s.entries(),null==i?([e,t])=>t.then((t=>[e,t])):([e,t])=>Promise.race([t,new Promise((r=>setTimeout((()=>r(new PromiseCancelledErrorWithId(e,t,"TIMED OUT"))),i)))]).then((t=>[e,t]))))):Promise.all(null==i?s:s.map((e=>Promise.race([e,new Promise((t=>setTimeout((()=>t(new PromiseCancelledError(e,"TIMED OUT"))),i)))]))))}async function h(){await new Promise((e=>queueMicrotask(e)))}},6398:(e,t,i)=>{i.d(t,{u:()=>c});var r=i(9376),s=i(4336),n=i(8227),o=i(6004);const a=class{constructor(e,t,...i){let a,c;if(this.scope=e,this.instance=`[${String((0,o.OD)()).padStart(5)}] `,"string"!=typeof e&&(a=e,e="",this.instance=""),c="boolean"==typeof t?.log?t.log?{}:void 0:t?.log??{},this.logLevel=t?.logLevel??n.i.Info,this.logProvider=t?.provider??s.Nu,this._time=(0,r.a)(),null!=c){if(!this.logProvider.enabled(this.logLevel))return;i.length?this.logProvider.log(this.logLevel,a,`${this.instance}${e}${c.message??""}${c.suffix??""}`,...i):this.logProvider.log(this.logLevel,a,`${this.instance}${e}${c.message??""}${c.suffix??""}`)}}get startTime(){return this._time}elapsed(){const[e,t]=(0,r.a)(this._time);return 1e3*e+Math.floor(t/1e6)}log(e){this.logCore(this.scope,e,!1)}restart(e){this.logCore(this.scope,e,!0),this._time=(0,r.a)()}stop(e){this.restart(e)}logCore(e,t,i){if(!this.logProvider.enabled(this.logLevel))return;let s;if("string"!=typeof e&&(s=e,e=""),!i)return void this.logProvider.log(this.logLevel,s,`${this.instance}${e}${t?.message??""}${t?.suffix??""}`);const[o,a]=(0,r.a)(this._time),c=1e3*o+Math.floor(a/1e6),l=`${this.instance}${e}${t?.message??""}`;this.logProvider.log(c>250?n.i.Warn:this.logLevel,s,`${l?`${l} `:""}[${c}ms]${t?.suffix??""}`)}static start(e,t,...i){a.watches.get(e)?.log(),a.watches.set(e,new a(e,t,...i))}static log(e,t){a.watches.get(e)?.log(t)}static stop(e,t){a.watches.get(e)?.stop(t),a.watches.delete(e)}};let c=a;c.watches=new Map},3620:(e,t,i)=>{i.d(t,{US:()=>n.U,zY:()=>c,TT:()=>u,j_:()=>d,QC:()=>V,se:()=>p,qq:()=>l,ry:()=>w,yI:()=>v,qk:()=>y,sC:()=>C,Gg:()=>R,dz:()=>U,sX:()=>D,Qu:()=>k,vk:()=>F,Q_:()=>E,eh:()=>$,_6:()=>O,dm:()=>h,pW:()=>x,$G:()=>I,AO:()=>B,ro:()=>W});var r=i(9376),s=i(5255),n=i(3317);let o,a;function c(e,t){null==o&&(o=new Intl.Collator(void 0,{sensitivity:"accent"}));const i=o.compare(e,t);return 0===i?0:i>0?1:-1}function l(e,t){return null==e&&null==t||null!=e&&null!=t&&0===c(e,t)}function h(e,t){return null==a&&(a=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"})),a.compare(e,t)}function u(e,t,i=0,r=e.length,s=0,n=t.length){for(;i<r&&s<n;i++,s++){const r=e.charCodeAt(i),n=t.charCodeAt(s);if(r<n)return-1;if(r>n)return 1}const o=r-i,a=n-s;return o<a?-1:o>a?1:0}function d(e,t,i=0,r=e.length,s=0,n=t.length){for(;i<r&&s<n;i++,s++){const o=e.charCodeAt(i),a=t.charCodeAt(s);if(o===a)continue;const c=o-a;if((32!==c||!T(a))&&(-32!==c||!T(o)))return _(o)&&_(a)?c:u(e.toLowerCase(),t.toLowerCase(),i,r,s,n)}const o=r-i,a=n-s;return o<a?-1:o>a?1:0}function p(e){return e?.replace(/[<>&"]/g,(e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;";default:return e}}))}const m=/[\\`*_{}[\]()#+\-.!]/g,g=/^===/gm,f=/\r?\n/g;function w(e,t={}){return e=e.replace(m,"\\$&").replace(g,"​==="),t.quoted?e.trim().replace(f,"\t\\\n>  "):e}function v(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function y(e){const[t,i]=(0,r.a)(e);return 1e3*t+Math.floor(i/1e6)}const b=["¹","²","³","⁴","⁵","⁶","⁷","⁸","⁹"];function C(e){return b[e-1]??""}const A=/\$\{(?:'.*?[^\\]'|\W*)?(\w*?)(?:'.*?[^\\]'|[\W\d]*)\}/g,P=new Map;function S(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57}function R(e){let t=P.get(e);if(null!=t)return t;t=[];const i=e.length;let r=0;for(;r<i;){const i=e.indexOf("${",r);if(-1===i)break;const s=e.indexOf("}",i);if(-1===s)break;let n=i+2,o="",a="",c="",l=!1,h="right",u="";if("'"===e[n]){const t=++n;if(n=e.indexOf("'",n),-1===n)break;t!==n&&(a=e.slice(t,n)),n++}else if(!S(e.charCodeAt(n))){const t=n++;for(;n<s&&!S(e.charCodeAt(n));)n++;t!==n&&(a=e.slice(t,n))}for(;n<s;){let t=e.charCodeAt(n);if(S(t))o+=e[n++];else{if(124!==t)break;for(;n<s;){if(t=e.charCodeAt(++n),!(t>=48&&t<=57)){63===t?(l=!0,n++):45===t&&(h="left",n++);break}c+=e[n]}}}if(n<s)if("'"===e[n]){const t=++n;if(n=e.indexOf("'",n),-1===n)break;t!==n&&(u=e.slice(t,n)),n++}else if(!S(e.charCodeAt(n))){const t=n++;for(;n<s&&!S(e.charCodeAt(n));)n++;t!==n&&(u=e.slice(t,n))}r=s+1,t.push({key:o,start:i,end:r,options:{prefix:a||void 0,suffix:u||void 0,truncateTo:c?parseInt(c,10):void 0,collapseWhitespace:l,padDirection:h}})}return P.set(e,t),t}function D(e,t){if(null==e||0===e.length)return e;if(null==t)return e.replace(A,"");const i=R(e);if(0===i.length)return e;let r=0,s="";for(const n of i)s+=e.slice(r,n.start)+(t[n.key]??""),r=n.end;return s}async function k(e,t){if(null==e||0===e.length)return e;if(null==t)return e.replace(A,"");const i=R(e);if(0===i.length)return e;let r,s=0,n="";for(const o of i)r=t[o.key],null!=r&&"object"==typeof r&&"function"==typeof r.then&&(r=await r),n+=e.slice(s,o.start)+(r??""),s=o.end;return n}function _(e){return e>=s.mN.a&&e<=s.mN.z}function T(e){return e>=s.mN.A&&e<=s.mN.Z}function F(e,t=0,i=0,r=" "){return 0===t&&0===i?e:`${0===t?"":r.repeat(t)}${e}${0===i?"":r.repeat(i)}`}function E(e,t,i=" ",r){const s=t-(r??U(e));return s<=0?e:i.repeat(s)+e}function $(e,t,i=" ",r){const s=t-(r??U(e));return s<=0?e:e+i.repeat(s)}function O(e,t,i){if(null==i)return`${t} ${e}${1===t?"":"s"}`;const r=1===t?e:i.plural??`${e}s`;return i.only?r:`${0===t?i.zero??t:i.format?.(t)??t}${i.infix??" "}${r}`}function x(e,t){const i=e.indexOf(t);if(-1===i)return[e];const r=e.substring(0,i),s=e.substring(i+t.length);return null!=s?[r,s]:[r]}function I(e,t,i="…",r){if(!e)return e;if(t<=1)return i;if((r=r??U(e))<=t)return e;if(r===e.length)return`${e.substring(0,t-1)}${i}`;let s=Math.floor(t/(r/e.length)),n=U(e.substring(0,s));for(;n<t;)n+=U(e[s++]);return n>=t&&s--,`${e.substring(0,s)}${i}`}function B(e,t,i="…",r){if(!e)return e;if(t<=1)return i;if((r=r??U(e))<=t)return e;if(r===e.length)return`${i}${e.substring(r-t)}`;let s=Math.floor(t/(r/e.length)),n=U(e.substring(0,s));for(;n<t;)n+=U(e[s++]);return n>=t&&s--,`${i}${e.substring(e.length-s)}`}function W(e,t,i="…"){if(!e)return e;if(t<=1)return i;const r=U(e);return r<=t?e:`${e.slice(0,Math.floor(t/2)-1)}${i}${e.slice(r-Math.ceil(t/2))}`}let L;const M=/[^\x20-\x7F\u00a0\u2026]/;function U(e){if(null==e||0===e.length)return 0;if(!M.test(e))return e.length;if(null==L&&(L=function({onlyFirst:e=!1}={}){const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}()),0===(e=e.replace(L,"")).length)return 0;let t=0,i=0,r=0;const s=[...e];for(let e=0;e<s.length;e++){const n=s[e].codePointAt(0);if(!(n<=31||n>=127&&n<=159)&&!(n>=768&&n<=879))if(n>=128512&&n<=128591||n>=127744&&n<=128511||n>=128640&&n<=128767||n>=9728&&n<=9983||n>=9984&&n<=10175||n>=65024&&n<=65039||n>=129280&&n<=129535||n>=65024&&n<=65039||n>=8400&&n<=8447){if(n>=127995&&n<=127999)continue;i++,t+=2}else 8205!==n?(n>65535&&e++,t+=N(n)?2:1):(r++,t-=2)}const n=i-r;return n>1&&(t+=n-1),t}function N(e){return e>=4352&&(e<=4447||9001===e||9002===e||e>=11904&&e<=12871&&12351!==e||e>=12880&&e<=19903||e>=19968&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510||e>=110592&&e<=110593||e>=127488&&e<=127569||e>=131072&&e<=262141)}const G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",H={};function V(e){return null==e||""===e?"":function(e,t,i){const r=[];let s,n=4,o=4,a=3,c="";const l=[];let h,u,d,p,m,g,f;const w={val:i(0),position:t,index:1};for(h=0;h<3;h+=1)r[h]=h;d=0,m=Math.pow(2,2),g=1;for(;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;const v=String.fromCharCode;switch(s=d){case 0:for(d=0,m=Math.pow(2,8),g=1;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;f=v(d);break;case 1:for(d=0,m=Math.pow(2,16),g=1;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;f=v(d);break;case 2:return""}r[3]=f,u=f,l.push(f);for(;;){if(w.index>e)return"";for(d=0,m=Math.pow(2,a),g=1;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;switch(f=d){case 0:for(d=0,m=Math.pow(2,8),g=1;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;r[o++]=v(d),f=o-1,n--;break;case 1:for(d=0,m=Math.pow(2,16),g=1;g!=m;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=t,w.val=i(w.index++)),d|=(p>0?1:0)*g,g<<=1;r[o++]=v(d),f=o-1,n--;break;case 2:return l.join("")}if(0==n&&(n=Math.pow(2,a),a++),r[f])c=r[f];else{if(f!==o)return;c=u+u.charAt(0)}l.push(c),r[o++]=u+c.charAt(0),n--,u=c,0==n&&(n=Math.pow(2,a),a++)}}(e.length,32,(t=>function(e,t){if(!H[e]){H[e]={};for(let t=0;t<e.length;t++)H[e][e.charAt(t)]=t}return H[e][t]}(G,e.charAt(t))))??""}},1526:(e,t,i)=>{i.d(t,{QF:()=>UriTrie,u$:()=>VisitedPathsTrie});var r=i(429),s=i(3105),n=i(3700);function o(e){return 47===(e=(0,n.AH)(e)).charCodeAt(0)&&(e=e.slice(1)),e}class UriTrie{constructor(e){this.normalize=e,this.trie=new PathTrie}clear(){this.trie.clear()}delete(e,t=!0){const{path:i,ignoreCase:r}=this.normalize(e);return this.trie.delete(i,r,t)}get(e){const{path:t,ignoreCase:i}=this.normalize(e);return this.trie.get(t,i)}getChildren(e){const{path:t,ignoreCase:i}=this.normalize(e);return this.trie.getChildren(t,i)}getClosest(e,t,i){const{path:r,ignoreCase:s}=this.normalize(e);return this.trie.getClosest(r,t,i,s)}getDescendants(e,t){if(null==e)return this.trie.getDescendants();const{path:i,ignoreCase:r}=this.normalize(e);return this.trie.getDescendants(i,t,r)}has(e){const{path:t,ignoreCase:i}=this.normalize(e);return this.trie.has(t,i)}set(e,t){const{path:i,ignoreCase:r}=this.normalize(e);return this.trie.set(i,t,r)}}class PathNode{constructor(e){this.path=e}}class PathTrie{constructor(e=o){this.normalize=e,this.root=new PathNode("")}clear(){this.root.children=void 0}delete(e,t,i=!0){let s,n;e=this.normalize(e),t=t??!r.IJ;for(const i of e.split("/")){const e=(s??this.root).children?.get(t?i.toLowerCase():i);if(null==e)return!1;n=s??this.root,s=e}return!!s?.value&&(i&&a(s.value),s.value=void 0,null!=s.children&&0!==s.children.size||null==n?.children||(n.children.delete(t?s.path.toLowerCase():s.path),0===n.children.size&&(n.children=void 0)),!0)}get(e,t){return this.getCore(e,t)}getCore(e,t){let i;e=this.normalize(e),t=t??!r.IJ;for(const r of e.split("/")){const e=(i??this.root).children?.get(t?r.toLowerCase():r);if(null==e)return;i=e}return i?.value}getChildren(e,t){let i;if(e=this.normalize(e),t=t??!r.IJ,e)for(const r of e.split("/")){const e=(i??this.root).children?.get(t?r.toLowerCase():r);if(null==e)return[];i=e}else i=this.root;return null==i?.children?[]:[...(0,s.DZ)(i.children.values(),(e=>e.value||void 0))]}getClosest(e,t,i,s){let n,o;e=this.normalize(e),s=s??!r.IJ;for(const t of e.split("/")){!n?.value||i&&!i?.(n.value)||(o=n);const e=(n??this.root).children?.get(s?t.toLowerCase():t);if(null==e)break;n=e}return t||!n?.value||i&&!i?.(n.value)?o?.value:n.value}*getDescendants(e,t,i){e=e?this.normalize(e):"",i=i??!r.IJ;let s,n="";if(e)for(const t of e.split("/")){const e=(s??this.root).children?.get(i?t.toLowerCase():t);if(null==e)return;s=e,n+=`${e.path}/`}else s=this.root;null!=s?.children&&(yield*function*e(i,r,s){for(const n of i.values()){const i=r?`${r}/${n.path}`:n.path;!n.value||t&&!t?.(n.value)||(yield n.value),null!=n.children&&(yield*e(n.children,i,s))}}(s.children,"",n))}has(e,t){return null!=this.getCore(e,t)}set(e,t,i){e=this.normalize(e),i=i??!r.IJ;let s=this.root;for(const t of e.split("/")){const e=i?t.toLowerCase():t;let r=s.children?.get(e);null==r&&(null==s.children&&(s.children=new Map),r=new PathNode(t),s.children.set(e,r)),s=r}const n=null==s.value;return n||s.value===t||a(s.value),s.value=t,n}}function a(e){null!=e&&"object"==typeof e&&"dispose"in e&&"function"==typeof e.dispose&&e.dispose()}class VisitedPathNode{constructor(e){this.path=e}}class VisitedPathsTrie{constructor(e=o){this.normalize=e,this.root=new VisitedPathNode("")}clear(){this.root.children=void 0}has(e,t){let i;e=this.normalize(e),t=t??!r.IJ;for(const r of e.split("/")){const e=(i??this.root).children?.get(t?r.toLowerCase():r);if(null==e)return!1;i=e}return null!=i}set(e,t){e=this.normalize(e),t=t??!r.IJ;let i=this.root;for(const r of e.split("/")){const e=t?r.toLowerCase():r;let s=i.children?.get(e);null==s&&(null==i.children&&(i.children=new Map),s=new VisitedPathNode(r),i.children.set(e,s)),i=s}}}},2509:(e,t,i)=>{i.d(t,{$S:()=>w,$_:()=>p,$o:()=>v,GC:()=>y,GR:()=>d,JM:()=>f,PH:()=>C,Tc:()=>S,_L:()=>D,aW:()=>m,bM:()=>A,gn:()=>k,hE:()=>g,ic:()=>R,lN:()=>P,pt:()=>b,s5:()=>u});var r=i(9496),s=i(5255),n=i(7462),o=i(9529),a=i(5148),c=i(4336),l=i(3700),h=i(4550);function u(e){const t=e.toString();return r.workspace.textDocuments.find((e=>e.uri.toString()===t))}async function d(e,t){const i=function(e){const t=r.window.activeTextEditor,i=e.toString();for(const e of[...null!=t?[t]:[],...r.window.visibleTextEditors])if(e.document.uri.toString()===i&&null!=e?.viewColumn)return e}(e);return null!=i?(t?.preserveFocus||await r.window.showTextDocument(i.document,{...t,viewColumn:i.viewColumn}),i):A(e,{viewColumn:r.window.activeTextEditor?.viewColumn,...t})}function p(e){const t=new Map(e.map((e=>[e.toString(),e])));for(const e of r.window.visibleTextEditors)null!=e?.viewColumn&&t.delete(e.document.uri.toString());for(const e of t.values())(0,o.dO)("vscode.open",e,{background:!0,preview:!1})}function m(e){const t=r.window.activeTextEditor;return null!=t&&t.document===e?t:void 0}function g(){return!a.D.get("advanced.quickPick.closeOnFocusOut")}function f(e){if(0===r.window.visibleTextEditors.length)return!1;if(null==e)return r.window.visibleTextEditors.some((e=>C(e)));const t=e.toString();return r.window.visibleTextEditors.some((e=>e.document.uri.toString()===t&&C(e)))}function w(e){const t=r.window.activeTextEditor;return null!=t&&t.document===e}function v(e){return e.kind===r.ColorThemeKind.Dark||e.kind===r.ColorThemeKind.HighContrast}function y(e){return e.kind===r.ColorThemeKind.Light||e.kind===r.ColorThemeKind.HighContrastLight}function b(e){return e.scheme===s.sN.Virtual||e.scheme===s.sN.GitHub}function C(e){const t=e.document.uri.scheme;return t!==s.sN.DebugConsole&&t!==s.sN.Output&&t!==s.sN.Terminal}async function A(e,t={}){const{rethrow:i,...a}=t;try{if((0,n.uy)(e)&&(e=e.documentUri()),e.scheme===s.sN.GitLens&&s.ZY[(0,l.DZ)(e.fsPath)])return void await(0,o.dO)("vscode.open",e);const t=await r.workspace.openTextDocument(e);return r.window.showTextDocument(t,{preserveFocus:!1,preview:!0,viewColumn:r.ViewColumn.Active,...a})}catch(t){if((t?.toString()??"").includes("File seems to be binary and cannot be opened as text"))return void await(0,o.dO)("vscode.open",e);if(i)throw t;return void c.Yd.error(t,"openEditor")}}async function P(e,t,i,s=!0){s&&null==r.window.tabGroups.activeTabGroup.activeTab&&(s=!1),await(0,o.dO)("workbench.action.openWalkthrough",{category:`${e}#${t}`,step:i?`${e}#${t}#${i}`:void 0},s)}var S=(e=>(e.CurrentWindow="currentWindow",e.NewWindow="newWindow",e.AddToWorkspace="addToWorkspace",e))(S||{});function R(e,t={location:"currentWindow"}){if("addToWorkspace"!==t?.location)(0,o.dO)("vscode.openFolder",e,{forceNewWindow:"newWindow"===t?.location});else{const i=r.workspace.workspaceFolders?.length??0;r.workspace.updateWorkspaceFolders(i,0,{uri:e,name:t?.name})}}function D(){let e;switch(r.env.appName){case"Visual Studio Code - Insiders":e="code-insiders --wait --reuse-window";break;case"Visual Studio Code - Exploration":e="code-exploration --wait --reuse-window";break;case"VSCodium":e="codium --wait --reuse-window";break;default:e="code --wait --reuse-window"}return e}function k(e){return"input-prompt-links"===e&&(0,h.L5)(r.version,">= 1.76")}},4550:(e,t,i)=>{i.d(t,{L5:()=>o,mL:()=>n,qu:()=>s});var r=i(3620);function s(e,t){return"string"==typeof e&&(e=n(e)),"string"==typeof t&&(t=n(t)),e.major>t.major?1:e.major<t.major?-1:e.minor>t.minor?1:e.minor<t.minor?-1:e.patch>t.patch?1:e.patch<t.patch?-1:void 0===e.pre&&void 0!==t.pre?1:void 0!==e.pre&&void 0===t.pre?-1:void 0!==e.pre&&void 0!==t.pre?(0,r.zY)(e.pre,t.pre):0}function n(e){const[t,i]=e.split("-"),[r,s,n]=t.split(".");return function(e,t,i,r){return{major:"string"==typeof e?parseInt(e,10):e,minor:"string"==typeof t?parseInt(t,10):t,patch:null==i?0:"string"==typeof i?parseInt(i,10):i,pre:r}}(r,s,n,i)}function o(e,t){if(null==e)return!1;const[i,r]=t.split(" ");if("="===i)return 0===s(e,r);if(">"===i)return s(e,r)>0;if(">="===i)return s(e,r)>=0;if("<"===i)return s(e,r)<0;if("<="===i)return s(e,r)<=0;throw new Error(`Unknown operator: ${i}`)}},9701:(e,t,i)=>{function r(e){return null!=e&&("webview"in e&&"webviewItem"in e)}function s(e){return null!=e&&("webview"in e&&"webviewItemGroup"in e)}function n(e){return JSON.stringify(e)}i.d(t,{BH:()=>n,dH:()=>s,tM:()=>r})},5750:(e,t,i)=>{var r;i.r(t),i.d(t,{OpenTelemetryProvider:()=>OpenTelemetryProvider}),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(r||(r={}));var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},s(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return o=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},o.apply(this,arguments)};function a(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function a(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;n&&(n=0,a[0]&&(o=0)),o;)try{if(i=1,r&&(s=2&a[0]?r.return:a[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,a[1])).done)return s;switch(r=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function l(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o}function u(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;"function"==typeof SuppressedError&&SuppressedError;var d="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof i.g?i.g:{},p="1.4.1",m=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var g=function(e){var t=new Set([e]),i=new Set,r=e.match(m);if(!r)return function(){return!1};var s=+r[1],n=+r[2],o=+r[3];if(null!=r[4])return function(t){return t===e};function a(e){return i.add(e),!1}function c(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(i.has(e))return!1;var r=e.match(m);if(!r)return a(e);var l=+r[1],h=+r[2],u=+r[3];return null!=r[4]||s!==l?a(e):0===s?n===h&&o<=u?c(e):a(e):n<=h?c(e):a(e)}}(p),f=p.split(".")[0],w=Symbol.for("opentelemetry.js.api."+f),v=d;function y(e,t,i,r){var s;void 0===r&&(r=!1);var n=v[w]=null!==(s=v[w])&&void 0!==s?s:{version:p};if(!r&&n[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return i.error(o.stack||o.message),!1}if(n.version!==p){o=new Error("@opentelemetry/api: Registration of version v"+n.version+" for "+e+" does not match previously registered API v"+p);return i.error(o.stack||o.message),!1}return n[e]=t,i.debug("@opentelemetry/api: Registered a global for "+e+" v"+p+"."),!0}function b(e){var t,i,r=null===(t=v[w])||void 0===t?void 0:t.version;if(r&&g(r))return null===(i=v[w])||void 0===i?void 0:i[e]}function C(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+p+".");var i=v[w];i&&delete i[e]}var A,P=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o},S=function(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},R=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return D("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return D("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return D("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return D("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return D("verbose",this._namespace,e)},e}();function D(e,t,i){var r=b("diag");if(r)return i.unshift(t),r[e].apply(r,S([],P(i),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(A||(A={}));var k=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o},_=function(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},T=function(){function e(){function e(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=b("diag");if(r)return r[e].apply(r,_([],k(t),!1))}}var t=this;t.setLogger=function(e,i){var r,s,n;if(void 0===i&&(i={logLevel:A.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=o.stack)&&void 0!==r?r:o.message),!1}"number"==typeof i&&(i={logLevel:i});var a=b("diag"),c=function(e,t){function i(i,r){var s=t[i];return"function"==typeof s&&e>=r?s.bind(t):function(){}}return e<A.NONE?e=A.NONE:e>A.ALL&&(e=A.ALL),t=t||{},{error:i("error",A.ERROR),warn:i("warn",A.WARN),info:i("info",A.INFO),debug:i("debug",A.DEBUG),verbose:i("verbose",A.VERBOSE)}}(null!==(s=i.logLevel)&&void 0!==s?s:A.INFO,e);if(a&&!i.suppressOverrideMessage){var l=null!==(n=(new Error).stack)&&void 0!==n?n:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+l),c.warn("Current logger will overwrite one already registered from "+l)}return y("diag",c,t,!0)},t.disable=function(){C("diag",t)},t.createComponentLogger=function(e){return new R(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),F=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o},E=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=F(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,i){var r=new e(this._entries);return r._entries.set(t,i),r},e.prototype.removeEntry=function(t){var i=new e(this._entries);return i._entries.delete(t),i},e.prototype.removeEntries=function(){for(var t,i,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var n=new e(this._entries);try{for(var o=E(r),a=o.next();!a.done;a=o.next()){var c=a.value;n._entries.delete(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return n},e.prototype.clear=function(){return new e},e}(),O=Symbol("BaggageEntryMetadata"),x=T.instance();function I(e){return void 0===e&&(e={}),new $(new Map(Object.entries(e)))}var B,W="=",L=";",M=",",U="baggage";function N(e){var t=e.split(L);if(!(t.length<=0)){var i=t.shift();if(i){var r=i.split(W);if(2===r.length){var s,n,o=decodeURIComponent(r[0].trim()),a=decodeURIComponent(r[1].trim());return t.length>0&&("string"!=typeof(n=t.join(L))&&(x.error("Cannot create baggage metadata from unknown type: "+typeof n),n=""),s={__TYPE__:O,toString:function(){return n}}),{key:o,value:a,metadata:s}}}}}function G(e){return"string"!=typeof e||0===e.length?{}:e.split(M).map((function(e){return N(e)})).filter((function(e){return void 0!==e&&e.value.length>0})).reduce((function(e,t){return e[t.key]=t.value,e}),{})}!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(B||(B={}));var H="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof i.g?i.g:{},V=",",q=["OTEL_SDK_DISABLED"];function Q(e){return q.indexOf(e)>-1}var Y=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function j(e){return Y.indexOf(e)>-1}var z=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function K(e){return z.indexOf(e)>-1}var J=1/0,X=128,Z={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:A.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:J,OTEL_ATTRIBUTE_COUNT_LIMIT:X,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:J,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:X,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:J,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:X,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:B.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function ee(e,t,i){if(void 0!==i[e]){var r=String(i[e]);t[e]="true"===r.toLowerCase()}}function te(e,t,i,r,s){if(void 0===r&&(r=-1/0),void 0===s&&(s=1/0),void 0!==i[e]){var n=Number(i[e]);isNaN(n)||(t[e]=n<r?r:n>s?s:n)}}function ie(e,t,i,r){void 0===r&&(r=V);var s=i[e];"string"==typeof s&&(t[e]=s.split(r).map((function(e){return e.trim()})))}var re={ALL:A.ALL,VERBOSE:A.VERBOSE,DEBUG:A.DEBUG,INFO:A.INFO,WARN:A.WARN,ERROR:A.ERROR,NONE:A.NONE};function se(e,t,i){var r=i[e];if("string"==typeof r){var s=re[r.toUpperCase()];null!=s&&(t[e]=s)}}function ne(e){var t={};for(var i in Z){var r=i;if("OTEL_LOG_LEVEL"===r)se(r,t,e);else if(Q(r))ee(r,t,e);else if(j(r))te(r,t,e);else if(K(r))ie(r,t,e);else{var s=e[r];null!=s&&(t[r]=String(s))}}return t}function oe(){var e=ne(H);return Object.assign({},Z,e)}var ae=T.instance(),ce=1e4;function le(e){return"number"==typeof e?e<=0?he(e,ce):e:function(){var e,t=Number(null!==(e=oe().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)&&void 0!==e?e:oe().OTEL_EXPORTER_OTLP_TIMEOUT);return t<=0?he(t,ce):t}()}function he(e,t){return ae.warn("Timeout must be greater than 0",e),t}var ue,de=function(){function e(){var e=this;this._promise=new Promise((function(t,i){e._resolve=t,e._reject=i}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),pe=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new de}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,u([this._that],h(i),!1))).then((function(e){return t._deferred.resolve(e)}),(function(e){return t._deferred.reject(e)}))}catch(e){this._deferred.reject(e)}}return this._deferred.promise},e}();!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(ue||(ue={}));var me=function(){function e(e){void 0===e&&(e={}),this._sendingPromises=[],this.url=this.getDefaultUrl(e),"string"==typeof e.hostname&&(this.hostname=e.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new pe(this._shutdown,this),this._concurrencyLimit="number"==typeof e.concurrencyLimit?e.concurrencyLimit:1/0,this.timeoutMillis=le(e.timeoutMillis),this.onInit(e)}return e.prototype.export=function(e,t){this._shutdownOnce.isCalled?t({code:ue.FAILED,error:new Error("Exporter has been shutdown")}):this._sendingPromises.length>=this._concurrencyLimit?t({code:ue.FAILED,error:new Error("Concurrent export limit reached")}):this._export(e).then((function(){t({code:ue.SUCCESS})})).catch((function(e){t({code:ue.FAILED,error:e})}))},e.prototype._export=function(e){var t=this;return new Promise((function(i,r){try{ae.debug("items to be sent",e),t.send(e,i,r)}catch(e){r(e)}}))},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype.forceFlush=function(){return Promise.all(this._sendingPromises).then((function(){}))},e.prototype._shutdown=function(){return ae.debug("shutdown started"),this.onShutdown(),this.forceFlush()},e}(),ge=function(e){function t(t,i,r){var s=e.call(this,t)||this;return s.name="OTLPExporterError",s.data=r,s.code=i,s}return n(t,e),t}(Error);function fe(e,t,i,r,s,n){var a,c,l=!1,u=setTimeout((function(){if(clearTimeout(a),l=!0,c.readyState===XMLHttpRequest.DONE){var e=new ge("Request Timeout");n(e)}else c.abort()}),r),d=function(r,p){void 0===r&&(r=5),void 0===p&&(p=1e3),(c=new XMLHttpRequest).open("POST",t);Object.entries(o(o({},{Accept:"application/json","Content-Type":"application/json"}),i)).forEach((function(e){var t=h(e,2),i=t[0],r=t[1];c.setRequestHeader(i,r)})),c.send(e),c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE&&!1===l)if(c.status>=200&&c.status<=299)ae.debug("xhr success",e),s(),clearTimeout(u),clearTimeout(a);else if(c.status&&(o=c.status,[429,502,503,504].includes(o))&&r>0){var t=void 0;p*=1.5,t=c.getResponseHeader("Retry-After")?function(e){if(null==e)return-1;var t=Number.parseInt(e,10);if(Number.isInteger(t))return t>0?1e3*t:-1;var i=new Date(e).getTime()-Date.now();return i>=0?i:0}(c.getResponseHeader("Retry-After")):Math.round(Math.random()*(5e3-p)+p),a=setTimeout((function(){d(r-1,p)}),t)}else{var i=new ge("Failed to export with XHR (status: "+c.status+")",c.status);n(i),clearTimeout(u),clearTimeout(a)}var o},c.onabort=function(){if(l){var e=new ge("Request Timeout");n(e)}clearTimeout(u),clearTimeout(a)},c.onerror=function(){if(l){var e=new ge("Request Timeout");n(e)}clearTimeout(u),clearTimeout(a)}};d()}var we=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;return i._useXHR=!1,i._useXHR=!!t.headers||"function"!=typeof navigator.sendBeacon,i._useXHR?i._headers=Object.assign({},function(e){void 0===e&&(e={});var t={};return Object.entries(e).forEach((function(e){var i=h(e,2),r=i[0],s=i[1];void 0!==s?t[r]=String(s):ae.warn('Header "'+r+'" has wrong value and will be ignored')})),t}(t.headers),G(oe().OTEL_EXPORTER_OTLP_HEADERS)):i._headers={},i}return n(t,e),t.prototype.onInit=function(){window.addEventListener("unload",this.shutdown)},t.prototype.onShutdown=function(){window.removeEventListener("unload",this.shutdown)},t.prototype.send=function(e,t,i){var r=this;if(this._shutdownOnce.isCalled)ae.debug("Shutdown already started. Cannot send objects");else{var s=this.convert(e),n=JSON.stringify(s),o=new Promise((function(e,t){r._useXHR?fe(n,r.url,r._headers,r.timeoutMillis,e,t):function(e,t,i,r,s){navigator.sendBeacon(t,new Blob([e],i))?(ae.debug("sendBeacon - can send",e),r()):s(new ge("sendBeacon - cannot send "+e))}(n,r.url,{type:"application/json"},e,t)})).then(t,i);this._sendingPromises.push(o);var a=function(){var e=r._sendingPromises.indexOf(o);r._sendingPromises.splice(e,1)};o.then(a,a)}},t}(me);function ve(e){return Object.keys(e).map((function(t){return ye(t,e[t])}))}function ye(e,t){return{key:e,value:be(t)}}function be(e){var t=typeof e;return"string"===t?{stringValue:e}:"number"===t?Number.isInteger(e)?{intValue:e}:{doubleValue:e}:"boolean"===t?{boolValue:e}:e instanceof Uint8Array?{bytesValue:e}:Array.isArray(e)?{arrayValue:{values:e.map(be)}}:"object"===t&&null!=e?{kvlistValue:{values:Object.entries(e).map((function(e){var t=h(e,2);return ye(t[0],t[1])}))}}:{}}var Ce=performance,Ae=Math.pow(10,6),Pe=Math.pow(10,9);function Se(e){var t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*Ae)]}function Re(){var e=Ce.timeOrigin;if("number"!=typeof e){var t=Ce;e=t.timing&&t.timing.fetchStart}return e}function De(e){return Fe(Se(Re()),Se("number"==typeof e?e:Ce.now()))}function ke(e){return e[0]*Pe+e[1]}function _e(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function Te(e){return _e(e)||"number"==typeof e||e instanceof Date}function Fe(e,t){var i=[e[0]+t[0],e[1]+t[1]];return i[1]>=Pe&&(i[1]-=Pe,i[0]+=1),i}function Ee(e){for(var t=e.length,i="",r=0;r<t;r+=2){var s=e.substring(r,r+2),n=parseInt(s,16);i+=String.fromCharCode(n)}return btoa(i)}function $e(e,t){var i,r=e.spanContext(),s=e.status,n=t?e.parentSpanId:null!=e.parentSpanId?Ee(e.parentSpanId):void 0;return{traceId:t?r.traceId:Ee(r.traceId),spanId:t?r.spanId:Ee(r.spanId),parentSpanId:n,traceState:null===(i=r.traceState)||void 0===i?void 0:i.serialize(),name:e.name,kind:null==e.kind?0:e.kind+1,startTimeUnixNano:ke(e.startTime),endTimeUnixNano:ke(e.endTime),attributes:ve(e.attributes),droppedAttributesCount:e.droppedAttributesCount,events:e.events.map(Oe),droppedEventsCount:e.droppedEventsCount,status:{code:s.code,message:s.message},links:e.links.map((function(e){return function(e,t){var i;return{attributes:e.attributes?ve(e.attributes):[],spanId:t?e.context.spanId:Ee(e.context.spanId),traceId:t?e.context.traceId:Ee(e.context.traceId),traceState:null===(i=e.context.traceState)||void 0===i?void 0:i.serialize(),droppedAttributesCount:e.droppedAttributesCount||0}}(e,t)})),droppedLinksCount:e.droppedLinksCount}}function Oe(e){return{attributes:e.attributes?ve(e.attributes):[],name:e.name,timeUnixNano:ke(e.time),droppedAttributesCount:e.droppedAttributesCount||0}}function xe(e,t){for(var i=function(e){var t,i,r=new Map;try{for(var s=l(e),n=s.next();!n.done;n=s.next()){var o=n.value,a=r.get(o.resource);a||(a=new Map,r.set(o.resource,a));var c=o.instrumentationLibrary.name+"@"+(o.instrumentationLibrary.version||"")+":"+(o.instrumentationLibrary.schemaUrl||""),h=a.get(c);h||(h=[],a.set(c,h)),h.push(o)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return r}(e),r=[],s=i.entries(),n=s.next();!n.done;){for(var o=h(n.value,2),a=o[0],c=[],u=o[1].values(),d=u.next();!d.done;){var p=d.value;if(p.length>0){var m=p[0].instrumentationLibrary,g=m.name,f=m.version,w=m.schemaUrl,v=p.map((function(e){return $e(e,t)}));c.push({scope:{name:g,version:f},spans:v,schemaUrl:w})}d=u.next()}var y={resource:{attributes:ve(a.attributes),droppedAttributesCount:0},scopeSpans:c,schemaUrl:void 0};r.push(y),n=s.next()}return r}var Ie,Be="v1/traces",We="http://localhost:4318/"+Be,Le=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;return i._headers=Object.assign(i._headers,G(oe().OTEL_EXPORTER_OTLP_TRACES_HEADERS)),i}return n(t,e),t.prototype.convert=function(e){return function(e,t){return{resourceSpans:xe(e,t)}}(e,!0)},t.prototype.getDefaultUrl=function(e){return"string"==typeof e.url?e.url:oe().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?function(e){try{var t=new URL(e);return""===t.pathname&&(t.pathname=t.pathname+"/"),t.toString()}catch(t){return ae.warn("Could not parse export URL: '"+e+"'"),e}}(oe().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT):oe().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?(t=oe().OTEL_EXPORTER_OTLP_ENDPOINT,i=Be,t.endsWith("/")||(t+="/"),t+i):We;var t,i},t}(we),Me="deployment.environment",Ue="device.id",Ne="os.type",Ge="process.runtime.name",He="service.name",Ve="service.version",qe="telemetry.sdk.name",Qe="telemetry.sdk.language",Ye="telemetry.sdk.version",je=((Ie={})[qe]="opentelemetry",Ie[Ge]="browser",Ie[Qe]="webjs",Ie[Ye]="1.15.0",Ie);var ze=function(){function e(e,t){var i,r=this;this._attributes=e,this.asyncAttributesPending=null!=t,this._syncAttributes=null!==(i=this._attributes)&&void 0!==i?i:{},this._asyncAttributesPromise=null==t?void 0:t.then((function(e){return r._attributes=Object.assign({},r._attributes,e),r.asyncAttributesPending=!1,e}),(function(e){return ae.debug("a resource's async attributes promise rejected: %s",e),r.asyncAttributesPending=!1,{}}))}return e.empty=function(){return e.EMPTY},e.default=function(){var t;return new e(((t={})[He]="unknown_service",t[Qe]=je[Qe],t[qe]=je[qe],t[Ye]=je[Ye],t))},Object.defineProperty(e.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&ae.error("Accessing resource attributes before async attributes settled"),null!==(e=this._attributes)&&void 0!==e?e:{}},enumerable:!1,configurable:!0}),e.prototype.waitForAsyncAttributes=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.merge=function(t){var i,r=this;if(!t)return this;var s=o(o({},this._syncAttributes),null!==(i=t._syncAttributes)&&void 0!==i?i:t.attributes);if(!this._asyncAttributesPromise&&!t._asyncAttributesPromise)return new e(s);var n=Promise.all([this._asyncAttributesPromise,t._asyncAttributesPromise]).then((function(e){var i,s=h(e,2),n=s[0],a=s[1];return o(o(o(o({},r._syncAttributes),n),null!==(i=t._syncAttributes)&&void 0!==i?i:t.attributes),a)}));return new e(s,n)},e.EMPTY=new e({}),e}();function Ke(e){return Symbol.for(e)}var Je,Xe=new function e(t){var i=this;i._currentContext=t?new Map(t):new Map,i.getValue=function(e){return i._currentContext.get(e)},i.setValue=function(t,r){var s=new e(i._currentContext);return s._currentContext.set(t,r),s},i.deleteValue=function(t){var r=new e(i._currentContext);return r._currentContext.delete(t),r}},Ze=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o},et=function(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},tt=function(){function e(){}return e.prototype.active=function(){return Xe},e.prototype.with=function(e,t,i){for(var r=[],s=3;s<arguments.length;s++)r[s-3]=arguments[s];return t.call.apply(t,et([i],Ze(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),it=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,s,n=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=n.next()).done;)o.push(r.value)}catch(e){s={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(s)throw s.error}}return o},rt=function(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))},st="context",nt=new tt,ot=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return y(st,e,T.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,i){for(var r,s=[],n=3;n<arguments.length;n++)s[n-3]=arguments[n];return(r=this._getContextManager()).with.apply(r,rt([e,t,i],it(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return b(st)||nt},e.prototype.disable=function(){this._getContextManager().disable(),C(st,T.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Je||(Je={}));var at="0000000000000000",ct="00000000000000000000000000000000",lt={traceId:ct,spanId:at,traceFlags:Je.NONE},ht=function(){function e(e){void 0===e&&(e=lt),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),ut=Ke("OpenTelemetry Context Key SPAN");function dt(e){return e.getValue(ut)||void 0}function pt(){return dt(ot.getInstance().active())}function mt(e,t){return e.setValue(ut,t)}function gt(e){return e.deleteValue(ut)}function ft(e,t){return mt(e,new ht(t))}function wt(e){var t;return null===(t=dt(e))||void 0===t?void 0:t.spanContext()}var vt=/^([0-9a-f]{32})$/i,yt=/^[0-9a-f]{16}$/i;function bt(e){return vt.test(e)&&e!==ct}function Ct(e){return bt(e.traceId)&&(t=e.spanId,yt.test(t)&&t!==at);var t}function At(e){return new ht(e)}var Pt=ot.getInstance(),St=function(){function e(){}return e.prototype.startSpan=function(e,t,i){if(void 0===i&&(i=Pt.active()),Boolean(null==t?void 0:t.root))return new ht;var r,s=i&&wt(i);return"object"==typeof(r=s)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&Ct(s)?new ht(s):new ht},e.prototype.startActiveSpan=function(e,t,i,r){var s,n,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(s=t,o=i):(s=t,n=i,o=r);var a=null!=n?n:Pt.active(),c=this.startSpan(e,s,a),l=mt(a,c);return Pt.with(l,o,void 0,c)}},e}();var Rt=new St,Dt=function(){function e(e,t,i,r){this._provider=e,this.name=t,this.version=i,this.options=r}return e.prototype.startSpan=function(e,t,i){return this._getTracer().startSpan(e,t,i)},e.prototype.startActiveSpan=function(e,t,i,r){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Rt},e}(),kt=new(function(){function e(){}return e.prototype.getTracer=function(e,t,i){return new St},e}()),_t=function(){function e(){}return e.prototype.getTracer=function(e,t,i){var r;return null!==(r=this.getDelegateTracer(e,t,i))&&void 0!==r?r:new Dt(this,e,t,i)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:kt},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,i){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,i)},e}(),Tt="trace",Ft=function(){function e(){this._proxyTracerProvider=new _t,this.wrapSpanContext=At,this.isSpanContextValid=Ct,this.deleteSpan=gt,this.getSpan=dt,this.getActiveSpan=pt,this.getSpanContext=wt,this.setSpan=mt,this.setSpanContext=ft}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=y(Tt,this._proxyTracerProvider,T.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return b(Tt)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){C(Tt,T.instance()),this._proxyTracerProvider=new _t},e}().getInstance(),Et=ot.getInstance(),$t=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),Ot={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},xt={set:function(e,t,i){null!=e&&(e[t]=i)}},It=Ke("OpenTelemetry Baggage Key");function Bt(e){return e.getValue(It)||void 0}function Wt(){return Bt(ot.getInstance().active())}function Lt(e,t){return e.setValue(It,t)}function Mt(e){return e.deleteValue(It)}var Ut,Nt,Gt="propagation",Ht=new $t,Vt=function(){function e(){this.createBaggage=I,this.getBaggage=Bt,this.getActiveBaggage=Wt,this.setBaggage=Lt,this.deleteBaggage=Mt}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return y(Gt,e,T.instance())},e.prototype.inject=function(e,t,i){return void 0===i&&(i=xt),this._getGlobalPropagator().inject(e,t,i)},e.prototype.extract=function(e,t,i){return void 0===i&&(i=Ot),this._getGlobalPropagator().extract(e,t,i)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){C(Gt,T.instance())},e.prototype._getGlobalPropagator=function(){return b(Gt)||Ht},e}().getInstance(),qt="[object Object]",Qt="[object Null]",Yt="[object Undefined]",jt=Function.prototype.toString,zt=jt.call(Object),Kt=(Ut=Object.getPrototypeOf,Nt=Object,function(e){return Ut(Nt(e))}),Jt=Object.prototype,Xt=Jt.hasOwnProperty,Zt=Symbol?Symbol.toStringTag:void 0,ei=Jt.toString;function ti(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||function(e){if(null==e)return void 0===e?Yt:Qt;return Zt&&Zt in Object(e)?function(e){var t=Xt.call(e,Zt),i=e[Zt],r=!1;try{e[Zt]=void 0,r=!0}catch(e){}var s=ei.call(e);r&&(t?e[Zt]=i:delete e[Zt]);return s}(e):function(e){return ei.call(e)}(e)}(e)!==qt)return!1;var t=Kt(e);if(null===t)return!0;var i=Xt.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&jt.call(i)===zt}var ii=20;function ri(e){return oi(e)?e.slice():e}function si(e,t,i,r){var s;if(void 0===i&&(i=0),!(i>ii)){if(i++,li(e)||li(t)||ai(t))s=ri(t);else if(oi(e)){if(s=e.slice(),oi(t))for(var n=0,o=t.length;n<o;n++)s.push(ri(t[n]));else if(ci(t))for(n=0,o=(a=Object.keys(t)).length;n<o;n++){s[c=a[n]]=ri(t[c])}}else if(ci(e))if(ci(t)){if(!function(e,t){if(!ti(e)||!ti(t))return!1;return!0}(e,t))return t;s=Object.assign({},e);var a;for(n=0,o=(a=Object.keys(t)).length;n<o;n++){var c,l=t[c=a[n]];if(li(l))void 0===l?delete s[c]:s[c]=l;else{var h=s[c],u=l;if(ni(e,c,r)||ni(t,c,r))delete s[c];else{if(ci(h)&&ci(u)){var d=r.get(h)||[],p=r.get(u)||[];d.push({obj:e,key:c}),p.push({obj:t,key:c}),r.set(h,d),r.set(u,p)}s[c]=si(s[c],l,i,r)}}}}else s=t;return s}}function ni(e,t,i){for(var r=i.get(e[t])||[],s=0,n=r.length;s<n;s++){var o=r[s];if(o.key===t&&o.obj===e)return!0}return!1}function oi(e){return Array.isArray(e)}function ai(e){return"function"==typeof e}function ci(e){return!li(e)&&!oi(e)&&!ai(e)&&"object"==typeof e}function li(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||e instanceof Date||e instanceof RegExp||null===e}var hi=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((function(e){return"function"==typeof e.fields?e.fields():[]})).reduce((function(e,t){return e.concat(t)}),[])))}return e.prototype.inject=function(e,t,i){var r,s;try{for(var n=l(this._propagators),o=n.next();!o.done;o=n.next()){var a=o.value;try{a.inject(e,t,i)}catch(e){ae.warn("Failed to inject with "+a.constructor.name+". Err: "+e.message)}}}catch(e){r={error:e}}finally{try{o&&!o.done&&(s=n.return)&&s.call(n)}finally{if(r)throw r.error}}},e.prototype.extract=function(e,t,i){return this._propagators.reduce((function(e,r){try{return r.extract(e,t,i)}catch(e){ae.warn("Failed to inject with "+r.constructor.name+". Err: "+e.message)}return e}),e)},e.prototype.fields=function(){return this._fields.slice()},e}(),ui=Ke("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function di(e){return e.setValue(ui,!0)}function pi(e){return!0===e.getValue(ui)}var mi="[_0-9a-z-*/]",gi=new RegExp("^(?:"+("[a-z]"+mi+"{0,255}")+"|"+("[a-z0-9]"+mi+"{0,240}@[a-z]"+mi+"{0,13}")+")$"),fi=/^[ -~]{0,255}[!-~]$/,wi=/,|=/;var vi=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var i=this._clone();return i._internalState.has(e)&&i._internalState.delete(e),i._internalState.set(e,t),i},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,i){return t.push(i+"="+e.get(i)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var i=t.trim(),r=i.indexOf("=");if(-1!==r){var s=i.slice(0,r),n=i.slice(r+1,t.length);(function(e){return gi.test(e)})(s)&&function(e){return fi.test(e)&&!wi.test(e)}(n)&&e.set(s,n)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),yi="traceparent",bi="tracestate",Ci=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");var Ai,Pi,Si=function(){function e(){}return e.prototype.inject=function(e,t,i){var r=Ft.getSpanContext(e);if(r&&!pi(e)&&Ct(r)){var s="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||Je.NONE).toString(16);i.set(t,yi,s),r.traceState&&i.set(t,bi,r.traceState.serialize())}},e.prototype.extract=function(e,t,i){var r=i.get(t,yi);if(!r)return e;var s=Array.isArray(r)?r[0]:r;if("string"!=typeof s)return e;var n=function(e){var t=Ci.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(s);if(!n)return e;n.isRemote=!0;var o=i.get(t,bi);if(o){var a=Array.isArray(o)?o.join(","):o;n.traceState=new vi("string"==typeof a?a:void 0)}return Ft.setSpanContext(e,n)},e.prototype.fields=function(){return[yi,bi]},e}(),Ri=function(){function e(){}return e.prototype.inject=function(e,t,i){var r=Vt.getBaggage(e);if(r&&!pi(e)){var s=function(e){return e.getAllEntries().map((function(e){var t=h(e,2),i=t[0],r=t[1],s=encodeURIComponent(i)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(s+=L+r.metadata.toString()),s}))}(r).filter((function(e){return e.length<=4096})).slice(0,180),n=function(e){return e.reduce((function(e,t){var i=""+e+(""!==e?M:"")+t;return i.length>8192?e:i}),"")}(s);n.length>0&&i.set(t,U,n)}},e.prototype.extract=function(e,t,i){var r=i.get(t,U),s=Array.isArray(r)?r.join(M):r;if(!s)return e;var n={};return 0===s.length?e:(s.split(M).forEach((function(e){var t=N(e);if(t){var i={value:t.value};t.metadata&&(i.metadata=t.metadata),n[t.key]=i}})),0===Object.entries(n).length?e:Vt.setBaggage(e,Vt.createBaggage(n)))},e.prototype.fields=function(){return[U]},e}();function Di(e){var t,i,r={};if("object"!=typeof e||null==e)return r;try{for(var s=l(Object.entries(e)),n=s.next();!n.done;n=s.next()){var o=h(n.value,2),a=o[0],c=o[1];ki(a)?_i(c)?Array.isArray(c)?r[a]=c.slice():r[a]=c:ae.warn("Invalid attribute value set for key: "+a):ae.warn("Invalid attribute key: "+a)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return r}function ki(e){return"string"==typeof e&&e.length>0}function _i(e){return null==e||(Array.isArray(e)?function(e){var t,i,r;try{for(var s=l(e),n=s.next();!n.done;n=s.next()){var o=n.value;if(null!=o){if(!r){if(Ti(o)){r=typeof o;continue}return!1}if(typeof o!==r)return!1}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return!0}(e):Ti(e))}function Ti(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Ai||(Ai={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(Pi||(Pi={}));var Fi,Ei="exception.type",$i="exception.message",Oi="exception.stacktrace",xi=function(){function e(e,t,i,r,s,n,o,a,c){void 0===o&&(o=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Pi.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=i,this._spanContext=r,this.parentSpanId=n,this.kind=s,this.links=o;var l=Date.now();this._performanceStartTime=Ce.now(),this._performanceOffset=l-(this._performanceStartTime+Re()),this._startTimeProvided=null!=a,this.startTime=this._getTime(null!=a?a:l),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return null==t||this._isSpanEnded()?this:0===e.length?(ae.warn("Invalid attribute key: "+e),this):_i(t)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(t),this):(ae.warn("Invalid attribute value set for key: "+e),this)},e.prototype.setAttributes=function(e){var t,i;try{for(var r=l(Object.entries(e)),s=r.next();!s.done;s=r.next()){var n=h(s.value,2),o=n[0],a=n[1];this.setAttribute(o,a)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return this},e.prototype.addEvent=function(e,t,i){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return ae.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(ae.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Te(t)&&(Te(i)||(i=t),t=void 0);var r=Di(t);return this.events.push({name:e,attributes:r,time:this._getTime(i),droppedAttributesCount:0}),this},e.prototype.setStatus=function(e){return this._isSpanEnded()||(this.status=e),this},e.prototype.updateName=function(e){return this._isSpanEnded()||(this.name=e),this},e.prototype.end=function(e){this._isSpanEnded()?ae.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(e),this._duration=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return r<0&&(i-=1,r+=Pe),[i,r]}(this.startTime,this.endTime),this._duration[0]<0&&(ae.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this))},e.prototype._getTime=function(e){if("number"==typeof e&&e<Ce.now())return De(e+this._performanceOffset);if("number"==typeof e)return Se(e);if(e instanceof Date)return Se(e.getTime());if(_e(e))return e;if(this._startTimeProvided)return Se(Date.now());var t=Ce.now()-this._performanceStartTime;return Fe(this.startTime,Se(t))},e.prototype.isRecording=function(){return!1===this._ended},e.prototype.recordException=function(e,t){var i={};"string"==typeof e?i[$i]=e:e&&(e.code?i[Ei]=e.code.toString():e.name&&(i[Ei]=e.name),e.message&&(i[$i]=e.message),e.stack&&(i[Oi]=e.stack)),i[Ei]||i[$i]?this.addEvent("exception",i,t):ae.warn("Failed to record an exception "+e)},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),e.prototype._isSpanEnded=function(){return this._ended&&ae.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},e.prototype._truncateToLimitUtil=function(e,t){return e.length<=t?e:e.substr(0,t)},e.prototype._truncateToSize=function(e){var t=this,i=this._attributeValueLengthLimit;return i<=0?(ae.warn("Attribute value limit must be positive, got "+i),e):"string"==typeof e?this._truncateToLimitUtil(e,i):Array.isArray(e)?e.map((function(e){return"string"==typeof e?t._truncateToLimitUtil(e,i):e})):e},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Fi||(Fi={}));var Ii=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Fi.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),Bi=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Fi.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}();var Wi=function(e){ae.error(function(e){return"string"==typeof e?e:JSON.stringify(function(e){for(var t={},i=e;null!==i;)Object.getOwnPropertyNames(i).forEach((function(e){if(!t[e]){var r=i[e];r&&(t[e]=String(r))}})),i=Object.getPrototypeOf(i);return t}(e))}(e))};function Li(e){try{Wi(e)}catch(e){}}var Mi=function(){function e(e){var t,i,r,s;this._root=e.root,this._root||(Li(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Bi),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new Bi,this._remoteParentNotSampled=null!==(i=e.remoteParentNotSampled)&&void 0!==i?i:new Ii,this._localParentSampled=null!==(r=e.localParentSampled)&&void 0!==r?r:new Bi,this._localParentNotSampled=null!==(s=e.localParentNotSampled)&&void 0!==s?s:new Ii}return e.prototype.shouldSample=function(e,t,i,r,s,n){var o=Ft.getSpanContext(e);return o&&Ct(o)?o.isRemote?o.traceFlags&Je.SAMPLED?this._remoteParentSampled.shouldSample(e,t,i,r,s,n):this._remoteParentNotSampled.shouldSample(e,t,i,r,s,n):o.traceFlags&Je.SAMPLED?this._localParentSampled.shouldSample(e,t,i,r,s,n):this._localParentNotSampled.shouldSample(e,t,i,r,s,n):this._root.shouldSample(e,t,i,r,s,n)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),Ui=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:bt(t)&&this._accumulate(t)<this._upperBound?Fi.RECORD_AND_SAMPLED:Fi.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,i=0;i<e.length/8;i++){var r=8*i;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t},e}(),Ni=oe(),Gi=B.AlwaysOn,Hi=1;function Vi(){return{sampler:qi(Ni),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:oe().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:oe().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:oe().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:oe().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:oe().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:oe().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:oe().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:oe().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function qi(e){switch(void 0===e&&(e=oe()),e.OTEL_TRACES_SAMPLER){case B.AlwaysOn:return new Bi;case B.AlwaysOff:return new Ii;case B.ParentBasedAlwaysOn:return new Mi({root:new Bi});case B.ParentBasedAlwaysOff:return new Mi({root:new Ii});case B.TraceIdRatio:return new Ui(Qi(e));case B.ParentBasedTraceIdRatio:return new Mi({root:new Ui(Qi(e))});default:return ae.error('OTEL_TRACES_SAMPLER value "'+e.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Gi+'".'),new Bi}}function Qi(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return ae.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+Hi+"."),Hi;var t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(ae.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+Hi+"."),Hi):t<0||t>1?(ae.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+Hi+"."),Hi):t}function Yi(e){var t,i,r,s,n,o,a,c,l,h,u,d,p=Object.assign({},e.spanLimits),m="undefined"!=typeof process&&process&&process.env?ne(process.env):ne(H);return p.attributeCountLimit=null!==(o=null!==(n=null!==(s=null!==(i=null===(t=e.spanLimits)||void 0===t?void 0:t.attributeCountLimit)&&void 0!==i?i:null===(r=e.generalLimits)||void 0===r?void 0:r.attributeCountLimit)&&void 0!==s?s:m.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)&&void 0!==n?n:m.OTEL_ATTRIBUTE_COUNT_LIMIT)&&void 0!==o?o:X,p.attributeValueLengthLimit=null!==(d=null!==(u=null!==(h=null!==(c=null===(a=e.spanLimits)||void 0===a?void 0:a.attributeValueLengthLimit)&&void 0!==c?c:null===(l=e.generalLimits)||void 0===l?void 0:l.attributeValueLengthLimit)&&void 0!==h?h:m.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==u?u:m.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==d?d:J,Object.assign({},e,{spanLimits:p})}var ji=function(){this.generateTraceId=Ki(16),this.generateSpanId=Ki(8)},zi=Array(32);function Ki(e){return function(){for(var t=0;t<2*e;t++)zi[t]=Math.floor(16*Math.random())+48,zi[t]>=58&&(zi[t]+=39);return String.fromCharCode.apply(null,zi.slice(0,2*e))}}var Ji=function(){function e(e,t,i){this._tracerProvider=i;var r,s,n,o,a=(r=t,s={sampler:qi()},n=Vi(),(o=Object.assign({},n,s,r)).generalLimits=Object.assign({},n.generalLimits,r.generalLimits||{}),o.spanLimits=Object.assign({},n.spanLimits,r.spanLimits||{}),o);this._sampler=a.sampler,this._generalLimits=a.generalLimits,this._spanLimits=a.spanLimits,this._idGenerator=t.idGenerator||new ji,this.resource=i.resource,this.instrumentationLibrary=e}return e.prototype.startSpan=function(e,t,i){var s,n,o;void 0===t&&(t={}),void 0===i&&(i=Et.active()),t.root&&(i=Ft.deleteSpan(i));var a=Ft.getSpan(i);if(pi(i))return ae.debug("Instrumentation suppressed, returning Noop Span"),Ft.wrapSpanContext(lt);var c,l,h,u=null==a?void 0:a.spanContext(),d=this._idGenerator.generateSpanId();u&&Ft.isSpanContextValid(u)?(c=u.traceId,l=u.traceState,h=u.spanId):c=this._idGenerator.generateTraceId();var p=null!==(s=t.kind)&&void 0!==s?s:r.INTERNAL,m=(null!==(n=t.links)&&void 0!==n?n:[]).map((function(e){return{context:e.context,attributes:Di(e.attributes)}})),g=Di(t.attributes),f=this._sampler.shouldSample(i,c,e,p,g,m);l=null!==(o=f.traceState)&&void 0!==o?o:l;var w={traceId:c,spanId:d,traceFlags:f.decision===Ai.RECORD_AND_SAMPLED?Je.SAMPLED:Je.NONE,traceState:l};if(f.decision===Ai.NOT_RECORD)return ae.debug("Recording is off, propagating context in a non-recording span"),Ft.wrapSpanContext(w);var v=new xi(this,i,e,w,p,h,m,t.startTime),y=Di(Object.assign(g,f.attributes));return v.setAttributes(y),v},e.prototype.startActiveSpan=function(e,t,i,r){var s,n,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(s=t,o=i):(s=t,n=i,o=r);var a=null!=n?n:Et.active(),c=this.startSpan(e,s,a),l=Ft.setSpan(a,c);return Et.with(l,o,void 0,c)}},e.prototype.getGeneralLimits=function(){return this._generalLimits},e.prototype.getSpanLimits=function(){return this._spanLimits},e.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},e}(),Xi=function(){function e(e){this._spanProcessors=e}return e.prototype.forceFlush=function(){var e,t,i=[];try{for(var r=l(this._spanProcessors),s=r.next();!s.done;s=r.next()){var n=s.value;i.push(n.forceFlush())}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e){Promise.all(i).then((function(){e()})).catch((function(t){Li(t||new Error("MultiSpanProcessor: forceFlush failed")),e()}))}))},e.prototype.onStart=function(e,t){var i,r;try{for(var s=l(this._spanProcessors),n=s.next();!n.done;n=s.next()){n.value.onStart(e,t)}}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}},e.prototype.onEnd=function(e){var t,i;try{for(var r=l(this._spanProcessors),s=r.next();!s.done;s=r.next()){s.value.onEnd(e)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.shutdown=function(){var e,t,i=[];try{for(var r=l(this._spanProcessors),s=r.next();!s.done;s=r.next()){var n=s.value;i.push(n.shutdown())}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e,t){Promise.all(i).then((function(){e()}),t)}))},e}(),Zi=function(){function e(){}return e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){},e.prototype.shutdown=function(){return Promise.resolve()},e.prototype.forceFlush=function(){return Promise.resolve()},e}();var er,tr=function(){function e(e,t){this._exporter=e,this._finishedSpans=[],this._droppedSpansCount=0;var i=oe();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:i.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:i.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:i.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:i.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new pe(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(ae.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return e.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){this._shutdownOnce.isCalled||0!=(e.spanContext().traceFlags&Je.SAMPLED)&&this._addToBuffer(e)},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){var e=this;return Promise.resolve().then((function(){return e.onShutdown()})).then((function(){return e._flushAll()})).then((function(){return e._exporter.shutdown()}))},e.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize)return 0===this._droppedSpansCount&&ae.debug("maxQueueSize reached, dropping spans"),void this._droppedSpansCount++;this._droppedSpansCount>0&&(ae.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},e.prototype._flushAll=function(){var e=this;return new Promise((function(t,i){for(var r=[],s=0,n=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize);s<n;s++)r.push(e._flushOneBatch());Promise.all(r).then((function(){t()})).catch(i)}))},e.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(t,i){var r=setTimeout((function(){i(new Error("Timeout"))}),e._exportTimeoutMillis);Et.with(di(Et.active()),(function(){var s=e._finishedSpans.splice(0,e._maxExportBatchSize),n=function(){return e._exporter.export(s,(function(e){var s;clearTimeout(r),e.code===ue.SUCCESS?t():i(null!==(s=e.error)&&void 0!==s?s:new Error("BatchSpanProcessor: span export failed"))}))},o=s.map((function(e){return e.resource})).filter((function(e){return e.asyncAttributesPending}));0===o.length?n():Promise.all(o.map((function(e){var t;return null===(t=e.waitForAsyncAttributes)||void 0===t?void 0:t.call(e)}))).then(n,(function(e){Li(e),i(e)}))}))}))},e.prototype._maybeStartTimer=function(){var e=this;void 0===this._timer&&(this._timer=setTimeout((function(){e._flushOneBatch().then((function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())})).catch((function(e){Li(e)}))}),this._scheduledDelayMillis),this._timer)},e.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},e}(),ir=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.onInit(i),r}return n(t,e),t.prototype.onInit=function(e){var t=this;!0!==(null==e?void 0:e.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&t.forceFlush()},this._pageHideListener=function(){t.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t}(tr);!function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"}(er||(er={}));var rr=function(){function e(e){var t;void 0===e&&(e={}),this._registeredSpanProcessors=[],this._tracers=new Map;var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=e.shift(),r=new WeakMap;e.length>0;)i=si(i,e.shift(),0,r);return i}({},Vi(),Yi(e));this.resource=null!==(t=i.resource)&&void 0!==t?t:ze.empty(),this.resource=ze.default().merge(this.resource),this._config=Object.assign({},i,{resource:this.resource});var r=this._buildExporterFromEnv();if(void 0!==r){var s=new ir(r);this.activeSpanProcessor=s}else this.activeSpanProcessor=new Zi}return e.prototype.getTracer=function(e,t,i){var r=e+"@"+(t||"")+":"+((null==i?void 0:i.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new Ji({name:e,version:t,schemaUrl:null==i?void 0:i.schemaUrl},this._config,this)),this._tracers.get(r)},e.prototype.addSpanProcessor=function(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((function(e){return ae.error("Error while trying to shutdown current span processor",e)})),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new Xi(this._registeredSpanProcessors)},e.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},e.prototype.register=function(e){void 0===e&&(e={}),Ft.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Et.setGlobalContextManager(e.contextManager),e.propagator&&Vt.setGlobalPropagator(e.propagator)},e.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map((function(t){return new Promise((function(i){var r,s=setTimeout((function(){i(new Error("Span processor did not completed within timeout period of "+e+" ms")),r=er.timeout}),e);t.forceFlush().then((function(){clearTimeout(s),r!==er.timeout&&(r=er.resolved,i(r))})).catch((function(e){clearTimeout(s),r=er.error,i(e)}))}))}));return new Promise((function(e,i){Promise.all(t).then((function(t){var r=t.filter((function(e){return e!==er.resolved}));r.length>0?i(r):e()})).catch((function(e){return i([e])}))}))},e.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},e.prototype._getPropagator=function(e){var t;return null===(t=this.constructor._registeredPropagators.get(e))||void 0===t?void 0:t()},e.prototype._getSpanExporter=function(e){var t;return null===(t=this.constructor._registeredExporters.get(e))||void 0===t?void 0:t()},e.prototype._buildPropagatorFromEnv=function(){var e=this,t=Array.from(new Set(oe().OTEL_PROPAGATORS)),i=t.map((function(t){var i=e._getPropagator(t);return i||ae.warn('Propagator "'+t+'" requested through environment variable is unavailable.'),i})).reduce((function(e,t){return t&&e.push(t),e}),[]);return 0===i.length?void 0:1===t.length?i[0]:new hi({propagators:i})},e.prototype._buildExporterFromEnv=function(){var e=oe().OTEL_TRACES_EXPORTER;if("none"!==e&&""!==e){var t=this._getSpanExporter(e);return t||ae.error('Exporter "'+e+'" requested through environment variable is unavailable.'),t}},e._registeredPropagators=new Map([["tracecontext",function(){return new Si}],["baggage",function(){return new Ri}]]),e._registeredExporters=new Map,e}();var sr={_export:function(e,t){return new Promise((function(i){Et.with(di(Et.active()),(function(){e.export(t,(function(e){i(e)}))}))}))}},nr=function(){function e(e){this._exporter=e,this._shutdownOnce=new pe(this._shutdown,this),this._unresolvedExports=new Set}return e.prototype.forceFlush=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return e.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){var t,i,r=this;if(!this._shutdownOnce.isCalled&&0!=(e.spanContext().traceFlags&Je.SAMPLED)){var s=function(){return sr._export(r._exporter,[e]).then((function(e){var t;e.code!==ue.SUCCESS&&Li(null!==(t=e.error)&&void 0!==t?t:new Error("SimpleSpanProcessor: span export failed (status "+e+")"))})).catch((function(e){Li(e)}))};if(e.resource.asyncAttributesPending){var n=null===(i=(t=e.resource).waitForAsyncAttributes)||void 0===i?void 0:i.call(t).then((function(){return null!=n&&r._unresolvedExports.delete(n),s()}),(function(e){return Li(e)}));null!=n&&this._unresolvedExports.add(n)}else s()}},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){return this._exporter.shutdown()},e}();class OpenTelemetryProvider{constructor(e,t,i){this._globalAttributes={},this.provider=new rr({resource:new ze({[He]:"gitlens",[Ve]:e.extensionVersion,[Me]:e.env,[Ue]:e.machineId,[Ne]:e.platform,"extension.id":e.extensionId,"session.id":e.sessionId,language:e.language,"vscode.edition":e.vscodeEdition,"vscode.version":e.vscodeVersion,"vscode.host":e.vscodeHost,"vscode.remoteName":e.vscodeRemoteName,"vscode.shell":e.vscodeShell,"vscode.uiKind":e.vscodeUIKind})});const r=new Le({url:i?"https://otel-dev.gitkraken.com:4318/v1/traces":"https://otel.gitkraken.com:4318/v1/traces",compression:"gzip",httpAgentOptions:t?.options});this.provider.addSpanProcessor(i?new nr(r):new ir(r)),this.tracer=this.provider.getTracer(e.extensionId)}dispose(){this.provider.shutdown()}sendEvent(e,t,i,s){const n=this.tracer.startSpan(e,{attributes:this._globalAttributes,kind:r.INTERNAL,startTime:i??Date.now()});null!=t&&n.setAttributes(t),n.end(s)}startEvent(e,t,i){const s=this.tracer.startSpan(e,{attributes:this._globalAttributes,kind:r.INTERNAL,startTime:i??Date.now()});return null!=t&&s.setAttributes(t),s}setGlobalAttributes(e){this._globalAttributes=Object.fromEntries(e)}}},4043:(e,t,i)=>{i.d(t,{$k:()=>n,$x:()=>o,HP:()=>h,I$:()=>r,WA:()=>l,_n:()=>s,eT:()=>u,gn:()=>d,lX:()=>a,mg:()=>c});var r=(e=>(e.DeepLink="link",e))(r||{}),s=(e=>(e.Branch="b",e.Commit="c",e.Comparison="compare",e.Repository="r",e.Tag="t",e))(s||{});function n(e){switch(e){case"b":return"Branch";case"c":return"Commit";case"compare":return"Comparison";case"r":return"Repository";case"t":return"Tag";default:return"Unknown"}}function o(e){switch(e){case"branch":return"b";case"revision":return"c";case"tag":return"t";default:return"r"}}function a(e){const[,t,i,r,s,...n]=e.path.split("/");if("link"!==t||"r"!==i)return;const o=new URLSearchParams(e.query);let a=o.get("url")??void 0;null!=a&&(a=decodeURIComponent(a));let c,l,h=o.get("path")??void 0;if(null!=h&&(h=decodeURIComponent(h)),!a&&!h)return;if(null==s)return{type:"r",repoId:r,remoteUrl:a,repoPath:h};if(null==n||0===n.length)return;const u=n.join("/");if("compare"===s){const e=u.split(/(\.\.\.|\.\.)/);if(3!==e.length)return;c=e[0],l=e[2]}else c=u;return{type:s,repoId:r,remoteUrl:a,repoPath:h,targetId:c,secondaryTargetId:l}}var c=(e=>(e[e.Idle=0]="Idle",e[e.RepoMatch=1]="RepoMatch",e[e.CloneOrAddRepo=2]="CloneOrAddRepo",e[e.OpeningRepo=3]="OpeningRepo",e[e.AddedRepoMatch=4]="AddedRepoMatch",e[e.RemoteMatch=5]="RemoteMatch",e[e.AddRemote=6]="AddRemote",e[e.TargetMatch=7]="TargetMatch",e[e.Fetch=8]="Fetch",e[e.FetchedTargetMatch=9]="FetchedTargetMatch",e[e.OpenGraph=10]="OpenGraph",e[e.OpenComparison=11]="OpenComparison",e))(c||{}),l=(e=>(e[e.DeepLinkEventFired=0]="DeepLinkEventFired",e[e.DeepLinkCancelled=1]="DeepLinkCancelled",e[e.DeepLinkResolved=2]="DeepLinkResolved",e[e.DeepLinkStored=3]="DeepLinkStored",e[e.DeepLinkErrored=4]="DeepLinkErrored",e[e.OpenRepo=5]="OpenRepo",e[e.RepoMatchedWithId=6]="RepoMatchedWithId",e[e.RepoMatchedWithPath=7]="RepoMatchedWithPath",e[e.RepoMatchedWithRemoteUrl=8]="RepoMatchedWithRemoteUrl",e[e.RepoMatchFailed=9]="RepoMatchFailed",e[e.RepoAdded=10]="RepoAdded",e[e.RepoOpened=11]="RepoOpened",e[e.RemoteMatched=12]="RemoteMatched",e[e.RemoteMatchFailed=13]="RemoteMatchFailed",e[e.RemoteAdded=14]="RemoteAdded",e[e.TargetMatched=15]="TargetMatched",e[e.TargetsMatched=16]="TargetsMatched",e[e.TargetMatchFailed=17]="TargetMatchFailed",e[e.TargetFetched=18]="TargetFetched",e))(l||{}),h=(e=>(e.Clone="clone",e.Folder="folder",e.Workspace="workspace",e))(h||{});const u={0:{0:1},1:{4:0,6:5,7:7,8:7,9:2},2:{5:3,11:5,4:0,1:0,3:0},3:{10:4,4:0,1:0},4:{6:5,7:7,8:7,4:0},5:{4:0,12:7,13:6},6:{14:7,4:0,1:0},7:{4:0,15:10,16:11,17:8},8:{18:9,4:0,1:0},9:{15:10,16:11,4:0},10:{2:0,4:0},11:{2:0,4:0}},d={0:{message:"Done.",increment:100},1:{message:"Finding a matching repository...",increment:10},2:{message:"Adding repository...",increment:20},3:{message:"Opening repository...",increment:30},4:{message:"Finding a matching repository...",increment:40},5:{message:"Finding a matching remote...",increment:50},6:{message:"Adding remote...",increment:60},7:{message:"finding a matching target...",increment:70},8:{message:"Fetching...",increment:80},9:{message:"Finding a matching target...",increment:90},10:{message:"Opening graph...",increment:95},11:{message:"Opening comparison...",increment:95}}},5539:(e,t,i)=>{i.d(t,{K:()=>FileHistoryView});var r=i(5255),s=i(9529),n=i(5148),o=i(2061),a=i(145),c=i(1614),l=i(5517),h=i(5688);const u=" (pinned)";class FileHistoryView extends l._{constructor(e){super(e,"fileHistory","File History","fileHistoryView"),this.configKey="fileHistory",this._followCursor=!1,this._followEditor=!0,(0,o.v)("gitlens:views:fileHistory:cursorFollowing",this._followCursor),(0,o.v)("gitlens:views:fileHistory:editorFollowing",this._followEditor)}get showCollapseAll(){return!1}getRoot(){return this._followCursor?new c.A(this):new a._(this)}registerCommands(){return this.container.viewCommands,[(0,h.i)(this.getQualifiedCommand("copy"),(()=>(0,s.P0)(r.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,h.i)(this.getQualifiedCommand("refresh"),(()=>this.refresh(!0)),this),(0,h.i)(this.getQualifiedCommand("changeBase"),(()=>this.changeBase()),this),(0,h.i)(this.getQualifiedCommand("setCursorFollowingOn"),(()=>this.setCursorFollowing(!0)),this),(0,h.i)(this.getQualifiedCommand("setCursorFollowingOff"),(()=>this.setCursorFollowing(!1)),this),(0,h.i)(this.getQualifiedCommand("setEditorFollowingOn"),(()=>this.setEditorFollowing(!0)),this),(0,h.i)(this.getQualifiedCommand("setEditorFollowingOff"),(()=>this.setEditorFollowing(!1)),this),(0,h.i)(this.getQualifiedCommand("setRenameFollowingOn"),(()=>this.setRenameFollowing(!0)),this),(0,h.i)(this.getQualifiedCommand("setRenameFollowingOff"),(()=>this.setRenameFollowing(!1)),this),(0,h.i)(this.getQualifiedCommand("setShowAllBranchesOn"),(()=>this.setShowAllBranches(!0)),this),(0,h.i)(this.getQualifiedCommand("setShowAllBranchesOff"),(()=>this.setShowAllBranches(!1)),this),(0,h.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,h.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||n.D.changed(e,"defaultDateFormat")||n.D.changed(e,"defaultDateLocale")||n.D.changed(e,"defaultDateShortFormat")||n.D.changed(e,"defaultDateSource")||n.D.changed(e,"defaultDateStyle")||n.D.changed(e,"defaultGravatarsStyle")||n.D.changed(e,"defaultTimeFormat")||n.D.changed(e,"advanced.fileHistoryFollowsRenames")||n.D.changed(e,"advanced.fileHistoryShowAllBranches"))}async showHistoryForUri(e){this.setCursorFollowing(!1);const t=this.ensureRoot(!0);return t instanceof a._&&(await t.showHistoryForUri(e),this.setEditorFollowing(!1)),this.show()}changeBase(){this.root?.changeBase()}setCursorFollowing(e){const t=!this._followEditor&&this.root?.hasUri?this.root.uri:void 0;this._followCursor=e,(0,o.v)("gitlens:views:fileHistory:cursorFollowing",e),this.title=this._followCursor?"Line History":"File History";const i=this.ensureRoot(!0);null!=t&&i.setUri(t),i.setEditorFollowing(this._followEditor),i.ensureSubscription(),this.refresh(!0)}setEditorFollowing(e){const t=this.ensureRoot();t.hasUri&&(this._followEditor=e,(0,o.v)("gitlens:views:fileHistory:editorFollowing",e),t.setEditorFollowing(e),this.description?.endsWith(u)?e&&(this.description=this.description.substr(0,this.description.length-9)):e||null==this.description||(this.description+=u),e&&(t.ensureSubscription(),this.refresh(!0)))}setRenameFollowing(e){return n.D.updateEffective("advanced.fileHistoryFollowsRenames",e)}setShowAllBranches(e){return n.D.updateEffective("advanced.fileHistoryShowAllBranches",e)}setShowAvatars(e){return n.D.updateEffective(`views.${this.configKey}.avatars`,e)}}},2610:(e,t,i)=>{i.d(t,{Z:()=>AutolinkedItemNode});var r=i(9496),s=i(2540),n=i(7462),o=i(8452),a=i(7512),c=i(6922);class AutolinkedItemNode extends c.Re{constructor(e,t,i,r){super(n.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this.item=r,this._uniqueId=(0,c.tO)(`autolink+${r.id}`,this.context)}get id(){return this._uniqueId}toClipboard(){return this.item.url}getChildren(){return[]}getTreeItem(){if(!function(e){return"closed"in e&&"boolean"==typeof e.closed}(this.item)){const{provider:e}=this.item,t=new r.TreeItem(`${this.item.prefix}${this.item.id}`,r.TreeItemCollapsibleState.None);return t.description=e?.name??"Custom",t.iconPath=new r.ThemeIcon(null==this.item.type?"link":this.item.type===s.fH.PullRequest?"git-pull-request":"issues"),t.contextValue=c.Td.AutolinkedItem,t.tooltip=new r.MarkdownString(`${this.item.description?`Autolinked ${this.item.description}`:`${null==this.item.type?"Autolinked":this.item.type===s.fH.PullRequest?"Autolinked Pull Request":"Autolinked Issue"} ${this.item.prefix}${this.item.id}`} \\\n[${this.item.url}](${this.item.url}${null!=this.item.title?` "${this.item.title}"`:""})`),t}const e=(0,a.Zh)(this.item.closedDate??this.item.date),t=new r.TreeItem(`${this.item.id}: ${this.item.title}`,r.TreeItemCollapsibleState.None);t.description=e,t.iconPath=(0,o.xX)(this.item),t.contextValue=this.item.type===o.mX.PullRequest?c.Td.PullRequest:c.Td.AutolinkedIssue;const i=` "Open ${this.item.type===o.mX.PullRequest?"Pull Request":"Issue"} \\#${this.item.id} on ${this.item.provider.name}"`,n=new r.MarkdownString(`${(0,o.sy)(this.item)} [**${this.item.title.trim()}**](${this.item.url}${i}) \\\n[#${this.item.id}](${this.item.url}${i}) was ${this.item.closed?"closed":"opened"} ${e}`,!0);return n.supportHtml=!0,n.isTrusted=!0,t.tooltip=n,t}}},7382:(e,t,i)=>{i.d(t,{E:()=>BranchNode});var r=i(9496),s=i(2540),n=i(5255),o=i(4092),a=i(3050),c=i(2061),l=i(5432),h=i(4241),u=i(3105),d=i(7469),p=i(3620),m=i(3479),g=i(9354),f=i(2925),w=i(21),v=i(9308),y=i(4741),b=i(2487),C=i(2060),A=i(1321),P=i(6922),S=Object.defineProperty,R=Object.getOwnPropertyDescriptor,D=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?R(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&S(t,i,n),n};class BranchNode extends P.bT{constructor(e,t,i,r,s,n,o){super(e,t,i),this.parent=i,this.repo=r,this.branch=s,this.root=n,this.splatted=!0,this.compacted=!1,this.updateContext({repository:r,branch:s,root:n}),this._uniqueId=(0,P.tO)("branch",this.context),this.limit=this.view.getNodeLastKnownLimit(this),this.options={expanded:!1,limitCommits:!1,showAsCommits:!1,showComparison:!1,showCurrent:!this.root,showStatus:!0,showTracking:!this.root,...o}}get id(){return this._uniqueId}toClipboard(){return this.branch.name}get current(){return this.branch.current}get label(){if(this.options.showAsCommits)return"Commits";const e=this.branch.getNameWithoutRemote();return`${this.view.config.branches?.layout!==s.CZ.Tree||this.compacted||this.root||this.current||this.branch.detached||this.branch.starred?e:this.branch.getBasename()}${this.branch.rebasing?" (Rebasing)":""}`}get ref(){return this.branch}get treeHierarchy(){return this.root||this.current||this.branch.detached||this.branch.starred?[this.branch.name]:this.branch.getNameWithoutRemote().split("/")}async getChildren(){if(null==this._children){const e=this.branch;let t,i;if(this.view.config.pullRequests.enabled&&this.view.config.pullRequests.showForBranches&&(null!=e.upstream||e.remote)&&(0,c.fw)("gitlens:hasConnectedRemotes")&&(i=this.getState("pullRequest"),void 0===i&&void 0===this.getState("pendingPullRequest"))){t=(0,d.PQ)();const i=this.getAssociatedPullRequest(e,this.root?{include:[o.o0.Open,o.o0.Merged]}:void 0);queueMicrotask((async()=>{await(t?.promise);let r=!1;const s=setTimeout((()=>{r=!0,this.view.triggerNodeChange(this)}),250),n=await i;clearTimeout(s),null!=n&&null!=this._children&&this._children.splice(this._children[0]instanceof v._?1:0,0,new C.Z(this.view,this,n,e)),(r||null!=n)&&this.view.triggerNodeChange(this.root?this.parent??this:this)}))}const[r,s,a,l,h,p]=await Promise.allSettled([this.getLog(),this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath,e.name),this.options.showStatus&&e.current?this.view.container.git.getStatusForRepo(this.uri.repoPath):void 0,this.options.showStatus&&e.current?this.view.container.git.getMergeStatus(this.uri.repoPath):void 0,this.options.showStatus?this.view.container.git.getRebaseStatus(this.uri.repoPath):void 0,e.remote?void 0:this.view.container.git.getBranchAheadRange(e).then((e=>e?this.view.container.git.getLogRefsOnly(this.uri.repoPath,{limit:0,ref:e}):void 0))]),P=(0,d.Sb)(r);if(null==P)return[new w.AE(this.view,this,"No commits could be found.")];const S=[];!1===this.options.showComparison||this.view instanceof m.L5||S.push(new v._(this.uri,this.view,this,e,this.options.showComparison,this.splatted)),null!=i&&S.push(new C.Z(this.view,this,i,e));const R=(0,d.Sb)(a),D=(0,d.Sb)(l),k=(0,d.Sb)(h);if(this.options.showStatus&&null!=D)S.push(new b.t(this.view,this,e,D,R??await this.view.container.git.getStatusForRepo(this.uri.repoPath),this.root));else if(this.options.showStatus&&null!=k&&(e.current||e.name===k.incoming.name))S.push(new A.S(this.view,this,e,k,R??await this.view.container.git.getStatusForRepo(this.uri.repoPath),this.root));else if(this.options.showTracking){const t={ref:e.ref,repoPath:e.repoPath,state:e.state,upstream:e.upstream?.name};null!=e.upstream?!this.root||t.state.behind||t.state.ahead?(t.state.behind&&S.push(new g.V(this.view,this,e,t,"behind",this.root)),t.state.ahead&&S.push(new g.V(this.view,this,e,t,"ahead",this.root))):S.push(new g.V(this.view,this,e,t,"same",this.root)):S.push(new g.V(this.view,this,e,t,"none",this.root))}0!==S.length&&S.push(new w.AE(this.view,this,"",n.NE.Dash.repeat(2),""));const _=(0,d.Sb)(p),T=(0,d.Sb)(s);S.push(...(0,y.E)((0,u.UI)(P.commits.values(),(t=>new f.D(this.view,this,t,_?.has(t.ref),e,T))),this)),P.hasMore&&S.push(new w.Gd(this.view,this,S[S.length-1],{getCount:()=>this.view.container.git.getCommitCount(e.repoPath,e.name)})),this._children=S,setTimeout((()=>t?.fulfill()),1)}return this._children}async getTreeItem(){this.splatted=!1;let e,t,i=`${this.current?"Current branch":"Branch"} $(git-branch) ${this.branch.getNameWithoutRemote()}${this.branch.rebasing?" (Rebasing)":""}`,s=P.Td.Branch;this.current&&(s+="+current"),this.branch.remote&&(s+="+remote"),this.branch.starred&&(s+="+starred"),null==this.branch.upstream||this.branch.upstream.missing||(s+="+tracking"),this.options.showAsCommits&&(s+="+commits"),this.repo.closed&&(s+="+closed");let o="";if(!this.branch.remote)if(null!=this.branch.upstream){let c=n.NE.Dash;const l=await this.branch.getRemote();if(this.branch.upstream.missing)c=n.NE.Warning;else if(null!=l){let e,t;for(const{type:i}of l.urls)if(i===a.XG.Fetch){if(e=!0,t)break}else if(i===a.XG.Push&&(t=!0,e))break;e&&t?c=n.NE.ArrowsRightLeft:t?c=n.NE.ArrowRight:e&&(c=n.NE.ArrowLeft)}t=this.options.showAsCommits?`${this.branch.getTrackingStatus({suffix:(0,p.vk)(n.NE.Dot,1,1)})}${this.branch.getNameWithoutRemote()}${this.branch.rebasing?" (Rebasing)":""}${(0,p.vk)(c,2,2)}${this.branch.upstream.name}`:`${this.branch.getTrackingStatus({suffix:`${n.NE.Space} `})}${c}${n.NE.Space} ${this.branch.upstream.name}`,i+=` is ${this.branch.getTrackingStatus({empty:this.branch.upstream.missing?`missing upstream $(git-branch) ${this.branch.upstream.name}`:`up to date with $(git-branch)  ${this.branch.upstream.name}${l?.provider?.name?` on ${l.provider.name}`:""}`,expand:!0,icons:!0,separator:", ",suffix:` $(git-branch) ${this.branch.upstream.name}${l?.provider?.name?` on ${l.provider.name}`:""}`})}`,(this.branch.state.ahead||this.branch.state.behind)&&(this.branch.state.ahead&&(s+="+ahead",e=new r.ThemeColor("gitlens.unpublishedChangesIconColor"),o="-green"),this.branch.state.behind&&(s+="+behind",e=new r.ThemeColor("gitlens.unpulledChangesIconColor"),o=this.branch.state.ahead?"-yellow":"-red"))}else{const e=a.ss.getHighlanderProviders(await this.view.container.git.getRemotesWithProviders(this.branch.repoPath));i+=` hasn't been published to ${(e?.length?e[0].name:void 0)??"a remote"}`}null!=this.branch.date&&(t=`${t?`${t}${(0,p.vk)(n.NE.Dot,2,2)}`:""}${this.branch.formattedDate}`,i+=`\n\nLast commit ${this.branch.formatDateFromNow()} (${this.branch.formatDate(this.view.container.BranchDateFormatting.dateFormat)})`),i=new r.MarkdownString(i,!0),i.supportHtml=!0,i.isTrusted=!0,this.branch.starred&&i.appendMarkdown("\\\n$(star-full) Favorited");const c=this.getState("pendingPullRequest");null!=c&&i.appendMarkdown(`\n\n$(loading~spin) Loading associated pull request${n.NE.Ellipsis}`);const l=new r.TreeItem(this.label,this.options.expanded?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed);return l.id=this.id,l.contextValue=s,l.description=t,l.iconPath=null!=c?new r.ThemeIcon("loading~spin"):this.options.showAsCommits?new r.ThemeIcon("git-commit",e):{dark:this.view.container.context.asAbsolutePath(`images/dark/icon-branch${o}.svg`),light:this.view.container.context.asAbsolutePath(`images/light/icon-branch${o}.svg`)},l.tooltip=i,l.resourceUri=r.Uri.parse(`gitlens-view://branch/status/${await this.branch.getStatus()}${this.options.showCurrent&&this.current?"/current":""}`),l}async star(){await this.branch.star(),this.view.refresh(!0)}async unstar(){await this.branch.unstar(),this.view.refresh(!0)}refresh(e){this._children=void 0,e&&(this._log=void 0,this.deleteState())}async getAssociatedPullRequest(e,t){let i=this.getState("pullRequest");if(void 0!==i)return Promise.resolve(i??void 0);let r=this.getState("pendingPullRequest");return r??(r=e.getAssociatedPullRequest(t),this.storeState("pendingPullRequest",r),i=await r,this.storeState("pullRequest",i??null),this.deleteState("pendingPullRequest"),i)}async getLog(){if(null==this._log){let e=this.limit??(this.root&&!this.options.limitCommits?this.view.config.pageItemLimit:this.view.config.defaultItemLimit);0!==e&&this.branch.state.ahead>e&&(e=Math.min(this.branch.state.ahead+1,2*e)),this._log=await this.view.container.git.getLog(this.uri.repoPath,{limit:e,ref:this.ref.ref,authors:this.options?.authors})}return this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this._children=void 0,this.triggerChange(!1)))}}D([(0,h.cM)()],BranchNode.prototype,"star",1),D([(0,h.cM)()],BranchNode.prototype,"unstar",1),D([(0,l.H)(),(0,h.fF)()],BranchNode.prototype,"refresh",1),D([(0,l.H)()],BranchNode.prototype,"loadMore",1)},4004:(e,t,i)=>{i.d(t,{n:()=>BranchOrTagFolderNode});var r=i(9496),s=i(7462),n=i(7382),o=i(6922);class BranchOrTagFolderNode extends o.Re{constructor(e,t,i,r,n,a,c,l=!1){super(s.YY.fromRepoPath(n),e,t),this.parent=t,this.type=i,this.root=r,this.repoPath=n,this.folderName=a,this.relativePath=c,this._expanded=l,this._uniqueId=(0,o.tO)(`${i}-folder+${c??a}`,this.context)}get id(){return this._uniqueId}toClipboard(){return this.folderName}getChildren(){if(void 0===this.root.descendants||void 0===this.root.children)return[];const e=[];for(const t of this.root.children.values())if(void 0!==t.value)t.value.parent=this.folderName?this:this.parent,e.push(t.value);else{const i=t.descendants?.some((e=>e instanceof n.E&&e.current));e.push(new BranchOrTagFolderNode(this.view,this.folderName?this:this.parent,this.type,t,this.repoPath,t.name,t.relativePath,i))}return e}getTreeItem(){const e=new r.TreeItem(this.label,this._expanded?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=o.Td.Folder,e.iconPath=r.ThemeIcon.Folder,e.tooltip=this.label,e}get label(){return this.folderName}}},9354:(e,t,i)=>{i.d(t,{V:()=>BranchTrackingStatusNode});var r=i(9496),s=i(7462),n=i(5367),o=i(4321),a=i(3050),c=i(7512),l=i(5432),h=i(4241),u=i(3105),d=i(3620),p=i(2540),m=i(2800),g=i(3700),f=i(4481),w=i(6586),v=i(6922);class BranchTrackingStatusFilesNode extends v.Re{constructor(e,t,i,r,n){super(s.YY.fromRepoPath(r.repoPath),e,t),this.parent=t,this.branch=i,this.status=r,this.direction=n,this.updateContext({branch:i,branchStatus:r,branchStatusUpstreamType:n}),this._uniqueId=(0,v.tO)("tracking-status-files",this.context)}get repoPath(){return this.status.repoPath}async getChildren(){const e=await this.view.container.git.getLog(this.repoPath,{limit:0,ref:(0,o.oI)(this.status.upstream,this.branch.ref,"behind"===this.direction?"...":"..")});let t;null!=e?(await Promise.allSettled((0,u.UI)((0,u.hX)(e.commits.values(),(e=>null==e.files)),(e=>e.ensureFullDetails()))),t=[...(0,u.VS)(e.commits.values(),(e=>e.files?.map((t=>({...t,commit:e})))??[]))]):t=[],t.sort(((e,t)=>t.commit.date.getTime()-e.commit.date.getTime()));const i=(0,m.vM)(t,(e=>e.path));let r=Object.values(i).map((e=>new w.q(this.view,this,e[e.length-1],this.repoPath,e.map((e=>e.commit)),this.direction)));if(this.view.config.files.layout!==p.Vc.List){const e=(0,m.Mo)(r,(e=>e.uri.relativePath.split("/")),((...e)=>(0,g.AH)((0,g.RQ)(...e))),this.view.config.files.compact);r=new f.Y(this.view,this,e,this.repoPath,"",void 0,!1).getChildren()}else r.sort(((e,t)=>e.priority-t.priority||(0,d.dm)(e.label,t.label)));return r}async getTreeItem(){const e=await this.view.container.git.getChangedFilesCount(this.repoPath,`${this.status.upstream}${"behind"===this.direction?"..":"..."}`),t=e?.changedFiles??0,i=`${(0,d._6)("file",t)} changed`,s=new r.TreeItem(i,r.TreeItemCollapsibleState.Collapsed);return s.id=this.id,s.contextValue=v.Td.BranchStatusFiles,s}}var y=i(2925),b=i(21),C=i(4741),A=Object.defineProperty,P=Object.getOwnPropertyDescriptor,S=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?P(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&A(t,i,n),n};class BranchTrackingStatusNode extends v.Re{constructor(e,t,i,r,n,o=!1,a){super(s.YY.fromRepoPath(r.repoPath),e,t),this.parent=t,this.branch=i,this.status=r,this.upstreamType=n,this.root=o,this.options=a,this.updateContext({branch:i,branchStatus:r,branchStatusUpstreamType:n,root:o}),this._uniqueId=(0,v.tO)("tracking-status",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}get repoPath(){return this.uri.repoPath}async getChildren(){if("same"===this.upstreamType||"none"===this.upstreamType)return[];const e=await this.getLog();if(null==e)return[];let t;if("ahead"===this.upstreamType){t=[...e.commits.values()];const i=t[t.length-1];if(null==await i.getPreviousSha()){const e=await this.view.container.git.getLog(this.uri.repoPath,{limit:2,ref:i.sha});null!=e&&(t[t.length-1]=(0,u.Ps)(e.commits.values()))}}else t=e.commits.values();const i=[];let r=!0;return!this.options?.showAheadCommits&&"ahead"===this.upstreamType&&this.status.upstream&&this.status.state.ahead>0?(r=!1,i.push(...await new BranchTrackingStatusFilesNode(this.view,this,this.branch,this.status,this.upstreamType).getChildren())):(i.push(...(0,C.E)((0,u.UI)(t,(e=>new y.D(this.view,this,e,"ahead"===this.upstreamType,this.branch))),this,1)),e.hasMore&&i.push(new b.Gd(this.view,this,i[i.length-1]))),r&&i.unshift(new BranchTrackingStatusFilesNode(this.view,this,this.branch,this.status,this.upstreamType)),i}async getTreeItem(){let e,t,i,s,o,l,h=0;if("none"!==this.upstreamType){const e=this.view.container.git.getRepository(this.repoPath);h=await(e?.getLastFetched())??0}switch(this.upstreamType){case"ahead":{const a=await this.branch.getRemote();e=`Changes to push to ${a?.name??(0,n.Lo)(this.status.upstream)}${a?.provider?.name?` on ${a?.provider.name}`:""}`,t=(0,d._6)("commit",this.status.state.ahead),l=`Branch $(git-branch) ${this.branch.name} is ${(0,d._6)("commit",this.status.state.ahead,{infix:"$(arrow-up) "})} ahead of $(git-branch) ${this.status.upstream}${a?.provider?.name?` on ${a.provider.name}`:""}`,i=r.TreeItemCollapsibleState.Collapsed,s=this.root?v.Td.StatusAheadOfUpstream:v.Td.BranchStatusAheadOfUpstream,o=new r.ThemeIcon("cloud-upload",new r.ThemeColor("gitlens.unpublishedChangesIconColor"));break}case"behind":{const a=await this.branch.getRemote();e=`Changes to pull from ${a?.name??(0,n.Lo)(this.status.upstream)}${a?.provider?.name?` on ${a.provider.name}`:""}`,t=(0,d._6)("commit",this.status.state.behind),l=`Branch $(git-branch) ${this.branch.name} is ${(0,d._6)("commit",this.status.state.behind,{infix:"$(arrow-down) "})} behind $(git-branch) ${this.status.upstream}${a?.provider?.name?` on ${a.provider.name}`:""}`,i=r.TreeItemCollapsibleState.Collapsed,s=this.root?v.Td.StatusBehindUpstream:v.Td.BranchStatusBehindUpstream,o=new r.ThemeIcon("cloud-download",new r.ThemeColor("gitlens.unpulledChangesIconColor"));break}case"same":{const a=await this.branch.getRemote();e=`Up to date with ${a?.name??(0,n.Lo)(this.status.upstream)}${a?.provider?.name?` on ${a.provider.name}`:""}`,t=h?`Last fetched ${(0,c.Zh)(new Date(h))}`:"",l=`Branch $(git-branch) ${this.branch.name} is up to date with $(git-branch) ${this.status.upstream}${a?.provider?.name?` on ${a.provider.name}`:""}`,i=r.TreeItemCollapsibleState.None,s=this.root?v.Td.StatusSameAsUpstream:v.Td.BranchStatusSameAsUpstream,o=new r.ThemeIcon("cloud");break}case"none":{const t=await this.view.container.git.getRemotesWithProviders(this.branch.repoPath),n=a.ss.getHighlanderProviders(t),c=n?.length?n[0].name:void 0;e=`Publish ${this.branch.name} to ${c??"a remote"}`,l=`Branch $(git-branch) ${this.branch.name} hasn't been published to ${c??"a remote"}`,i=r.TreeItemCollapsibleState.None,s=this.root?v.Td.StatusNoUpstream:v.Td.BranchStatusNoUpstream,o=new r.ThemeIcon("cloud-upload",t.length?new r.ThemeColor("gitlens.unpublishedChangesIconColor"):void 0);break}}const u=new r.TreeItem(e,i);u.id=this.id,u.contextValue=s,u.description=t,h&&(l+=`\n\nLast fetched ${(0,c.Zh)(new Date(h))}`),u.iconPath=o;const p=new r.MarkdownString(l,!0);return p.supportHtml=!0,p.isTrusted=!0,u.tooltip=p,u}refresh(e){e&&(this._log=void 0)}async getLog(){if("same"!==this.upstreamType&&"none"!==this.upstreamType){if(null==this._log){const e="ahead"===this.upstreamType?(0,o.oI)(this.status.upstream,this.status.ref):(0,o.oI)(this.status.ref,this.status.upstream);this._log=await this.view.container.git.getLog(this.uri.repoPath,{limit:this.limit??this.view.config.defaultItemLimit,ref:e})}return this._log}}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1)))}}S([(0,l.H)(),(0,h.fF)()],BranchTrackingStatusNode.prototype,"refresh",1),S([(0,l.H)()],BranchTrackingStatusNode.prototype,"loadMore",1)},3608:(e,t,i)=>{i.d(t,{r:()=>BranchesNode});var r=i(9496),s=i(2540),n=i(7462),o=i(2800),a=i(5432),c=i(4241),l=i(5478),h=i(7382),u=i(4004),d=i(21),p=i(6922),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor;class BranchesNode extends p.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,p.tO)("branches",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){const e=await this.repo.getBranches({filter:e=>!e.remote,sort:{current:!1}});if(0===e.values.length)return[new d.AE(this.view,this,"No branches could be found.")];const t=e.values.map((e=>new h.E(n.YY.fromRepoPath(this.uri.repoPath,e.ref),this.view,this,this.repo,e,!1,{showComparison:this.view instanceof l.a?this.view.config.branches.showBranchComparison:this.view.config.showBranchComparison})));if(this.view.config.branches.layout===s.CZ.List)return t;const i=(0,o.Mo)(t,(e=>e.treeHierarchy),((...e)=>e.join("/")),this.view.config.files.compact,(e=>(e.compacted=!0,!0))),r=new u.n(this.view,this,"branch",i,this.repo.path,"",void 0);this._children=r.getChildren()}return this._children}async getTreeItem(){const e=new r.TreeItem("Branches",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=p.Td.Branches,await this.repo.hasRemotes()&&(e.contextValue+="+remotes"),this.repo.closed&&(e.contextValue+="+closed"),e.iconPath=new r.ThemeIcon("git-branch"),e}refresh(){this._children=void 0}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&m(t,i,n)})([(0,a.H)(),(0,c.fF)()],BranchesNode.prototype,"refresh",1)},2601:(e,t,i)=>{i.d(t,{R:()=>CommitFileNode});var r=i(9496),s=i(5255),n=i(6373),o=i(7462),a=i(7881),c=i(3700),l=i(6922);class CommitFileNode extends l.RW{constructor(e,t,i,r,s={}){super(o.YY.fromFile(i,r.repoPath,r.sha),e,t,i),this.commit=r,this._options=s,this.updateContext({commit:r,file:i}),this._uniqueId=(0,l.tO)("commit-file",this.context)}get id(){return this._uniqueId}toClipboard(){return this.file.path}get priority(){return 0}get ref(){return this.commit}getChildren(){return[]}async getTreeItem(){if(null==this.commit.file){const e=await this.commit.getCommitForFile(this.file);if(null==e){const e=await this.view.container.git.getLogForFile(this.repoPath,this.file.path,{limit:2,ref:this.commit.sha});null!=e&&(this.commit=e.commits.get(this.commit.sha)??this.commit)}else this.commit=e}const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.None);if(e.id=this.id,e.contextValue=this.contextValue,e.description=this.description,"type"===this.view.config.files.icon)e.resourceUri=r.Uri.from({scheme:s.sN.Git,authority:"gitlens-view",path:this.uri.path,query:JSON.stringify({path:this.uri.fsPath,ref:this.uri.sha,decoration:`gitlens-view://commit-file/status/${this.file.status}`})});else{e.resourceUri=r.Uri.parse(`gitlens-view://commit-file/status/${this.file.status}`);const t=(0,a.tK)(this.file.status);e.iconPath={dark:this.view.container.context.asAbsolutePath((0,c.RQ)("images","dark",t)),light:this.view.container.context.asAbsolutePath((0,c.RQ)("images","light",t))}}return e.tooltip=this.tooltip,e.command=this.getCommand(),this._label=void 0,e}get contextValue(){return this.commit.isUncommitted?this.commit.isUncommittedStaged?`${l.Td.File}+staged`:`${l.Td.File}+unstaged`:`${l.Td.File}+committed${this._options.branch?.current?"+current":""}${this._options.branch?.current&&this._options.branch.sha===this.commit.ref?"+HEAD":""}${this._options.unpublished?"+unpublished":""}`}get description(){return n.o.fromTemplate(this.view.config.formats.files.description,this.file,{relativePath:this.relativePath})}get folderName(){return void 0===this._folderName&&(this._folderName=(0,c.Fd)(this.uri.relativePath)),this._folderName}get label(){return void 0===this._label&&(this._label=n.o.fromTemplate(this.view.config.formats.files.label,this.file,{relativePath:this.relativePath})),this._label}get relativePath(){return this._relativePath}set relativePath(e){this._relativePath=e,this._label=void 0}get tooltip(){const e=n.o.fromTemplate("${file}${'&nbsp;&nbsp;•&nbsp;&nbsp;'changesDetail}${'&nbsp;\\\n'directory}&nbsp;\n\n${status}${ (originalPath)}",this.file),t=new r.MarkdownString(e,!0);return t.supportHtml=!0,t.isTrusted=!0,t}getCommand(){let e;e=this.commit.lines.length?this.commit.lines[0].line-1:this._options.selection?.active.line??0;const t={commit:this.commit,uri:o.YY.fromFile(this.file,this.commit.repoPath),line:e,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:s.Gh.DiffWithPrevious,arguments:[void 0,t]}}}},2925:(e,t,i)=>{i.d(t,{D:()=>CommitNode});var r=i(9496),s=i(2540),n=i(5255),o=i(9338),a=i(2800),c=i(5148),l=i(2061),h=i(5432),u=i(3700),d=i(7469),p=i(3620),m=i(5539),g=i(9137),f=i(2601),w=i(4481),v=i(2060),y=i(6922),b=Object.defineProperty,C=Object.getOwnPropertyDescriptor;class CommitNode extends y.bT{constructor(e,t,i,r,s,n,o={}){super(i.getGitUri(),e,t),this.commit=i,this.unpublished=r,this.branch=s,this.getBranchAndTagTips=n,this._options=o,this.updateContext({commit:i}),this._uniqueId=(0,y.tO)("commit",this.context)}get id(){return this._uniqueId}toClipboard(){return`${this.commit.shortSha}: ${this.commit.summary}`}get isTip(){return(this.branch?.current&&this.branch.sha===this.commit.ref)??!1}get ref(){return this.commit}async getChildren(){if(this.view instanceof m.K)return[];if(null==this._children){const e=this.commit;let t,i,r=[];if(!(this.view instanceof g.wc)&&!this.unpublished&&(0,l.fw)("gitlens:hasConnectedRemotes")&&this.view.config.pullRequests.enabled&&this.view.config.pullRequests.showForCommits&&(i=this.getState("pullRequest"),void 0===i&&void 0===this.getState("pendingPullRequest"))){t=(0,d.PQ)();const i=this.getAssociatedPullRequest(e);queueMicrotask((async()=>{await(t?.promise);let r=!1;const s=setTimeout((()=>{r=!0,this.view.triggerNodeChange(this)}),250),n=await i;clearTimeout(s),null!=n&&null!=this._children&&this._children.unshift(new v.Z(this.view,this,n,e)),(r||null!=n)&&this.view.triggerNodeChange(this)}))}const n=await e.getCommitsForFiles();for(const e of n)r.push(new f.R(this.view,this,e.file,e));if(this.view.config.files.layout!==s.Vc.List){const e=(0,a.Mo)(r,(e=>e.uri.relativePath.split("/")),((...e)=>(0,u.AH)((0,u.RQ)(...e))),this.view.config.files.compact);r=new w.Y(this.view,this,e,this.repoPath,"",void 0).getChildren()}else r.sort(((e,t)=>(0,p.dm)(e.label,t.label)));null!=i&&r.unshift(new v.Z(this.view,this,i,e)),this._children=r,setTimeout((()=>t?.fulfill()),1)}return this._children}async getTreeItem(){const e=o.i.fromTemplate(this.view.config.formats.commits.label,this.commit,{dateFormat:c.D.get("defaultDateFormat"),getBranchAndTagTips:e=>this.getBranchAndTagTips?.(e,{compact:!0}),messageTruncateAtNewLine:!0}),t=new r.TreeItem(e,this._options.expand?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed);t.id=this.id,t.contextValue=`${y.Td.Commit}${this.branch?.current?"+current":""}${this.isTip?"+HEAD":""}${this.unpublished?"+unpublished":""}`,t.description=o.i.fromTemplate(this.view.config.formats.commits.description,this.commit,{dateFormat:c.D.get("defaultDateFormat"),getBranchAndTagTips:e=>this.getBranchAndTagTips?.(e,{compact:!0}),messageTruncateAtNewLine:!0});const i=this.getState("pendingPullRequest");return t.iconPath=null!=i?new r.ThemeIcon("loading~spin"):this.unpublished?new r.ThemeIcon("arrow-up",new r.ThemeColor("gitlens.unpublishedCommitIconColor")):this.view.config.avatars?await this.commit.getAvatarUri({defaultStyle:c.D.get("defaultGravatarsStyle")}):void 0,t}getCommand(){const e={commit:this.commit,uri:this.uri,line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:n.Gh.DiffWithPrevious,arguments:[void 0,e]}}refresh(e){this._children=void 0,e&&this.deleteState()}async resolveTreeItem(e){return null==e.tooltip&&(e.tooltip=await this.getTooltip()),e}async getAssociatedPullRequest(e,t){let i=this.getState("pullRequest");if(void 0!==i)return Promise.resolve(i??void 0);let r=this.getState("pendingPullRequest");return r??(r=e.getAssociatedPullRequest({remote:t}),this.storeState("pendingPullRequest",r),i=await r,this.storeState("pullRequest",i??null),this.deleteState("pendingPullRequest"),i)}async getTooltip(){const e=await this.view.container.git.getRemotesWithProviders(this.commit.repoPath,{sort:!0}),t=await this.view.container.git.getBestRemoteWithRichProvider(e);let i,s;if(null!=t&&e.sort(((e,i)=>e===t?-1:i===t?1:0)),null==this.commit.message&&await this.commit.ensureFullDetails(),null!=t?.provider){const[e,r]=await Promise.allSettled([this.view.container.autolinks.getLinkedIssuesAndPullRequests(this.commit.message??this.commit.summary,t),this.getAssociatedPullRequest(this.commit,t)]);i=(0,d.Sb)(e),s=(0,d.Sb)(r),null!=s&&i?.delete(s.id)}const n=await o.i.fromTemplateAsync(this.view.config.formats.commits.tooltip,this.commit,{autolinkedIssuesOrPullRequests:i,dateFormat:c.D.get("defaultDateFormat"),getBranchAndTagTips:this.getBranchAndTagTips,messageAutolinks:!0,messageIndent:4,pullRequestOrRemote:s,outputFormat:"markdown",remotes:e,unpublished:this.unpublished}),a=new r.MarkdownString(n,!0);return a.supportHtml=!0,a.isTrusted=!0,a}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?C(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&b(t,i,n)})([(0,h.H)()],CommitNode.prototype,"refresh",1)},21:(e,t,i)=>{i.d(t,{$h:()=>CommandMessageNode,AE:()=>MessageNode,Gd:()=>LoadMoreNode});var r=i(9496),s=i(5255),n=i(7462),o=i(5148),a=i(6922);class MessageNode extends a.Re{constructor(e,t,i,r,s,o,a){super(n.Wj,e,t),this.parent=t,this._message=i,this._description=r,this._tooltip=s,this._iconPath=o,this._contextValue=a}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(this._message,r.TreeItemCollapsibleState.None);return e.contextValue=this._contextValue??a.Td.Message,e.description=this._description,e.tooltip=this._tooltip,e.iconPath=this._iconPath,e}}class CommandMessageNode extends MessageNode{constructor(e,t,i,r,s,n,o){super(e,t,r,s,n,o),this.parent=t,this._command=i}getTreeItem(){const e=super.getTreeItem();return e instanceof r.TreeItem?(e.command=this._command,e):e.then((e=>(e.command=this._command,e)))}}class PagerNode extends a.Re{constructor(e,t,i,r,s){super(n.Wj,e,t),this.message=i,this.previousNode=r,this.options=s}async loadAll(){const e=await(this.options?.getCount?.())??0;return this.view.loadMoreNodeChildren(this.parent,e>5e3?5e3:0,this.previousNode,this.options?.context)}loadMore(){return this.view.loadMoreNodeChildren(this.parent,this.options?.pageSize??o.D.get("views.pageItemLimit"),this.previousNode,this.options?.context)}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(this.message,r.TreeItemCollapsibleState.None);return e.contextValue=a.Td.Pager,e.command=this.getCommand(),e}getCommand(){return{title:"Load more",command:"gitlens.views.loadMoreChildren",arguments:[this]}}}class LoadMoreNode extends PagerNode{constructor(e,t,i,r){super(e,t,r?.message??(0===r?.pageSize?`Load all ${s.NE.Space}${s.NE.Dash}${s.NE.Space} this may take a while`:"Load more"),i,r)}}},9308:(e,t,i)=>{i.d(t,{_:()=>CompareBranchNode});var r=i(9496),s=i(2540),n=i(5255),o=i(4321),a=i(9729),c=i(3636),l=i(5432),h=i(4241),u=i(7469),d=i(3620),p=i(5988),m=i(812),g=i(6922),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor,v=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&f(t,i,n),n};class CompareBranchNode extends g.Re{constructor(e,t,i,r,s,n=!1){super(e,t,i),this.parent=i,this.branch=r,this.showComparison=s,this.root=n,this.updateContext({branch:r,root:n}),this._uniqueId=(0,g.tO)("compare-branch",this.context),this.loadCompareWith()}get ahead(){return{ref1:this._compareWith?.ref||"HEAD",ref2:this.branch.ref}}get behind(){return{ref1:this.branch.ref,ref2:this._compareWith?.ref||"HEAD"}}get repoPath(){return this.branch.repoPath}async getChildren(){if(null==this._compareWith)return[];if(null==this._children){const e=this.ahead,t=this.behind,i=await this.view.container.git.getAheadBehindCommitCount(this.branch.repoPath,[(0,o.oI)(t.ref1,t.ref2,"...")]),r=await this.view.container.git.getMergeBase(this.repoPath,t.ref1,t.ref2,{forkPoint:!0})??await this.view.container.git.getMergeBase(this.repoPath,t.ref1,t.ref2);this._children=[new p.J(this.view,this,this.repoPath,"Behind",{query:this.getCommitsQuery((0,o.oI)(t.ref1,t.ref2,"..")),comparison:t,direction:"behind",files:{ref1:this.compareWithWorkingTree?"":r??t.ref1,ref2:t.ref2,query:this.getBehindFilesQuery.bind(this)}},{description:(0,d._6)("commit",i?.behind??0),expand:!1}),new p.J(this.view,this,this.repoPath,"Ahead",{query:this.getCommitsQuery((0,o.oI)(e.ref1,this.compareWithWorkingTree?"":e.ref2,"..")),comparison:e,direction:"ahead",files:{ref1:r??e.ref1,ref2:this.compareWithWorkingTree?"":e.ref2,query:this.getAheadFilesQuery.bind(this)}},{description:(0,d._6)("commit",i?.ahead??0),expand:!1}),new m.V(this.view,this,this.repoPath,this._compareWith.ref||"HEAD",this.compareWithWorkingTree?"":this.branch.ref,this.getFilesQuery.bind(this),void 0,{expand:!1})]}return this._children}getTreeItem(){let e,t,i;null==this._compareWith?(t=`Compare ${this.compareWithWorkingTree?"Working Tree":this.branch.name} with <branch, tag, or ref>`,e=r.TreeItemCollapsibleState.None,i=`Click to compare ${this.compareWithWorkingTree?"Working Tree":this.branch.name} with a branch, tag, or ref`):(t=`Compare ${this.compareWithWorkingTree?"Working Tree":this.branch.name} with ${(0,o.zL)(this._compareWith.ref,{strings:{working:"Working Tree"}})}`,e=r.TreeItemCollapsibleState.Collapsed);const s=new r.TreeItem(t,e);return s.id=this.id,s.contextValue=`${g.Td.CompareBranch}${this.branch.current?"+current":""}+${this.comparisonType}${null==this._compareWith?"":"+comparing"}${this.root?"+root":""}`,null==this._compareWith&&(s.command={title:`Compare ${this.branch.name}${this.compareWithWorkingTree?" (working)":""} with${n.NE.Ellipsis}`,command:"gitlens.views.editNode",arguments:[this]}),s.iconPath=new r.ThemeIcon("git-compare"),s.tooltip=i,s}async clear(){this._compareWith=void 0,await this.updateCompareWith(void 0),this._children=void 0,this.view.triggerNodeChange(this)}async edit(){await this.compareWith()}refresh(){this._children=void 0,this.loadCompareWith()}async setComparisonType(e){null!=this._compareWith?await this.updateCompareWith({...this._compareWith,type:e}):this.showComparison=e,this._children=void 0,this.view.triggerNodeChange(this)}get comparisonType(){return this._compareWith?.type??this.showComparison}get compareWithWorkingTree(){return this.comparisonType===s.DH.Working}async compareWith(){const e=await(0,c.V)(this.branch.repoPath,`Compare ${this.branch.name}${this.compareWithWorkingTree?" (working)":""} with`,"Choose a reference to compare with",{allowEnteringRefs:!0,picked:this.branch.ref,sort:{branches:{current:!0},tags:{}}});null==e||e instanceof a.$w||(await this.updateCompareWith({ref:e.ref,notation:void 0,type:this.comparisonType}),this._children=void 0,this.view.triggerNodeChange(this))}async getAheadFilesQuery(){const e=(0,o.oI)(this._compareWith?.ref||"HEAD",this.branch.ref||"HEAD","..."),[t,i,r,s]=await Promise.allSettled([this.view.container.git.getDiffStatus(this.repoPath,e),this.compareWithWorkingTree?this.view.container.git.getDiffStatus(this.repoPath,"HEAD"):void 0,this.view.container.git.getChangedFilesCount(this.repoPath,e),this.compareWithWorkingTree?this.view.container.git.getChangedFilesCount(this.repoPath,"HEAD"):void 0]);let n=(0,u.Sb)(t)??[],a=(0,u.Sb)(r);if(this.compareWithWorkingTree){const e=(0,u.Sb)(i);if(null!=e)if(0===n.length)n=e;else for(const t of e){const e=n.findIndex((e=>e.path===t.path));-1!==e?n.splice(e,1,t):n.push(t)}const t=(0,u.Sb)(s);null!=t&&(a=null==a?t:{additions:a.additions+t.additions,deletions:a.deletions+t.deletions,changedFiles:n.length,approximated:!0})}return{label:`${(0,d._6)("file",n.length,{zero:"No"})} changed`,files:n,stats:a}}async getBehindFilesQuery(){const e=(0,o.oI)(this.branch.ref,this._compareWith?.ref||"HEAD","..."),[t,i]=await Promise.allSettled([this.view.container.git.getDiffStatus(this.repoPath,e),this.view.container.git.getChangedFilesCount(this.repoPath,e)]),r=(0,u.Sb)(t)??[];return{label:`${(0,d._6)("file",r.length,{zero:"No"})} changed`,files:r,stats:(0,u.Sb)(i)}}getCommitsQuery(e){const t=this.repoPath;return async i=>{const r=await this.view.container.git.getLog(t,{limit:i,ref:e}),s={log:r,hasMore:r?.hasMore??!0};return s.hasMore&&(s.more=async e=>{s.log=await(s.log?.more?.(e))??s.log,s.hasMore=s.log?.hasMore??!0}),s}}async getFilesQuery(){let e;e=this._compareWith?.ref?this.compareWithWorkingTree?this._compareWith.ref:`${this._compareWith.ref}..${this.branch.ref}`:this.branch.ref;const[t,i]=await Promise.allSettled([this.view.container.git.getDiffStatus(this.repoPath,e),this.view.container.git.getChangedFilesCount(this.repoPath,e)]),r=(0,u.Sb)(t)??[];return{label:`${(0,d._6)("file",r.length,{zero:"No"})} changed`,files:r,stats:(0,u.Sb)(i)}}loadCompareWith(){const e=this.view.container.storage.getWorkspace("branch:comparisons"),t=`${this.branch.id}${this.branch.current?"+current":""}`,i=e?.[t];this._compareWith=null!=i&&"string"==typeof i?{ref:i,notation:void 0,type:this.showComparison}:i}async updateCompareWith(e){this._compareWith=e;let t=this.view.container.storage.getWorkspace("branch:comparisons");if(null==t){if(null==e)return;t=Object.create(null)}const i=`${this.branch.id}${this.branch.current?"+current":""}`;if(null!=e)t[i]={...e};else{if(null==t[i])return;const{[i]:e,...r}=t;t=r}await this.view.container.storage.storeWorkspace("branch:comparisons",t)}}v([(0,h.cM)()],CompareBranchNode.prototype,"clear",1),v([(0,h.cM)()],CompareBranchNode.prototype,"edit",1),v([(0,l.H)(),(0,h.fF)()],CompareBranchNode.prototype,"refresh",1),v([(0,h.cM)()],CompareBranchNode.prototype,"setComparisonType",1)},5538:(e,t,i)=>{i.d(t,{f:()=>y});var r=i(9496),s=i(4290),n=i(7462),o=i(4321),a=i(5432),c=i(4241),l=i(7469),h=i(3620),u=i(5988),d=i(812),p=i(6922),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&m(t,i,n),n};let w=0;const v=class extends p.Re{constructor(e,t,i,r,s,o=0){super(n.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this._ref=r,this._compareWith=s,this._pinned=o,this._order=Date.now(),this._instanceId=w++,this.updateContext({comparisonId:`${r.ref}+${s.ref}+${this._instanceId}`}),this._uniqueId=(0,p.tO)("comparison-results",this.context)}static getPinnableId(e,t,i){return(0,s.FB)(`${e}|${t}|${i}`,"base64")}get id(){return this._uniqueId}get ahead(){return{ref1:this._compareWith.ref||"HEAD",ref2:this._ref.ref}}get behind(){return{ref1:this._ref.ref,ref2:this._compareWith.ref||"HEAD"}}get canDismiss(){return!this.pinned}get compareRef(){return this._ref}get compareWithRef(){return this._compareWith}get order(){return this._pinned||this._order}get pinned(){return 0!==this._pinned}async getChildren(){if(null==this._children){const e=this.ahead,t=this.behind,i=await this.view.container.git.getAheadBehindCommitCount(this.repoPath,[(0,o.oI)(t.ref1||"HEAD",t.ref2,"...")]),r=await this.view.container.git.getMergeBase(this.repoPath,t.ref1,t.ref2,{forkPoint:!0})??await this.view.container.git.getMergeBase(this.repoPath,t.ref1,t.ref2);this._children=[new u.J(this.view,this,this.repoPath,"Behind",{query:this.getCommitsQuery((0,o.oI)(t.ref1,t.ref2,"..")),comparison:t,direction:"behind",files:{ref1:""===t.ref1?"":r??t.ref1,ref2:t.ref2,query:this.getBehindFilesQuery.bind(this)}},{description:(0,h._6)("commit",i?.behind??0),expand:!1}),new u.J(this.view,this,this.repoPath,"Ahead",{query:this.getCommitsQuery((0,o.oI)(e.ref1,e.ref2,"..")),comparison:e,direction:"ahead",files:{ref1:r??e.ref1,ref2:e.ref2,query:this.getAheadFilesQuery.bind(this)}},{description:(0,h._6)("commit",i?.ahead??0),expand:!1}),new d.V(this.view,this,this.repoPath,this._compareWith.ref,this._ref.ref,this.getFilesQuery.bind(this),void 0,{expand:!1})]}return this._children}getTreeItem(){let e;if(this.view.container.git.repositoryCount>1){const t=this.repoPath?this.view.container.git.getRepository(this.repoPath):void 0;e=t?.formattedName??this.repoPath}const t=new r.TreeItem(`Comparing ${this._ref.label??(0,o.zL)(this._ref.ref,{strings:{working:"Working Tree"}})} with ${this._compareWith.label??(0,o.zL)(this._compareWith.ref,{strings:{working:"Working Tree"}})}`,r.TreeItemCollapsibleState.Collapsed);return t.id=this.id,t.contextValue=`${p.Td.CompareResults}${this._pinned?"+pinned":""}${""===this._ref.ref?"+working":""}`,t.description=e,this._pinned&&(t.iconPath=new r.ThemeIcon("pinned")),t}async getDiffRefs(){return Promise.resolve([this._compareWith.ref,this._ref.ref])}async pin(){this.pinned||(this._pinned=Date.now(),await this.updatePinned(),queueMicrotask((()=>this.view.reveal(this,{focus:!0,select:!0}))))}refresh(e=!1){e&&(this._children=void 0)}async swap(){if(""===this._ref.ref)return void r.window.showErrorMessage("Cannot swap comparisons with the working tree");const e=this.getPinnableId(),t=this._ref;this._ref=this._compareWith,this._compareWith=t,this.pinned&&(await this.view.updatePinned(e),await this.updatePinned()),this._children=void 0,this.view.triggerNodeChange(this.parent),queueMicrotask((()=>this.view.reveal(this,{expand:!0,focus:!0,select:!0})))}async unpin(){this.pinned&&(this._pinned=0,await this.view.updatePinned(this.getPinnableId()),queueMicrotask((()=>this.view.reveal(this,{focus:!0,select:!0}))))}getPinnableId(){return v.getPinnableId(this.repoPath,this._ref.ref,this._compareWith.ref)}async getAheadFilesQuery(){return this.getAheadBehindFilesQuery((0,o.oI)(this._compareWith?.ref||"HEAD",this._ref.ref||"HEAD","..."),""===this._ref.ref)}async getBehindFilesQuery(){return this.getAheadBehindFilesQuery((0,o.oI)(this._ref.ref||"HEAD",this._compareWith.ref||"HEAD","..."),!1)}async getAheadBehindFilesQuery(e,t){const[i,r,s,n]=await Promise.allSettled([this.view.container.git.getDiffStatus(this.repoPath,e),t?this.view.container.git.getDiffStatus(this.repoPath,"HEAD"):void 0,this.view.container.git.getChangedFilesCount(this.repoPath,e),t?this.view.container.git.getChangedFilesCount(this.repoPath,"HEAD"):void 0]);let o=(0,l.Sb)(i)??[],a=(0,l.Sb)(s);if(t){const e=(0,l.Sb)(r);if(null!=e)if(0===o.length)o=e??[];else for(const t of e){const e=o.findIndex((e=>e.path===t.path));-1!==e?o.splice(e,1,t):o.push(t)}const t=(0,l.Sb)(n);null!=t&&(a=null==a?t:{additions:a.additions+t.additions,deletions:a.deletions+t.deletions,changedFiles:o.length,approximated:!0})}return{label:`${(0,h._6)("file",o.length,{zero:"No"})} changed`,files:o,stats:a}}getCommitsQuery(e){const t=this.repoPath;return async i=>{const r=await this.view.container.git.getLog(t,{limit:i,ref:e}),s={log:r,hasMore:r?.hasMore??!0};return s.hasMore&&(s.more=async e=>{s.log=await(s.log?.more?.(e))??s.log,s.hasMore=s.log?.hasMore??!0}),s}}async getFilesQuery(){let e;if(""===this._compareWith.ref)throw new Error("Cannot get files for comparisons of a ref with working tree");e=""===this._ref.ref?this._compareWith.ref:`${this._compareWith.ref}..${this._ref.ref}`;const[t,i]=await Promise.allSettled([this.view.container.git.getDiffStatus(this.repoPath,e),this.view.container.git.getChangedFilesCount(this.repoPath,e)]),r=(0,l.Sb)(t)??[];return{label:`${(0,h._6)("file",r.length,{zero:"No"})} changed`,files:r,stats:(0,l.Sb)(i)}}updatePinned(){return this.view.updatePinned(this.getPinnableId(),{type:"comparison",timestamp:this._pinned,path:this.repoPath,ref1:{label:this._ref.label,ref:this._ref.ref},ref2:{label:this._compareWith.label,ref:this._compareWith.ref}})}};let y=v;f([(0,a.H)(),(0,c.fF)()],y.prototype,"getDiffRefs",1),f([(0,c.cM)()],y.prototype,"pin",1),f([(0,a.H)(),(0,c.fF)()],y.prototype,"refresh",1),f([(0,c.cM)()],y.prototype,"swap",1),f([(0,c.cM)()],y.prototype,"unpin",1)},5310:(e,t,i)=>{i.d(t,{K:()=>ContributorNode});var r=i(9496),s=i(8388),n=i(5255),o=i(5148),a=i(5432),c=i(4241),l=i(3105),h=i(3620),u=i(2925),d=i(21),p=i(4741),m=i(6922),g=Object.defineProperty,f=Object.getOwnPropertyDescriptor,w=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?f(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&g(t,i,n),n};class ContributorNode extends m.Re{constructor(e,t,i,r,s){super(e,t,i),this.parent=i,this.contributor=r,this._options=s,this.updateContext({contributor:r}),this._uniqueId=(0,m.tO)("contributor",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}toClipboard(){return`${this.contributor.name}${this.contributor.email?` <${this.contributor.email}>`:""}`}get repoPath(){return this.contributor.repoPath}async getChildren(){const e=await this.getLog();if(null==e)return[new d.AE(this.view,this,"No commits could be found.")];const t=await this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath),i=[...(0,p.E)((0,l.UI)(e.commits.values(),(e=>new u.D(this.view,this,e,void 0,void 0,t))),this)];return e.hasMore&&i.push(new d.Gd(this.view,this,i[i.length-1])),i}async getTreeItem(){const e=this._options?.presence?.get(this.contributor.email),t=new r.TreeItem(this.contributor.current?`${this.contributor.label} (you)`:this.contributor.label,r.TreeItemCollapsibleState.Collapsed);let i,a;if(t.id=this.id,t.contextValue=this.contributor.current?`${m.Td.Contributor}+current`:m.Td.Contributor,t.description=`${null!=e&&"offline"!==e.status?`${e.statusText} ${n.NE.Space}${n.NE.Dot}${n.NE.Space} `:""}${null!=this.contributor.date?`${this.contributor.formatDateFromNow()}, `:""}${(0,h._6)("commit",this.contributor.count)}`,this.view.config.avatars){const t=o.D.get("hovers.avatarSize");if(i=await this.contributor.getAvatarUri({defaultStyle:o.D.get("defaultGravatarsStyle"),size:t}),null!=e){const r=`${this.contributor.count?"You are":`${this.contributor.label} is`} ${"dnd"===e.status?"in ":""}${e.statusText.toLocaleLowerCase()}`;a=`![${r}](${i.toString(!0)}|width=${t},height=${t} "${r}")![${r}](${(0,s.TU)(e.status)} "${r}")`}else a=`![${this.contributor.label}](${i.toString(!0)}|width=${t},height=${t} "${this.contributor.label}")`}const c=new Intl.NumberFormat,l=null!=this.contributor.stats?`\\\n${(0,h._6)("file",this.contributor.stats.files,{format:c.format})} changed, ${(0,h._6)("addition",this.contributor.stats.additions,{format:c.format})}, ${(0,h._6)("deletion",this.contributor.stats.deletions,{format:c.format})}`:"",u=this.contributor.email?`__[${this.contributor.name}](mailto:${this.contributor.email} "Email ${this.contributor.label} (${this.contributor.email})")__`:`__${this.contributor.label}__`,d=null!=this.contributor.date?`Last commit ${this.contributor.formatDateFromNow()} (${this.contributor.formatDate()})\\\n`:"",p=new r.MarkdownString(`${null!=a?a:""} &nbsp;${u} \n\n${d}${(0,h._6)("commit",this.contributor.count,{format:c.format})}${l}`);return p.supportHtml=!0,p.isTrusted=!0,t.tooltip=p,t.iconPath=i,t}refresh(e){e&&(this._log=void 0)}async getLog(){return null==this._log&&(this._log=await this.view.container.git.getLog(this.uri.repoPath,{all:this._options?.all,ref:this._options?.ref,limit:this.limit??this.view.config.defaultItemLimit,authors:[{name:this.contributor.name,email:this.contributor.email,username:this.contributor.username,id:this.contributor.id}]})),this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1)))}}w([(0,a.H)(),(0,c.fF)()],ContributorNode.prototype,"refresh",1),w([(0,a.H)()],ContributorNode.prototype,"loadMore",1)},4562:(e,t,i)=>{i.d(t,{I:()=>ContributorsNode});var r=i(9496),s=i(1719),n=i(5148),o=i(5432),a=i(4241),c=i(6767),l=i(21),h=i(5310),u=i(6922),d=Object.defineProperty,p=Object.getOwnPropertyDescriptor,m=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?p(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&d(t,i,n),n};class ContributorsNode extends u.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.splatted=!0,this.updateContext({repository:r}),this._uniqueId=(0,u.tO)("contributors",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){const e=n.D.get("views.contributors.showAllBranches");let t;if(!e)try{const e=await this.view.container.git.getBranch(this.uri.repoPath);null==e?.upstream?.name||e.upstream.missing||(t="@{u}")}catch{}const i=n.D.get("views.contributors.showStatistics"),r=await this.repo.getContributors({all:e,ref:t,stats:i});if(0===r.length)return[new l.AE(this.view,this,"No contributors could be found.")];s.V.sort(r);const o=await this.maybeGetPresenceMap(r);this._children=r.map((i=>new h.K(this.uri,this.view,this,i,{all:e,ref:t,presence:o})))}return this._children}getTreeItem(){this.splatted=!1;const e=new r.TreeItem("Contributors",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=u.Td.Contributors,e.iconPath=new r.ThemeIcon("organization"),e}updateAvatar(e){if(null!=this._children)for(const t of this._children)t.contributor.email===e&&t.triggerChange()}refresh(){this._children=void 0}async maybeGetPresenceMap(e){const t=e.find((e=>e.current))?.email;if(null!=t)return this.view.container.vsls.getContactsPresence([t])}}m([(0,o.H)(),(0,a.fF)()],ContributorsNode.prototype,"refresh",1),m([(0,a.fF)({args:!1}),(0,c.V)(250)],ContributorsNode.prototype,"maybeGetPresenceMap",1)},906:(e,t,i)=>{i.d(t,{J:()=>FileHistoryNode});var r=i(9496),s=i(439),n=i(3646),o=i(5148),a=i(5432),c=i(4241),l=i(4488),h=i(3105),u=i(4336),d=i(3700),p=i(2925),m=i(21),g=i(145),f=i(9719),w=i(4741),v=i(6922),y=Object.defineProperty,b=Object.getOwnPropertyDescriptor,C=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?b(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&y(t,i,n),n};class FileHistoryNode extends v.CF{constructor(e,t,i,r,s){super(e,t,i),this.parent=i,this.folder=r,this.branch=s,this.splatted=!0,null!=s&&this.updateContext({branch:s}),this._uniqueId=(0,v.tO)(`file-history+${e.toString()}`,this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}toClipboard(){return this.uri.fileName}async getChildren(){this.view.description=`${this.label}${this.parent instanceof g._&&!this.parent.followingEditor?" (pinned)":""}`;const e=[];if(null==this.uri.repoPath)return e;const t=null!=this.branch?await this.view.container.git.getBranchAheadRange(this.branch):void 0,[i,r,s,n,o]=await Promise.all([this.getLog(),null==this.uri.sha?this.view.container.git.getStatusForFiles(this.uri.repoPath,this.getPathOrGlob()):void 0,null==this.uri.sha?this.view.container.git.getCurrentUser(this.uri.repoPath):void 0,null!=this.branch?this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath,this.branch.name):void 0,t?this.view.container.git.getLogRefsOnly(this.uri.repoPath,{limit:0,ref:t}):void 0]);if(r?.length)if(this.folder){const t=(0,h.UI)((0,h.uw)((0,h.VS)(r,(e=>e.getPseudoCommits(this.view.container,s))),(e=>e.sha),((e,t)=>e.with({files:{files:[...e.files,...t.files]}}))),(e=>new p.D(this.view,this,e)));e.push(...t)}else{const[t]=r,i=t.getPseudoCommits(this.view.container,s);i.length&&e.push(...i.map((e=>new f.m(this.view,this,t,e))))}return null!=i&&(e.push(...(0,w.E)((0,h.DZ)(i.commits.values(),(e=>this.folder?new p.D(this.view,this,e,o?.has(e.ref),this.branch,void 0,{expand:!1}):null!=e.file?new f.m(this.view,this,e.file,e,{branch:this.branch,getBranchAndTagTips:n,unpublished:o?.has(e.ref)}):void 0)),this)),i.hasMore&&e.push(new m.Gd(this.view,this,e[e.length-1]))),0===e.length?[new m.AE(this.view,this,"No file history could be found.")]:e}getTreeItem(){this.splatted=!1;const e=this.label,t=new r.TreeItem(e,r.TreeItemCollapsibleState.Expanded);return t.contextValue=v.Td.FileHistory,t.description=this.uri.directory,t.tooltip=`History of ${this.uri.fileName}\n${this.uri.directory}/${null==this.uri.sha?"":`\n\n${this.uri.sha}`}`,this.view.description=`${e}${this.parent instanceof g._&&!this.parent.followingEditor?" (pinned)":""}`,t}get label(){return this.folder&&""===this.uri.fileName?`${(0,d.EZ)(this.uri.path)}${this.uri.sha?` ${this.uri.sha===s.Ii?this.uri.shortSha:`(${this.uri.shortSha})`}`:""}`:`${this.uri.fileName}${this.uri.sha?` ${this.uri.sha===s.Ii?this.uri.shortSha:`(${this.uri.shortSha})`}`:""}`}subscribe(){const e=this.view.container.git.getRepository(this.uri);if(null==e)return;return r.Disposable.from(e.onDidChange(this.onRepositoryChanged,this),e.onDidChangeFileSystem(this.onFileSystemChanged,this),e.startWatchingFileSystem(),o.D.onDidChange((e=>{o.D.changed(e,"advanced.fileHistoryFollowsRenames")&&this.view.resetNodeLastKnownLimit(this)})))}etag(){return Date.now()}onRepositoryChanged(e){e.changed(n.I6.Index,n.I6.Heads,n.I6.Remotes,n.I6.RemoteProviders,n.I6.Status,n.I6.Unknown,n.du.Any)&&(u.Yd.debug(`FileHistoryNode.onRepositoryChanged(${e.toString()}); triggering node refresh`),this.triggerChange(!0))}onFileSystemChanged(e){if(this.folder){if(!e.uris.some((e=>e.fsPath.startsWith(this.uri.fsPath))))return}else if(!e.uris.some((e=>e.toString()===this.uri.toString())))return;u.Yd.debug(`FileHistoryNode.onFileSystemChanged(${this.uri.toString(!0)}); triggering node refresh`),this.triggerChange(!0)}refresh(e){e&&(this._log=void 0)}async getLog(){return null==this._log&&(this._log=await this.view.container.git.getLogForFile(this.uri.repoPath,this.getPathOrGlob(),{limit:this.limit??this.view.config.pageItemLimit,ref:this.uri.sha})),this._log}getPathOrGlob(){return this.folder?r.Uri.joinPath(this.uri,"*"):this.uri}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1,this.splatted)))}}C([(0,c.fF)()],FileHistoryNode.prototype,"subscribe",1),C([(0,a.H)(),(0,c.fF)()],FileHistoryNode.prototype,"refresh",1),C([(0,l.H)()],FileHistoryNode.prototype,"getPathOrGlob",1),C([(0,a.H)()],FileHistoryNode.prototype,"loadMore",1)},145:(e,t,i)=>{i.d(t,{_:()=>FileHistoryTrackerNode});var r=i(9496),s=i(7462),n=i(4321),o=i(3636),a=i(4298),c=i(2061),l=i(5432),h=i(4241),u=i(9796),d=i(4336),p=i(6004),m=i(2509),g=i(906),f=i(6922),w=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?v(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&w(t,i,n),n};class FileHistoryTrackerNode extends f.CF{constructor(e){super(s.Wj,e),this.splatted=!0}dispose(){super.dispose(),this.resetChild()}resetChild(){null!=this._child&&(this._child.dispose(),this._child=void 0)}async getChildren(){if(null==this._child){if(!this.hasUri)return this.view.description=void 0,this.view.message="There are no editors open that can provide file history information.",[];this.view.message=void 0;const e={...this.uri,repoPath:this.uri.repoPath,sha:this._base??this.uri.sha},t=new s.YY(this.uri,e);let i,o=!1;try{((await r.workspace.fs.stat(this.uri)).type&r.FileType.Directory)===r.FileType.Directory&&(o=!0)}catch{}this.view.title=o?"Folder History":"File History",e.sha&&"HEAD"!==e.sha?(0,n.D3)(e.sha)||({values:[i]}=await this.view.container.git.getBranches(this.uri.repoPath,{filter:t=>t.name===e.sha})):i=await this.view.container.git.getBranch(this.uri.repoPath),this._child=new g.J(t,this.view,this,o,i)}return this._child.getChildren()}getTreeItem(){this.splatted=!1;const e=new r.TreeItem("File History",r.TreeItemCollapsibleState.Expanded);return e.contextValue=f.Td.ActiveFileHistory,e}get followingEditor(){return this.canSubscribe}get hasUri(){return this._uri!=s.Wj&&null!=this._uri.repoPath}async changeBase(){const e=await(0,o.V)(this.uri.repoPath,"Change File History Base","Choose a reference to set as the new base",{allowEnteringRefs:!0,picked:this._base,sort:{branches:{current:!0},tags:{}}});if(null!=e){if((0,n.UR)(e)){const t=await this.view.container.git.getBranch(this.uri.repoPath);this._base=t?.name===e.name?void 0:e.ref}else this._base=e.ref;null!=this._child&&(this.setUri(),await this.triggerChange())}}async refresh(e=!1){const t=(0,p.UH)();if(!this.canSubscribe)return!1;e&&(null!=this._uri&&this._uri!==s.Wj&&await this.view.container.tracker.resetCache(this._uri,"log"),this.reset());const i=r.window.activeTextEditor;if(null==i||!this.view.container.git.isTrackable(i.document.uri))return!!(!this.hasUri||this.view.container.git.isTrackable(this.uri)&&r.window.visibleTextEditors.some((e=>e.document?.uri.path===this.uri.path)))||(this.reset(),(0,p.lH)(t,`, uri=${d.Yd.toLoggable(this._uri)}`),!1);if(i.document.uri.path===this.uri.path)return(0,p.lH)(t,`, uri=${d.Yd.toLoggable(this._uri)}`),!0;let n,o=await s.YY.fromUri(i.document.uri);if(null!=o.sha){const e=await this.view.container.git.getWorkingUri(o.repoPath,o);null!=e&&(n=e)}return!(!this.hasUri||!a.n.equals(n??o,this.uri))||(null!=n&&(o=await s.YY.fromUri(n)),null==o.repoPath?this.reset():(this.setUri(o),this.resetChild()),(0,p.lH)(t,`, uri=${d.Yd.toLoggable(this._uri)}`),!1)}reset(){this.setUri(),this.resetChild()}setEditorFollowing(e){e&&this.setUri(),this.canSubscribe=e,e||this.triggerChange()}async showHistoryForUri(e){this.setUri(e),await this.triggerChange()}subscribe(){return r.Disposable.from(r.window.onDidChangeActiveTextEditor((0,u.Ds)(this.onActiveEditorChanged,250),this))}etag(){return 0}onActiveEditorChanged(e){if(null==e&&(0,m.pt)(this._uri))return null==this._triggerChangeDebounced&&(this._triggerChangeDebounced=(0,u.Ds)((()=>this.triggerChange()),1500)),void this._triggerChangeDebounced();this.triggerChange()}setUri(e){this._uri=e??s.Wj,(0,c.v)("gitlens:views:fileHistory:canPin",this.hasUri)}}y([(0,h.fF)()],FileHistoryTrackerNode.prototype,"resetChild",1),y([(0,l.H)(),(0,h.cM)()],FileHistoryTrackerNode.prototype,"changeBase",1),y([(0,l.H)(),(0,h.fF)({exit:!0})],FileHistoryTrackerNode.prototype,"refresh",1),y([(0,h.cM)()],FileHistoryTrackerNode.prototype,"setEditorFollowing",1),y([(0,h.cM)()],FileHistoryTrackerNode.prototype,"showHistoryForUri",1),y([(0,h.fF)()],FileHistoryTrackerNode.prototype,"subscribe",1),y([(0,h.fF)({args:!1})],FileHistoryTrackerNode.prototype,"onActiveEditorChanged",1)},9719:(e,t,i)=>{i.d(t,{m:()=>FileRevisionAsCommitNode});var r=i(9496),s=i(5255),n=i(9338),o=i(6373),a=i(7462),c=i(7881),l=i(5148),h=i(3700),u=i(7469),d=i(7692),p=i(4167),m=i(6922);class FileRevisionAsCommitNode extends m.RW{constructor(e,t,i,r,s={}){super(a.YY.fromFile(i,r.repoPath,r.sha),e,t,i),this.commit=r,this._options=s}toClipboard(){return`${this.commit.shortSha}: ${this.commit.summary}`}get isTip(){return(this._options.branch?.current&&this._options.branch.sha===this.commit.ref)??!1}get ref(){return this.commit}async getChildren(){if(!this.commit.file?.hasConflicts)return[];const[e,t]=await Promise.allSettled([this.view.container.git.getMergeStatus(this.commit.repoPath),this.view.container.git.getRebaseStatus(this.commit.repoPath)]),i=(0,u.Sb)(e);if(null==i)return[];const r=(0,u.Sb)(t);return null==r?[]:[new d.l(this.view,this,i??r,this.file),new p.w(this.view,this,i??r,this.file)]}async getTreeItem(){if(null==this.commit.file){const e=await this.commit.getCommitForFile(this.file);if(null==e){const e=await this.view.container.git.getLogForFile(this.repoPath,this.file.path,{limit:2,ref:this.commit.sha});null!=e&&(this.commit=e.commits.get(this.commit.sha)??this.commit)}else this.commit=e}const e=new r.TreeItem(n.i.fromTemplate(this.view.config.formats.commits.label,this.commit,{dateFormat:l.D.get("defaultDateFormat"),getBranchAndTagTips:e=>this._options.getBranchAndTagTips?.(e,{compact:!0}),messageTruncateAtNewLine:!0}),this.commit.file?.hasConflicts?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.None);if(e.contextValue=this.contextValue,e.description=n.i.fromTemplate(this.view.config.formats.commits.description,this.commit,{dateFormat:l.D.get("defaultDateFormat"),getBranchAndTagTips:e=>this._options.getBranchAndTagTips?.(e,{compact:!0}),messageTruncateAtNewLine:!0}),e.resourceUri=r.Uri.parse(`gitlens-view://commit-file/status/${this.file.status}`),!this.commit.isUncommitted&&this.view.config.avatars&&(e.iconPath=this._options.unpublished?new r.ThemeIcon("arrow-up",new r.ThemeColor("gitlens.unpublishedCommitIconColor")):await this.commit.getAvatarUri({defaultStyle:l.D.get("defaultGravatarsStyle")})),null==e.iconPath){const t=(0,c.tK)(this.file.status);e.iconPath={dark:this.view.container.context.asAbsolutePath((0,h.RQ)("images","dark",t)),light:this.view.container.context.asAbsolutePath((0,h.RQ)("images","light",t))}}return e.command=this.getCommand(),e}get contextValue(){return this.commit.isUncommitted?this.commit.file?.hasConflicts?`${m.Td.File}+conflicted`:this.commit.isUncommittedStaged?`${m.Td.File}+staged`:`${m.Td.File}+unstaged`:`${m.Td.File}+committed${this._options.branch?.current?"+current":""}${this.isTip?"+HEAD":""}${this._options.unpublished?"+unpublished":""}`}getCommand(){let e;if(e=this.commit.lines.length?this.commit.lines[0].line-1:this._options.selection?.active.line??0,this.commit.file?.hasConflicts)return{title:"Open Changes",command:s.Gh.DiffWith,arguments:[{lhs:{sha:"MERGE_HEAD",uri:a.YY.fromFile(this.file,this.repoPath,void 0,!0)},rhs:{sha:"HEAD",uri:a.YY.fromFile(this.file,this.repoPath)},repoPath:this.repoPath,line:0,showOptions:{preserveFocus:!1,preview:!1}}]};const t={commit:this.commit,uri:a.YY.fromFile(this.file,this.commit.repoPath),line:e,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:s.Gh.DiffWithPrevious,arguments:[void 0,t]}}async resolveTreeItem(e){return null==e.tooltip&&(e.tooltip=await this.getTooltip()),e}async getConflictBaseUri(){if(!this.commit.file?.hasConflicts)return;const e=await this.view.container.git.getMergeBase(this.repoPath,"MERGE_HEAD","HEAD");return a.YY.fromFile(this.file,this.repoPath,e??"HEAD")}async getTooltip(){const e=await this.view.container.git.getRemotesWithProviders(this.commit.repoPath),t=await this.view.container.git.getBestRemoteWithRichProvider(e);let i,s;if(null==this.commit.message&&await this.commit.ensureFullDetails(),null!=t?.provider){const[e,r]=await Promise.allSettled([this.view.container.autolinks.getLinkedIssuesAndPullRequests(this.commit.message??this.commit.summary,t),this.commit.getAssociatedPullRequest({remote:t})]);i=(0,u.Sb)(e),s=(0,u.Sb)(r),null!=s&&i?.delete(s.id)}const a=o.o.fromTemplate("${status}${ (originalPath)}${'&nbsp;&nbsp;•&nbsp;&nbsp;'changesDetail}",this.file),c=await n.i.fromTemplateAsync(this.view.config.formats.commits.tooltipWithStatus.replace("{{slot-status}}",a),this.commit,{autolinkedIssuesOrPullRequests:i,dateFormat:l.D.get("defaultDateFormat"),getBranchAndTagTips:this._options.getBranchAndTagTips,messageAutolinks:!0,messageIndent:4,pullRequestOrRemote:s,outputFormat:"markdown",remotes:e,unpublished:this._options.unpublished}),h=new r.MarkdownString(c,!0);return h.supportHtml=!0,h.isTrusted=!0,h}}},4481:(e,t,i)=>{i.d(t,{Y:()=>FolderNode});var r=i(9496),s=i(2540),n=i(7462),o=i(3620),a=i(6922);class FolderNode extends a.Re{constructor(e,t,i,r,s,o,c){super(n.YY.fromRepoPath(r),e,t),this.parent=t,this.root=i,this.repoPath=r,this.folderName=s,this.relativePath=o,this.containsWorkingFiles=c,this.priority=1,this._uniqueId=(0,a.tO)(`folder+${o??s}`,this.context)}get id(){return this._uniqueId}toClipboard(){return this.folderName}getChildren(){if(void 0===this.root.descendants||void 0===this.root.children)return[];let e;if(FolderNode.getFileNesting(this.view.config.files,this.root.descendants,void 0===this.relativePath)===s.Vc.List)this.root.descendants.forEach((e=>e.relativePath=this.root.relativePath)),e=this.root.descendants;else{e=[];for(const t of this.root.children.values())void 0!==t.value?(t.value.parent=this.folderName?this:this.parent,t.value.relativePath=this.root.relativePath,e.push(t.value)):e.push(new FolderNode(this.view,this.folderName?this:this.parent,t,this.repoPath,t.name,t.relativePath,this.containsWorkingFiles))}return e.sort(((e,t)=>(e instanceof FolderNode?-1:1)-(t instanceof FolderNode?-1:1)||e.priority-t.priority||(0,o.dm)(e.label,t.label))),e}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.Expanded);return e.id=this.id,e.contextValue=a.Td.Folder,this.containsWorkingFiles&&(e.contextValue+="+working"),e.iconPath=r.ThemeIcon.Folder,e.tooltip=this.label,e}get label(){return this.folderName}static getFileNesting(e,t,i){const r=e.layout||s.Vc.Auto;if(r===s.Vc.Auto){if(i||e.compact){const i=e.threshold||5;if(t.length<=i)return s.Vc.List}return s.Vc.Tree}return r}}},4741:(e,t,i)=>{i.d(t,{E:()=>o});var r=i(21),s=i(6922);const n=[[0,"Less than a week ago"],[7,"Over a week ago"],[25,"Over a month ago"],[77,"Over 3 months ago"]];function*o(e,t,i,{show:o}={show:!0}){if(!t.view.config.showRelativeDateMarkers||!o)return yield*e;let a,c=i??0;const l=Date.now();let h=!0;for(const i of e){if(c<n.length){let[e,o]=n[c];if(void 0===a){const t=new Date(l);a=t.setDate(t.getDate()-e)}const u=new Date(i.commit.committer.date).setUTCHours(0,0,0,0);if(u<=a){for(;c<n.length-1;){[e]=n[c+1];const t=new Date(l);if(u>t.setDate(t.getDate()-e))break;c++,a=void 0,[,o]=n[c]}h||(yield new r.AE(t.view,t,"",o,void 0,void 0,s.Td.DateMarker)),c++,a=void 0}}h=!1,yield i}}},3126:(e,t,i)=>{i.d(t,{q:()=>LineHistoryNode});var r=i(9496),s=i(439),n=i(7881),o=i(4321),a=i(3646),c=i(5432),l=i(4241),h=i(4488),u=i(3105),d=i(4336),p=i(21),m=i(9719),g=i(4741),f=i(1614),w=i(6922),v=Object.defineProperty,y=Object.getOwnPropertyDescriptor,b=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?y(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&v(t,i,n),n};class LineHistoryNode extends w.CF{constructor(e,t,i,r,s,n){super(e,t,i),this.parent=i,this.branch=r,this.selection=s,this.editorContents=n,this.splatted=!0,null!=r&&this.updateContext({branch:r}),this._uniqueId=(0,w.tO)(`file-history+${e.toString()}+[${s.start.line},${s.start.character}-${s.end.line},${s.end.character}]`,this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}toClipboard(){return this.uri.fileName}async getChildren(){this.view.description=`${this.label}${this.parent instanceof f.A&&!this.parent.followingEditor?" (pinned)":""}`;const e=[];if(null==this.uri.repoPath)return e;let t=this.selection;const i=null!=this.branch?await this.view.container.git.getBranchAheadRange(this.branch):void 0,[s,a,c,l]=await Promise.all([this.getLog(t),null==this.uri.sha||(0,o.l3)(this.uri.sha)?this.editorContents?await this.view.container.git.getBlameForRangeContents(this.uri,t,this.editorContents):await this.view.container.git.getBlameForRange(this.uri,t):void 0,null!=this.branch?this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath,this.branch.name):void 0,i?this.view.container.git.getLogRefsOnly(this.uri.repoPath,{limit:0,ref:i}):void 0]);if(null!=a)for(const i of a.commits.values()){if(!i.isUncommitted)continue;const s=a.lines[0],o=a.lines[a.lines.length-1],c=t.active.line===s.line-1;t=new r.Selection((c?o:s).originalLine-1,t.anchor.character,(c?s:o).originalLine-1,t.active.character);const l=await this.view.container.git.getStatusForFile(this.uri.repoPath,this.uri);if(null!=l){const r={conflictStatus:l?.conflictStatus,path:i.file?.path??"",indexStatus:l?.indexStatus,originalPath:i.file?.originalPath,repoPath:this.uri.repoPath,status:l?.status??n.NV.Modified,workingTreeStatus:l?.workingTreeStatus},s=await this.view.container.git.getCurrentUser(this.uri.repoPath),o=l?.getPseudoCommits(this.view.container,s);if(null!=o)for(const i of o.reverse())e.unshift(new m.m(this.view,this,r,i,{selection:t}))}break}return null!=s&&(e.push(...(0,g.E)((0,u.DZ)(s.commits.values(),(e=>null!=e.file?new m.m(this.view,this,e.file,e,{branch:this.branch,getBranchAndTagTips:c,selection:t,unpublished:l?.has(e.ref)}):void 0)),this)),s.hasMore&&e.push(new p.Gd(this.view,this,e[e.length-1]))),0===e.length?[new p.AE(this.view,this,"No line history could be found.")]:e}getTreeItem(){this.splatted=!1;const e=this.label,t=new r.TreeItem(e,r.TreeItemCollapsibleState.Expanded);return t.contextValue=w.Td.LineHistory,t.description=this.uri.directory,t.tooltip=`History of ${this.uri.fileName}${this.lines}\n${this.uri.directory}/${null==this.uri.sha?"":`\n\n${this.uri.sha}`}`,this.view.description=`${e}${this.parent instanceof f.A&&!this.parent.followingEditor?" (pinned)":""}`,t}get label(){return`${this.uri.fileName}${this.lines}${this.uri.sha?` ${this.uri.sha===s.Ii?this.uri.shortSha:`(${this.uri.shortSha})`}`:""}`}get lines(){return this.selection.isSingleLine?`:${this.selection.start.line+1}`:`:${this.selection.start.line+1}-${this.selection.end.line+1}`}subscribe(){const e=this.view.container.git.getRepository(this.uri);if(null==e)return;return r.Disposable.from(e.onDidChange(this.onRepositoryChanged,this),e.onDidChangeFileSystem(this.onFileSystemChanged,this),e.startWatchingFileSystem())}etag(){return Date.now()}onRepositoryChanged(e){e.changed(a.I6.Index,a.I6.Heads,a.I6.Remotes,a.I6.RemoteProviders,a.I6.Status,a.I6.Unknown,a.du.Any)&&(d.Yd.debug(`LineHistoryNode.onRepositoryChanged(${e.toString()}); triggering node refresh`),this.triggerChange(!0))}onFileSystemChanged(e){e.uris.some((e=>e.toString()===this.uri.toString()))&&(d.Yd.debug(`LineHistoryNode.onFileSystemChanged(${this.uri.toString(!0)}); triggering node refresh`),this.triggerChange(!0))}refresh(e){e&&(this._log=void 0)}async getLog(e){return null==this._log&&(this._log=await this.view.container.git.getLogForFile(this.uri.repoPath,this.uri,{all:!1,limit:this.limit??this.view.config.pageItemLimit,range:e??this.selection,ref:this.uri.sha,renames:!1})),this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1,this.splatted)))}}b([(0,h.H)()],LineHistoryNode.prototype,"lines",1),b([(0,l.fF)()],LineHistoryNode.prototype,"subscribe",1),b([(0,c.H)(),(0,l.fF)()],LineHistoryNode.prototype,"refresh",1),b([(0,c.H)()],LineHistoryNode.prototype,"loadMore",1)},1614:(e,t,i)=>{i.d(t,{A:()=>LineHistoryTrackerNode});var r=i(9496),s=i(7462),n=i(439),o=i(4321),a=i(3636),c=i(4298),l=i(2061),h=i(5432),u=i(4241),d=i(9796),p=i(4336),m=i(6004),g=i(3126),f=i(6922),w=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?v(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&w(t,i,n),n};class LineHistoryTrackerNode extends f.CF{constructor(e){super(s.Wj,e),this.splatted=!0}dispose(){super.dispose(),this.resetChild()}resetChild(){null!=this._child&&(this._child.dispose(),this._child=void 0)}async getChildren(){if(null==this._child){if(!this.hasUri)return this.view.description=void 0,this.view.message="There are no editors open that can provide line history information.",[];if(null==this._selection)return this.view.description=void 0,this.view.message="There was no selection provided for line history.",this.view.description=`${this.uri.fileName}${this.uri.sha?` ${this.uri.sha===n.Ii?this.uri.shortSha:`(${this.uri.shortSha})`}`:""}${this.followingEditor?"":" (pinned)"}`,[];this.view.message=void 0;const e={...this.uri,repoPath:this.uri.repoPath,sha:this.uri.sha??this._base},t=new s.YY(this.uri,e);let i;e.sha&&"HEAD"!==e.sha?(0,o.D3)(e.sha)||({values:[i]}=await this.view.container.git.getBranches(this.uri.repoPath,{filter:t=>t.name===e.sha})):i=await this.view.container.git.getBranch(this.uri.repoPath),this._child=new g.q(t,this.view,this,i,this._selection,this._editorContents)}return this._child.getChildren()}getTreeItem(){this.splatted=!1;const e=new r.TreeItem("Line History",r.TreeItemCollapsibleState.Expanded);return e.contextValue=f.Td.ActiveLineHistory,this.ensureSubscription(),e}get followingEditor(){return this.canSubscribe}get hasUri(){return this._uri!=s.Wj&&null!=this._uri.repoPath}async changeBase(){const e=await(0,a.V)(this.uri.repoPath,"Change Line History Base","Choose a reference to set as the new base",{allowEnteringRefs:!0,picked:this._base,sort:{branches:{current:!0},tags:{}}});if(null!=e){if((0,o.UR)(e)){const t=await this.view.container.git.getBranch(this.uri.repoPath);this._base=t?.name===e.name?void 0:e.ref}else this._base=e.ref;null!=this._child&&(this.setUri(),await this.triggerChange())}}async refresh(e=!1){const t=(0,m.UH)();if(!this.canSubscribe)return!1;e&&(null!=this._uri&&this._uri!==s.Wj&&await this.view.container.tracker.resetCache(this._uri,"log"),this.reset());const i=r.window.activeTextEditor;if(null==i||!this.view.container.git.isTrackable(i.document.uri))return!!(!this.hasUri||this.view.container.git.isTrackable(this.uri)&&r.window.visibleTextEditors.some((e=>e.document?.uri.path===this.uri.path)))||(this.reset(),(0,m.lH)(t,`, uri=${p.Yd.toLoggable(this._uri)}`),!1);if(i.document.uri.path===this.uri.path&&null!=this._selection&&i.selection.isEqual(this._selection))return(0,m.lH)(t,`, uri=${p.Yd.toLoggable(this._uri)}`),!0;const n=await s.YY.fromUri(i.document.uri);return!!(this.hasUri&&c.n.equals(n,this.uri)&&null!=this._selection&&i.selection.isEqual(this._selection))||(null==n.repoPath?this.reset():(this.setUri(n),this._editorContents=i.document.isDirty?i.document.getText():void 0,this._selection=i.selection,this.resetChild()),(0,m.lH)(t,`, uri=${p.Yd.toLoggable(this._uri)}`),!1)}reset(){this.setUri(),this._editorContents=void 0,this._selection=void 0,this.resetChild()}setEditorFollowing(e){this.canSubscribe=e}subscribe(){if(this.view.container.lineTracker.subscribed(this))return;const e=(0,d.Ds)(this.onActiveLinesChanged.bind(this),250);return this.view.container.lineTracker.subscribe(this,this.view.container.lineTracker.onDidChangeActiveLines((t=>{t.pending||e(t)})))}etag(){return 0}onActiveLinesChanged(e){this.triggerChange()}setUri(e){this._uri=e??s.Wj,(0,l.v)("gitlens:views:fileHistory:canPin",this.hasUri)}}y([(0,u.fF)()],LineHistoryTrackerNode.prototype,"resetChild",1),y([(0,h.H)(),(0,u.cM)()],LineHistoryTrackerNode.prototype,"changeBase",1),y([(0,h.H)(),(0,u.fF)({exit:!0})],LineHistoryTrackerNode.prototype,"refresh",1),y([(0,u.cM)()],LineHistoryTrackerNode.prototype,"setEditorFollowing",1),y([(0,u.fF)()],LineHistoryTrackerNode.prototype,"subscribe",1),y([(0,u.fF)({args:{0:e=>`editor=${e.editor?.document.uri.toString(!0)}, selections=${e.selections?.map((e=>`[${e.anchor}-${e.active}]`)).join(",")}, pending=${Boolean(e.pending)}, reason=${e.reason}`}})],LineHistoryTrackerNode.prototype,"onActiveLinesChanged",1)},7692:(e,t,i)=>{i.d(t,{l:()=>MergeConflictCurrentChangesNode});var r=i(9496),s=i(5255),n=i(9338),o=i(7462),a=i(4321),c=i(9529),l=i(5148),h=i(6922);class MergeConflictCurrentChangesNode extends h.Re{constructor(e,t,i,r){super(o.YY.fromFile(r,i.repoPath,"HEAD"),e,t),this.parent=t,this.status=i,this.file=r}getChildren(){return[]}async getTreeItem(){const e=await this.view.container.git.getCommit(this.status.repoPath,"HEAD"),t=new r.TreeItem("Current changes",r.TreeItemCollapsibleState.None);t.contextValue=h.Td.MergeConflictCurrentChanges,t.description=`${(0,a.Wh)(this.status.current,{expand:!1,icon:!1})}${null!=e?` (${(0,a.Wh)(e,{expand:!1,icon:!1})})`:" (HEAD)"}`,t.iconPath=this.view.config.avatars?await(e?.getAvatarUri({defaultStyle:l.D.get("defaultGravatarsStyle")}))??new r.ThemeIcon("diff"):new r.ThemeIcon("diff");const i=new r.MarkdownString(`Current changes to $(file)${s.NE.Space}${this.file.path} on ${(0,a.Wh)(this.status.current)}${null!=e?`\n\n${await n.i.fromTemplateAsync("${avatar}&nbsp;__${author}__, ${ago} &nbsp; _(${date})_ \n\n${message}\n\n${link}${' via 'pullRequest}",e,{avatarSize:16,dateFormat:l.D.get("defaultDateFormat"),messageIndent:4,outputFormat:"markdown"})}`:""}`,!0);return i.supportHtml=!0,i.isTrusted=!0,t.tooltip=i,t.command=this.getCommand(),t}getCommand(){return null==this.status.mergeBase?(0,c.j$)("vscode.open","Open Revision",this.view.container.git.getRevisionUri("HEAD",this.file.path,this.status.repoPath)):(0,c.fA)(s.Gh.DiffWith,"Open Changes",{lhs:{sha:this.status.mergeBase,uri:o.YY.fromFile(this.file,this.status.repoPath,void 0,!0),title:`${this.file.path} (merge-base)`},rhs:{sha:"HEAD",uri:o.YY.fromFile(this.file,this.status.repoPath),title:`${this.file.path} (${(0,a.Wh)(this.status.current,{expand:!1,icon:!1})})`},repoPath:this.status.repoPath,line:0,showOptions:{preserveFocus:!0,preview:!0}})}}},981:(e,t,i)=>{i.d(t,{E:()=>MergeConflictFileNode});var r=i(9496),s=i(6373),n=i(7462),o=i(9529),a=i(3700),c=i(7692),l=i(4167),h=i(6922);class MergeConflictFileNode extends h.Te{constructor(e,t,i,r){super(n.YY.fromFile(i,r.repoPath,r.HEAD.ref),e,t,i),this.status=r}toClipboard(){return this.fileName}get baseUri(){return n.YY.fromFile(this.file,this.status.repoPath,this.status.mergeBase??"HEAD")}get fileName(){return this.file.path}getChildren(){return[new c.l(this.view,this,this.status,this.file),new l.w(this.view,this,this.status,this.file)]}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.Collapsed);e.description=this.description,e.contextValue=`${h.Td.File}+conflicted`;const t=s.o.fromTemplate("${file}${ • changesDetail}${\\\\\ndirectory}${\n\nstatus}${ (originalPath)} in Index (staged)",this.file),i=new r.MarkdownString(t,!0);return i.isTrusted=!0,i.supportHtml=!0,e.tooltip=i,e.resourceUri=this.view.container.git.getAbsoluteUri(this.file.path,this.repoPath),e.iconPath=r.ThemeIcon.File,e.command=this.getCommand(),this._label=void 0,this._description=void 0,e}get description(){return null==this._description&&(this._description=s.o.fromTemplate(this.view.config.formats.files.description,this.file,{relativePath:this.relativePath})),this._description}get folderName(){return null==this._folderName&&(this._folderName=(0,a.Fd)(this.uri.relativePath)),this._folderName}get label(){return null==this._label&&(this._label=s.o.fromTemplate(this.view.config.formats.files.label,this.file,{relativePath:this.relativePath})),this._label}get priority(){return 0}get relativePath(){return this._relativePath}set relativePath(e){this._relativePath=e,this._label=void 0,this._description=void 0}getCommand(){return(0,o.j$)("vscode.open","Open File",this.view.container.git.getAbsoluteUri(this.file.path,this.repoPath),{preserveFocus:!0,preview:!0})}}},4167:(e,t,i)=>{i.d(t,{w:()=>MergeConflictIncomingChangesNode});var r=i(9496),s=i(5255),n=i(9338),o=i(7462),a=i(4321),c=i(9529),l=i(5148),h=i(6922);class MergeConflictIncomingChangesNode extends h.Re{constructor(e,t,i,r){super(o.YY.fromFile(r,i.repoPath,i.HEAD.ref),e,t),this.parent=t,this.status=i,this.file=r}getChildren(){return[]}async getTreeItem(){const e=await this.view.container.git.getCommit(this.status.repoPath,"rebase"===this.status.type?this.status.steps.current.commit.ref:this.status.HEAD.ref),t=new r.TreeItem("Incoming changes",r.TreeItemCollapsibleState.None);t.contextValue=h.Td.MergeConflictIncomingChanges,t.description=`${(0,a.Wh)(this.status.incoming,{expand:!1,icon:!1})}${"rebase"===this.status.type?` (${(0,a.Wh)(this.status.steps.current.commit,{expand:!1,icon:!1})})`:` (${(0,a.Wh)(this.status.HEAD,{expand:!1,icon:!1})})`}`,t.iconPath=this.view.config.avatars?await(e?.getAvatarUri({defaultStyle:l.D.get("defaultGravatarsStyle")}))??new r.ThemeIcon("diff"):new r.ThemeIcon("diff");const i=new r.MarkdownString(`Incoming changes to $(file)${s.NE.Space}${this.file.path}${null!=this.status.incoming?` from ${(0,a.Wh)(this.status.incoming)}${null!=e?`\n\n${await n.i.fromTemplateAsync("${avatar}&nbsp;__${author}__, ${ago} &nbsp; _(${date})_ \n\n${message}\n\n${link}${' via 'pullRequest}",e,{avatarSize:16,dateFormat:l.D.get("defaultDateFormat"),messageIndent:4,outputFormat:"markdown"})}`:"rebase"===this.status.type?`\n\n${(0,a.Wh)(this.status.steps.current.commit,{capitalize:!0,label:!1})}`:`\n\n${(0,a.Wh)(this.status.HEAD,{capitalize:!0,label:!1})}`}`:""}`,!0);return i.supportHtml=!0,i.isTrusted=!0,t.tooltip=i,t.command=this.getCommand(),t}getCommand(){return null==this.status.mergeBase?(0,c.j$)("vscode.open","Open Revision",this.view.container.git.getRevisionUri(this.status.HEAD.ref,this.file.path,this.status.repoPath)):(0,c.fA)(s.Gh.DiffWith,"Open Changes",{lhs:{sha:this.status.mergeBase,uri:o.YY.fromFile(this.file,this.status.repoPath,void 0,!0),title:`${this.file.path} (merge-base)`},rhs:{sha:this.status.HEAD.ref,uri:o.YY.fromFile(this.file,this.status.repoPath),title:`${this.file.path} (${null!=this.status.incoming?(0,a.Wh)(this.status.incoming,{expand:!1,icon:!1}):"incoming"})`},repoPath:this.status.repoPath,line:0,showOptions:{preserveFocus:!0,preview:!0}})}}},2487:(e,t,i)=>{i.d(t,{t:()=>MergeStatusNode});var r=i(9496),s=i(2540),n=i(7462),o=i(4321),a=i(2800),c=i(3700),l=i(3620),h=i(4481),u=i(981),d=i(6922);class MergeStatusNode extends d.Re{constructor(e,t,i,r,s,o){super(n.YY.fromRepoPath(r.repoPath),e,t),this.parent=t,this.branch=i,this.mergeStatus=r,this.status=s,this.root=o,this.updateContext({branch:i,root:o}),this._uniqueId=(0,d.tO)("merge-status",this.context)}get repoPath(){return this.uri.repoPath}getChildren(){if(!0!==this.status?.hasConflicts)return[];let e=this.status.conflicts.map((e=>new u.E(this.view,this,e,this.mergeStatus)));if(this.view.config.files.layout!==s.Vc.List){const t=(0,a.Mo)(e,(e=>e.uri.relativePath.split("/")),((...e)=>(0,c.AH)((0,c.RQ)(...e))),this.view.config.files.compact);e=new h.Y(this.view,this,t,this.repoPath,"",void 0).getChildren()}else e.sort(((e,t)=>(0,l.dm)(e.label,t.label)));return e}getTreeItem(){const e=new r.TreeItem(`${this.status?.hasConflicts?"Resolve conflicts before merging":"Merging"} ${null!=this.mergeStatus.incoming?`${(0,o.Wh)(this.mergeStatus.incoming,{expand:!1,icon:!1})} `:""}into ${(0,o.Wh)(this.mergeStatus.current,{expand:!1,icon:!1})}`,r.TreeItemCollapsibleState.Expanded);e.id=this.id,e.contextValue=d.Td.Merge,e.description=this.status?.hasConflicts?(0,l._6)("conflict",this.status.conflicts.length):void 0,e.iconPath=this.status?.hasConflicts?new r.ThemeIcon("warning",new r.ThemeColor("list.warningForeground")):new r.ThemeIcon("debug-pause",new r.ThemeColor("list.foreground"));const t=new r.MarkdownString(`Merging ${null!=this.mergeStatus.incoming?(0,o.Wh)(this.mergeStatus.incoming):""}into ${(0,o.Wh)(this.mergeStatus.current)}${this.status?.hasConflicts?`\n\n${(0,l._6)("conflicted file",this.status.conflicts.length)}`:""}`,!0);return t.supportHtml=!0,t.isTrusted=!0,e.tooltip=t,e}}},2060:(e,t,i)=>{i.d(t,{Z:()=>PullRequestNode});var r=i(9496),s=i(7462),n=i(5367),o=i(4092),a=i(6922);class PullRequestNode extends a.Re{constructor(e,t,i,r){let o,c;"string"==typeof r?c=r:(c=r.repoPath,o=r),super(s.YY.fromRepoPath(c),e,t),this.parent=t,this.pullRequest=i,null!=o&&(o instanceof n.XI?this.updateContext({branch:o}):this.updateContext({commit:o})),this._uniqueId=(0,a.tO)("pullrequest",this.context),this.repoPath=c}get id(){return this._uniqueId}toClipboard(){return this.pullRequest.url}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(`#${this.pullRequest.id}: ${this.pullRequest.title}`,r.TreeItemCollapsibleState.None);e.id=this.id,e.contextValue=a.Td.PullRequest,e.description=`${this.pullRequest.state}, ${this.pullRequest.formatDateFromNow()}`,e.iconPath=o.i7.getThemeIcon(this.pullRequest);const t=new r.MarkdownString("",!0);t.supportHtml=!0,t.isTrusted=!0,null!=this.context.commit&&t.appendMarkdown(`Commit \`$(git-commit) ${this.context.commit.shortSha}\` was introduced by $(git-pull-request) PR #${this.pullRequest.id}\n\n`);const i=` "Open Pull Request \\#${this.pullRequest.id} on ${this.pullRequest.provider.name}"`;return t.appendMarkdown(`${o.i7.getMarkdownIcon(this.pullRequest)} [**${this.pullRequest.title.trim()}**](${this.pullRequest.url}${i}) \\\n[#${this.pullRequest.id}](${this.pullRequest.url}${i}) by [@${this.pullRequest.author.name}](${this.pullRequest.author.url} "Open @${this.pullRequest.author.name} on ${this.pullRequest.provider.name}") was ${this.pullRequest.state===o.o0.Open?"opened":this.pullRequest.state.toLowerCase()} ${this.pullRequest.formatDateFromNow()}`),e.tooltip=t,e}}},1321:(e,t,i)=>{i.d(t,{S:()=>RebaseStatusNode});var r=i(9496),s=i(2540),n=i(5255),o=i(9338),a=i(7462),c=i(4321),l=i(2800),h=i(9529),u=i(5148),d=i(3700),p=i(7469),m=i(3620),g=i(2601),f=i(4481),w=i(981),v=i(6922);class RebaseStatusNode extends v.Re{constructor(e,t,i,r,s,n){super(a.YY.fromRepoPath(r.repoPath),e,t),this.parent=t,this.branch=i,this.rebaseStatus=r,this.status=s,this.root=n,this.updateContext({branch:i,root:n}),this._uniqueId=(0,v.tO)("merge-status",this.context)}get repoPath(){return this.uri.repoPath}async getChildren(){let e=this.status?.conflicts.map((e=>new w.E(this.view,this,e,this.rebaseStatus)))??[];if(this.view.config.files.layout!==s.Vc.List){const t=(0,l.Mo)(e,(e=>e.uri.relativePath.split("/")),((...e)=>(0,d.AH)((0,d.RQ)(...e))),this.view.config.files.compact);e=new f.Y(this.view,this,t,this.repoPath,"",void 0).getChildren()}else e.sort(((e,t)=>(0,m.dm)(e.label,t.label)));const t=await this.view.container.git.getCommit(this.rebaseStatus.repoPath,this.rebaseStatus.steps.current.commit.ref);return null!=t&&e.unshift(new RebaseCommitNode(this.view,this,t)),e}getTreeItem(){const e=new r.TreeItem(`${this.status?.hasConflicts?"Resolve conflicts to continue rebasing":"Rebasing"} ${null!=this.rebaseStatus.incoming?`${(0,c.Wh)(this.rebaseStatus.incoming,{expand:!1,icon:!1})}`:""} (${this.rebaseStatus.steps.current.number}/${this.rebaseStatus.steps.total})`,r.TreeItemCollapsibleState.Expanded);e.id=this.id,e.contextValue=v.Td.Rebase,e.description=this.status?.hasConflicts?(0,m._6)("conflict",this.status.conflicts.length):void 0,e.iconPath=this.status?.hasConflicts?new r.ThemeIcon("warning",new r.ThemeColor("list.warningForeground")):new r.ThemeIcon("debug-pause",new r.ThemeColor("list.foreground"));const t=new r.MarkdownString(`Rebasing ${null!=this.rebaseStatus.incoming?(0,c.Wh)(this.rebaseStatus.incoming):""}onto ${(0,c.Wh)(this.rebaseStatus.current)}\n\nStep ${this.rebaseStatus.steps.current.number} of ${this.rebaseStatus.steps.total}\\\nPaused at ${(0,c.Wh)(this.rebaseStatus.steps.current.commit,{icon:!0})}${this.status?.hasConflicts?`\n\n${(0,m._6)("conflicted file",this.status.conflicts.length)}`:""}`,!0);return t.supportHtml=!0,t.isTrusted=!0,e.tooltip=t,e}async openEditor(){const e=r.Uri.joinPath(this.uri,".git","rebase-merge","git-rebase-todo");await(0,h.dO)("vscode.openWith",e,"gitlens.rebase",{preview:!1})}}class RebaseCommitNode extends v.bT{constructor(e,t,i){super(i.getGitUri(),e,t),this.commit=i}toClipboard(){return`${this.commit.shortSha}: ${this.commit.summary}`}get ref(){return this.commit}async getChildren(){const e=this.commit;let t=(await e.getCommitsForFiles()).map((e=>new g.R(this.view,this,e.file,e)));if(this.view.config.files.layout!==s.Vc.List){const e=(0,l.Mo)(t,(e=>e.uri.relativePath.split("/")),((...e)=>(0,d.AH)((0,d.RQ)(...e))),this.view.config.files.compact);t=new f.Y(this.view,this,e,this.repoPath,"",void 0).getChildren()}else t.sort(((e,t)=>(0,m.dm)(e.label,t.label)));return t}getTreeItem(){const e=new r.TreeItem(`Paused at commit ${this.commit.shortSha}`,r.TreeItemCollapsibleState.Collapsed);return e.description=o.i.fromTemplate("${message}",this.commit,{messageTruncateAtNewLine:!0}),e.iconPath=new r.ThemeIcon("git-commit"),e}getCommand(){const e={commit:this.commit,uri:this.uri,line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:n.Gh.DiffWithPrevious,arguments:[void 0,e]}}async resolveTreeItem(e){return null==e.tooltip&&(e.tooltip=await this.getTooltip()),e}async getTooltip(){const e=await this.view.container.git.getRemotesWithProviders(this.commit.repoPath),t=await this.view.container.git.getBestRemoteWithRichProvider(e);let i,s;if(null==this.commit.message&&await this.commit.ensureFullDetails(),null!=t?.provider){const[e,r]=await Promise.allSettled([this.view.container.autolinks.getLinkedIssuesAndPullRequests(this.commit.message??this.commit.summary,t),this.commit.getAssociatedPullRequest({remote:t})]);i=(0,p.Sb)(e),s=(0,p.Sb)(r),null!=s&&i?.delete(s.id)}const n=await o.i.fromTemplateAsync(`Rebase paused at ${this.view.config.formats.commits.tooltip}`,this.commit,{autolinkedIssuesOrPullRequests:i,dateFormat:u.D.get("defaultDateFormat"),messageAutolinks:!0,messageIndent:4,pullRequestOrRemote:s,outputFormat:"markdown",remotes:e}),a=new r.MarkdownString(n,!0);return a.supportHtml=!0,a.isTrusted=!0,a}}},8896:(e,t,i)=>{i.d(t,{Y:()=>ReflogNode});var r=i(9496),s=i(5432),n=i(4241),o=i(21),a=i(5255),c=i(7462),l=i(3105),h=i(2925),u=i(6922),d=Object.defineProperty,p=Object.getOwnPropertyDescriptor,m=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?p(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&d(t,i,n),n};class ReflogRecordNode extends u.Re{constructor(e,t,i){super(c.YY.fromRepoPath(i.repoPath),e,t),this.record=i,this.updateContext({reflog:i}),this._uniqueId=(0,u.tO)("reflog-record",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}async getChildren(){const e=await this.getLog();if(void 0===e)return[new o.AE(this.view,this,"No commits could be found.")];const t=[...(0,l.UI)(e.commits.values(),(e=>new h.D(this.view,this,e)))];return e.hasMore&&t.push(new o.Gd(this.view,this,t[t.length-1])),t}getTreeItem(){const e=new r.TreeItem(`${this.record.command}${this.record.commandArgs?` ${this.record.commandArgs}`:""}`,r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.description=`${0===this.record.HEAD.length?"":`${this.record.HEAD} ${a.NE.Space}${a.NE.Dot}${a.NE.Space} `}${this.record.formattedDate}`,e.contextValue=u.Td.ReflogRecord,e.tooltip=`${0===this.record.HEAD.length?"":`${this.record.HEAD}\n`}${this.record.command}${this.record.commandArgs?` ${this.record.commandArgs}`:""}${this.record.details?` (${this.record.details})`:""}\n${this.record.formatDateFromNow()} (${this.record.formatDate()})\n${this.record.previousShortSha} ${a.NE.Space}${a.NE.ArrowRight}${a.NE.Space} ${this.record.shortSha}`,e}refresh(e){e&&(this._log=void 0)}async getLog(){if(void 0===this._log){const e=`${this.record.previousSha}..${this.record.sha}`;this._log=await this.view.container.git.getLog(this.uri.repoPath,{limit:this.limit??this.view.config.defaultItemLimit,ref:e})}return this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));void 0!==t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1)))}}m([(0,s.H)(),(0,n.fF)()],ReflogRecordNode.prototype,"refresh",1),m([(0,s.H)()],ReflogRecordNode.prototype,"loadMore",1);var g=Object.defineProperty,f=Object.getOwnPropertyDescriptor;class ReflogNode extends u.Re{constructor(e,t,i,r){super(e,t,i),this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,u.tO)("reflog",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}async getChildren(){if(void 0===this._children){const e=[],t=await this.getReflog();if(void 0===t||0===t.records.length)return[new o.AE(this.view,this,"No activity could be found.")];e.push(...t.records.map((e=>new ReflogRecordNode(this.view,this,e)))),t.hasMore&&e.push(new o.Gd(this.view,this,e[e.length-1])),this._children=e}return this._children}getTreeItem(){const e=new r.TreeItem("Incoming Activity",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=u.Td.Reflog,e.description="experimental",e.iconPath={dark:this.view.container.context.asAbsolutePath("images/dark/icon-activity.svg"),light:this.view.container.context.asAbsolutePath("images/light/icon-activity.svg")},e}refresh(e){this._children=void 0,e&&(this._reflog=void 0)}async getReflog(){return void 0===this._reflog&&(this._reflog=await this.view.container.git.getIncomingActivity(this.repo.path,{all:!0,limit:this.limit??this.view.config.defaultItemLimit})),this._reflog}get hasMore(){return this._reflog?.hasMore??!0}async loadMore(e){let t=await this.getReflog();void 0!==t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._reflog!==t&&(this._reflog=t,this.limit=t?.count,this.triggerChange(!1)))}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?f(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&g(t,i,n)})([(0,s.H)(),(0,n.fF)()],ReflogNode.prototype,"refresh",1)},1351:(e,t,i)=>{i.d(t,{V:()=>RemoteNode});var r=i(9496),s=i(2540),n=i(5255),o=i(7462),a=i(3050),c=i(2800),l=i(4241),h=i(7382),u=i(4004),d=i(21),p=i(6922),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor;class RemoteNode extends p.Re{constructor(e,t,i,r,s){super(e,t,i),this.parent=i,this.repo=r,this.remote=s,this.updateContext({repository:r,remote:s}),this._uniqueId=(0,p.tO)("remote",this.context)}get id(){return this._uniqueId}toClipboard(){return this.remote.name}get repoPath(){return this.repo.path}async getChildren(){const e=await this.repo.getBranches({filter:e=>e.remote&&e.name.startsWith(this.remote.name),sort:!0});if(0===e.values.length)return[new d.AE(this.view,this,"No branches could be found.")];const t=e.values.map((e=>new h.E(o.YY.fromRepoPath(this.uri.repoPath,e.ref),this.view,this,this.repo,e,!1,{showComparison:!1,showTracking:!1})));if(this.view.config.branches.layout===s.CZ.List)return t;const i=(0,c.Mo)(t,(e=>e.treeHierarchy),((...e)=>e.join("/")),this.view.config.files.compact,(e=>(e.compacted=!0,!0)));return new u.n(this.view,this,"remote-branch",i,this.repo.path,"",void 0).getChildren()}async getTreeItem(){const e=new r.TreeItem(this.remote.name,r.TreeItemCollapsibleState.Collapsed);if(e.id=this.id,e.description=(0,a.jv)(this.remote),null!=this.remote.provider){const{provider:t}=this.remote;if(e.iconPath=null!=t.avatarUri&&this.view.config.avatars?t.avatarUri:"remote"===t.icon?new r.ThemeIcon("cloud"):{dark:this.view.container.context.asAbsolutePath(`images/dark/icon-${t.icon}.svg`),light:this.view.container.context.asAbsolutePath(`images/light/icon-${t.icon}.svg`)},t.hasRichIntegration()){const i=t.maybeConnected??await t.isConnected();e.contextValue=`${p.Td.Remote}${i?"+connected":"+disconnected"}`,e.tooltip=`${this.remote.name} (${t.name} ${n.NE.Dash} ${i?"connected":"not connected"})\n${t.displayPath}\n`}else e.contextValue=p.Td.Remote,e.tooltip=`${this.remote.name} (${t.name})\n${t.displayPath}\n`}else e.contextValue=p.Td.Remote,e.iconPath=new r.ThemeIcon("cloud"),e.tooltip=`${this.remote.name} (${this.remote.domain})\n${this.remote.path}\n`;this.remote.default&&(e.contextValue+="+default",e.resourceUri=r.Uri.parse("gitlens-view://remote/default"));for(const{type:t,url:i}of this.remote.urls)e.tooltip+=`\n${i} (${t})`;return e}async setAsDefault(e=!0){await this.remote.setAsDefault(e),this.triggerChange()}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&m(t,i,n)})([(0,l.cM)()],RemoteNode.prototype,"setAsDefault",1)},1952:(e,t,i)=>{i.d(t,{e:()=>RemotesNode});var r=i(9496),s=i(5432),n=i(4241),o=i(21),a=i(1351),c=i(6922),l=Object.defineProperty,h=Object.getOwnPropertyDescriptor;class RemotesNode extends c.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,c.tO)("remotes",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){const e=await this.repo.getRemotes({sort:!0});if(0===e.length)return[new o.AE(this.view,this,"No remotes could be found")];this._children=e.map((e=>new a.V(this.uri,this.view,this,this.repo,e)))}return this._children}getTreeItem(){const e=new r.TreeItem("Remotes",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=c.Td.Remotes,e.iconPath=new r.ThemeIcon("cloud"),e}refresh(){this._children=void 0}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?h(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&l(t,i,n)})([(0,s.H)(),(0,n.fF)()],RemotesNode.prototype,"refresh",1)},7424:(e,t,i)=>{i.d(t,{S:()=>RepositoriesNode});var r=i(9496),s=i(7462),n=i(5432),o=i(4241),a=i(9796),c=i(4336),l=i(21),h=i(9100),u=i(6922),d=Object.defineProperty,p=Object.getOwnPropertyDescriptor,m=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?p(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&d(t,i,n),n};class RepositoriesNode extends u.CF{constructor(e){super(s.Wj,e)}dispose(){super.dispose(),this.resetChildren()}resetChildren(){if(null!=this._children){for(const e of this._children)"dispose"in e&&e.dispose();this._children=void 0}}getChildren(){if(null==this._children){const e=this.view.container.git.openRepositories;if(0===e.length)return[new l.AE(this.view,this,"No repositories could be found.")];this._children=e.map((e=>new h.q(s.YY.fromRepoPath(e.path),this.view,this,e)))}return this._children}getTreeItem(){const e="workspaces"===this.view.type,t=e&&null!=this.view.container.workspaces.currentWorkspaceId,i=t&&null!=this.view.container.workspaces.currentWorkspace,s=new r.TreeItem(e?"Current Window":"Repositories",e?r.TreeItemCollapsibleState.Collapsed:r.TreeItemCollapsibleState.Expanded);e&&(s.description=r.workspace.name??r.workspace.workspaceFolders?.[0]?.name??"");let n=u.Td.Repositories;return e&&(n+="+workspaces"),t&&(n+="+linked"),i&&(n+="+current",s.resourceUri=r.Uri.parse("gitlens-view://workspaces/workspace/current")),s.contextValue=n,s}async refresh(e=!1){if(null==this._children)return;if(e)return this.resetChildren(),await this.unsubscribe(),void this.ensureSubscription();const t=this.view.container.git.openRepositories;if(0===t.length&&(null==this._children||0===this._children.length))return;if(0===t.length)return void(this._children=[new l.AE(this.view,this,"No repositories could be found.")]);const i=[];for(const e of t){const t=e.id,r=this._children.find((e=>e.repo.id===t));null!=r?(i.push(r),r.refresh()):i.push(new h.q(s.YY.fromRepoPath(e.path),this.view,this,e))}for(const e of this._children)i.includes(e)||e.dispose();this._children=i,this.ensureSubscription()}subscribe(){const e=[this.view.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this)];return this.view.config.autoReveal&&e.push(r.window.onDidChangeActiveTextEditor((0,a.Ds)(this.onActiveEditorChanged,500),this)),r.Disposable.from(...e)}etag(){return(0,a.NX)(this.view.container.git.etag,this.view.container.subscription.etag)}onActiveEditorChanged(e){if(null!=e&&null!=this._children&&1!==this._children.length)try{const t=e.document.uri,i=this._children.find((e=>e instanceof h.q&&e.repo.containsUri(t)));if(null==i)return;let r=0===this.view.selection.length?void 0:this.view.selection[0];for(;null!=r;){if(r===i)return;r=r.getParent()}this.view.reveal(i,{expand:!0})}catch(e){c.Yd.error(e)}}onRepositoriesChanged(e){this.triggerChange(!0)}}m([(0,o.fF)()],RepositoriesNode.prototype,"resetChildren",1),m([(0,n.H)(),(0,o.fF)()],RepositoriesNode.prototype,"refresh",1),m([(0,o.fF)()],RepositoriesNode.prototype,"subscribe",1),m([(0,o.fF)({args:!1})],RepositoriesNode.prototype,"onActiveEditorChanged",1),m([(0,o.fF)()],RepositoriesNode.prototype,"onRepositoriesChanged",1)},9100:(e,t,i)=>{i.d(t,{q:()=>RepositoryNode});var r=i(9496),s=i(5255),n=i(8887),o=i(5367),a=i(3050),c=i(3646),l=i(1907),h=i(2800),u=i(5432),d=i(4241),p=i(9796),m=i(3620),g=i(3608),f=i(7382),w=i(9354),v=i(21),y=i(9308),b=i(4562),C=i(2487),A=i(1321),P=i(8896),S=i(1952),R=i(727),D=i(2540),k=i(7462),_=i(3105),T=i(3700),F=i(7933),E=i(4481),$=i(6586),O=i(6922);class StatusFilesNode extends O.Re{constructor(e,t,i,r){super(k.YY.fromRepoPath(i.repoPath),e,t),this.parent=t,this.status=i,this.range=r,this._uniqueId=(0,O.tO)("status-files",this.context)}get id(){return this._uniqueId}get repoPath(){return this.status.repoPath}async getChildren(){let e=[];const t=this.repoPath;let i;null!=this.range&&(i=await this.view.container.git.getLog(t,{limit:0,ref:this.range}),null!=i&&(await Promise.allSettled((0,_.UI)((0,_.hX)(i.commits.values(),(e=>null==e.files)),(e=>e.ensureFullDetails()))),e=[...(0,_.VS)(i.commits.values(),(e=>e.files?.map((t=>({...t,commit:e})))??[]))])),(this.view instanceof F.m9||this.view.config.includeWorkingTree)&&0!==this.status.files.length&&e.unshift(...(0,_.VS)(this.status.files,(e=>(0,_.UI)(e.getPseudoCommits(this.view.container,void 0),(t=>this.getFileWithPseudoCommit(e,t)))))),e.sort(((e,t)=>t.commit.date.getTime()-e.commit.date.getTime()));const r=(0,h.vM)(e,(e=>e.path));let s=Object.values(r).map((e=>new $.q(this.view,this,e[e.length-1],t,e.map((e=>e.commit)))));if(this.view.config.files.layout!==D.Vc.List){const e=(0,h.Mo)(s,(e=>e.uri.relativePath.split("/")),((...e)=>(0,T.AH)((0,T.RQ)(...e))),this.view.config.files.compact);s=new E.Y(this.view,this,e,t,"",void 0,!0).getChildren()}else s.sort(((e,t)=>e.priority-t.priority||(0,m.dm)(e.label,t.label)));return s}async getTreeItem(){let e=this.view instanceof F.m9||this.view.config.includeWorkingTree?this.status.files.length:0;if(null!=this.range&&null!=this.status.upstream&&this.status.state.ahead>0)if(e>0){const t=await this.view.container.git.getDiffStatus(this.repoPath,`${this.status.upstream}...`);if(null!=t){const i=new Set;for(const e of this.status.files)i.add(e.path);for(const e of t)i.add(e.path);e=i.size}}else{const t=await this.view.container.git.getChangedFilesCount(this.repoPath,`${this.status.upstream}...`);null!=t?e+=t.changedFiles:e=-1}const t=-1===e?"?? files changed":`${(0,m._6)("file",e)} changed`,i=new r.TreeItem(t,r.TreeItemCollapsibleState.Collapsed);return i.id=this.id,i.contextValue=O.Td.StatusFiles,i.iconPath={dark:this.view.container.context.asAbsolutePath("images/dark/icon-diff.svg"),light:this.view.container.context.asAbsolutePath("images/light/icon-diff.svg")},i}getFileWithPseudoCommit(e,t){return{status:e.status,repoPath:e.repoPath,indexStatus:e.indexStatus,workingTreeStatus:e.workingTreeStatus,path:e.path,originalPath:e.originalPath,commit:t}}}var x=i(1841),I=i(8562),B=Object.defineProperty,W=Object.getOwnPropertyDescriptor,L=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?W(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&B(t,i,n),n};class RepositoryNode extends O.CF{constructor(e,t,i,r,s){super(e,t,i),this.repo=r,this.updateContext({...s,repository:this.repo}),this._uniqueId=(0,O.tO)("repository",this.context),this._status=this.repo.getStatus()}get id(){return this._uniqueId}toClipboard(){return this.repo.path}get repoPath(){return this.repo.path}get workspace(){return this.context.workspace}get wsRepositoryDescriptor(){return this.context.wsRepositoryDescriptor}async getChildren(){if(void 0===this._children){const e=[],t=await this._status;if(null!=t){const i=new o.XI(t.repoPath,t.branch,!1,!0,void 0,t.sha,t.upstream?{name:t.upstream,missing:!1}:void 0,t.state.ahead,t.state.behind,t.detached,t.rebasing);!1!==this.view.config.showBranchComparison&&e.push(new y._(this.uri,this.view,this,i,this.view.config.showBranchComparison,!0));const[r,n]=await Promise.all([this.view.container.git.getMergeStatus(t.repoPath),this.view.container.git.getRebaseStatus(t.repoPath)]);if(null!=r?e.push(new C.t(this.view,this,i,r,t,!0)):null!=n?e.push(new A.S(this.view,this,i,n,t,!0)):this.view.config.showUpstreamStatus&&(t.upstream?t.state.behind||t.state.ahead?(t.state.behind&&e.push(new w.V(this.view,this,i,t,"behind",!0)),t.state.ahead&&e.push(new w.V(this.view,this,i,t,"ahead",!0,{showAheadCommits:!0}))):e.push(new w.V(this.view,this,i,t,"same",!0)):e.push(new w.V(this.view,this,i,t,"none",!0))),this.view.config.includeWorkingTree&&0!==t.files.length){const i=void 0;e.push(new StatusFilesNode(this.view,this,t,i))}0===e.length||this.view.config.compact||e.push(new v.AE(this.view,this,"",s.NE.Dash.repeat(2),"")),this.view.config.showCommits&&e.push(new f.E(this.uri,this.view,this,this.repo,i,!0,{showAsCommits:!0,showComparison:!1,showCurrent:!1,showStatus:!1,showTracking:!1}))}this.view.config.showBranches&&e.push(new g.r(this.uri,this.view,this,this.repo)),this.view.config.showRemotes&&e.push(new S.e(this.uri,this.view,this,this.repo)),this.view.config.showStashes&&await this.repo.supports(n.A.Stashes)&&e.push(new R.m(this.uri,this.view,this,this.repo)),this.view.config.showTags&&e.push(new x.P(this.uri,this.view,this,this.repo)),this.view.config.showWorktrees&&await this.repo.supports(n.A.Worktrees)&&e.push(new I.S(this.uri,this.view,this,this.repo)),this.view.config.showContributors&&e.push(new b.I(this.uri,this.view,this,this.repo)),this.view.config.showIncomingActivity&&!this.repo.provider.virtual&&e.push(new P.Y(this.uri,this.view,this,this.repo)),this._children=e}return this._children}async getTreeItem(){const e=this.repo.formattedName??this.uri.repoPath??"",t=await(this.repo?.getLastFetched())??0;let i,n=`${this.repo.formattedName??this.uri.repoPath??""}${t?`${(0,m.vk)(s.NE.Dash,2,2)}Last fetched ${c._j.formatLastFetched(t,!1)}`:""}${this.repo.formattedName?`\\\n${this.uri.repoPath}`:""}`,o="";const{workspace:h}=this.context;let u,d=O.Td.Repository;this.repo.starred&&(d+="+starred"),null!=h&&(d+="+workspace",h.type===l.EI.Cloud?d+="+cloud":h.type===l.EI.Local&&(d+="+local")),this.repo.closed?(d+="+closed",u=""):u="-solid",this.repo.virtual&&(d+="+virtual",u="-cloud");const p=await this._status;if(null!=p){n+=`\n\nCurrent branch $(git-branch) ${p.branch}${p.rebasing?" (Rebasing)":""}`,this.view.config.includeWorkingTree&&0!==p.files.length&&(o=p.getFormattedDiffStatus({compact:!0,prefix:(0,m.vk)(s.NE.Dot,1,1)}));let e;if(i=`${p.getUpstreamStatus({suffix:(0,m.vk)(s.NE.Dot,1,1)})}${p.branch}${p.rebasing?" (Rebasing)":""}${o}`,null!=p.upstream){const t=a.ss.getHighlanderProviders(await this.view.container.git.getRemotesWithProviders(p.repoPath));e=t?.length?t[0].name:void 0}else{const t=await p.getRemote();e=t?.provider?.name}u+=o?"-blue":"",null!=p.upstream&&(n+=` is ${p.getUpstreamStatus({empty:`up to date with $(git-branch) ${p.upstream}${e?` on ${e}`:""}`,expand:!0,icons:!0,separator:", ",suffix:` $(git-branch) ${p.upstream}${e?` on ${e}`:""}`})}`,p.state.behind&&(d+="+behind",u+="-red"),p.state.ahead&&(u+=p.state.behind?"-yellow":"-green",d+="+ahead")),o&&(n+=`\n\nWorking tree has uncommitted changes${p.getFormattedDiffStatus({expand:!0,prefix:"\n",separator:"\n"})}`)}null!=h&&(n+=`\n\nRepository is ${this.repo.closed?"not ":""}open in the current window`);const g=new r.TreeItem(e,null!=h||"workspaces"===this.view.type?r.TreeItemCollapsibleState.Collapsed:r.TreeItemCollapsibleState.Expanded);g.id=this.id,g.contextValue=d,g.description=`${i??""}${t?`${(0,m.vk)(s.NE.Dot,1,1)}Last fetched ${c._j.formatLastFetched(t)}`:""}`,g.iconPath={dark:this.view.container.context.asAbsolutePath(`images/dark/icon-repo${u}.svg`),light:this.view.container.context.asAbsolutePath(`images/light/icon-repo${u}.svg`)},null==h||this.repo.closed||(g.resourceUri=r.Uri.parse("gitlens-view://workspaces/repository/open"));const f=new r.MarkdownString(n,!0);return f.supportHtml=!0,f.isTrusted=!0,g.tooltip=f,g}fetch(e={}){return this.repo.fetch(e)}pull(e={}){return this.repo.pull(e)}push(e={}){return this.repo.push(e)}async refresh(e=!1){e&&(this._status=this.repo.getStatus(),this._children=void 0),await this.ensureSubscription()}async star(){await this.repo.star(),this.parent.triggerChange()}async unstar(){await this.repo.unstar(),this.parent.triggerChange()}async subscribe(){const e=await(this.repo?.getLastFetched())??0,t=[this.repo.onDidChange(this.onRepositoryChanged,this)],i=c._j.getLastFetchedUpdateInterval(e);return 0!==e&&i>0&&t.push((0,p.DH)((()=>{i!==c._j.getLastFetchedUpdateInterval(e)&&this.resetSubscription(),this.splatted?this.view.triggerNodeChange(this.parent??this):this.view.triggerNodeChange(this)}),i)),this.view.config.includeWorkingTree&&t.push(this.repo.onDidChangeFileSystem(this.onFileSystemChanged,this),this.repo.startWatchingFileSystem()),r.Disposable.from(...t)}etag(){return this.repo.etag}async onFileSystemChanged(e){if(this._status=this.repo.getStatus(),void 0!==this._children){const e=await this._status;let t=this._children.findIndex((e=>e instanceof StatusFilesNode));if(void 0===e||!e.state.ahead&&0===e.files.length)-1!==t&&this._children.splice(t,1);else{let i=1;-1===t&&(t=(0,h.qr)(this._children,(e=>e instanceof w.V||e instanceof f.E)),i=0,t++);const r=void 0;this._children.splice(t,i,new StatusFilesNode(this.view,this,e,r))}}this.triggerChange(!1)}onRepositoryChanged(e){if(e.changed(c.I6.Closed,c.du.Any))this.dispose();else if(null==this._children||e.changed(c.I6.Config,c.I6.Index,c.I6.Heads,c.I6.Opened,c.I6.Status,c.I6.Unknown,c.du.Any))this.triggerChange(!0);else{if(e.changed(c.I6.Remotes,c.I6.RemoteProviders,c.du.Any)){const e=this._children.find((e=>e instanceof S.e));null!=e&&this.view.triggerNodeChange(e)}if(e.changed(c.I6.Stash,c.du.Any)){const e=this._children.find((e=>e instanceof R.m));null!=e&&this.view.triggerNodeChange(e)}if(e.changed(c.I6.Tags,c.du.Any)){const e=this._children.find((e=>e instanceof x.P));null!=e&&this.view.triggerNodeChange(e)}}}}L([(0,d.cM)()],RepositoryNode.prototype,"fetch",1),L([(0,d.cM)()],RepositoryNode.prototype,"pull",1),L([(0,d.cM)()],RepositoryNode.prototype,"push",1),L([(0,u.H)(),(0,d.fF)()],RepositoryNode.prototype,"refresh",1),L([(0,d.cM)()],RepositoryNode.prototype,"star",1),L([(0,d.cM)()],RepositoryNode.prototype,"unstar",1),L([(0,d.fF)()],RepositoryNode.prototype,"subscribe",1),L([(0,d.fF)({args:{0:e=>`{ repository: ${e.repository?.name??""}, uris(${e.uris.length}): [${e.uris.slice(0,1).map((e=>e.fsPath)).join(", ")}${e.uris.length>1?", ...":""}] }`}})],RepositoryNode.prototype,"onFileSystemChanged",1),L([(0,d.fF)({args:{0:e=>e.toString()}})],RepositoryNode.prototype,"onRepositoryChanged",1)},5988:(e,t,i)=>{i.d(t,{J:()=>ResultsCommitsNode});var r=i(9496),s=i(7462),n=i(6450),o=i(5148),a=i(5432),c=i(4241),l=i(3105),h=i(7469),u=i(4092),d=i(2610),p=i(21),m=i(2060),g=i(6922),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor;let v=0;class AutolinkedItemsNode extends g.Re{constructor(e,t,i,r,n){super(s.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this.log=r,this.expand=n,this._instanceId=v++,this.updateContext({autolinksId:String(this._instanceId)}),this._uniqueId=(0,g.tO)("autolinks",this.context)}get id(){return this._uniqueId}async getChildren(){if(null==this._children){const e=[...this.log.commits.values()];let t;if(e.length){const i=e.map((e=>e.message)).join("\n");let r;const s=this.view.container.autolinks.getAutolinks(i),n=await this.view.container.git.getBestRemoteWithProvider(this.repoPath);if(null!=n){const e=this.view.container.autolinks.getAutolinks(i,n);r=e;const[t]=await Promise.allSettled([this.view.container.autolinks.getLinkedIssuesAndPullRequests(i,n,{autolinks:e})]);if("fulfilled"===t.status&&null!=t.value)for(const[e,i]of t.value)r.set(e,i);r=new Map((0,l.G0)(r,s))}else r=s;t=[...r.values()].map((e=>u.i7.is(e)?new m.Z(this.view,this,e,this.log.repoPath):new d.Z(this.view,this,this.repoPath,e)))}null!=t&&0!==t.length||(t=[new p.AE(this.view,this,"No autolinked issues or pull requests could be found.")]),this.log.hasMore&&t.push(new p.Gd(this.view,this.parent,t[t.length-1],{context:{expandAutolinks:!0},message:"Load more commits to search for autolinks"})),this._children=t}return this._children}getTreeItem(){const e=new r.TreeItem("Autolinked Issues and Pull Requests",this.expand?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=g.Td.AutolinkedItems,e}refresh(e=!1){e&&(this._children=void 0)}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&f(t,i,n)})([(0,a.H)(),(0,c.fF)()],AutolinkedItemsNode.prototype,"refresh",1);var y=i(2925),b=i(4741),C=i(812),A=i(1101),P=Object.defineProperty,S=Object.getOwnPropertyDescriptor;class ResultsCommitsNode extends g.Re{constructor(e,t,i,r,n,o=void 0,a){super(s.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this._label=r,this._results=n,this._options=o,this._hasMore=!0,this._expandAutolinks=!1,null!=n.direction&&this.updateContext({branchStatusUpstreamType:n.direction}),this._uniqueId=(0,g.tO)("results-commits",this.context),this.limit=this.view.getNodeLastKnownLimit(this),this._options={expand:!0,...o},null!=a&&(this.splatted=a)}get id(){return this._uniqueId}get ref1(){return this._results.comparison?.ref1}get ref2(){return this._results.comparison?.ref2}async getChildren(){this._onChildrenCompleted?.cancel(),this._onChildrenCompleted=(0,h.PQ)();const{log:e}=await this.getCommitsQueryResults();if(null==e)return[];const[t]=await Promise.all([this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath)]),i=[new AutolinkedItemsNode(this.view,this,this.uri.repoPath,e,this._expandAutolinks)];this._expandAutolinks=!1;const{files:r}=this._results;null!=r&&i.push(new C.V(this.view,this,this.uri.repoPath,r.ref1,r.ref2,r.query,this._results.direction,{expand:!1}));const s={expand:this._options.expand&&1===e.count};return i.push(...(0,b.E)((0,l.UI)(e.commits.values(),(e=>(0,n.G2)(e)?new A.i(this.view,this,e,{icon:!0}):new y.D(this.view,this,e,void 0,void 0,t,s))),this,void 0,{show:e.count>1})),e.hasMore&&i.push(new p.Gd(this.view,this,i[i.length-1])),this._onChildrenCompleted.fulfill(),i}async getTreeItem(){let e,t;if(this._results.deferred)e=this._label,t=r.TreeItemCollapsibleState.Collapsed;else try{let i;({label:e,log:i}=await(0,h.HO)(this.getCommitsQueryResults(),100)),t=null==i||0===i.count?r.TreeItemCollapsibleState.None:this._options.expand||1===i.count?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed}catch(e){e instanceof h.PK&&setTimeout((async()=>{await e.promise;try{await(this._onChildrenCompleted?.promise)}catch{}setTimeout((()=>{this.triggerChange(!1)}),1)}),1),t=r.TreeItemCollapsibleState.Collapsed}const i=new r.TreeItem(e??this._label,t);return i.id=this.id,i.contextValue=null!=this._results.comparison?g.Td.CompareResultsCommits:g.Td.SearchResultsCommits,i.description=this._options.description,i}refresh(e=!1){e&&(this._commitsQueryResults=void 0,this._commitsQueryResultsPromise=void 0,this.getCommitsQueryResults())}async getCommitsQueryResults(){if(null==this._commitsQueryResultsPromise){this._commitsQueryResultsPromise=this._results.query(this.limit??o.D.get("advanced.maxSearchItems"));const e=await this._commitsQueryResultsPromise;this._commitsQueryResults=e,this._hasMore=e.hasMore,this._results.deferred&&(this._results.deferred=!1)}return this._commitsQueryResultsPromise}maybeGetCommitsQueryResults(){return this._commitsQueryResults}get hasMore(){return this._hasMore}async loadMore(e,t){const i=await this.getCommitsQueryResults();null!=i&&i.hasMore&&(null!=t&&"expandAutolinks"in t&&(this._expandAutolinks=Boolean(t.expandAutolinks)),await(i.more?.(e??this.view.config.pageItemLimit)),this.limit=i.log?.count,this.triggerChange(!1))}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?S(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&P(t,i,n)})([(0,a.H)(),(0,c.fF)()],ResultsCommitsNode.prototype,"refresh",1)},202:(e,t,i)=>{i.d(t,{C:()=>ResultsFileNode});var r=i(9496),s=i(5255),n=i(6373),o=i(7462),a=i(7881),c=i(4321),l=i(3700),h=i(6922);class ResultsFileNode extends h.RW{constructor(e,t,i,r,s,n,a){super(o.YY.fromFile(r,i,s||n),e,t,r),this.ref1=s,this.ref2=n,this.direction=a}toClipboard(){return this.file.path}get ref(){return(0,c.xB)(this.ref1||this.ref2,this.uri.repoPath)}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.None);e.contextValue=h.Td.ResultsFile,e.description=this.description,e.tooltip=n.o.fromTemplate("${file}\n${directory}/\n\n${status}${ (originalPath)}",this.file);const t=(0,a.tK)(this.file.status);return e.iconPath={dark:this.view.container.context.asAbsolutePath((0,l.RQ)("images","dark",t)),light:this.view.container.context.asAbsolutePath((0,l.RQ)("images","light",t))},e.command=this.getCommand(),e}get description(){return void 0===this._description&&(this._description=n.o.fromTemplate(this.view.config.formats.files.description,this.file,{relativePath:this.relativePath})),this._description}get folderName(){return void 0===this._folderName&&(this._folderName=(0,l.Fd)(this.uri.relativePath)),this._folderName}get label(){return void 0===this._label&&(this._label=n.o.fromTemplate(this.view.config.formats.files.label,this.file,{relativePath:this.relativePath})),this._label}get relativePath(){return this._relativePath}set relativePath(e){this._relativePath=e,this._label=void 0,this._description=void 0}get priority(){return 0}getCommand(){const e={lhs:{sha:this.ref1,uri:"R"!==this.file.status&&"C"!==this.file.status||"behind"!==this.direction?this.uri:o.YY.fromFile(this.file,this.uri.repoPath,this.ref2,!0)},rhs:{sha:this.ref2,uri:"R"!==this.file.status&&"C"!==this.file.status||"behind"===this.direction?this.uri:o.YY.fromFile(this.file,this.uri.repoPath,this.ref2,!0)},repoPath:this.uri.repoPath,line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes",command:s.Gh.DiffWith,arguments:[e]}}}},812:(e,t,i)=>{i.d(t,{V:()=>ResultsFilesNode,W:()=>v});var r=i(9496),s=i(2540),n=i(7462),o=i(2800),a=i(5432),c=i(4241),l=i(3105),h=i(3700),u=i(7469),d=i(3620),p=i(4481),m=i(202),g=i(6922),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor,v=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(v||{});class ResultsFilesNode extends g.Re{constructor(e,t,i,r,s,o,a,c=void 0){super(n.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this.ref1=r,this.ref2=s,this._filesQuery=o,this.direction=a,this._options=c,null!=this.direction&&this.updateContext({branchStatusUpstreamType:this.direction}),this._uniqueId=(0,g.tO)("results-files",this.context),this._options={expand:!0,...c}}get id(){return this._uniqueId}get filter(){return this.view.nodeState.getState(this.id,"filter")}set filter(e){this.filter!==e&&(this.view.nodeState.storeState(this.id,"filter",e),this._filterResults=void 0,this.triggerChange(!1))}get filterable(){return null!=this.filter||this.ref1!==this.ref2&&void 0===this.direction}getFilterContextValue(){switch(this.filter){case 0:return"+filtered~left";case 1:return"+filtered~right";default:return""}}async getChildren(){const e=await this.getFilesQueryResults(),t=(null!=this.filter?e.filtered?.get(this.filter):void 0)??e.files;if(null==t)return[];let i=[...(0,l.UI)(t,(e=>new m.C(this.view,this,this.repoPath,e,this.ref1,this.ref2,this.direction)))];if(this.view.config.files.layout!==s.Vc.List){const e=(0,o.Mo)(i,(e=>e.uri.relativePath.split("/")),((...e)=>(0,h.AH)((0,h.RQ)(...e))),this.view.config.files.compact);i=new p.Y(this.view,this,e,this.repoPath,"",void 0).getChildren()}else i.sort(((e,t)=>e.priority-t.priority||(0,d.dm)(e.label,t.label)));return i}async getTreeItem(){let e,t,i,s,n,o;const a=this.filter;try{const c=await(0,u.HO)(this.getFilesQueryResults(),100);e=c.label,null==a&&null!=c.stats&&(t=`${(0,d._6)("addition",c.stats.additions)} (+), ${(0,d._6)("deletion",c.stats.deletions)} (-)${c.stats.approximated?" *approximated":""}`,o=`${e}, ${t}`),null!=a?(t="Filtered",o=`${e} &mdash; ${t}`,s=c.filtered?.get(a),null==s&&(e="files changed",i=new r.ThemeIcon("ellipsis"),n=r.TreeItemCollapsibleState.Collapsed,this._filterResults?.then((()=>queueMicrotask((()=>this.triggerChange(!1))))))):s=c.files,void 0===n&&(n=null==s||0===s.length?r.TreeItemCollapsibleState.None:this._options.expand?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed)}catch(t){t instanceof u.PK&&t.promise.then((()=>queueMicrotask((()=>this.triggerChange(!1))))),e="files changed",i=new r.ThemeIcon("ellipsis"),n=r.TreeItemCollapsibleState.Collapsed}const c=new r.TreeItem(`${null!=a&&null!=s?`Showing ${s.length} of `:""}${e}`,n);return c.description=t,c.id=this.id,c.iconPath=i,c.contextValue=`${g.Td.ResultsFiles}${this.filterable?"+filterable":""}${this.getFilterContextValue()}`,c.tooltip=o,c}refresh(e=!1){e&&(this.view.nodeState.deleteState(this.id,"filter"),this._filterResults=void 0,this._filesQueryResults=this._filesQuery())}async getFilesQueryResults(){void 0===this._filesQueryResults&&(this._filesQueryResults=this._filesQuery());const e=await this._filesQueryResults;return null!=e.files&&this.filterable&&null!=this.filter&&null==e.filtered?.get(this.filter)?(void 0===this._filterResults&&(this._filterResults=this.filterResults(this.filter,e)),await this._filterResults,e):e}async filterResults(e,t){let i;const r=0===this.filter?this.ref2:this.ref1,s=await this.view.container.git.getMergeBase(this.repoPath,this.ref1||"HEAD",this.ref2||"HEAD");if(null!=s){const e=await this.view.container.git.getDiffStatus(this.uri.repoPath,`${s}..${r}`);null!=e&&(i=new Set(e.map((e=>e.path))))}else{const e=await this.view.container.git.getCommit(this.uri.repoPath,r||"HEAD");null!=e?.files&&(i=new Set(e.files.map((e=>e.path))))}null==t.filtered&&(t.filtered=new Map),t.filtered.set(e,null==i?[]:t.files.filter((e=>i.has(e.path))))}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&f(t,i,n)})([(0,a.H)(),(0,c.fF)()],ResultsFilesNode.prototype,"refresh",1)},4655:(e,t,i)=>{i.d(t,{V:()=>v});var r=i(9496),s=i(4290),n=i(9311),o=i(7462),a=i(6934),c=i(5432),l=i(4241),h=i(3620),u=i(5988),d=i(6922),p=Object.defineProperty,m=Object.getOwnPropertyDescriptor,g=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?m(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&p(t,i,n),n};let f=0;const w=class extends d.Re{constructor(e,t,i,r,s,n,c=0){super(o.YY.fromRepoPath(i),e,t),this.parent=t,this.repoPath=i,this._labels=s,this._searchQueryOrLog=n,this._pinned=c,this._order=Date.now(),this._search=r,this._instanceId=f++,this._order=Date.now(),this.updateContext({searchId:`${(0,a.FL)(r)}+${this._instanceId}`}),this._uniqueId=(0,d.tO)("search-results",this.context)}static getPinnableId(e,t){return(0,s.FB)(`${e}|${(0,a.FL)(t)}`,"base64")}get id(){return this._uniqueId}get canDismiss(){return!this.pinned}get order(){return this._pinned||this._order}get pinned(){return 0!==this._pinned}get search(){return this._search}ensureResults(){if(null==this._resultsNode){let e;null==this._searchQueryOrLog?(e=!0,this._searchQueryOrLog=this.getSearchQuery({label:this._labels.queryLabel})):"function"!=typeof this._searchQueryOrLog&&(this._searchQueryOrLog=this.getSearchQuery({label:this._labels.queryLabel},this._searchQueryOrLog)),this._resultsNode=new u.J(this.view,this,this.repoPath,this._labels.label,{query:this._searchQueryOrLog,deferred:e},{expand:!this.pinned},!0)}return this._resultsNode}async getChildren(){return this.ensureResults().getChildren()}async getTreeItem(){const e=await this.ensureResults().getTreeItem();if(e.id=this.id,e.contextValue=`${d.Td.SearchResults}${this._pinned?"+pinned":""}`,this.view.container.git.repositoryCount>1){const t=this.view.container.git.getRepository(this.repoPath);e.description=t?.formattedName??this.repoPath}return this._pinned&&(e.iconPath=new r.ThemeIcon("pinned")),e}get hasMore(){return this.ensureResults().hasMore}async loadMore(e){return this.ensureResults().loadMore(e)}async edit(e){if(null==e)return void await(0,n.m)({command:"search",prefillOnly:!0,state:{repo:this.repoPath,...this.search,showResultsInSideBar:this}});const t=this.getPinnableId();this._search=e.pattern,this._labels=e.labels,this._searchQueryOrLog=e.log,this._resultsNode=void 0,this.pinned&&(await this.view.updatePinned(t),await this.updatePinned()),this.triggerChange(!1),queueMicrotask((()=>this.view.reveal(this,{expand:!0,focus:!0,select:!0})))}refresh(e=!1){this._resultsNode?.refresh(e)}async pin(){this.pinned||(this._pinned=Date.now(),await this.updatePinned(),queueMicrotask((()=>this.view.reveal(this,{focus:!0,select:!0}))))}async unpin(){this.pinned&&(this._pinned=0,await this.view.updatePinned(this.getPinnableId()),queueMicrotask((()=>this.view.reveal(this,{focus:!0,select:!0}))))}getPinnableId(){return w.getPinnableId(this.repoPath,this.search)}getSearchLabel(e,t){if("string"==typeof e)return e;const i=t?.count??0,r=void 0===e.resultsType?{singular:"result",plural:"results"}:e.resultsType;return`${(0,h._6)(r.singular,i,{format:e=>t?.hasMore?`${e}+`:void 0,plural:r.plural,zero:"No"})} ${e.label}`}getSearchQuery(e,t){let i=!0;return async r=>{t=await(t??this.view.container.git.richSearchCommits(this.repoPath,this.search)),i||null==t?.query||(t=await t.query(r)),i=!1;const s={label:this.getSearchLabel(e.label,t),log:t,hasMore:t?.hasMore??!1};return s.hasMore&&(s.more=async t=>{s.log=await(s.log?.more?.(t))??s.log,s.label=this.getSearchLabel(e.label,s.log),s.hasMore=s.log?.hasMore??!0}),s}}updatePinned(){return this.view.updatePinned(this.getPinnableId(),{type:"search",timestamp:this._pinned,path:this.repoPath,labels:this._labels,search:(0,a.KQ)(this.search)})}};let v=w;g([(0,c.H)(),(0,l.fF)()],v.prototype,"refresh",1),g([(0,l.cM)()],v.prototype,"pin",1),g([(0,l.cM)()],v.prototype,"unpin",1)},2758:(e,t,i)=>{i.d(t,{y:()=>StashFileNode});var r=i(2601),s=i(6922);class StashFileNode extends r.R{constructor(e,t,i,r){super(e,t,i,r)}get contextValue(){return`${s.Td.File}+stashed`}}},1101:(e,t,i)=>{i.d(t,{i:()=>StashNode});var r=i(9496),s=i(2540),n=i(9338),o=i(2800),a=i(5148),c=i(3700),l=i(3620),h=i(4481),u=i(2758),d=i(6922);class StashNode extends d.bT{constructor(e,t,i,r){super(i.getGitUri(),e,t),this.parent=t,this.commit=i,this.options=r,this.updateContext({commit:i}),this._uniqueId=(0,d.tO)("stash",this.context)}get id(){return this._uniqueId}toClipboard(){return this.commit.stashName}get ref(){return this.commit}async getChildren(){let e=(await this.commit.getCommitsForFiles()).map((e=>new u.y(this.view,this,e.file,e)));if(this.view.config.files.layout!==s.Vc.List){const t=(0,o.Mo)(e,(e=>e.uri.relativePath.split("/")),((...e)=>(0,c.AH)((0,c.RQ)(...e))),this.view.config.files.compact);e=new h.Y(this.view,this,t,this.repoPath,"",void 0).getChildren()}else e.sort(((e,t)=>(0,l.dm)(e.label,t.label)));return e}getTreeItem(){const e=new r.TreeItem(n.i.fromTemplate(this.view.config.formats.stashes.label,this.commit,{messageTruncateAtNewLine:!0,dateFormat:a.D.get("defaultDateFormat")}),r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.description=n.i.fromTemplate(this.view.config.formats.stashes.description,this.commit,{messageTruncateAtNewLine:!0,dateFormat:a.D.get("defaultDateFormat")}),e.contextValue=d.Td.Stash,this.options?.icon&&(e.iconPath=new r.ThemeIcon("archive")),e.tooltip=n.i.fromTemplate("${'On 'stashOnRef\n}${ago} (${date})\n\n${message}",this.commit,{dateFormat:a.D.get("defaultDateFormat")}),e}}},727:(e,t,i)=>{i.d(t,{m:()=>StashesNode});var r=i(9496),s=i(5432),n=i(4241),o=i(3105),a=i(21),c=i(1101),l=i(6922),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor;class StashesNode extends l.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,l.tO)("stashes",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){const e=await this.repo.getStash();if(null==e)return[new a.AE(this.view,this,"No stashes could be found.")];this._children=[...(0,o.UI)(e.commits.values(),(e=>new c.i(this.view,this,e)))]}return this._children}getTreeItem(){const e=new r.TreeItem("Stashes",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=l.Td.Stashes,e.iconPath=new r.ThemeIcon("gitlens-stashes"),e}refresh(){this._children=void 0}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&h(t,i,n)})([(0,s.H)(),(0,n.fF)()],StashesNode.prototype,"refresh",1)},6586:(e,t,i)=>{i.d(t,{q:()=>StatusFileNode});var r=i(9496),s=i(5255),n=i(6373),o=i(7462),a=i(7881),c=i(3700),l=i(3620),h=i(9719),u=i(6922);class StatusFileNode extends u.Te{constructor(e,t,i,r,s,n="ahead"){let a,c=!1,l=!1;for(const e of s){if(!e.isUncommitted){if(l)break;a=e.sha;break}if(e.isUncommittedStaged){c=!0,l||(a=e.sha);break}a=void 0,l=!0}super(o.YY.fromFile(i,r,a),e,t,i),this.commits=s,this._direction=n,this._hasStagedChanges=c,this._hasUnstagedChanges=l}toClipboard(){return this.fileName}get fileName(){return this.file.path}getChildren(){return this.commits.map((e=>new h.m(this.view,this,this.file,e)))}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.None);if(e.description=this.description,(this._hasStagedChanges||this._hasUnstagedChanges)&&1===this.commits.length)e.contextValue=u.Td.File,this._hasStagedChanges?(e.contextValue+="+staged",e.tooltip=n.o.fromTemplate("${file}\n${directory}/\n\n${status}${ (originalPath)} in Index (staged)",this.file)):(e.contextValue+="+unstaged",e.tooltip=n.o.fromTemplate("${file}\n${directory}/\n\n${status}${ (originalPath)} in Working Tree",this.file)),e.resourceUri=this.view.container.git.getAbsoluteUri(this.file.path,this.repoPath),e.iconPath=r.ThemeIcon.File,e.command=this.getCommand();else{if(e.collapsibleState=r.TreeItemCollapsibleState.Collapsed,this._hasStagedChanges||this._hasUnstagedChanges)e.contextValue=u.Td.File,this._hasStagedChanges&&this._hasUnstagedChanges?e.contextValue+="+staged+unstaged":this._hasStagedChanges?e.contextValue+="+staged":e.contextValue+="+unstaged",e.resourceUri=this.view.container.git.getAbsoluteUri(this.file.path,this.repoPath),e.iconPath=r.ThemeIcon.File;else{e.contextValue=u.Td.StatusFileCommits;const t=(0,a.tK)(this.file.status);e.iconPath={dark:this.view.container.context.asAbsolutePath((0,c.RQ)("images","dark",t)),light:this.view.container.context.asAbsolutePath((0,c.RQ)("images","light",t))}}e.tooltip=n.o.fromTemplate(`\${file}\n\${directory}/\n\n\${status}\${ (originalPath)} in ${this.getChangedIn()}`,this.file),e.command=this.getCommand()}return this._label=void 0,this._description=void 0,e}get description(){return null==this._description&&(this._description=n.o.fromTemplate(this.view.config.formats.files.description,{...this.file,commit:this.commit},{relativePath:this.relativePath})),this._description}get folderName(){return null==this._folderName&&(this._folderName=(0,c.Fd)(this.uri.relativePath)),this._folderName}get label(){return null==this._label&&(this._label=n.o.fromTemplate(this.view.config.formats.files.label,{...this.file,commit:this.commit},{relativePath:this.relativePath})),this._label}get commit(){return this.commits[0]}get priority(){return this._hasStagedChanges&&!this._hasUnstagedChanges?-3:this._hasStagedChanges?-2:this._hasUnstagedChanges?-1:0}get relativePath(){return this._relativePath}set relativePath(e){this._relativePath=e,this._label=void 0,this._description=void 0}getChangedIn(){const e=[];let t=0;return this._hasUnstagedChanges&&(t++,e.push("Working Tree")),this._hasStagedChanges&&(t++,e.push("Index (staged)")),this.commits.length>t&&(t=this.commits.length-t),t>0&&e.push((0,l._6)("commit",t)),e.length>2&&(e[e.length-1]=`and ${e[e.length-1]}`),e.join(e.length>2?", ":" and ")}getCommand(){if((this._hasStagedChanges||this._hasUnstagedChanges)&&1===this.commits.length){const e={commit:this.commit,uri:o.YY.fromFile(this.file,this.repoPath),line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:s.Gh.DiffWithPrevious,arguments:[void 0,e]}}const e="behind"===this._direction?this.commits[0]:this.commits[this.commits.length-1],t=e.files?.find((e=>e.path===this.file.path))??this.file,i={lhs:{sha:"behind"===this._direction?e.sha:`${e.sha}^`,uri:o.YY.fromFile(t,this.repoPath,void 0,!0)},rhs:{sha:"",uri:o.YY.fromFile(this.file,this.repoPath)},repoPath:this.repoPath,line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes",command:s.Gh.DiffWith,arguments:[i]}}}},638:(e,t,i)=>{i.d(t,{_:()=>TagNode});var r=i(9496),s=i(2540),n=i(5255),o=i(3148),a=i(4321),c=i(5432),l=i(4241),h=i(3105),u=i(3620),d=i(2925),p=i(21),m=i(4741),g=i(6922),f=Object.defineProperty,w=Object.getOwnPropertyDescriptor,v=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?w(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&f(t,i,n),n};class TagNode extends g.bT{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.tag=r,this.updateContext({tag:r}),this._uniqueId=(0,g.tO)("tag",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}toClipboard(){return this.tag.name}get label(){return this.view.config.branches.layout===s.CZ.Tree?this.tag.getBasename():this.tag.name}get ref(){return this.tag}async getChildren(){const e=await this.getLog();if(null==e)return[new p.AE(this.view,this,"No commits could be found.")];const t=await this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath,this.tag.name),i=[...(0,m.E)((0,h.UI)(e.commits.values(),(e=>new d.D(this.view,this,e,void 0,void 0,t))),this)];return e.hasMore&&i.push(new p.Gd(this.view,this,i[i.length-1],{getCount:()=>this.view.container.git.getCommitCount(this.tag.repoPath,this.tag.name)})),i}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=g.Td.Tag,e.description=(0,o.X)(this.tag.message),e.tooltip=`${this.tag.name}${(0,u.vk)(n.NE.Dash,2,2)}${(0,a.zL)(this.tag.sha,{force:!0})}${null!=this.tag.date?`\n${this.tag.formatDateFromNow()} (${this.tag.formatDate(this.view.container.TagDateFormatting.dateFormat)})`:""}\n\n${(0,o.X)(this.tag.message)}${null!=this.tag.commitDate&&this.tag.date!==this.tag.commitDate?`\n${this.tag.formatCommitDateFromNow()} (${this.tag.formatCommitDate(this.view.container.TagDateFormatting.dateFormat)})`:""}`,e}refresh(e){e&&(this._log=void 0)}async getLog(){return null==this._log&&(this._log=await this.view.container.git.getLog(this.uri.repoPath,{limit:this.limit??this.view.config.defaultItemLimit,ref:this.tag.name})),this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this.triggerChange(!1)))}}v([(0,c.H)(),(0,l.fF)()],TagNode.prototype,"refresh",1),v([(0,c.H)()],TagNode.prototype,"loadMore",1)},1841:(e,t,i)=>{i.d(t,{P:()=>TagsNode});var r=i(9496),s=i(2540),n=i(7462),o=i(2800),a=i(5432),c=i(4241),l=i(4004),h=i(21),u=i(638),d=i(6922),p=Object.defineProperty,m=Object.getOwnPropertyDescriptor;class TagsNode extends d.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,d.tO)("tags",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){const e=await this.repo.getTags({sort:!0});if(0===e.values.length)return[new h.AE(this.view,this,"No tags could be found.")];const t=e.values.map((e=>new u._(n.YY.fromRepoPath(this.uri.repoPath,e.ref),this.view,this,e)));if(this.view.config.branches.layout===s.CZ.List)return t;const i=(0,o.Mo)(t,(e=>e.tag.name.split("/")),((...e)=>e.join("/")),this.view.config.files.compact),r=new l.n(this.view,this,"tag",i,this.repo.path,"",void 0);this._children=r.getChildren()}return this._children}getTreeItem(){const e=new r.TreeItem("Tags",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=d.Td.Tags,e.iconPath=new r.ThemeIcon("tag"),e}refresh(){this._children=void 0}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?m(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&p(t,i,n)})([(0,a.H)(),(0,c.fF)()],TagsNode.prototype,"refresh",1)},6922:(e,t,i)=>{i.d(t,{CF:()=>SubscribeableViewNode,FZ:()=>RepositoriesSubscribeableNode,Jc:()=>b,LD:()=>R,On:()=>A,RW:()=>ViewRefFileNode,Re:()=>y,Td:()=>w,Te:()=>ViewFileNode,bT:()=>ViewRefNode,kP:()=>D,kr:()=>S,pp:()=>k,tO:()=>v,vb:()=>RepositoryFolderNode,w8:()=>C});var r=i(9496),s=i(5255),n=i(7462),o=i(4321),a=i(3050),c=i(3646),l=i(5432),h=i(4241),u=i(9796),d=i(4336),p=i(3620),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&m(t,i,n),n},w=(e=>(e.ActiveFileHistory="gitlens:history:active:file",e.ActiveLineHistory="gitlens:history:active:line",e.AutolinkedItems="gitlens:autolinked:items",e.AutolinkedIssue="gitlens:autolinked:issue",e.AutolinkedItem="gitlens:autolinked:item",e.Branch="gitlens:branch",e.Branches="gitlens:branches",e.BranchStatusAheadOfUpstream="gitlens:status-branch:upstream:ahead",e.BranchStatusBehindUpstream="gitlens:status-branch:upstream:behind",e.BranchStatusNoUpstream="gitlens:status-branch:upstream:none",e.BranchStatusSameAsUpstream="gitlens:status-branch:upstream:same",e.BranchStatusFiles="gitlens:status-branch:files",e.Commit="gitlens:commit",e.Commits="gitlens:commits",e.Compare="gitlens:compare",e.CompareBranch="gitlens:compare:branch",e.ComparePicker="gitlens:compare:picker",e.ComparePickerWithRef="gitlens:compare:picker:ref",e.CompareResults="gitlens:compare:results",e.CompareResultsCommits="gitlens:compare:results:commits",e.Contributor="gitlens:contributor",e.Contributors="gitlens:contributors",e.DateMarker="gitlens:date-marker",e.File="gitlens:file",e.FileHistory="gitlens:history:file",e.Folder="gitlens:folder",e.LineHistory="gitlens:history:line",e.Merge="gitlens:merge",e.MergeConflictCurrentChanges="gitlens:merge-conflict:current",e.MergeConflictIncomingChanges="gitlens:merge-conflict:incoming",e.Message="gitlens:message",e.MessageSignIn="gitlens:message:signin",e.Pager="gitlens:pager",e.PullRequest="gitlens:pullrequest",e.Rebase="gitlens:rebase",e.Reflog="gitlens:reflog",e.ReflogRecord="gitlens:reflog-record",e.Remote="gitlens:remote",e.Remotes="gitlens:remotes",e.Repositories="gitlens:repositories",e.Repository="gitlens:repository",e.RepositoryFolder="gitlens:repo-folder",e.ResultsFile="gitlens:file:results",e.ResultsFiles="gitlens:results:files",e.SearchAndCompare="gitlens:searchAndCompare",e.SearchResults="gitlens:search:results",e.SearchResultsCommits="gitlens:search:results:commits",e.Stash="gitlens:stash",e.Stashes="gitlens:stashes",e.StatusFileCommits="gitlens:status:file:commits",e.StatusFiles="gitlens:status:files",e.StatusAheadOfUpstream="gitlens:status:upstream:ahead",e.StatusBehindUpstream="gitlens:status:upstream:behind",e.StatusNoUpstream="gitlens:status:upstream:none",e.StatusSameAsUpstream="gitlens:status:upstream:same",e.Tag="gitlens:tag",e.Tags="gitlens:tags",e.UncommittedFiles="gitlens:uncommitted:files",e.Workspace="gitlens:workspace",e.WorkspaceMissingRepository="gitlens:workspaceMissingRepository",e.Workspaces="gitlens:workspaces",e.Worktree="gitlens:worktree",e.Worktrees="gitlens:worktrees",e))(w||{});function v(e,t){let i="";return t.root&&(i+="/root"),null!=t.workspace&&(i+=`/ws/${t.workspace.id}`),null!=t.wsRepositoryDescriptor&&(i+=`/wsrepo/${t.wsRepositoryDescriptor.id}`),null!=t.repository&&(i+=`/repo/${t.repository.id}`),null!=t.worktree&&(i+=`/worktree/${t.worktree.uri.path}`),null!=t.remote&&(i+=`/remote/${t.remote.id}`),null!=t.tag&&(i+=`/tag/${t.tag.id}`),null!=t.branch&&(i+=`/branch/${t.branch.id}`),null!=t.branchStatus&&(i+=`/status/${t.branchStatus.upstream??"-"}`),null!=t.branchStatusUpstreamType&&(i+=`/status-direction/${t.branchStatusUpstreamType}`),null!=t.reflog&&(i+=`/reflog/${t.reflog.sha}+${t.reflog.selector}+${t.reflog.command}+${t.reflog.commandArgs??""}+${t.reflog.date.getTime()}`),null!=t.contributor&&(i+=`/contributor/${t.contributor.id??`${t.contributor.username}+${t.contributor.email}+${t.contributor.name}`}`),null!=t.autolinksId&&(i+=`/autolinks/${t.autolinksId}`),null!=t.comparisonId&&(i+=`/comparison/${t.comparisonId}`),null!=t.searchId&&(i+=`/search/${t.searchId}`),null!=t.commit&&(i+=`/commit/${t.commit.sha}`),null!=t.file&&(i+=`/file/${t.file.path}+${t.file.status}`),`gitlens://viewnode/${e}${i}`}let y=class{constructor(e,t,i){this.view=t,this.parent=i,this.splatted=!1,this._uri=e}get id(){return this._uniqueId}get context(){return this._context??this.parent?.context??{}}updateContext(e,t=!1){this._context=this.getNewContext(e,t)}getNewContext(e,t=!1){return{...t?this.parent?.context:this.context,...e}}toString(){const e=this.id;return`${(0,d.q4)(this)}${null!=e?`(${e})`:""}`}get uri(){return this._uri}getParent(){return this.parent?.splatted?this.parent?.getParent():this.parent}getCommand(){}triggerChange(e=!1,t=!1,i){return this.splatted&&null!=this.parent&&this.parent!==i?this.parent.triggerChange(e,t):this.view.refreshNode(this,e,t)}deleteState(e){if(null==this.id)throw new Error("Id is required to delete state");this.view.nodeState.deleteState(this.id,e)}getState(e){if(null==this.id)throw new Error("Id is required to get state");return this.view.nodeState.getState(this.id,e)}storeState(e,t){if(null==this.id)throw new Error("Id is required to store state");this.view.nodeState.storeState(this.id,e,t)}};function b(e){return e instanceof y}function C(e){return e instanceof ViewFileNode}f([(0,l.H)(((e=!1,t=!1,i)=>JSON.stringify([e,t,i?.toString()]))),(0,h.fF)()],y.prototype,"triggerChange",1),y=f([(0,h.hJ)(((e,t)=>`${t}${null!=e.id?`(${e.id})`:""}`))],y);class ViewFileNode extends y{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.file=r}get repoPath(){return this.uri.repoPath}toString(){return`${super.toString()}:${this.file.path}`}}class ViewRefNode extends y{constructor(e,t,i){super(e,t,i),this.parent=i}get repoPath(){return this.uri.repoPath}toString(){return`${super.toString()}:${(0,o.Wh)(this.ref,!1)}`}}class ViewRefFileNode extends ViewFileNode{toString(){return`${super.toString()}:${this.file.path}`}}function A(e){return(0,u.is)(e,"loadMore")}class SubscribeableViewNode extends y{constructor(e,t,i){super(e,t,i),this.loaded=!1,this._canSubscribe=!0,this._pendingReset=!1;const s=[this.view.onDidChangeVisibility(this.onVisibilityChanged,this),this.view.onDidChangeNodeCollapsibleState(this.onNodeCollapsibleStateChanged,this)];P(this.view)&&s.push(this.view.onDidChangeAutoRefresh(this.onAutoRefreshChanged,this));const n=this.getTreeItem;this.getTreeItem=function(){return this.loaded=!0,this.ensureSubscription(),n.apply(this)};const o=this.getChildren;this.getChildren=function(){return this.loaded=!0,this.ensureSubscription(),o.apply(this)},this.disposable=r.Disposable.from(...s)}dispose(){this.unsubscribe(),this.disposable?.dispose()}async triggerChange(e=!1,t=!1){this.loaded&&(e&&!this.view.visible&&(this._pendingReset=e),await super.triggerChange(e,t))}get canSubscribe(){return this._canSubscribe}set canSubscribe(e){this._canSubscribe!==e&&(this._canSubscribe=e,this.ensureSubscription(),e&&this.triggerChange())}get requiresResetOnVisible(){let e=this._pendingReset;this._pendingReset=!1;const t=this.etag();return t!==this._etag&&(this._etag=t,e=!0),e}async unsubscribe(){if(this._etag=this.etag(),null!=this.subscription){const e=this.subscription;this.subscription=void 0,(await e)?.dispose()}}onAutoRefreshChanged(){this.onVisibilityChanged({visible:this.view.visible})}onNodeCollapsibleStateChanged(e){e.element===this?(this.collapsibleState=e.state,void 0!==this.onCollapsibleStateChanged&&this.onCollapsibleStateChanged(e.state)):e.element===this.parent&&void 0!==this.onParentCollapsibleStateChanged&&this.onParentCollapsibleStateChanged(e.state)}onVisibilityChanged(e){this.ensureSubscription(),e.visible&&this.triggerChange(this.requiresResetOnVisible)}async ensureSubscription(){this.canSubscribe&&this.view.visible&&(!P(this.view)||this.view.autoRefresh)?null==this.subscription&&(this.subscription=Promise.resolve(this.subscribe()),await this.subscription):await this.unsubscribe()}async resetSubscription(){await this.unsubscribe(),await this.ensureSubscription()}}f([(0,h.fF)()],SubscribeableViewNode.prototype,"dispose",1),f([(0,l.H)(),(0,h.fF)()],SubscribeableViewNode.prototype,"triggerChange",1),f([(0,h.fF)()],SubscribeableViewNode.prototype,"unsubscribe",1),f([(0,h.fF)()],SubscribeableViewNode.prototype,"onAutoRefreshChanged",1),f([(0,h.fF)()],SubscribeableViewNode.prototype,"onVisibilityChanged",1),f([(0,l.H)(),(0,h.fF)()],SubscribeableViewNode.prototype,"ensureSubscription",1),f([(0,l.H)(),(0,h.fF)()],SubscribeableViewNode.prototype,"resetSubscription",1);class RepositoryFolderNode extends SubscribeableViewNode{constructor(e,t,i,r,s,n){super(e,t,i),this.parent=i,this.repo=r,this.options=n,this.splatted=!0,this.updateContext({repository:this.repo}),this._uniqueId=v("repository-folder",this.context),this.splatted=s}get id(){return this._uniqueId}toClipboard(){return this.repo.path}get repoPath(){return this.repo.path}async getTreeItem(){this.splatted=!1;const e=await this.repo.getBranch(),t=(e?.state.ahead??0)>0,i=(e?.state.behind??0)>0,n=t||i||this.repo.starred||this.view.container.git.isRepositoryForEditor(this.repo),o=new r.TreeItem(this.repo.formattedName??this.uri.repoPath??"",n?r.TreeItemCollapsibleState.Expanded:r.TreeItemCollapsibleState.Collapsed);if(o.contextValue="gitlens:repo-folder"+(this.repo.starred?"+starred":""),t&&(o.contextValue+="+ahead"),i&&(o.contextValue+="+behind"),null!=e&&this.options?.showBranchAndLastFetched){const t=await this.repo.getLastFetched()??0,i=e.getTrackingStatus();let n;if(o.description=`${i?`${i}${(0,p.vk)(s.NE.Dot,1,1)}`:""}${e.name}${t?`${(0,p.vk)(s.NE.Dot,1,1)}Last fetched ${c._j.formatLastFetched(t)}`:""}`,null!=e.upstream){const t=a.ss.getHighlanderProviders(await this.view.container.git.getRemotesWithProviders(e.repoPath));n=t?.length?t[0].name:void 0}else{const t=await e.getRemoteWithProvider();n=t?.provider?.name}o.tooltip=new r.MarkdownString(`${this.repo.formattedName??this.uri.repoPath??""}${t?`${(0,p.vk)(s.NE.Dash,2,2)}Last fetched ${c._j.formatLastFetched(t,!1)}`:""}${this.repo.formattedName?`\n${this.uri.repoPath}`:""}\n\nCurrent branch $(git-branch) ${e.name}${null!=e.upstream?` is ${e.getTrackingStatus({empty:e.upstream.missing?`missing upstream $(git-branch) ${e.upstream.name}`:`up to date with $(git-branch) ${e.upstream.name}${n?` on ${n}`:""}`,expand:!0,icons:!0,separator:", ",suffix:` $(git-branch) ${e.upstream.name}${n?` on ${n}`:""}`})}`:`hasn't been published to ${n??"a remote"}`}`,!0)}else o.tooltip=`${this.repo.formattedName?`${this.repo.formattedName}\n${this.uri.repoPath}`:this.uri.repoPath??""}`;return o}async getSplattedChild(){return null==this.child&&await this.getChildren(),this.child}async refresh(e=!1){await(this.child?.triggerChange(e,!1,this)),await this.ensureSubscription()}async star(){await this.repo.star()}async unstar(){await this.repo.unstar()}subscribe(){return this.repo.onDidChange(this.onRepositoryChanged,this)}etag(){return this.repo.etag}onRepositoryChanged(e){if(e.changed(c.I6.Closed,c.du.Any))return this.dispose(),void this.parent?.triggerChange(!0);e.changed(c.I6.Opened,c.du.Any)||e.changed(c.I6.Starred,c.du.Any)?this.parent?.triggerChange(!0):this.changed(e)&&(this.loaded?this:this.parent??this).triggerChange(!0)}}f([(0,l.H)(),(0,h.fF)()],RepositoryFolderNode.prototype,"refresh",1),f([(0,h.cM)()],RepositoryFolderNode.prototype,"star",1),f([(0,h.cM)()],RepositoryFolderNode.prototype,"unstar",1),f([(0,h.fF)()],RepositoryFolderNode.prototype,"subscribe",1),f([(0,h.fF)({args:{0:e=>e.toString()}})],RepositoryFolderNode.prototype,"onRepositoryChanged",1);class RepositoriesSubscribeableNode extends SubscribeableViewNode{constructor(e){super(n.Wj,e),this.splatted=!0}dispose(){super.dispose(),this.resetChildren()}resetChildren(){if(null!=this.children){for(const e of this.children)"dispose"in e&&e.dispose();this.children=void 0}}async getSplattedChild(){return null==this.children&&await this.getChildren(),1===this.children?.length?this.children[0]:void 0}refresh(e=!1){null!=this.children&&e&&this.resetChildren()}etag(){return(0,u.NX)(this.view.container.git.etag,this.view.container.subscription.etag)}subscribe(){return r.Disposable.from(this.view.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this),this.view.container.subscription.onDidChange(this.onSubscriptionChanged,this))}onRepositoriesChanged(e){this.triggerChange(!0)}onSubscriptionChanged(e){e.current.plan!==e.previous.plan&&this.triggerChange(!0)}}function P(e){return(0,u.is)(e,"onDidChangeAutoRefresh")}function S(e){return"function"==typeof e.clear}function R(e){return"function"==typeof e.edit}function D(e){return"function"==typeof e.dismissNode}function k(e){return function(e){return null!=e&&"repoPath"in e&&"string"==typeof e.repoPath}(e)?e.repoPath:void 0}f([(0,l.H)(),(0,h.fF)()],RepositoriesSubscribeableNode.prototype,"refresh",1),f([(0,h.fF)()],RepositoriesSubscribeableNode.prototype,"subscribe",1)},6418:(e,t,i)=>{i.d(t,{w:()=>WorktreeNode});var r=i(9496),s=i(5255),n=i(4092),o=i(4321),a=i(3050),c=i(2061),l=i(5432),h=i(4241),u=i(3105),d=i(7469),p=i(3620),m=i(2925),g=i(21),f=i(9308),w=i(4741),v=i(2060),y=i(2540),b=i(7462),C=i(6450),A=i(439),P=i(7881),S=i(2800),R=i(3700),D=i(4481),k=i(6373),_=i(6922);class UncommittedFileNode extends _.Te{constructor(e,t,i,r){super(b.YY.fromFile(r,i),e,t,r)}toClipboard(){return this.path}get path(){return this.file.path}getChildren(){return[]}getTreeItem(){const e=new r.TreeItem(this.label,r.TreeItemCollapsibleState.None);e.contextValue=_.Td.File,e.description=this.description,e.resourceUri=this.view.container.git.getAbsoluteUri(this.file.path,this.repoPath);const t=(0,P.tK)(this.file.status);return e.iconPath={dark:this.view.container.context.asAbsolutePath((0,R.RQ)("images","dark",t)),light:this.view.container.context.asAbsolutePath((0,R.RQ)("images","light",t))},e.tooltip=k.o.fromTemplate("${file}\n${directory}/\n\n${status}${ (originalPath)}",this.file),e.command=this.getCommand(),this._label=void 0,this._description=void 0,e}get description(){return null==this._description&&(this._description=k.o.fromTemplate(this.view.config.formats.files.description,{...this.file},{relativePath:this.relativePath})),this._description}get folderName(){return null==this._folderName&&(this._folderName=(0,R.XX)(this.uri.relativePath)),this._folderName}get label(){return null==this._label&&(this._label=k.o.fromTemplate("${file}",{...this.file},{relativePath:this.relativePath})),this._label}get priority(){return 0}get relativePath(){return this._relativePath}set relativePath(e){this._relativePath=e,this._label=void 0,this._description=void 0}getCommand(){const e={uri:b.YY.fromFile(this.file,this.repoPath),line:0,showOptions:{preserveFocus:!0,preview:!0}};return{title:"Open Changes with Previous Revision",command:s.Gh.DiffWithPrevious,arguments:[void 0,e]}}}class UncommittedFilesNode extends _.Re{constructor(e,t,i,r){super(b.YY.fromRepoPath(i.repoPath),e,t),this.parent=t,this.status=i,this.range=r,this._uniqueId=(0,_.tO)("uncommitted-files",this.context)}get id(){return this._uniqueId}get repoPath(){return this.status.repoPath}getChildren(){const e=this.repoPath,t=[...(0,u.VS)(this.status.files,(e=>{if(null!=e.workingTreeStatus&&null!=e.indexStatus){const t=new Date;return t.setMilliseconds(t.getMilliseconds()-1),[this.getFileWithPseudoCommit(e,A.CL,A.pw),this.getFileWithPseudoCommit(e,A.pw,"HEAD",t)]}return null!=e.indexStatus?[this.getFileWithPseudoCommit(e,A.pw,"HEAD")]:[this.getFileWithPseudoCommit(e,A.CL,"HEAD")]}))];t.sort(((e,t)=>t.commit.date.getTime()-e.commit.date.getTime()));const i=(0,S.vM)(t,(e=>e.path));let r=Object.values(i).map((t=>new UncommittedFileNode(this.view,this,e,t[t.length-1])));if(this.view.config.files.layout!==y.Vc.List){const t=(0,S.Mo)(r,(e=>e.uri.relativePath.split("/")),((...e)=>(0,R.AH)((0,R.RQ)(...e))),this.view.config.files.compact);r=new D.Y(this.view,this,t,e,"",void 0,!0).getChildren()}else r.sort(((e,t)=>e.priority-t.priority||e.label.localeCompare(t.label,void 0,{numeric:!0,sensitivity:"base"})));return r}getTreeItem(){const e=new r.TreeItem("Uncommitted changes",r.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.contextValue=_.Td.UncommittedFiles,e.iconPath=new r.ThemeIcon("folder"),e}getFileWithPseudoCommit(e,t,i,r){return r=r??new Date,{status:e.status,repoPath:e.repoPath,indexStatus:e.indexStatus,workingTreeStatus:e.workingTreeStatus,path:e.path,originalPath:e.originalPath,commit:new C.aM(this.view.container,e.repoPath,t,new C._j("You",void 0,r),new C._j("You",void 0,r),"Uncommitted changes",[i],"Uncommitted changes",new P.K8(e.repoPath,e.path,e.status,e.originalPath,i),void 0,[])}}}var T=Object.defineProperty,F=Object.getOwnPropertyDescriptor,E=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?F(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&T(t,i,n),n};class WorktreeNode extends _.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.worktree=r,this.updateContext({worktree:r}),this._uniqueId=(0,_.tO)("worktree",this.context),this.limit=this.view.getNodeLastKnownLimit(this)}get id(){return this._uniqueId}toClipboard(){return this.worktree.uri.fsPath}get repoPath(){return this.uri.repoPath}async getChildren(){if(null==this._children){const e=this._branch;let t,i;if(null!=e&&this.view.config.pullRequests.enabled&&this.view.config.pullRequests.showForBranches&&(null!=e.upstream||e.remote)&&(0,c.fw)("gitlens:hasConnectedRemotes")&&(i=this.getState("pullRequest"),void 0===i&&void 0===this.getState("pendingPullRequest"))){t=(0,d.PQ)();const i=this.getAssociatedPullRequest(e,{include:[n.o0.Open,n.o0.Merged]});queueMicrotask((async()=>{await(t?.promise);let r=!1;const s=setTimeout((()=>{r=!0,this.view.triggerNodeChange(this)}),250),n=await i;clearTimeout(s),null!=n&&null!=this._children&&this._children.splice(this._children[0]instanceof f._?1:0,0,new v.Z(this.view,this,n,e)),(r||null!=n)&&this.view.triggerNodeChange(this)}))}const[r,s,o,a]=await Promise.allSettled([this.getLog(),this.view.container.git.getBranchesAndTagsTipsFn(this.uri.repoPath),this.worktree.getStatus(),null==e||e.remote?void 0:this.view.container.git.getBranchAheadRange(e).then((e=>e?this.view.container.git.getLogRefsOnly(this.uri.repoPath,{limit:0,ref:e}):void 0))]),l=(0,d.Sb)(r);if(null==l)return[new g.AE(this.view,this,"No commits could be found.")];const h=[];null!=e&&!1!==this.view.config.showBranchComparison&&h.push(new f._(this.uri,this.view,this,e,this.view.config.showBranchComparison,this.splatted)),null!=e&&null!=i&&h.push(new v.Z(this.view,this,i,e));const p=(0,d.Sb)(a),y=(0,d.Sb)(s);h.push(...(0,w.E)((0,u.UI)(l.commits.values(),(t=>new m.D(this.view,this,t,p?.has(t.ref),e,y))),this)),l.hasMore&&h.push(new g.Gd(this.view,this,h[h.length-1]));const b=(0,d.Sb)(o);b?.hasChanges&&h.unshift(new UncommittedFilesNode(this.view,this,b,void 0)),this._children=h,t?.fulfill()}return this._children}async getTreeItem(){this.splatted=!1;let e="";const t=new r.MarkdownString("",!0);let i,n=!1;const c=this.worktree.main||this.worktree.opened?`${(0,p.vk)(s.NE.Dash,2,2)} ${this.worktree.main?"_Main"+(this.worktree.opened?", Active_":"_"):this.worktree.opened?"_Active_":""} `:"";switch(this.worktree.type){case"bare":i=new r.ThemeIcon("folder"),t.appendMarkdown(`${this.worktree.main?"$(pass) ":""}Bare Worktree${c}\\\n\`${this.worktree.friendlyPath}\``);break;case"branch":{const[o,l]=await Promise.all([this.worktree.getBranch(),this.worktree.getStatus()]);if(this._branch=o,t.appendMarkdown(`${this.worktree.main?"$(pass) ":""}Worktree for Branch $(git-branch) ${o?.getNameWithoutRemote()??this.worktree.branch}${c}\\\n\`${this.worktree.friendlyPath}\``),i=new r.ThemeIcon("git-branch"),null!=l&&(n=l.hasChanges,t.appendMarkdown(`\n\n${l.getFormattedDiffStatus({prefix:"Has Uncommitted Changes\\\n",empty:"No Uncommitted Changes",expand:!0})}`)),null!=o&&(t.appendMarkdown(`\n\nBranch $(git-branch) ${o.getNameWithoutRemote()}`),!o.remote))if(null!=o.upstream){let i=s.NE.Dash;const r=await o.getRemote();if(o.upstream.missing)i=s.NE.Warning;else if(null!=r){let e,t;for(const{type:i}of r.urls)if(i===a.XG.Fetch){if(e=!0,t)break}else if(i===a.XG.Push&&(t=!0,e))break;e&&t?i=s.NE.ArrowsRightLeft:t?i=s.NE.ArrowRight:e&&(i=s.NE.ArrowLeft)}e=`${o.getTrackingStatus({empty:(0,p.vk)(i,0,2),suffix:(0,p.vk)(i,2,2)})}${o.upstream.name}`,t.appendMarkdown(` is ${o.getTrackingStatus({empty:o.upstream.missing?`missing upstream $(git-branch) ${o.upstream.name}`:`up to date with $(git-branch)  ${o.upstream.name}${r?.provider?.name?` on ${r.provider.name}`:""}`,expand:!0,icons:!0,separator:", ",suffix:` $(git-branch) ${o.upstream.name}${r?.provider?.name?` on ${r.provider.name}`:""}`})}`)}else{const e=a.ss.getHighlanderProviderName(await this.view.container.git.getRemotesWithProviders(o.repoPath));t.appendMarkdown(` hasn't been published to ${e??"a remote"}`)}break}case"detached":{i=new r.ThemeIcon("git-commit"),t.appendMarkdown(`${this.worktree.main?"$(pass) ":""}Detached Worktree at $(git-commit) ${(0,o.zL)(this.worktree.sha)}${c}\\\n\`${this.worktree.friendlyPath}\``);const e=await this.worktree.getStatus();null!=e&&(n=e.hasChanges,t.appendMarkdown(`\n\n${e.getFormattedDiffStatus({prefix:"Has Uncommitted Changes",empty:"No Uncommitted Changes",expand:!0})}`));break}}const l=this.getState("pendingPullRequest");null!=l&&t.appendMarkdown(`\n\n$(loading~spin) Loading associated pull request${s.NE.Ellipsis}`);const h=new r.TreeItem(this.worktree.name,r.TreeItemCollapsibleState.Collapsed);return h.id=this.id,h.description=e,h.contextValue=`${_.Td.Worktree}${this.worktree.main?"+main":""}${this.worktree.opened?"+active":""}`,h.iconPath=null!=l?new r.ThemeIcon("loading~spin"):this.worktree.opened?new r.ThemeIcon("check"):i,h.tooltip=t,h.resourceUri=n?r.Uri.parse("gitlens-view://worktree/changes"):void 0,h}refresh(e){this._children=void 0,e&&(this._log=void 0,this.deleteState())}async getAssociatedPullRequest(e,t){let i=this.getState("pullRequest");if(void 0!==i)return Promise.resolve(i??void 0);let r=this.getState("pendingPullRequest");return r??(r=e.getAssociatedPullRequest(t),this.storeState("pendingPullRequest",r),i=await r,this.storeState("pullRequest",i??null),this.deleteState("pendingPullRequest"),i)}async getLog(){return null==this._log&&(this._log=await this.view.container.git.getLog(this.uri.repoPath,{ref:this.worktree.sha,limit:this.limit??this.view.config.defaultItemLimit})),this._log}get hasMore(){return this._log?.hasMore??!0}async loadMore(e){let t=await r.window.withProgress({location:{viewId:this.view.id}},(()=>this.getLog()));null!=t&&t.hasMore&&(t=await(t.more?.(e??this.view.config.pageItemLimit)),this._log!==t&&(this._log=t,this.limit=t?.count,this._children=void 0,this.triggerChange(!1)))}}E([(0,l.H)(),(0,h.fF)()],WorktreeNode.prototype,"refresh",1),E([(0,l.H)()],WorktreeNode.prototype,"loadMore",1)},8562:(e,t,i)=>{i.d(t,{S:()=>WorktreesNode});var r=i(9496),s=i(5255),n=i(8887),o=i(5432),a=i(4241),c=i(21),l=i(6922),h=i(6418),u=Object.defineProperty,d=Object.getOwnPropertyDescriptor;class WorktreesNode extends l.Re{constructor(e,t,i,r){super(e,t,i),this.parent=i,this.repo=r,this.updateContext({repository:r}),this._uniqueId=(0,l.tO)("worktrees",this.context)}get id(){return this._uniqueId}get repoPath(){return this.repo.path}async getChildren(){if(null==this._children){if(!(await this.repo.access(n.x.Worktrees)).allowed)return[];const e=await this.repo.getWorktrees();if(0===e.length)return[new c.AE(this.view,this,"No worktrees could be found.")];this._children=e.map((e=>new h.w(this.uri,this.view,this,e)))}return this._children}async getTreeItem(){const e=await this.repo.access(n.x.Worktrees),t=new r.TreeItem("Worktrees",e.allowed?r.TreeItemCollapsibleState.Collapsed:r.TreeItemCollapsibleState.None);return t.id=this.id,t.contextValue=l.Td.Worktrees,t.description=e.allowed?void 0:` ${s.NE.Warning}  Requires a trial or paid plan for use on privately hosted repos`,t.iconPath=new r.ThemeIcon("folder-opened"),t}refresh(){this._children=void 0}}((e,t,i,r)=>{for(var s,n=r>1?void 0:r?d(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);r&&n&&u(t,i,n)})([(0,o.H)(),(0,a.fF)()],WorktreesNode.prototype,"refresh",1)},3479:(e,t,i)=>{i.d(t,{L5:()=>RemotesView});var r=i(9496),s=i(2540),n=i(5255),o=i(7462),a=i(5367),c=i(6450),l=i(4321),h=i(3646),u=i(9529),d=i(5148),p=i(5432),m=i(7382),g=i(4004),f=i(1351),w=i(1952),v=i(9100),y=i(6922),b=i(5517),C=i(5688),A=Object.defineProperty,P=Object.getOwnPropertyDescriptor,S=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?P(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&A(t,i,n),n};class RemotesRepositoryNode extends y.vb{async getChildren(){return null==this.child&&(this.child=new w.e(this.uri,this.view,this,this.repo)),this.child.getChildren()}changed(e){return e.changed(h.I6.Config,h.I6.Remotes,h.I6.RemoteProviders,h.I6.Unknown,h.du.Any)}}class RemotesViewNode extends y.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No remotes could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new RemotesRepositoryNode(o.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.repo.getRemotes();return 0===t.length?(this.view.message="No remotes could be found.",this.view.title="Remotes",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Remotes (${t.length})`,e.getChildren())}return this.view.title="Remotes",this.children}getTreeItem(){return new r.TreeItem("Remotes",r.TreeItemCollapsibleState.Expanded)}}class RemotesView extends b._{constructor(e){super(e,"remotes","Remotes","remotesView"),this.configKey="remotes"}get canReveal(){return this.config.reveal||!d.D.get("views.repositories.showRemotes")}getRoot(){return new RemotesViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,C.i)(this.getQualifiedCommand("copy"),(()=>(0,u.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,C.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("branches","remotes"),this.refresh(!0))),this),(0,C.i)(this.getQualifiedCommand("setLayoutToList"),(()=>this.setLayout(s.CZ.List)),this),(0,C.i)(this.getQualifiedCommand("setLayoutToTree"),(()=>this.setLayout(s.CZ.Tree)),this),(0,C.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(s.Vc.Auto)),this),(0,C.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(s.Vc.List)),this),(0,C.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(s.Vc.Tree)),this),(0,C.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,C.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,C.i)(this.getQualifiedCommand("setShowBranchPullRequestOn"),(()=>this.setShowBranchPullRequest(!0)),this),(0,C.i)(this.getQualifiedCommand("setShowBranchPullRequestOff"),(()=>this.setShowBranchPullRequest(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||d.D.changed(e,"defaultDateFormat")||d.D.changed(e,"defaultDateLocale")||d.D.changed(e,"defaultDateShortFormat")||d.D.changed(e,"defaultDateSource")||d.D.changed(e,"defaultDateStyle")||d.D.changed(e,"defaultGravatarsStyle")||d.D.changed(e,"defaultTimeFormat")||d.D.changed(e,"integrations.enabled")||d.D.changed(e,"sortBranchesBy"))}findBranch(e,t){if(!e.remote)return;const{repoPath:i}=e;return this.findNode((t=>t.branch?.ref===e.ref),{allowPaging:!0,maxDepth:5,canTraverse:t=>t instanceof RemotesViewNode||(t instanceof RemotesRepositoryNode||t instanceof g.n?t.repoPath===i:t instanceof f.V&&(t.repoPath===i&&t.remote.name===(0,a.Lo)(e.name))),token:t})}async findCommit(e,t){const{repoPath:i}=e,r=await this.container.git.getCommitBranches(e.repoPath,e.ref,(0,c.f_)(e)?{commitDate:e.committer.date,remotes:!0}:{remotes:!0});if(0===r.length)return;const s=r.map((e=>e.split("/",1)[0]));return this.findNode((t=>t.commit?.ref===e.ref),{allowPaging:!0,maxDepth:6,canTraverse:e=>e instanceof RemotesViewNode||(e instanceof RemotesRepositoryNode||e instanceof g.n?e.repoPath===i:e instanceof f.V?e.repoPath===i&&s.includes(e.remote.name):e instanceof m.E?e.repoPath===i&&r.includes(e.branch.name):(e instanceof v.q||e instanceof w.e||e instanceof g.n)&&e.repoPath===i),token:t})}findRemote(e,t){const{repoPath:i}=e;return this.findNode((t=>t.remote?.name===e.name),{allowPaging:!0,maxDepth:2,canTraverse:e=>e instanceof RemotesViewNode||e instanceof RemotesRepositoryNode&&e.repoPath===i,token:t})}revealBranch(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,l.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findBranch(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealCommit(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,l.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findCommit(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}revealRemote(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing remote '${e.name}' in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findRemote(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof y.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof RemotesViewNode||e instanceof y.vb});return void 0!==i&&await this.reveal(i,t),i}setLayout(e){return d.D.updateEffective(`views.${this.configKey}.branches.layout`,e)}setFilesLayout(e){return d.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAvatars(e){return d.D.updateEffective(`views.${this.configKey}.avatars`,e)}async setShowBranchPullRequest(e){await d.D.updateEffective(`views.${this.configKey}.pullRequests.showForBranches`,e),await d.D.updateEffective(`views.${this.configKey}.pullRequests.enabled`,e)}}S([(0,p.H)((()=>""))],RemotesView.prototype,"revealBranch",1),S([(0,p.H)((()=>""))],RemotesView.prototype,"revealCommit",1),S([(0,p.H)((()=>""))],RemotesView.prototype,"revealRemote",1),S([(0,p.H)((()=>""))],RemotesView.prototype,"revealRepository",1)},5478:(e,t,i)=>{i.d(t,{a:()=>RepositoriesView});var r=i(9496),s=i(2540),n=i(5255),o=i(5367),a=i(6450),c=i(4321),l=i(9529),h=i(5148),u=i(2061),d=i(5432),p=i(3608),m=i(7382),g=i(4004),f=i(9354),w=i(9308),v=i(5310),y=i(4562),b=i(8896),C=i(1351),A=i(1952),P=i(7424),S=i(9100),R=i(727),D=i(1841),k=i(6418),_=i(8562),T=i(5517),F=i(5688),E=Object.defineProperty,$=Object.getOwnPropertyDescriptor,O=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?$(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&E(t,i,n),n};class RepositoriesView extends T._{constructor(e){super(e,"repositories","Repositories","repositoriesView"),this.configKey="repositories",this._onDidChangeAutoRefresh=new r.EventEmitter}get onDidChangeAutoRefresh(){return this._onDidChangeAutoRefresh.event}get canSelectMany(){return!1}getRoot(){return new P.S(this)}registerCommands(){return this.container.viewCommands,[(0,F.i)(this.getQualifiedCommand("copy"),(()=>(0,l.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,F.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("branches","contributors","remotes","stashes","status","tags"),this.refresh(!0))),this),(0,F.i)(this.getQualifiedCommand("setBranchesLayoutToList"),(()=>this.setBranchesLayout(s.CZ.List)),this),(0,F.i)(this.getQualifiedCommand("setBranchesLayoutToTree"),(()=>this.setBranchesLayout(s.CZ.Tree)),this),(0,F.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(s.Vc.Auto)),this),(0,F.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(s.Vc.List)),this),(0,F.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(s.Vc.Tree)),this),(0,F.i)(this.getQualifiedCommand("setAutoRefreshToOn"),(()=>this.setAutoRefresh(h.D.get("views.repositories.autoRefresh"),!0)),this),(0,F.i)(this.getQualifiedCommand("setAutoRefreshToOff"),(()=>this.setAutoRefresh(h.D.get("views.repositories.autoRefresh"),!1)),this),(0,F.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,F.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,F.i)(this.getQualifiedCommand("setShowBranchComparisonOn"),(()=>this.setShowBranchComparison(!0)),this),(0,F.i)(this.getQualifiedCommand("setShowBranchComparisonOff"),(()=>this.setShowBranchComparison(!1)),this),(0,F.i)(this.getQualifiedCommand("setBranchesShowBranchComparisonOn"),(()=>this.setBranchShowBranchComparison(!0)),this),(0,F.i)(this.getQualifiedCommand("setBranchesShowBranchComparisonOff"),(()=>this.setBranchShowBranchComparison(!1)),this),(0,F.i)(this.getQualifiedCommand("setShowBranchesOn"),(()=>this.toggleSection("showBranches",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowBranchesOff"),(()=>this.toggleSection("showBranches",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowCommitsOn"),(()=>this.toggleSection("showCommits",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowCommitsOff"),(()=>this.toggleSection("showCommits",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowContributorsOn"),(()=>this.toggleSection("showContributors",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowContributorsOff"),(()=>this.toggleSection("showContributors",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowRemotesOn"),(()=>this.toggleSection("showRemotes",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowRemotesOff"),(()=>this.toggleSection("showRemotes",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowStashesOn"),(()=>this.toggleSection("showStashes",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowStashesOff"),(()=>this.toggleSection("showStashes",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowTagsOn"),(()=>this.toggleSection("showTags",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowTagsOff"),(()=>this.toggleSection("showTags",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowWorktreesOn"),(()=>this.toggleSection("showWorktrees",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowWorktreesOff"),(()=>this.toggleSection("showWorktrees",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowUpstreamStatusOn"),(()=>this.toggleSection("showUpstreamStatus",!0)),this),(0,F.i)(this.getQualifiedCommand("setShowUpstreamStatusOff"),(()=>this.toggleSection("showUpstreamStatus",!1)),this),(0,F.i)(this.getQualifiedCommand("setShowSectionOff"),(e=>this.toggleSectionByNode(e,!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||h.D.changed(e,"defaultDateFormat")||h.D.changed(e,"defaultDateLocale")||h.D.changed(e,"defaultDateShortFormat")||h.D.changed(e,"defaultDateSource")||h.D.changed(e,"defaultDateStyle")||h.D.changed(e,"defaultGravatarsStyle")||h.D.changed(e,"defaultTimeFormat")||h.D.changed(e,"sortBranchesBy")||h.D.changed(e,"sortContributorsBy")||h.D.changed(e,"sortTagsBy"))}onConfigurationChanged(e){h.D.changed(e,`views.${this.configKey}.autoRefresh`)&&this.setAutoRefresh(h.D.get("views.repositories.autoRefresh")),super.onConfigurationChanged(e)}get autoRefresh(){return this.config.autoRefresh&&this.container.storage.getWorkspace("views:repositories:autoRefresh",!0)}findBranch(e,t){const{repoPath:i}=e;return e.remote?this.findNode((t=>t.branch?.ref===e.ref),{allowPaging:!0,maxDepth:6,canTraverse:t=>t instanceof P.S||(t instanceof C.V?t.repoPath===i&&(e.remote&&t.remote.name===(0,o.Lo)(e.name)):(t instanceof S.q||t instanceof p.r||t instanceof A.e||t instanceof g.n)&&t.repoPath===i),token:t}):this.findNode((t=>t.branch?.ref===e.ref),{allowPaging:!0,maxDepth:5,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof p.r||e instanceof g.n)&&e.repoPath===i,token:t})}async findCommit(e,t){const{repoPath:i}=e;let r=await this.container.git.getCommitBranches(e.repoPath,e.ref,(0,a.f_)(e)?{commitDate:e.committer.date}:void 0);if(0!==r.length)return this.findNode((t=>t.commit?.ref===e.ref),{allowPaging:!0,maxDepth:6,canTraverse:async t=>t instanceof P.S||(t instanceof S.q||t instanceof p.r||t instanceof g.n?t.repoPath===i:!!(t instanceof m.E&&t.repoPath===i&&r.includes(t.branch.name))&&(await t.loadMore({until:e.ref}),!0)),token:t});if(r=await this.container.git.getCommitBranches(e.repoPath,e.ref,(0,a.f_)(e)?{commitDate:e.committer.date,remotes:!0}:{remotes:!0}),0===r.length)return;const s=r.map((e=>e.split("/",1)[0]));return this.findNode((t=>t.commit?.ref===e.ref),{allowPaging:!0,maxDepth:8,canTraverse:e=>e instanceof P.S||(e instanceof C.V?e.repoPath===i&&s.includes(e.remote.name):e instanceof m.E?e.repoPath===i&&r.includes(e.branch.name):(e instanceof S.q||e instanceof A.e||e instanceof g.n)&&e.repoPath===i),token:t})}findContributor(e,t){const{repoPath:i,username:r,email:s,name:n}=e;return this.findNode((e=>e instanceof v.K&&e.contributor.username===r&&e.contributor.email===s&&e.contributor.name===n),{maxDepth:2,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof y.I)&&e.repoPath===i,token:t})}findRemote(e,t){const{repoPath:i}=e;return this.findNode((t=>t.remote?.name===e.name),{allowPaging:!0,maxDepth:2,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof A.e)&&e.repoPath===i,token:t})}findStash(e,t){const{repoPath:i}=e;return this.findNode((t=>t.commit?.ref===e.ref),{maxDepth:3,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof R.m)&&e.repoPath===i,token:t})}findTag(e,t){const{repoPath:i}=e;return this.findNode((t=>t.tag?.ref===e.ref),{allowPaging:!0,maxDepth:5,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof D.P||e instanceof g.n)&&e.repoPath===i,token:t})}findWorktree(e,t){const{repoPath:i,uri:r}=e,s=r.toString();return this.findNode((t=>t instanceof k.w&&e.uri.toString()===s),{maxDepth:2,canTraverse:e=>e instanceof P.S||(e instanceof S.q||e instanceof _.S)&&e.repoPath===i,token:t})}revealBranch(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,c.Wh)(e,{icon:!1,quoted:!0})} in the Repositories view...`,cancellable:!0},(async(i,r)=>{const s=await this.findBranch(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealBranches(e,t){const i=await this.findNode((t=>t instanceof p.r&&t.repoPath===e),{maxDepth:2,canTraverse:t=>t instanceof P.S||t instanceof S.q&&t.repoPath===e});return void 0!==i&&await this.reveal(i,t),i}async revealCommit(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,c.Wh)(e,{icon:!1,quoted:!0})} in the Repositories view...`,cancellable:!0},(async(i,r)=>{const s=await this.findCommit(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealContributor(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing contributor '${e.name} in the Repositories view...`,cancellable:!0},(async(i,r)=>{const s=await this.findContributor(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}revealRemote(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing remote '${e.name}' in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findRemote(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof S.q&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof P.S});return void 0!==i&&await this.reveal(i,t),i}async revealStash(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,c.Wh)(e,{icon:!1,quoted:!0})} in the Repositories view...`,cancellable:!0},(async(i,r)=>{const s=await this.findStash(e,r);return void 0!==s&&await this.reveal(s,t),s}))}async revealStashes(e,t){const i=await this.findNode((t=>t instanceof R.m&&t.repoPath===e),{maxDepth:2,canTraverse:t=>t instanceof P.S||t instanceof S.q&&t.repoPath===e});return void 0!==i&&await this.reveal(i,t),i}revealTag(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,c.Wh)(e,{icon:!1,quoted:!0})} in the Repositories view...`,cancellable:!0},(async(i,r)=>{const s=await this.findTag(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealTags(e,t){const i=await this.findNode((t=>t instanceof D.P&&t.repoPath===e),{maxDepth:2,canTraverse:t=>t instanceof P.S||t instanceof S.q&&t.repoPath===e});return void 0!==i&&await this.reveal(i,t),i}revealWorktree(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing worktree '${e.name}' in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findWorktree(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}async revealWorktrees(e,t){const i=await this.findNode((t=>t instanceof _.S&&t.repoPath===e),{maxDepth:2,canTraverse:t=>t instanceof P.S||t instanceof S.q&&t.repoPath===e});return void 0!==i&&await this.reveal(i,t),i}async setAutoRefresh(e,t){e&&(void 0===t?t=this.container.storage.getWorkspace("views:repositories:autoRefresh",!0):await this.container.storage.storeWorkspace("views:repositories:autoRefresh",t)),(0,u.v)("gitlens:views:repositories:autoRefresh",e&&t),this._onDidChangeAutoRefresh.fire()}setBranchesLayout(e){return h.D.updateEffective(`views.${this.configKey}.branches.layout`,e)}setFilesLayout(e){return h.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAvatars(e){return h.D.updateEffective(`views.${this.configKey}.avatars`,e)}setShowBranchComparison(e){return h.D.updateEffective(`views.${this.configKey}.showBranchComparison`,!!e&&s.DH.Working)}setBranchShowBranchComparison(e){return h.D.updateEffective(`views.${this.configKey}.branches.showBranchComparison`,!!e&&s.DH.Branch)}toggleSection(e,t){return h.D.updateEffective(`views.${this.configKey}.${e}`,t)}toggleSectionByNode(e,t){return e instanceof p.r?h.D.updateEffective(`views.${this.configKey}.showBranches`,t):e instanceof m.E?h.D.updateEffective(`views.${this.configKey}.showCommits`,t):e instanceof f.V?h.D.updateEffective(`views.${this.configKey}.showUpstreamStatus`,t):e instanceof w._?this.setShowBranchComparison(t):e instanceof y.I?h.D.updateEffective(`views.${this.configKey}.showContributors`,t):e instanceof b.Y?h.D.updateEffective(`views.${this.configKey}.showIncomingActivity`,t):e instanceof A.e?h.D.updateEffective(`views.${this.configKey}.showRemotes`,t):e instanceof R.m?h.D.updateEffective(`views.${this.configKey}.showStashes`,t):e instanceof D.P?h.D.updateEffective(`views.${this.configKey}.showTags`,t):e instanceof _.S?h.D.updateEffective(`views.${this.configKey}.showWorktrees`,t):Promise.resolve()}}O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealBranch",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealBranches",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealCommit",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealContributor",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealRemote",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealRepository",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealStash",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealStashes",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealTag",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealTags",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealWorktree",1),O([(0,d.H)((()=>""))],RepositoriesView.prototype,"revealWorktrees",1)},9137:(e,t,i)=>{i.d(t,{wc:()=>TagsView});var r=i(9496),s=i(2540),n=i(5255),o=i(7462),a=i(4321),c=i(3646),l=i(9529),h=i(5148),u=i(5432),d=i(4004),p=i(1841),m=i(6922),g=i(5517),f=i(5688),w=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?v(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&w(t,i,n),n};class TagsRepositoryNode extends m.vb{async getChildren(){return null==this.child&&(this.child=new p.P(this.uri,this.view,this,this.repo)),this.child.getChildren()}changed(e){return e.changed(c.I6.Tags,c.I6.Unknown,c.du.Any)}}class TagsViewNode extends m.FZ{async getChildren(){if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No tags could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new TagsRepositoryNode(o.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.repo.getTags();return 0===t.values.length?(this.view.message="No tags could be found.",this.view.title="Tags",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Tags (${t.values.length})`,e.getChildren())}return this.view.title="Tags",this.children}getTreeItem(){return new r.TreeItem("Tags",r.TreeItemCollapsibleState.Expanded)}}class TagsView extends g._{constructor(e){super(e,"tags","Tags","tagsView"),this.configKey="tags"}get canReveal(){return this.config.reveal||!h.D.get("views.repositories.showTags")}getRoot(){return new TagsViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,f.i)(this.getQualifiedCommand("copy"),(()=>(0,l.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,f.i)(this.getQualifiedCommand("refresh"),(()=>(this.container.git.resetCaches("tags"),this.refresh(!0))),this),(0,f.i)(this.getQualifiedCommand("setLayoutToList"),(()=>this.setLayout(s.CZ.List)),this),(0,f.i)(this.getQualifiedCommand("setLayoutToTree"),(()=>this.setLayout(s.CZ.Tree)),this),(0,f.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(s.Vc.Auto)),this),(0,f.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(s.Vc.List)),this),(0,f.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(s.Vc.Tree)),this),(0,f.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,f.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||h.D.changed(e,"defaultDateFormat")||h.D.changed(e,"defaultDateLocale")||h.D.changed(e,"defaultDateShortFormat")||h.D.changed(e,"defaultDateSource")||h.D.changed(e,"defaultDateStyle")||h.D.changed(e,"defaultGravatarsStyle")||h.D.changed(e,"defaultTimeFormat")||h.D.changed(e,"sortTagsBy"))}findTag(e,t){const{repoPath:i}=e;return this.findNode((t=>t.tag?.ref===e.ref),{allowPaging:!0,maxDepth:2,canTraverse:e=>e instanceof TagsViewNode||(e instanceof TagsRepositoryNode||e instanceof d.n)&&e.repoPath===i,token:t})}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof m.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof TagsViewNode||e instanceof m.vb});return void 0!==i&&await this.reveal(i,t),i}revealTag(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing ${(0,a.Wh)(e,{icon:!1,quoted:!0})} in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findTag(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}setLayout(e){return h.D.updateEffective(`views.${this.configKey}.branches.layout`,e)}setFilesLayout(e){return h.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAvatars(e){return h.D.updateEffective(`views.${this.configKey}.avatars`,e)}}y([(0,u.H)((()=>""))],TagsView.prototype,"revealRepository",1),y([(0,u.H)((()=>""))],TagsView.prototype,"revealTag",1)},5517:(e,t,i)=>{i.d(t,{_:()=>ViewBase});var r=i(9496),s=i(2540),n=i(9529),o=i(5148),a=i(4241),c=i(2185),l=i(9796),h=i(4336),u=i(6004),d=i(7469),p=i(6922),m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?g(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&m(t,i,n),n};class ViewBase{constructor(e,t,i,s){if(this.container=e,this.type=t,this.name=i,this.trackingFeature=s,this._onDidChangeTreeData=new r.EventEmitter,this._onDidChangeSelection=new r.EventEmitter,this._onDidChangeVisibility=new r.EventEmitter,this._onDidChangeNodeCollapsibleState=new r.EventEmitter,this.disposables=[],this._lastKnownLimits=new Map,this.disposables.push((0,c.IH)(e.onReady)(this.onReady,this)),this.container.debugging||o.D.get("debug")){let e=function(e,t,i){null==e.tooltip&&(e.tooltip=new r.MarkdownString(null!=e.label&&"string"!=typeof e.label?e.label.label:e.label??"")),"string"==typeof e.tooltip?e.tooltip=`${e.tooltip}\n\n---\ncontext: ${e.contextValue}\nnode: ${t.toString()}${null!=i?`\nparent: ${i.toString()}`:""}`:e.tooltip.appendMarkdown(`\n\n---\n\ncontext: \`${e.contextValue}\`\\\nnode: \`${t.toString()}\`${null!=i?`\\\nparent: \`${i.toString()}\``:""}`)};const t=this.getTreeItem;this.getTreeItem=async function(i){const r=await t.apply(this,[i]);return null==i.resolveTreeItem&&e(r,i,i.getParent()),r};const i=this.resolveTreeItem;this.resolveTreeItem=async function(t,r){return t=await i.apply(this,[t,r]),e(t,r,r.getParent()),t}}this.disposables.push(...this.registerCommands())}get id(){return`gitlens.views.${this.type}`}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get onDidChangeSelection(){return this._onDidChangeSelection.event}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}get onDidChangeNodeCollapsibleState(){return this._onDidChangeNodeCollapsibleState.event}dispose(){this._nodeState?.dispose(),this._nodeState=void 0,r.Disposable.from(...this.disposables).dispose()}onReady(){this.initialize({canSelectMany:this.canSelectMany,showCollapseAll:this.showCollapseAll}),queueMicrotask((()=>this.onConfigurationChanged()))}get canReveal(){return!0}get canSelectMany(){return this.container.prereleaseOrDebugging&&o.D.get("views.experimental.multiSelect.enabled",void 0,!1)}get nodeState(){return null==this._nodeState&&(this._nodeState=new ViewNodeState),this._nodeState}get showCollapseAll(){return!0}filterConfigurationChanged(e){if(!o.D.changed(e,"views"))return!1;if(o.D.changed(e,`views.${this.configKey}`))return!0;for(const t of s.TA)if(o.D.changed(e,`views.${t}`))return!0;return!1}get badge(){return this.tree?.badge}set badge(e){null!=this.tree&&(this.tree.badge=e)}get title(){return this._title}set title(e){this._title=e,null!=this.tree&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,null!=this.tree&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,null!=this.tree&&(this.tree.message=e)}getQualifiedCommand(e){return`gitlens.views.${this.type}.${e}`}onConfigurationChanged(e){null!=e&&null!=this.root&&this.refresh(!0)}initialize(e={}){this.tree=r.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(o.D.onDidChange((e=>{this.filterConfigurationChanged(e)&&(this._config=void 0,this.onConfigurationChanged(e))}),this),this.tree,this.tree.onDidChangeSelection((0,l.Ds)(this.onSelectionChanged,250),this),this.tree.onDidChangeVisibility((0,l.Ds)(this.onVisibilityChanged,250),this),this.tree.onDidCollapseElement(this.onElementCollapsed,this),this.tree.onDidExpandElement(this.onElementExpanded,this)),null!=this._title?this.tree.title=this._title:this._title=this.tree.title,null!=this._description&&(this.tree.description=this._description),null!=this._message&&(this.tree.message=this._message)}ensureRoot(e=!1){return(null==this.root||e)&&(this.root=this.getRoot()),this.root}getChildren(e){if(null!=e)return e.getChildren();return this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}resolveTreeItem(e,t){return t.resolveTreeItem?.(e)??e}onElementCollapsed(e){this._onDidChangeNodeCollapsibleState.fire({...e,state:r.TreeItemCollapsibleState.Collapsed})}onElementExpanded(e){this._onDidChangeNodeCollapsibleState.fire({...e,state:r.TreeItemCollapsibleState.Expanded})}onSelectionChanged(e){this._onDidChangeSelection.fire(e)}onVisibilityChanged(e){e.visible&&this.container.usage.track(`${this.trackingFeature}:shown`),this._onDidChangeVisibility.fire(e)}get activeSelection(){if(null!=this.tree&&null!=this.root)return this.tree.selection[0]}get selection(){return null==this.tree||null==this.root?[]:this.tree.selection}get visible(){return this.tree?.visible??!1}async findNode(e,{allowPaging:t=!1,canTraverse:i,maxDepth:r=2,token:s}={}){const n=(0,u.UH)();async function o(){try{return await this.findNodeCoreBFS(e,this.ensureRoot(),t,i,r,s)}catch(e){return void h.Yd.error(e,n)}}return null!=this.root?o.call(this):(await this.show({preserveFocus:!0}),new Promise((e=>setTimeout((()=>e(o.call(this))),100))))}async findNodeCoreBFS(e,t,i,r,s,n){const a=[t,void 0],c=o.D.get("advanced.maxListItems");let l,h,u,m=0;for(;a.length>1;){if(n?.isCancellationRequested)return;if(l=a.shift(),null!=l){if(e(l))return l;if(null!=r){const e=r(l);if((0,d.tI)(e)){if(!await e)continue}else if(!e)continue}if(h=await l.getChildren(),0!==h.length){for(;null!=l&&!(0,p.On)(l);)l=await(l.getSplattedChild?.());if(null!=l&&(0,p.On)(l)){let t=h.find(e);if(null!=t)return t;if(i&&l.hasMore)for(;;){if(n?.isCancellationRequested)return;if(await this.loadMoreNodeChildren(l,c),u=await(0,d.HO)(Promise.resolve(l.getChildren()),n??6e4,{onDidCancel:e=>e([])}),t=u.find(e),null!=t)return t;if(!l.hasMore)break}}else a.push(...h)}}else if(m++,a.push(void 0),m>s)break}}async ensureRevealNode(e,t){const i=[];let r=e;for(;null!=r;)i.push(r),r=r.getParent();i.length>1&&i.pop();for(const e of i.reverse())try{await this.reveal(e,t)}catch{}}async refresh(e=!1){e&&this.nodeState.reset(),await(this.root?.refresh?.(e)),this.triggerNodeChange()}async refreshNode(e,t=!1,i=!1){const r=await(e.refresh?.(t));(i||!0!==r)&&this.triggerNodeChange(e)}async reveal(e,t){if(null!=this.tree)try{await this.tree.reveal(e,t)}catch(e){h.Yd.error(e)}}async show(e){const t=(0,u.UH)();try{await(0,n.dO)(`${this.id}.focus`,e)}catch(e){h.Yd.error(e,t)}}getNodeLastKnownLimit(e){return this._lastKnownLimits.get(e.id)}async loadMoreNodeChildren(e,t,i,r){null!=i&&await this.reveal(i,{select:!0}),await e.loadMore(t,r),this._lastKnownLimits.set(e.id,e.limit)}resetNodeLastKnownLimit(e){this._lastKnownLimits.delete(e.id)}triggerNodeChange(e){this._onDidChangeTreeData.fire(null!=e&&e!==this.root?e:void 0)}get config(){if(null==this._config){const e={...o.D.get("views")};for(const t of s.S4)delete e[t];this._config={...e,...o.D.get("views")[this.configKey]}}return this._config}}f([(0,a.cM)({args:{0:"<function>",1:e=>`options=${JSON.stringify({...e,canTraverse:void 0,token:void 0})}`}})],ViewBase.prototype,"findNode",1),f([(0,a.fF)()],ViewBase.prototype,"refresh",1),f([(0,a.fF)({args:{0:e=>e.toString()}})],ViewBase.prototype,"refreshNode",1),f([(0,a.cM)({args:{0:e=>e.toString()}})],ViewBase.prototype,"reveal",1),f([(0,a.cM)()],ViewBase.prototype,"show",1),f([(0,a.fF)({args:{0:e=>e.toString(),2:e=>e?.toString()}})],ViewBase.prototype,"loadMoreNodeChildren",1),f([(0,a.fF)({args:{0:e=>e.toString()},singleLine:!0})],ViewBase.prototype,"resetNodeLastKnownLimit",1),f([(0,a.fF)({args:{0:e=>e?.toString()}})],ViewBase.prototype,"triggerNodeChange",1);class ViewNodeState{dispose(){this.reset()}reset(){this._state?.clear(),this._state=void 0}deleteState(e,t){null==t?this._state?.delete(e):this._state?.get(e)?.delete(t)}getState(e,t){return this._state?.get(e)?.get(t)}storeState(e,t,i){null==this._state&&(this._state=new Map);const r=this._state.get(e);null!=r?r.set(t,i):this._state.set(e,new Map([[t,i]]))}}},5688:(e,t,i)=>{i.d(t,{i:()=>K,s:()=>ViewCommands});var r=i(9496),s=i(2540),n=i(5255),o=i(9311),a=i(3401),c=i(6897),l=i(7445),h=i(4155),u=i(8834),d=i(252),p=i(6713),m=i(5025),g=i(7462),f=i(439),w=i(4321),v=i(9529),y=i(5148),b=i(2061),C=i(4241),A=i(9796),P=i(2509),S=i(7382),R=i(9354),D=i(2601),k=i(2925),_=i(9308),T=i(5310),F=i(906),E=i(9719),$=i(4481),O=i(3126),x=i(981),I=i(2060),B=i(1351),W=i(9100),L=i(202),M=i(812),U=i(2758),N=i(1101),G=i(6586),H=i(638),V=i(6922),q=i(6418),Q=i(8562),Y=Object.defineProperty,j=Object.getOwnPropertyDescriptor,z=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?j(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&Y(t,i,n),n};function K(e,t,i,r=1){return(0,v.xR)(e,((...e)=>{if(0!==r){let[s,n,...o]=e;if(s instanceof V.Re&&Array.isArray(n)&&n[0]instanceof V.Re)return n=n.filter((e=>e?.constructor===s.constructor)),2===r?t.apply(i,[s,n,...o]):(0,A.df)(t,n.map((e=>[e,...o])),i)}return t.apply(i,e)}),i)}class ViewCommands{constructor(e){this.container=e,K("gitlens.views.clearNode",(e=>(0,V.kr)(e)&&e.clear()),this),(0,v.xR)(n.Gh.ViewsCopy,(async(e,t)=>{if(0===(t=Array.isArray(t)?t:null!=e?[e]:[]).length)return;const i=t.map((e=>e.toClipboard?.())).filter((e=>Boolean(e))).join("\n");await r.env.clipboard.writeText(i)}),this),K("gitlens.views.dismissNode",(e=>(0,V.kP)(e.view)&&e.view.dismissNode(e)),this),K("gitlens.views.editNode",(e=>(0,V.LD)(e)&&e.edit()),this),K("gitlens.views.expandNode",(e=>e.view.reveal(e,{select:!1,focus:!1,expand:3})),this),K("gitlens.views.loadMoreChildren",(e=>e.loadMore()),this),K("gitlens.views.loadAllChildren",(e=>e.loadAll()),this),K("gitlens.views.refreshNode",((e,t)=>(null==t&&(0,V.On)(e)&&(e.limit=void 0,e.view.resetNodeLastKnownLimit(e)),e.view.refreshNode(e,t??!0))),this),K("gitlens.views.setShowRelativeDateMarkersOn",(()=>this.setShowRelativeDateMarkers(!0)),this),K("gitlens.views.setShowRelativeDateMarkersOff",(()=>this.setShowRelativeDateMarkers(!1)),this),K("gitlens.views.fetch",this.fetch,this),K("gitlens.views.publishBranch",this.publishBranch,this),K("gitlens.views.publishRepository",this.publishRepository,this),K("gitlens.views.pull",this.pull,this),K("gitlens.views.push",this.push,this),K("gitlens.views.pushWithForce",(e=>this.push(e,!0)),this),K("gitlens.views.closeRepository",this.closeRepository,this),K("gitlens.views.setAsDefault",this.setAsDefault,this),K("gitlens.views.unsetAsDefault",this.unsetAsDefault,this),K("gitlens.views.openInTerminal",this.openInTerminal,this),K("gitlens.views.star",this.star,this),K("gitlens.views.unstar",this.unstar,this),K("gitlens.views.browseRepoAtRevision",this.browseRepoAtRevision,this),K("gitlens.views.browseRepoAtRevisionInNewWindow",(e=>this.browseRepoAtRevision(e,{openInNewWindow:!0})),this),K("gitlens.views.browseRepoBeforeRevision",(e=>this.browseRepoAtRevision(e,{before:!0})),this),K("gitlens.views.browseRepoBeforeRevisionInNewWindow",(e=>this.browseRepoAtRevision(e,{before:!0,openInNewWindow:!0})),this),K("gitlens.views.addAuthors",this.addAuthors,this),K("gitlens.views.addAuthor",this.addAuthor,this),K("gitlens.views.openChanges",this.openChanges,this),K("gitlens.views.openChangesWithWorking",this.openChangesWithWorking,this),K("gitlens.views.openPreviousChangesWithWorking",this.openPreviousChangesWithWorking,this),K("gitlens.views.openFile",this.openFile,this),K("gitlens.views.openFileRevision",this.openRevision,this),K("gitlens.views.openChangedFiles",this.openFiles,this),K("gitlens.views.openChangedFileDiffs",this.openAllChanges,this),K("gitlens.views.openChangedFileDiffsWithWorking",this.openAllChangesWithWorking,this),K("gitlens.views.openChangedFileRevisions",this.openRevisions,this),K("gitlens.views.applyChanges",this.applyChanges,this),K("gitlens.views.highlightChanges",this.highlightChanges,this),K("gitlens.views.highlightRevisionChanges",this.highlightRevisionChanges,this),K("gitlens.views.restore",this.restore,this),K("gitlens.views.switchToAnotherBranch",this.switch,this),K("gitlens.views.switchToBranch",this.switchTo,this),K("gitlens.views.switchToCommit",this.switchTo,this),K("gitlens.views.switchToTag",this.switchTo,this),K("gitlens.views.addRemote",this.addRemote,this),K("gitlens.views.pruneRemote",this.pruneRemote,this),K("gitlens.views.removeRemote",this.removeRemote,this),K("gitlens.views.stageDirectory",this.stageDirectory,this),K("gitlens.views.stageFile",this.stageFile,this),K("gitlens.views.unstageDirectory",this.unstageDirectory,this),K("gitlens.views.unstageFile",this.unstageFile,this),K("gitlens.views.compareAncestryWithWorking",this.compareAncestryWithWorking,this),K("gitlens.views.compareWithHead",this.compareHeadWith,this),K("gitlens.views.compareWithUpstream",this.compareWithUpstream,this),K("gitlens.views.compareWithSelected",this.compareWithSelected,this),K("gitlens.views.selectForCompare",this.selectForCompare,this),K("gitlens.views.compareFileWithSelected",this.compareFileWithSelected,this),K("gitlens.views.selectFileForCompare",this.selectFileForCompare,this),K("gitlens.views.compareWithWorking",this.compareWorkingWith,this),K("gitlens.views.setBranchComparisonToWorking",(e=>this.setBranchComparison(e,s.DH.Working)),this),K("gitlens.views.setBranchComparisonToBranch",(e=>this.setBranchComparison(e,s.DH.Branch)),this),K("gitlens.views.cherryPick",this.cherryPick,this,2),K("gitlens.views.title.createBranch",(()=>this.createBranch())),K("gitlens.views.createBranch",this.createBranch,this),K("gitlens.views.deleteBranch",this.deleteBranch,this),K("gitlens.views.renameBranch",this.renameBranch,this),K("gitlens.views.title.applyStash",(()=>this.applyStash())),K("gitlens.views.stash.delete",this.deleteStash,this,2),K("gitlens.views.stash.rename",this.renameStash,this),K("gitlens.views.title.createTag",(()=>this.createTag())),K("gitlens.views.createTag",this.createTag,this),K("gitlens.views.deleteTag",this.deleteTag,this),K("gitlens.views.mergeBranchInto",this.merge,this),K("gitlens.views.pushToCommit",this.pushToCommit,this),K("gitlens.views.rebaseOntoBranch",this.rebase,this),K("gitlens.views.rebaseOntoUpstream",this.rebaseToRemote,this),K("gitlens.views.rebaseOntoCommit",this.rebase,this),K("gitlens.views.resetCommit",this.resetCommit,this),K("gitlens.views.resetToCommit",this.resetToCommit,this),K("gitlens.views.revert",this.revert,this),K("gitlens.views.undoCommit",this.undoCommit,this),K("gitlens.views.createPullRequest",this.createPullRequest,this),K("gitlens.views.openPullRequest",this.openPullRequest,this),K("gitlens.views.title.createWorktree",(()=>this.createWorktree())),K("gitlens.views.createWorktree",this.createWorktree,this),K("gitlens.views.deleteWorktree",this.deleteWorktree,this),K("gitlens.views.openWorktree",this.openWorktree,this),K("gitlens.views.revealRepositoryInExplorer",this.revealRepositoryInExplorer,this),K("gitlens.views.revealWorktreeInExplorer",this.revealWorktreeInExplorer,this),K("gitlens.views.openWorktreeInNewWindow",(e=>this.openWorktree(e,{location:P.Tc.NewWindow})),this)}addAuthors(e){return l.q((0,V.pp)(e))}addAuthor(e){return e instanceof T.K?l.q(e.repoPath,e.contributor.current?void 0:e.contributor):Promise.resolve()}addRemote(e){return h.IH((0,V.pp)(e))}applyChanges(e){return e instanceof V.RW?e instanceof L.C?c.zb(e.file,(0,w.xB)(e.ref1,e.repoPath),(0,w.xB)(e.ref2,e.repoPath)):null==e.ref||"HEAD"===e.ref.ref?Promise.resolve():c.zb(e.file,e.ref):Promise.resolve()}applyStash(){return d.nn()}browseRepoAtRevision(e,t){return e instanceof V.bT||e instanceof V.RW?(0,o.g)(e.uri,{before:t?.before,openInNewWindow:t?.openInNewWindow}):Promise.resolve()}cherryPick(e,t){return e instanceof k.D?null!=t&&0!==t.length?u.QP(e.repoPath,t.map((e=>e.ref))):u.QP(e.repoPath,e.ref):Promise.resolve()}closeRepository(e){(e instanceof W.q||e instanceof V.vb)&&(e.repo.closed=!0)}async createBranch(e){let t=e instanceof V.bT||e instanceof V.RW?e?.ref:e instanceof R.V?e.branch:void 0;if(null==t){t=await this.container.git.getBranch(e?.repoPath??this.container.git.getBestRepository()?.uri)}return a.Ue(e?.repoPath,t)}async createPullRequest(e){if(!(e instanceof S.E||e instanceof R.V))return Promise.resolve();const t=await e.branch.getRemote();return(0,v.SI)("createPullRequest",{repoPath:e.repoPath,remote:null!=t?{name:t.name,provider:null!=t.provider?{id:t.provider.id,name:t.provider.name,domain:t.provider.domain}:void 0,url:t.url}:void 0,branch:{name:e.branch.name,upstream:e.branch.upstream?.name,isRemote:e.branch.remote}})}async createTag(e){let t=e instanceof V.bT||e instanceof V.RW?e?.ref:e instanceof R.V?e.branch:void 0;if(null==t){t=await this.container.git.getBranch(e?.repoPath??this.container.git.getBestRepository()?.uri)}return p.Ue(e?.repoPath,t)}async createWorktree(e){if(e instanceof Q.S&&(e=void 0),null==e||e instanceof S.E)return m.Ue(e?.repoPath,void 0,e?.ref)}deleteBranch(e){return e instanceof S.E?a.Od(e.repoPath,e.branch):Promise.resolve()}deleteStash(e,t){if(!(e instanceof N.i))return Promise.resolve();if(null!=t&&0!==t.length){const e=t.sort(((e,t)=>parseInt(t.commit.number,10)-parseInt(e.commit.number,10)));return(0,A.df)(d.Cw,e.map((e=>[e.repoPath,e.commit])),this)}return d.Cw(e.repoPath,e.commit)}renameStash(e){return e instanceof N.i?d.PQ(e.repoPath,e.commit):Promise.resolve()}deleteTag(e){return e instanceof H._?p.Od(e.repoPath,e.tag):Promise.resolve()}async deleteWorktree(e){if(e instanceof q.w)return m.Od(e.repoPath,e.worktree.uri)}fetch(e){return e instanceof W.q||e instanceof V.vb?u.he(e.repo):e instanceof B.V?h.he(e.remote.repoPath,e.remote.name):e instanceof S.E||e instanceof R.V?u.he(e.repoPath,e.root?void 0:e.branch):Promise.resolve()}async highlightChanges(e){(e instanceof D.R||e instanceof U.y||e instanceof E.m||e instanceof L.C)&&(await this.openFile(e,{preserveFocus:!0,preview:!0}),await this.container.fileAnnotations.toggle(r.window.activeTextEditor,s.VP.Changes,{sha:e.ref.ref},!0))}async highlightRevisionChanges(e){(e instanceof D.R||e instanceof U.y||e instanceof E.m||e instanceof L.C)&&(await this.openFile(e,{preserveFocus:!0,preview:!0}),await this.container.fileAnnotations.toggle(r.window.activeTextEditor,s.VP.Changes,{sha:e.ref.ref,only:!0},!0))}merge(e){return e instanceof S.E||e instanceof H._?u.TS(e.repoPath,e instanceof S.E?e.branch:e.tag):Promise.resolve()}openInTerminal(e){return e instanceof W.q||e instanceof V.vb?(0,v.dO)("openInTerminal",r.Uri.file(e.repo.path)):Promise.resolve()}openPullRequest(e){return e instanceof I.Z?(0,v.SI)("openPullRequest",{repoPath:e.uri.repoPath,provider:{id:e.pullRequest.provider.id,name:e.pullRequest.provider.name,domain:e.pullRequest.provider.domain},pullRequest:{id:e.pullRequest.id,url:e.pullRequest.url}}):Promise.resolve()}openWorktree(e,t){e instanceof q.w&&(0,P.ic)(e.worktree.uri,t)}pruneRemote(e){return e instanceof B.V?h.Qs(e.remote.repoPath,e.remote.name):Promise.resolve()}async removeRemote(e){return e instanceof B.V?h.Od(e.remote.repoPath,e.remote.name):Promise.resolve()}publishBranch(e){return e instanceof S.E||e instanceof R.V?u.VF(e.repoPath,void 0,e.branch):Promise.resolve()}publishRepository(e){return e instanceof S.E||e instanceof R.V?(0,v.Zv)("git.publish",r.Uri.file(e.repoPath)):Promise.resolve()}pull(e){return e instanceof W.q||e instanceof V.vb?u.X4(e.repo):e instanceof S.E||e instanceof R.V?u.X4(e.repoPath,e.root?void 0:e.branch):Promise.resolve()}push(e,t){return e instanceof W.q||e instanceof V.vb?u.VF(e.repo,t):e instanceof S.E||e instanceof R.V?u.VF(e.repoPath,t,e.root?void 0:e.branch):e instanceof k.D||e instanceof E.m?e.isTip?u.VF(e.repoPath,t):this.pushToCommit(e):Promise.resolve()}pushToCommit(e){return e instanceof k.D||e instanceof E.m?u.VF(e.repoPath,!1,e.commit):Promise.resolve()}rebase(e){return e instanceof S.E||e instanceof k.D||e instanceof E.m||e instanceof H._?u.DW(e.repoPath,e.ref):Promise.resolve()}rebaseToRemote(e){if(!(e instanceof S.E||e instanceof R.V))return Promise.resolve();const t=e instanceof S.E?e.branch.upstream?.name:e.status.upstream;return null==t?Promise.resolve():u.DW(e.repoPath,(0,w.xB)(t,e.repoPath,{refType:"branch",name:t,remote:!0}))}renameBranch(e){return e instanceof S.E?a.PQ(e.repoPath,e.branch):Promise.resolve()}resetCommit(e){return e instanceof k.D||e instanceof E.m?u.mc(e.repoPath,(0,w.xB)(`${e.ref.ref}^`,e.ref.repoPath,{refType:"revision",name:`${e.ref.name}^`,message:e.ref.message})):Promise.resolve()}resetToCommit(e){return e instanceof k.D||e instanceof E.m?u.mc(e.repoPath,e.ref):Promise.resolve()}restore(e){return e instanceof V.RW?c.Hl(e.file,e.ref):Promise.resolve()}revealRepositoryInExplorer(e){if(e instanceof W.q)return u.qM(e.repo)}revealWorktreeInExplorer(e){if(e instanceof q.w)return m.qM(e.worktree)}revert(e){return e instanceof k.D||e instanceof E.m?u.CU(e.repoPath,e.ref):Promise.resolve()}setAsDefault(e){return e instanceof B.V?e.setAsDefault():Promise.resolve()}setBranchComparison(e,t){if(e instanceof _._)return e.setComparisonType(t)}setShowRelativeDateMarkers(e){return y.D.updateEffective("views.showRelativeDateMarkers",e)}async stageFile(e){(e instanceof D.R||e instanceof E.m||e instanceof G.q)&&(await this.container.git.stageFile(e.repoPath,e.file.path),e.triggerChange())}async stageDirectory(e){e instanceof $.Y&&e.relativePath&&(await this.container.git.stageDirectory(e.repoPath,e.relativePath),e.triggerChange())}star(e){return e instanceof S.E||e instanceof W.q||e instanceof V.vb?e.star():Promise.resolve()}switch(e){return u.gu((0,V.pp)(e))}switchTo(e){return e instanceof V.bT?u.gu(e.repoPath,e instanceof S.E&&e.branch.current?void 0:e.ref):u.gu((0,V.pp)(e))}async undoCommit(e){if(!(e instanceof k.D||e instanceof E.m))return;const t=await this.container.git.getOrOpenScmRepository(e.repoPath),i=await(t?.getCommit("HEAD"));i?.hash===e.ref.ref?await(0,v.Zv)("git.undoCommit",e.repoPath):r.window.showWarningMessage(`Commit ${(0,w.Wh)(e.ref,{capitalize:!0,icon:!1})} cannot be undone, because it is no longer the most recent commit.`)}unsetAsDefault(e){return e instanceof B.V?e.setAsDefault(!1):Promise.resolve()}async unstageFile(e){(e instanceof D.R||e instanceof E.m||e instanceof G.q)&&(await this.container.git.unStageFile(e.repoPath,e.file.path),e.triggerChange())}async unstageDirectory(e){e instanceof $.Y&&e.relativePath&&(await this.container.git.unStageDirectory(e.repoPath,e.relativePath),e.triggerChange())}unstar(e){return e instanceof S.E||e instanceof W.q||e instanceof V.vb?e.unstar():Promise.resolve()}compareHeadWith(e){return e instanceof V.bT||e instanceof V.RW?e instanceof V.RW?this.compareFileWith(e.repoPath,e.uri,e.ref.ref,void 0,"HEAD"):this.container.searchAndCompareView.compare(e.repoPath,"HEAD",e.ref):Promise.resolve()}compareWithUpstream(e){return e instanceof S.E?null==e.branch.upstream?Promise.resolve():this.container.searchAndCompareView.compare(e.repoPath,e.ref,e.branch.upstream.name):Promise.resolve()}compareWorkingWith(e){return e instanceof V.bT||e instanceof V.RW?e instanceof V.RW?this.compareFileWith(e.repoPath,e.uri,e.ref.ref,void 0,""):this.container.searchAndCompareView.compare(e.repoPath,"",e.ref):Promise.resolve()}async compareAncestryWithWorking(e){if(!(e instanceof S.E))return;const t=await this.container.git.getBranch(e.repoPath);if(null==t)return;const i=await this.container.git.getMergeBase(e.repoPath,t.ref,e.ref.ref);return null!=i?this.container.searchAndCompareView.compare(e.repoPath,{ref:i,label:`ancestry with ${e.ref.ref} (${(0,w.zL)(i)})`},""):void 0}compareWithSelected(e){(e instanceof V.bT||e instanceof V.RW)&&this.container.searchAndCompareView.compareWithSelected(e.repoPath,e.ref)}selectForCompare(e){(e instanceof V.bT||e instanceof V.RW)&&this.container.searchAndCompareView.selectForCompare(e.repoPath,e.ref)}async compareFileWith(e,t,i,r,s){return null==r&&(r=await this.container.git.getWorkingUri(e,t)),(0,v.P0)(n.Gh.DiffWith,{repoPath:e,lhs:{sha:i,uri:t},rhs:{sha:s,uri:r??t}})}compareFileWithSelected(e){if(null==this._selectedFile||!(e instanceof V.RW)||null==e.ref)return Promise.resolve();if(this._selectedFile.repoPath!==e.repoPath)return this.selectFileForCompare(e),Promise.resolve();const t=this._selectedFile;return this._selectedFile=void 0,(0,b.v)("gitlens:views:canCompare:file",!1),this.compareFileWith(t.repoPath,t.uri,t.ref,e.uri,e.ref.ref)}selectFileForCompare(e){e instanceof V.RW&&null!=e.ref&&(this._selectedFile={ref:e.ref.ref,repoPath:e.repoPath,uri:e.uri},(0,b.v)("gitlens:views:canCompare:file",!0))}async openAllChanges(e,t){if(e instanceof k.D||e instanceof N.i||e instanceof M.V){if(e instanceof M.V){const{files:i}=await e.getFilesQueryResults();if(null==i||0===i.length)return;return c.Gp(i,{repoPath:e.repoPath,ref1:e.ref1,ref2:e.ref2},t)}return c.Gp(e.commit,t)}}openChanges(e){if(!(e instanceof V.RW||e instanceof x.E||e instanceof G.q))return;if(e instanceof x.E)return void(0,v.P0)(n.Gh.DiffWith,{lhs:{sha:e.status.HEAD.ref,uri:g.YY.fromFile(e.file,e.repoPath,void 0,!0)},rhs:{sha:"HEAD",uri:g.YY.fromFile(e.file,e.repoPath)},repoPath:e.repoPath,line:0,showOptions:{preserveFocus:!1,preview:!1}});const t=e.getCommand();if(null!=t?.arguments)switch(t.command){case n.Gh.DiffWith:{const[e]=t.arguments;e.showOptions.preview=!1,(0,v.P0)(t.command,e);break}case n.Gh.DiffWithPrevious:{const[,e]=t.arguments;e.showOptions.preview=!1,(0,v.b2)(t.command,void 0,e);break}default:throw new Error(`Unexpected command: ${t.command}`)}}async openAllChangesWithWorking(e,t){if(e instanceof k.D||e instanceof N.i||e instanceof M.V){if(e instanceof M.V){const{files:i}=await e.getFilesQueryResults();if(null==i||0===i.length)return;return c.Ou(i,{repoPath:e.repoPath,ref:e.ref1||e.ref2},t)}return c.Ou(e.commit,t)}}async openChangesWithWorking(e){if(!(e instanceof V.RW||e instanceof x.E||e instanceof G.q))return Promise.resolve();if(e instanceof G.q)return(0,v.b2)(n.Gh.DiffWithWorking,void 0,{uri:e.uri,showOptions:{preserveFocus:!0,preview:!0}});if(e instanceof x.E)return(0,v.b2)(n.Gh.DiffWithWorking,void 0,{uri:e.baseUri,showOptions:{preserveFocus:!0,preview:!0}});if(e instanceof E.m&&e.commit.file?.hasConflicts){const t=await e.getConflictBaseUri();if(null!=t)return(0,v.b2)(n.Gh.DiffWithWorking,void 0,{uri:t,showOptions:{preserveFocus:!0,preview:!0}})}return c.ce(e.file,{repoPath:e.repoPath,ref:e.ref.ref})}async openPreviousChangesWithWorking(e){return e instanceof V.RW?c.ce(e.file,{repoPath:e.repoPath,ref:`${e.ref.ref}^`}):Promise.resolve()}openFile(e,t){return e instanceof V.RW||e instanceof x.E||e instanceof G.q||e instanceof F.J||e instanceof O.q?c.ZB(e.uri,{preserveFocus:!0,preview:!1,...t}):Promise.resolve()}async openFiles(e){if(e instanceof k.D||e instanceof N.i||e instanceof M.V){if(e instanceof M.V){const{files:t}=await e.getFilesQueryResults();if(null==t||0===t.length)return;return c.aE(t,e.repoPath,e.ref1||e.ref2)}return c.aE(e.commit)}}async openRevision(e,t){if(!(e instanceof D.R||e instanceof E.m||e instanceof L.C||e instanceof U.y||e instanceof x.E||e instanceof G.q))return Promise.resolve();let i=(t={showOptions:{preserveFocus:!0,preview:!1},...t}).revisionUri;return null==i&&(i=e instanceof L.C||e instanceof x.E?this.container.git.getRevisionUri(e.uri):"D"===e.commit.file?.status?this.container.git.getRevisionUri(await e.commit.getPreviousSha()??f.Ii,e.commit.file.path,e.commit.repoPath):this.container.git.getRevisionUri(e.uri)),c.YS(i,t.showOptions??{preserveFocus:!0,preview:!1})}async openRevisions(e,t){if(e instanceof k.D||e instanceof N.i||e instanceof M.V){if(e instanceof M.V){const{files:t}=await e.getFilesQueryResults();if(null==t||0===t.length)return;return c.Dh(t,e.repoPath,e.ref1,e.ref2)}return c.Dh(e.commit)}}}z([(0,C.fF)()],ViewCommands.prototype,"addAuthors",1),z([(0,C.fF)()],ViewCommands.prototype,"addAuthor",1),z([(0,C.fF)()],ViewCommands.prototype,"addRemote",1),z([(0,C.fF)()],ViewCommands.prototype,"applyChanges",1),z([(0,C.fF)()],ViewCommands.prototype,"applyStash",1),z([(0,C.fF)()],ViewCommands.prototype,"browseRepoAtRevision",1),z([(0,C.fF)()],ViewCommands.prototype,"cherryPick",1),z([(0,C.fF)()],ViewCommands.prototype,"closeRepository",1),z([(0,C.fF)()],ViewCommands.prototype,"createBranch",1),z([(0,C.fF)()],ViewCommands.prototype,"createPullRequest",1),z([(0,C.fF)()],ViewCommands.prototype,"createTag",1),z([(0,C.fF)()],ViewCommands.prototype,"createWorktree",1),z([(0,C.fF)()],ViewCommands.prototype,"deleteBranch",1),z([(0,C.fF)()],ViewCommands.prototype,"deleteStash",1),z([(0,C.fF)()],ViewCommands.prototype,"renameStash",1),z([(0,C.fF)()],ViewCommands.prototype,"deleteTag",1),z([(0,C.fF)()],ViewCommands.prototype,"deleteWorktree",1),z([(0,C.fF)()],ViewCommands.prototype,"fetch",1),z([(0,C.fF)()],ViewCommands.prototype,"highlightChanges",1),z([(0,C.fF)()],ViewCommands.prototype,"highlightRevisionChanges",1),z([(0,C.fF)()],ViewCommands.prototype,"merge",1),z([(0,C.fF)()],ViewCommands.prototype,"openInTerminal",1),z([(0,C.fF)()],ViewCommands.prototype,"openPullRequest",1),z([(0,C.fF)()],ViewCommands.prototype,"openWorktree",1),z([(0,C.fF)()],ViewCommands.prototype,"pruneRemote",1),z([(0,C.fF)()],ViewCommands.prototype,"removeRemote",1),z([(0,C.fF)()],ViewCommands.prototype,"publishBranch",1),z([(0,C.fF)()],ViewCommands.prototype,"publishRepository",1),z([(0,C.fF)()],ViewCommands.prototype,"pull",1),z([(0,C.fF)()],ViewCommands.prototype,"push",1),z([(0,C.fF)()],ViewCommands.prototype,"pushToCommit",1),z([(0,C.fF)()],ViewCommands.prototype,"rebase",1),z([(0,C.fF)()],ViewCommands.prototype,"rebaseToRemote",1),z([(0,C.fF)()],ViewCommands.prototype,"renameBranch",1),z([(0,C.fF)()],ViewCommands.prototype,"resetCommit",1),z([(0,C.fF)()],ViewCommands.prototype,"resetToCommit",1),z([(0,C.fF)()],ViewCommands.prototype,"restore",1),z([(0,C.fF)()],ViewCommands.prototype,"revealRepositoryInExplorer",1),z([(0,C.fF)()],ViewCommands.prototype,"revealWorktreeInExplorer",1),z([(0,C.fF)()],ViewCommands.prototype,"revert",1),z([(0,C.fF)()],ViewCommands.prototype,"setAsDefault",1),z([(0,C.fF)()],ViewCommands.prototype,"setBranchComparison",1),z([(0,C.fF)()],ViewCommands.prototype,"setShowRelativeDateMarkers",1),z([(0,C.fF)()],ViewCommands.prototype,"stageFile",1),z([(0,C.fF)()],ViewCommands.prototype,"stageDirectory",1),z([(0,C.fF)()],ViewCommands.prototype,"star",1),z([(0,C.fF)()],ViewCommands.prototype,"switch",1),z([(0,C.fF)()],ViewCommands.prototype,"switchTo",1),z([(0,C.fF)()],ViewCommands.prototype,"undoCommit",1),z([(0,C.fF)()],ViewCommands.prototype,"unsetAsDefault",1),z([(0,C.fF)()],ViewCommands.prototype,"unstageFile",1),z([(0,C.fF)()],ViewCommands.prototype,"unstageDirectory",1),z([(0,C.fF)()],ViewCommands.prototype,"unstar",1),z([(0,C.fF)()],ViewCommands.prototype,"compareHeadWith",1),z([(0,C.fF)()],ViewCommands.prototype,"compareWithUpstream",1),z([(0,C.fF)()],ViewCommands.prototype,"compareWorkingWith",1),z([(0,C.fF)()],ViewCommands.prototype,"compareAncestryWithWorking",1),z([(0,C.fF)()],ViewCommands.prototype,"compareWithSelected",1),z([(0,C.fF)()],ViewCommands.prototype,"selectForCompare",1),z([(0,C.fF)()],ViewCommands.prototype,"compareFileWithSelected",1),z([(0,C.fF)()],ViewCommands.prototype,"selectFileForCompare",1),z([(0,C.fF)()],ViewCommands.prototype,"openAllChanges",1),z([(0,C.fF)()],ViewCommands.prototype,"openChanges",1),z([(0,C.fF)()],ViewCommands.prototype,"openAllChangesWithWorking",1),z([(0,C.fF)()],ViewCommands.prototype,"openChangesWithWorking",1),z([(0,C.fF)()],ViewCommands.prototype,"openPreviousChangesWithWorking",1),z([(0,C.fF)()],ViewCommands.prototype,"openFile",1),z([(0,C.fF)()],ViewCommands.prototype,"openFiles",1),z([(0,C.fF)()],ViewCommands.prototype,"openRevision",1),z([(0,C.fF)()],ViewCommands.prototype,"openRevisions",1)},7933:(e,t,i)=>{i.d(t,{m9:()=>WorktreesView});var r=i(9496),s=i(2540),n=i(5255),o=i(8887),a=i(7462),c=i(3646),l=i(2215),h=i(9529),u=i(5148),d=i(5432),p=i(6922),m=i(6418),g=i(8562),f=i(5517),w=i(5688),v=Object.defineProperty,y=Object.getOwnPropertyDescriptor,b=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?y(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&v(t,i,n),n};class WorktreesRepositoryNode extends p.vb{getChildren(){return null==this.child&&(this.child=new g.S(this.uri,this.view,this,this.repo)),this.child.getChildren()}changed(e){return e.changed(c.I6.Config,c.I6.Worktrees,c.I6.Unknown,c.du.Any)}}class WorktreesViewNode extends p.FZ{async getChildren(){if(!1===(await this.view.container.git.access(o.x.Worktrees)).allowed)return[];if(null==this.children){const e=this.view.container.git.openRepositories;if(0===e.length)return this.view.message="No worktrees could be found.",[];this.view.message=void 0;const t=1===e.length;this.children=e.map((e=>new WorktreesRepositoryNode(a.YY.fromRepoPath(e.path),this.view,this,e,t)))}if(1===this.children.length){const[e]=this.children,t=await e.getChildren();return t.length<=1?(this.view.message=void 0,this.view.title="Worktrees",e.ensureSubscription(),[]):(this.view.message=void 0,this.view.title=`Worktrees (${t.length})`,t)}return this.view.title="Worktrees",this.children}getTreeItem(){return new r.TreeItem("Worktrees",r.TreeItemCollapsibleState.Expanded)}}class WorktreesView extends f._{constructor(e){super(e,"worktrees","Worktrees","workspaceView"),this.configKey="worktrees",this.disposables.push(r.window.registerFileDecorationProvider({provideFileDecoration:(e,t)=>{if("gitlens-view"===e.scheme&&"worktree"===e.authority&&e.path.includes("/changes"))return{badge:"●",color:new r.ThemeColor("gitlens.decorations.worktreeView.hasUncommittedChangesForegroundColor"),tooltip:"Has Uncommitted Changes"}}})),this.description="✨"}get canReveal(){return this.config.reveal||!u.D.get("views.repositories.showWorktrees")}async show(e){if(await(0,l.C)())return super.show(e)}getRoot(){return new WorktreesViewNode(this)}registerCommands(){return this.container.viewCommands,[(0,w.i)(this.getQualifiedCommand("copy"),(()=>(0,h.P0)(n.Gh.ViewsCopy,this.activeSelection,this.selection)),this),(0,w.i)(this.getQualifiedCommand("refresh"),(async()=>this.refresh(!0)),this),(0,w.i)(this.getQualifiedCommand("setFilesLayoutToAuto"),(()=>this.setFilesLayout(s.Vc.Auto)),this),(0,w.i)(this.getQualifiedCommand("setFilesLayoutToList"),(()=>this.setFilesLayout(s.Vc.List)),this),(0,w.i)(this.getQualifiedCommand("setFilesLayoutToTree"),(()=>this.setFilesLayout(s.Vc.Tree)),this),(0,w.i)(this.getQualifiedCommand("setShowAvatarsOn"),(()=>this.setShowAvatars(!0)),this),(0,w.i)(this.getQualifiedCommand("setShowAvatarsOff"),(()=>this.setShowAvatars(!1)),this),(0,w.i)(this.getQualifiedCommand("setShowBranchComparisonOn"),(()=>this.setShowBranchComparison(!0)),this),(0,w.i)(this.getQualifiedCommand("setShowBranchComparisonOff"),(()=>this.setShowBranchComparison(!1)),this),(0,w.i)(this.getQualifiedCommand("setShowBranchPullRequestOn"),(()=>this.setShowBranchPullRequest(!0)),this),(0,w.i)(this.getQualifiedCommand("setShowBranchPullRequestOff"),(()=>this.setShowBranchPullRequest(!1)),this)]}filterConfigurationChanged(e){return!!(super.filterConfigurationChanged(e)||u.D.changed(e,"defaultDateFormat")||u.D.changed(e,"defaultDateLocale")||u.D.changed(e,"defaultDateShortFormat")||u.D.changed(e,"defaultDateSource")||u.D.changed(e,"defaultDateStyle")||u.D.changed(e,"defaultGravatarsStyle")||u.D.changed(e,"defaultTimeFormat"))}findWorktree(e,t){const{repoPath:i,uri:r}=e,s=r.toString();return this.findNode((t=>t instanceof m.w&&e.uri.toString()===s),{maxDepth:2,canTraverse:e=>e instanceof WorktreesViewNode||e instanceof WorktreesRepositoryNode&&e.repoPath===i,token:t})}async revealRepository(e,t){const i=await this.findNode((t=>t instanceof p.vb&&t.repoPath===e),{maxDepth:1,canTraverse:e=>e instanceof WorktreesViewNode||e instanceof p.vb});return void 0!==i&&await this.reveal(i,t),i}revealWorktree(e,t){return r.window.withProgress({location:r.ProgressLocation.Notification,title:`Revealing worktree '${e.name}' in the side bar...`,cancellable:!0},(async(i,r)=>{const s=await this.findWorktree(e,r);if(null!=s)return await this.ensureRevealNode(s,t),s}))}setFilesLayout(e){return u.D.updateEffective(`views.${this.configKey}.files.layout`,e)}setShowAvatars(e){return u.D.updateEffective(`views.${this.configKey}.avatars`,e)}setShowBranchComparison(e){return u.D.updateEffective(`views.${this.configKey}.showBranchComparison`,!!e&&s.DH.Branch)}async setShowBranchPullRequest(e){await u.D.updateEffective(`views.${this.configKey}.pullRequests.showForBranches`,e),await u.D.updateEffective(`views.${this.configKey}.pullRequests.enabled`,e)}}b([(0,d.H)((()=>""))],WorktreesView.prototype,"revealRepository",1),b([(0,d.H)((()=>""))],WorktreesView.prototype,"revealWorktree",1)},9206:(e,t,i)=>{i.d(t,{CommitDetailsWebviewProvider:()=>CommitDetailsWebviewProvider});var r=i(9496),s=i(3139),n=i(5255),o=i(9311),a=i(6897),c=i(9338),l=i(6450),h=i(7881),u=i(8452),d=i(4092),p=i(4321),m=i(9529),g=i(5148),f=i(2061),w=i(4241),v=i(9796),y=i(3105),b=i(4336),C=i(6004);class MRU{constructor(e=10,t){this.maxSize=e,this.comparator=t,this.stack=[],this._position=0}get count(){return this.stack.length}get position(){return this._position}add(e){this._position>0&&(this.stack.splice(0,this._position),this._position=0);const t=null!=this.comparator?this.stack.findIndex((t=>this.comparator(e,t))):this.stack.indexOf(e);-1!==t?this.stack.splice(t,1):this.stack.length===this.maxSize&&this.stack.pop(),this.stack.unshift(e),this._position=0}get(e){if(null!=e){if(e<0||e>=this.stack.length)return;return this.stack[e]}return this.stack.length>0?this.stack[0]:void 0}insert(e){this._position>0&&(this.stack.splice(0,this._position),this._position=0),this.stack.unshift(e),this._position++}navigate(e){if(!(this.stack.length<=1)){if("back"===e){if(this._position>=this.stack.length-1)return;this._position+=1}else{if(this._position<=0)return;this._position-=1}return this.stack[this._position]}}}var A=i(7469);var P=i(5798),S=i(6260),R=i(1753);const D=new P.ke("commit/actions"),k=new P.ke("commit/file/actions"),_=new P.ke("commit/file/open"),T=new P.ke("commit/file/openOnRemote"),F=new P.ke("commit/file/compareWorking"),E=new P.ke("commit/file/comparePrevious"),$=new P.ke("commit/pickCommit"),O=new P.ke("commit/searchCommit"),x=new P.ke("commit/autolinkSettings"),I=new P.ke("commit/explain"),B=new P.ke("commit/pin"),W=new P.ke("commit/navigate"),L=new P.ke("commit/preferences"),M=new P.jH("commit/didChange",!0),U=(new P.jH("commit/didChange/rich"),new P.jH("commit/didExplain"));var N=Object.defineProperty,G=Object.getOwnPropertyDescriptor,H=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?G(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&N(t,i,n),n};class CommitDetailsWebviewProvider{constructor(e,t,i){this.container=e,this.host=t,this.options=i,this._bootstraping=!0,this._pinned=!1,this._focused=!1,this._commitStack=new MRU(10,((e,t)=>e.ref===t.ref)),this._cancellationTokenSource=void 0,this._notifyDidChangeStateDebounced=void 0,this._context={pinned:!1,commit:void 0,preferences:{autolinksExpanded:this.container.storage.getWorkspace("views:commitDetails:autolinksExpanded"),avatars:g.D.get("views.commitDetails.avatars"),files:g.D.get("views.commitDetails.files")},richStateLoaded:!1,formattedMessage:void 0,autolinkedIssues:void 0,pullRequest:void 0,dateFormat:g.D.get("defaultDateFormat")??"MMMM Do, YYYY h:mma",indentGuides:g.D.getAny("workbench.tree.renderIndentGuides")??"onHover",navigationStack:{count:0,position:0},visible:!1},this._disposable=g.D.onDidChangeAny(this.onAnyConfigurationChanged,this)}dispose(){this._disposable.dispose()}onReloaded(){this.notifyDidChangeState(!0)}async onShowing(e,t,...i){let r;const[s]=i;if((0,R.W)(s)){const{selected:e}=s.state;null!=e?.repoPath&&null!=e?.sha&&(r=null!=e.stashNumber?{commit:(0,p.xB)(e.sha,e.repoPath,{refType:"stash",name:e.message,number:e.stashNumber})}:{commit:(0,p.xB)(e.sha,e.repoPath,{refType:"revision",message:e.message})})}else r=null!=s&&"object"==typeof s?s:void 0;let n;return null!=r&&(r.preserveFocus&&(t.preserveFocus=!0),({commit:n,...r}=r)),null==n&&(this._pinned||(n=this.getBestCommitOrStash())),null==n||this._context.commit?.ref.startsWith(n.ref)||await this.updateCommit(n,{pinned:!1}),!(r?.preserveVisibility&&!this.host.visible)}onCommitSelected(e){null==e.data||"graph"===this.options.mode&&"gitlens.views.graph"!==e.source||"default"===this.options.mode&&"gitlens.views.graph"===e.source||(this._pinned&&"passive"===e.data.interaction?(this._commitStack.insert((0,p.qj)(e.data.commit)),this.updateNavigation()):this.host.show(!1,{preserveFocus:e.data.preserveFocus},e.data))}includeBootstrap(){return this._bootstraping=!0,this._context={...this._context,...this._pendingContext},this._pendingContext=void 0,this.getState(this._context)}onFocusChanged(e){this._focused!==e&&(this._focused=e,e&&this.isLineTrackerSuspended&&this.ensureTrackers())}onVisibilityChanged(e){this.ensureTrackers(),this.updatePendingContext({visible:e}),e&&(this._bootstraping&&(this._bootstraping=!1,null==this._pendingContext)||(this.onRefresh(),this.updateState(!0)))}onAnyConfigurationChanged(e){g.D.changed(e,"defaultDateFormat")&&(this.updatePendingContext({dateFormat:g.D.get("defaultDateFormat")??"MMMM Do, YYYY h:mma"}),this.updateState()),g.D.changed(e,"views.commitDetails")&&((g.D.changed(e,"views.commitDetails.files")||g.D.changed(e,"views.commitDetails.avatars"))&&this.updatePendingContext({preferences:{...this._context.preferences,...this._pendingContext?.preferences,avatars:g.D.get("views.commitDetails.avatars"),files:g.D.get("views.commitDetails.files")}}),null!=this._context.commit&&(g.D.changed(e,"views.commitDetails.autolinks")||g.D.changed(e,"views.commitDetails.pullRequests"))&&this.updateCommit(this._context.commit,{force:!0}),this.updateState()),g.D.changedAny(e,"workbench.tree.renderIndentGuides")&&(this.updatePendingContext({indentGuides:g.D.getAny("workbench.tree.renderIndentGuides")??"onHover"}),this.updateState())}ensureTrackers(){if(this._commitTrackerDisposable?.dispose(),this._commitTrackerDisposable=void 0,this._lineTrackerDisposable?.dispose(),this._lineTrackerDisposable=void 0,this.host.visible&&(this._commitTrackerDisposable=this.container.events.on("commit:selected",this.onCommitSelected,this),!this._pinned&&"graph"!==this.options.mode)){const{lineTracker:e}=this.container;this._lineTrackerDisposable=e.subscribe(this,e.onDidChangeActiveLines(this.onActiveEditorLinesChanged,this))}}get isLineTrackerSuspended(){return"graph"!==this.options.mode&&null==this._lineTrackerDisposable}suspendLineTracker(){setTimeout((()=>{this._lineTrackerDisposable?.dispose(),this._lineTrackerDisposable=void 0}),100)}onRefresh(e){if(this._pinned)return;const t=this._pendingContext?.commit??this.getBestCommitOrStash();this.updateCommit(t,{immediate:!1})}onMessageReceived(e){switch(e.method){case T.method:(0,P.mq)(T,e,(e=>{this.openFileOnRemote(e)}));break;case _.method:(0,P.mq)(_,e,(e=>{this.openFile(e)}));break;case F.method:(0,P.mq)(F,e,(e=>{this.openFileComparisonWithWorking(e)}));break;case E.method:(0,P.mq)(E,e,(e=>{this.openFileComparisonWithPrevious(e)}));break;case k.method:(0,P.mq)(k,e,(e=>{this.showFileActions(e)}));break;case D.method:(0,P.mq)(D,e,(e=>{switch(e.action){case"graph":if(null==this._context.commit)return;(0,m.P0)(n.Gh.ShowInCommitGraph,{ref:(0,p.qj)(this._context.commit)});break;case"more":this.showCommitActions();break;case"scm":(0,m.dO)("workbench.view.scm");break;case"sha":e.alt?this.showCommitPicker():null!=this._context.commit&&(0,m.P0)(n.Gh.CopyShaToClipboard,{sha:this._context.commit.sha})}}));break;case $.method:(0,P.mq)($,e,(e=>this.showCommitPicker()));break;case O.method:(0,P.mq)(O,e,(e=>this.showCommitSearch()));break;case x.method:(0,P.mq)(x,e,(e=>this.showAutolinkSettings()));break;case B.method:(0,P.mq)(B,e,(e=>this.updatePinned(e.pin??!1,!0)));break;case W.method:(0,P.mq)(W,e,(e=>this.navigateStack(e.direction)));break;case L.method:(0,P.mq)(L,e,(e=>this.updatePreferences(e)));break;case I.method:(0,P.mq)(I,e,(()=>this.explainCommit(e.completionId)))}}async explainCommit(e){let t;try{t={summary:await this.container.ai.explainCommit(this._context.commit,{progress:{location:{viewId:this.host.id}}})}}catch(e){t={error:{message:e.message}}}this.host.notify(U,t,e)}navigateStack(e){const t=this._commitStack.navigate(e);null!=t&&this.updateCommit(t,{immediate:!0,skipStack:!0})}onActiveEditorLinesChanged(e){if(e.pending||null==e.editor)return;const t=e.selections?.[0]?.active,i=null!=t?this.container.lineTracker.getState(t)?.commit:void 0;this.updateCommit(i)}async getState(e){let t;if(null!=this._cancellationTokenSource&&(this._cancellationTokenSource.cancel(),this._cancellationTokenSource.dispose(),this._cancellationTokenSource=void 0),null!=e.commit&&(t=await this.getDetailsModel(e.commit,e.formattedMessage),!e.richStateLoaded)){this._cancellationTokenSource=new r.CancellationTokenSource;const t=this._cancellationTokenSource.token;setTimeout((()=>{t.isCancellationRequested||this.updateRichState(e,t)}),100)}return function(e){try{let t=function(e,t){if(t instanceof Date)return t.getTime();if(t instanceof Map||t instanceof Set)return[...t.entries()];if(t instanceof Function||t instanceof Error)return;if(t instanceof RegExp)return t.toString();const i=this[e];return i instanceof Date?i.getTime():t};return JSON.parse(JSON.stringify(e,t))}catch(e){throw e}}({timestamp:Date.now(),pinned:e.pinned,includeRichContent:e.richStateLoaded,preferences:e.preferences,selected:t,autolinkedIssues:e.autolinkedIssues?.map(u.Gj),pullRequest:null!=e.pullRequest?(0,d.l1)(e.pullRequest):void 0,dateFormat:e.dateFormat,indentGuides:e.indentGuides,navigationStack:e.navigationStack})}async updateRichState(e,t){const{commit:i}=e;if(null==i)return;const r=await this.container.git.getBestRemoteWithRichProvider(i.repoPath);if(t.isCancellationRequested)return;let s,n;if(null!=r?.provider){const[e,o]=await Promise.allSettled([g.D.get("views.commitDetails.autolinks.enabled")&&g.D.get("views.commitDetails.autolinks.enhanced")?this.container.autolinks.getLinkedIssuesAndPullRequests(i.message??i.summary,r):void 0,g.D.get("views.commitDetails.pullRequests.enabled")?i.getAssociatedPullRequest({remote:r}):void 0]);if(t.isCancellationRequested)return;s=(0,A.Sb)(e),n=(0,A.Sb)(o)}const o=this.getFormattedMessage(i,r,s);null!=n&&s?.delete(n.id),this.updatePendingContext({richStateLoaded:!0,formattedMessage:o,autolinkedIssues:null!=s?[...s.values()]:void 0,pullRequest:n}),this.updateState()}async updateCommit(e,t){if(!t?.force&&this._context.commit?.sha===e?.ref)return;let i;if(this._commitDisposable?.dispose(),(0,l.f_)(e))i=e;else if(null!=e)if("stash"===e.refType){const t=await this.container.git.getStash(e.repoPath);i=t?.commits.get(e.ref)}else i=await this.container.git.getCommit(e.repoPath,e.ref);if(i?.isUncommitted){const e=this.container.git.getRepository(i.repoPath);this._commitDisposable=r.Disposable.from(e.startWatchingFileSystem(),e.onDidChangeFileSystem((()=>{this.updatePendingContext({commit:i},!0),this.updateState()})))}this.updatePendingContext({commit:i,richStateLoaded:Boolean(i?.isUncommitted)||!(0,f.fw)("gitlens:hasConnectedRemotes"),formattedMessage:void 0,autolinkedIssues:void 0,pullRequest:void 0},t?.force),null!=t?.pinned&&this.updatePinned(t?.pinned),this.isLineTrackerSuspended&&this.ensureTrackers(),null!=i&&(t?.skipStack||this._commitStack.add((0,p.qj)(i)),this.updateNavigation()),this.updateState(t?.immediate??!0)}updatePinned(e,t){e!==this._context.pinned&&(this._pinned=e,this.ensureTrackers(),this.updatePendingContext({pinned:e}),this.updateState(t))}updatePreferences(e){if(this._context.preferences?.autolinksExpanded===e.autolinksExpanded&&this._context.preferences?.avatars===e.avatars&&this._context.preferences?.files===e.files&&this._context.preferences?.files?.compact===e.files?.compact&&this._context.preferences?.files?.icon===e.files?.icon&&this._context.preferences?.files?.layout===e.files?.layout&&this._context.preferences?.files?.threshold===e.files?.threshold)return;const t={...this._context.preferences,...this._pendingContext?.preferences};null!=e.autolinksExpanded&&this._context.preferences?.autolinksExpanded!==e.autolinksExpanded&&(this.container.storage.storeWorkspace("views:commitDetails:autolinksExpanded",e.autolinksExpanded),t.autolinksExpanded=e.autolinksExpanded),null!=e.avatars&&this._context.preferences?.avatars!==e.avatars&&(g.D.updateEffective("views.commitDetails.avatars",e.avatars),t.avatars=e.avatars),null!=e.files&&this._context.preferences?.files!==e.files&&(this._context.preferences?.files?.compact!==e.files?.compact&&g.D.updateEffective("views.commitDetails.files.compact",e.files?.compact),this._context.preferences?.files?.icon!==e.files?.icon&&g.D.updateEffective("views.commitDetails.files.icon",e.files?.icon),this._context.preferences?.files?.layout!==e.files?.layout&&g.D.updateEffective("views.commitDetails.files.layout",e.files?.layout),this._context.preferences?.files?.threshold!==e.files?.threshold&&g.D.updateEffective("views.commitDetails.files.threshold",e.files?.threshold),t.files=e.files),this.updatePendingContext({preferences:t})}updatePendingContext(e,t=!1){const[i,r]=(0,S.OY)(this._context,this._pendingContext,e,t);return i&&(this._pendingContext=r),i}updateState(e=!1){e?this.notifyDidChangeState():(null==this._notifyDidChangeStateDebounced&&(this._notifyDidChangeStateDebounced=(0,v.Ds)(this.notifyDidChangeState.bind(this),500)),this._notifyDidChangeStateDebounced())}updateNavigation(){let e=this._commitStack.get(this._commitStack.position-1)?.ref;null!=e&&(e=(0,p.zL)(e)),this.updatePendingContext({navigationStack:{count:this._commitStack.count,position:this._commitStack.position,hint:e}}),this.updateState()}async notifyDidChangeState(e=!1){const t=(0,C.UH)();if(this._notifyDidChangeStateDebounced?.cancel(),!e&&null==this._pendingContext)return!1;let i;return null!=this._pendingContext?(i={...this._context,...this._pendingContext},this._context=i,this._pendingContext=void 0):i=this._context,r.window.withProgress({location:{viewId:this.host.id}},(async()=>{try{await this.host.notify(M,{state:await this.getState(i)})}catch(e){b.Yd.error(t,e)}}))}getBestCommitOrStash(){if(this._pinned)return;let e;if("graph"!==this.options.mode&&null!=r.window.activeTextEditor){const{lineTracker:t}=this.container,i=t.selections?.[0].active;null!=i&&(e=t.getState(i)?.commit)}else if(e=this._pendingContext?.commit,null==e){const t=this.container.events.getCachedEventArgs("commit:selected");e=t?.commit}return e}async getDetailsModel(e,t){const[i,n,o]=await Promise.allSettled([e.hasFullDetails()?e:e.ensureFullDetails().then((()=>e)),e.author.getAvatarUri(e,{size:32}),this.container.git.getBestRemoteWithRichProvider(e.repoPath,{includeDisconnected:!0})]);e=(0,A.Sb)(i,e);const a=(0,A.Sb)(n),c=(0,A.Sb)(o);let l;if(null==t&&(t=this.getFormattedMessage(e,c)),null!=e.message){const t=this.container.autolinks.getAutolinks(e.message);if(null!=c){const i=this.container.autolinks.getAutolinks(e.message,c);l=new Map((0,y.G0)(i,t))}else l=t}return{repoPath:e.repoPath,sha:e.sha,shortSha:e.shortSha,author:{...e.author,avatar:a?.toString(!0)},message:t,stashNumber:"stash"===e.refType?e.number:void 0,files:e.files?.map((({status:e,repoPath:t,path:i,originalPath:s})=>{const n=(0,h.tK)(e);return{path:i,originalPath:s,status:e,repoPath:t,icon:{dark:this.host.asWebviewUri(r.Uri.joinPath(this.host.getRootUri(),"images","dark",n)).toString(),light:this.host.asWebviewUri(r.Uri.joinPath(this.host.getRootUri(),"images","light",n)).toString()}}})),stats:e.stats,autolinks:null!=l?[...(0,y.UI)(l.values(),s.G)]:void 0}}getFormattedMessage(e,t,i){let r=c.i.fromTemplate("${message}",e);const s=r.indexOf("\n");return-1!==s&&(r=`${r.substring(0,s)}\0\n\0${r.substring(s+1)}`),g.D.get("views.commitDetails.autolinks.enabled")?this.container.autolinks.linkify(r,"html",null!=t?[t]:void 0,i):r}async getFileCommitFromParams(e){const t=await(this._context.commit?.getCommitForFile(e.path));return null!=t?[t,t.file]:void 0}showAutolinkSettings(){(0,m.P0)(n.Gh.ShowSettingsPageAndJumpToAutolinks)}showCommitSearch(){(0,o.m)({command:"search",state:{openPickInView:!0}})}showCommitPicker(){(0,o.m)({command:"log",state:{reference:"HEAD",repo:this._context.commit?.repoPath,openPickInView:!0}})}showCommitActions(){null==this._context.commit||this._context.commit.isUncommitted||(0,a.$J)(this._context.commit)}async showFileActions(e){const t=await this.getFileCommitFromParams(e);if(null==t)return;const[i,r]=t;this.suspendLineTracker(),(0,a.$J)(i,r)}async openFileComparisonWithWorking(e){const t=await this.getFileCommitFromParams(e);if(null==t)return;const[i,r]=t;this.suspendLineTracker(),(0,a.ce)(r.path,i,{preserveFocus:!0,preview:!0,...this.getShowOptions(e)})}async openFileComparisonWithPrevious(e){const t=await this.getFileCommitFromParams(e);if(null==t)return;const[i,r]=t;this.suspendLineTracker(),(0,a.vw)(r.path,i,{preserveFocus:!0,preview:!0,...this.getShowOptions(e)}),this.container.events.fire("file:selected",{uri:r.uri},{source:this.host.id})}async openFile(e){const t=await this.getFileCommitFromParams(e);if(null==t)return;const[i,r]=t;this.suspendLineTracker(),(0,a.ZB)(r.path,i,{preserveFocus:!0,preview:!0,...this.getShowOptions(e)})}async openFileOnRemote(e){const t=await this.getFileCommitFromParams(e);if(null==t)return;const[i,r]=t;(0,a.YM)(r.path,i)}getShowOptions(e){return e.showOptions}}H([(0,w.fF)({args:!1})],CommitDetailsWebviewProvider.prototype,"getState",1),H([(0,w.fF)({args:!1})],CommitDetailsWebviewProvider.prototype,"updateRichState",1)},2384:(e,t,i)=>{i.d(t,{HomeWebviewProvider:()=>HomeWebviewProvider});var r=i(9496),s=i(9529);const n=new(i(5798).jH)("repositories/didChange"),o=Object.freeze({dispose:()=>{}});class HomeWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._disposable=r.Disposable.from(this.container.git.onDidChangeRepositories(this.onRepositoriesChanged,this),r.workspace.isTrusted?o:r.workspace.onDidGrantWorkspaceTrust(this.notifyDidChangeRepositories,this))}dispose(){this._disposable.dispose()}onRepositoriesChanged(){this.notifyDidChangeRepositories()}registerCommands(){return[(0,s.xR)(`${this.host.id}.refresh`,(()=>this.host.refresh(!0)),this)]}includeBootstrap(){return this.getState()}onReloaded(){this.notifyDidChangeRepositories()}getState(){return{timestamp:Date.now(),repositories:this.getRepositoriesState(),webroot:this.host.getWebRoot()}}getRepositoriesState(){return{count:this.container.git.repositoryCount,openCount:this.container.git.openRepositoryCount,hasUnsafe:this.container.git.hasUnsafeRepositories(),trusted:r.workspace.isTrusted}}notifyDidChangeRepositories(){this.host.notify(n,this.getRepositoriesState())}}},5798:(e,t,i)=>{i.d(t,{M5:()=>s,Mb:()=>a,NM:()=>p,TB:()=>m,W2:()=>n,bo:()=>h,dp:()=>o,eP:()=>u,jH:()=>IpcNotificationType,ke:()=>IpcCommandType,mq:()=>r,n:()=>l,qi:()=>c});class IpcMessageType{constructor(e,t=!1){this.method=e,this.reset=t}}class IpcCommandType extends IpcMessageType{}class IpcNotificationType extends IpcMessageType{}function r(e,t,i){e.method===t.method&&i(t.params,e)}const s=new IpcCommandType("webview/ready"),n=new IpcCommandType("webview/focus"),o=new IpcCommandType("command/execute"),a=new IpcCommandType("configuration/preview"),c=new IpcCommandType("configuration/update"),l=new IpcNotificationType("configuration/didChange"),h=new IpcNotificationType("configuration/didPreview"),u=new IpcNotificationType("webview/didOpenAnchor"),d=["rebaseEditor.enabled","currentLine.useUncommittedChangesFormat"];function p(e){return d.includes(e)}function m(e,t){}},5596:(e,t,i)=>{i.d(t,{SettingsWebviewProvider:()=>SettingsWebviewProvider});var r=i(9496),s=i(5255),n=i(9338),o=i(6450),a=i(7881),c=i(4092),l=i(5148),h=i(3105),u=i(4336),d=i(5798);class SettingsWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._disposable=l.D.onDidChangeAny(this.onAnyConfigurationChanged,this)}dispose(){this._disposable.dispose()}includeBootstrap(){const e=[["user","User"]];return r.workspace.workspaceFolders?.length&&e.push(["workspace","Workspace"]),{timestamp:Date.now(),version:this.container.version,config:l.D.getAll(!0),customSettings:this.getCustomSettings(),scope:"user",scopes:e}}onReloaded(){this.notifyDidChangeConfiguration()}onShowing(e,t,...i){const r=i[0];if(r&&"string"==typeof r){if(!e&&this.host.ready&&this.host.visible)return queueMicrotask((()=>{this.host.notify(d.eP,{anchor:r,scrollBehavior:"smooth"})})),!0;this._pendingJumpToAnchor=r}return!0}onActiveChanged(e){e&&this.notifyDidChangeConfiguration()}onReady(){if(null!=this._pendingJumpToAnchor){const e=this._pendingJumpToAnchor;this._pendingJumpToAnchor=void 0,this.host.notify(d.eP,{anchor:e,scrollBehavior:"auto"})}}onMessageReceived(e){if(null!=e)switch(e.method){case d.qi.method:u.Yd.debug(`Webview(${this.host.id}).onMessageReceived: method=${e.method}`),(0,d.mq)(d.qi,e,(async e=>{const t="workspace"===e.scope?r.ConfigurationTarget.Workspace:r.ConfigurationTarget.Global;let i;for(i in e.changes){let r=e.changes[i];if((0,d.NM)(i)){const e=this.customSettings.get(i);null!=e&&"boolean"==typeof r&&await e.update(r);continue}(0,d.TB)(i,r);const s=l.D.inspect(i);if(null!=r)if("workspace"===e.scope){if(r===s.workspaceValue)continue}else{if(r===s.globalValue&&r!==s.defaultValue)continue;r===s.defaultValue&&(r=void 0)}await l.D.update(i,r,t)}for(const i of e.removes)await l.D.update(i,void 0,t)}));break;case d.Mb.method:u.Yd.debug(`Webview(${this.host.id}).onMessageReceived: method=${e.method}`),(0,d.mq)(d.Mb,e,(async t=>{switch(t.type){case"commit":case"commit-uncommitted":{const i=new o.aM(this.container,"~/code/eamodio/vscode-gitlens-demo","fe26af408293cba5b4bfd77306e1ac9ff7ccaef8",new o._j("You","eamodio@gmail.com",new Date("2016-11-12T20:41:00.000Z")),new o._j("You","eamodio@gmail.com",new Date("2020-11-01T06:57:21.000Z")),"commit-uncommitted"===t.type?"Uncommitted changes":"Supercharged",["3ac1d3f51d7cf5f438cc69f25f6740536ad80fef"],"commit-uncommitted"===t.type?"Uncommitted changes":"Supercharged",new a.K8("~/code/eamodio/vscode-gitlens-demo","code.ts",a.NV.Modified),void 0,[]);let r,s,h=!1;switch(t.key){case l.D.name("currentLine.format"):h=l.D.get("currentLine.pullRequests.enabled");break;case l.D.name("statusBar.format"):h=l.D.get("statusBar.pullRequests.enabled")}h&&(r=new c.i7({id:"github",name:"GitHub",domain:"github.com",icon:"github"},{name:"Eric Amodio",avatarUrl:"https://avatars1.githubusercontent.com/u/641685?s=32&v=4",url:"https://github.com/eamodio"},"1","Supercharged","https://github.com/gitkraken/vscode-gitlens/pulls/1",c.o0.Merged,new Date("Sat, 12 Nov 2016 19:41:00 GMT"),void 0,new Date("Sat, 12 Nov 2016 20:41:00 GMT")));try{s=n.i.fromTemplate(t.format,i,{dateFormat:l.D.get("defaultDateFormat"),pullRequestOrRemote:r,messageTruncateAtNewLine:!0})}catch{s="Invalid format"}await this.host.notify(d.bo,{preview:s},e.completionId)}}}))}}onAnyConfigurationChanged(e){if(!l.D.changedAny(e,s.m1)){if(!l.D.changedAny(e,[...(0,h.UI)(this.customSettings.values(),(e=>e.name))]))return}this.notifyDidChangeConfiguration()}get customSettings(){return null==this._customSettings&&(this._customSettings=new Map([["rebaseEditor.enabled",{name:"workbench.editorAssociations",enabled:()=>this.container.rebaseEditor.enabled,update:this.container.rebaseEditor.setEnabled}],["currentLine.useUncommittedChangesFormat",{name:"currentLine.uncommittedChangesFormat",enabled:()=>null!=l.D.get("currentLine.uncommittedChangesFormat"),update:async e=>l.D.updateEffective("currentLine.uncommittedChangesFormat",e?"✏️ ${ago}":null)}]])),this._customSettings}getCustomSettings(){const e=Object.create(null);for(const[t,i]of this.customSettings)e[t]=i.enabled();return e}notifyDidChangeConfiguration(){return this.host.notify(d.n,{config:l.D.getAll(!0),customSettings:this.getCustomSettings()})}}},6260:(e,t,i)=>{i.d(t,{wU:()=>g,Q5:()=>f,qW:()=>w,Db:()=>v,OY:()=>y});var r=i(9496),s=i(4290),n=i(9529),o=i(2061),a=i(4241);var c=i(7469),l=i(5798),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&h(t,i,n),n};const p=new TextDecoder("utf8");let m=0;let g=class{constructor(e,t,i,n){this.container=e,this.descriptor=t,this.parent=i,this._onDidDispose=new r.EventEmitter,this._ready=!1,this._disposed=!1,this._cspNonce=(0,s.Vu)(),this._pendingIpcNotifications=new Map,this.id=t.id,this.webview=i.webview;const o="onDidChangeViewState"in i;this._isEditor=o,this._originalTitle=t.title,i.title=t.title,this._initializing=n(e,this).then((e=>{this.provider=e,this._disposed?e.dispose():this.disposable=r.Disposable.from(r.window.onDidChangeWindowState(this.onWindowStateChanged,this),i.webview.onDidReceiveMessage(this.onMessageReceivedCore,this),o?i.onDidChangeViewState((({webviewPanel:{visible:e,active:t}})=>this.onParentVisibilityChanged(e,t))):i.onDidChangeVisibility((()=>this.onParentVisibilityChanged(this.visible,this.active))),i.onDidDispose(this.onParentDisposed,this),...this.provider.registerCommands?.()??[],this.provider)}))}static async create(e,t,i,r){const s=new g(e,t,i,r);return await s.initialize(),s}get onDidDispose(){return this._onDidDispose.event}get ready(){return this._ready}dispose(){this._disposed=!0,w(this.descriptor.contextKeyPrefix),this.provider?.onFocusChanged?.(!1),this.provider?.onVisibilityChanged?.(!1),this._ready=!1,this._onDidDispose.fire(),this.disposable?.dispose()}async initialize(){null!=this._initializing&&(await this._initializing,this._initializing=void 0)}isEditor(){return this._isEditor}isView(){return!this._isEditor}get active(){return"active"in this.parent?!this._disposed&&this.parent.active:!this._disposed&&void 0}get badge(){return"badge"in this.parent?this.parent.badge:void 0}set badge(e){if(!("badge"in this.parent))throw new Error("The 'badge' property not supported on Webview parent");this.parent.badge=e}get description(){return"description"in this.parent?this.parent.description:this._description}set description(e){"description"in this.parent&&(this.parent.description=e),this._description=e}get originalTitle(){return this._originalTitle}get title(){return this.parent.title??this._originalTitle}set title(e){this.parent.title=e}get visible(){return!this._disposed&&this.parent.visible}async show(e,t,...i){null==t&&(t={});const s=this.provider.onShowing?.(e,t,...i);if(null!=s)if((0,c.tI)(s)){if(!1===await s)return}else if(!1===s)return;e&&(this.webview.html=await this.getHtml(this.webview)),this.isEditor()?e||this.parent.reveal(t.column??this.parent.viewColumn??this.descriptor.column??r.ViewColumn.Beside,t.preserveFocus??!1):this.isView()&&(await(0,n.dO)(`${this.id}.focus`,t),e&&this.provider.onVisibilityChanged?.(!0)),v(this.descriptor.contextKeyPrefix,this.active)}get cspNonce(){return this._cspNonce}asWebviewUri(e){return this.webview.asWebviewUri(e)}async refresh(e){e&&this.clearPendingIpcNotifications(),this.provider.onRefresh?.(e);const t=this._ready;this._ready=!1;const i=await this.getHtml(this.webview);e&&(this.webview.html=""),this.webview.html!==i?this.webview.html=i:t&&(this._ready=!0)}onParentDisposed(){this.dispose()}onMessageReceivedCore(e){if(null!=e)switch(e.method){case l.M5.method:(0,l.mq)(l.M5,e,(()=>{this._ready=!0,this.sendPendingIpcNotifications(),this.provider.onReady?.()}));break;case l.W2.method:(0,l.mq)(l.W2,e,(e=>{this.onViewFocusChanged(e)}));break;case l.dp.method:(0,l.mq)(l.dp,e,(e=>{null!=e.args?(0,n.P0)(e.command,...e.args):(0,n.P0)(e.command)}));break;default:this.provider.onMessageReceived?.(e)}}onViewFocusChanged(e){v(this.descriptor.contextKeyPrefix,void 0,e.focused,e.inputFocused),this.provider.onFocusChanged?.(e.focused)}onParentVisibilityChanged(e,t){!0!==this.descriptor.webviewHostOptions?.retainContextWhenHidden&&(e?this._ready?this.sendPendingIpcNotifications():null!=this.provider.onReloaded?(this.clearPendingIpcNotifications(),this.provider.onReloaded()):this.refresh():this._ready=!1),e?(this.container.usage.track(`${this.descriptor.trackingFeature}:shown`),v(this.descriptor.contextKeyPrefix,t),null!=t&&(this.provider.onActiveChanged?.(t),t||this.provider.onFocusChanged?.(!1))):(w(this.descriptor.contextKeyPrefix),null!=t&&this.provider.onActiveChanged?.(!1),this.provider.onFocusChanged?.(!1)),this.provider.onVisibilityChanged?.(e)}onWindowStateChanged(e){this.visible&&this.provider.onWindowFocusChanged?.(e.focused)}getRootUri(){return this.container.context.extensionUri}getWebRoot(){return null==this._webRoot&&(this._webRoot=this.asWebviewUri(this.getWebRootUri()).toString()),this._webRoot}getWebRootUri(){return null==this._webRootUri&&(this._webRootUri=r.Uri.joinPath(this.getRootUri(),"dist","webviews")),this._webRootUri}async getHtml(e){const t=this.getWebRootUri(),i=r.Uri.joinPath(t,this.descriptor.fileName),[s,n,o,a,c]=await Promise.all([r.workspace.fs.readFile(i),this.provider.includeBootstrap?.(),this.provider.includeHead?.(),this.provider.includeBody?.(),this.provider.includeEndOfBody?.()]);return f(p.decode(s),e.cspSource,this._cspNonce,this.asWebviewUri(this.getRootUri()).toString(),this.getWebRoot(),this.isEditor()?"editor":"view",n,o,a,c)}nextIpcId(){return 1073741824===m?m=1:m++,`host:${m}`}async notify(e,t,i){const r={id:this.nextIpcId(),method:e.method,params:t,completionId:i},s=await this.postMessage(r);return s?this._pendingIpcNotifications.clear():this.addPendingIpcNotificationCore(e,r),s}async postMessage(e){if(!this._ready)return Promise.resolve(!1);return await Promise.race([this.webview.postMessage(e),new Promise((e=>setTimeout(e,5e3,!1)))])}addPendingIpcNotification(e,t,i){this.addPendingIpcNotificationCore(e,t.get(e)?.bind(i))}addPendingIpcNotificationCore(e,t){e.reset&&this._pendingIpcNotifications.clear(),null!=t&&this._pendingIpcNotifications.set(e,t)}clearPendingIpcNotifications(){this._pendingIpcNotifications.clear()}sendPendingIpcNotifications(){if(0===this._pendingIpcNotifications.size)return;const e=new Map(this._pendingIpcNotifications);this._pendingIpcNotifications.clear();for(const t of e.values())"function"==typeof t?t():this.postMessage(t)}};function f(e,t,i,r,s,n,o,a,c,l){return e.replace(/#{(head|body|endOfBody|placement|cspSource|cspNonce|root|webroot)}/g,((e,h)=>{switch(h){case"head":return a??"";case"body":return c??"";case"endOfBody":return`${null!=o?`<script type="text/javascript" nonce="${i}">window.bootstrap=${JSON.stringify(o)};<\/script>`:""}${l??""}`;case"placement":return n;case"cspSource":return t;case"cspNonce":return i;case"root":return r;case"webroot":return s;default:return""}}))}function w(e){(0,o.v)(`${e}:visible`,!1),(0,o.v)(`${e}:inputFocus`,!1),(0,o.v)(`${e}:focus`,!1),e.startsWith("gitlens:webview:")&&(0,o.v)(`${e}:active`,!1)}function v(e,t,i,r){(0,o.v)(`${e}:visible`,!0),e.startsWith("gitlens:webview:")&&null!=t&&((0,o.v)(`${e}:active`,t),t||(i=!1,r=!1)),null!=i&&(0,o.v)(`${e}:focus`,i),null!=r&&(0,o.v)(`${e}:inputFocus`,r)}function y(e,t,i,s=!1){let n=!1;for(const[o,a]of Object.entries(i)){const i=e[o];!s&&(i instanceof r.Uri||a instanceof r.Uri)&&i?.toString()===a?.toString()||(s||i!==a||void 0===a&&!(o in e)||null!=t&&o in t)&&(null==t&&(t={}),t[o]=a,n=!0)}return[n,t]}d([(0,a.fF)()],g.prototype,"show",1),d([(0,a.fF)()],g.prototype,"refresh",1),d([(0,a.fF)()],g.prototype,"onParentDisposed",1),d([(0,a.fF)({args:{0:e=>null!=e?`${e.id}: method=${e.method}`:"<undefined>"}})],g.prototype,"onMessageReceivedCore",1),d([(0,a.fF)({args:{0:e=>`focused=${e.focused}, inputFocused=${e.inputFocused}`}})],g.prototype,"onViewFocusChanged",1),d([(0,a.fF)()],g.prototype,"onParentVisibilityChanged",1),d([(e,t,i)=>{let r;if("function"==typeof i.value?r=i.value:"function"==typeof i.get&&(r=i.get),void 0===r)throw new Error("Not supported");const s=`$serialize$${t}`;i.value=function(...e){Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let t=this[s];const i=async()=>await r.apply(this,e);return t=null==t?i():t.then(i,i),this[s]=t,t}},(0,a.fF)({args:{0:e=>`{"id":${e.id},"method":${e.method}${e.completionId?`,"completionId":${e.completionId}`:""}}`}})],g.prototype,"postMessage",1),g=d([(0,a.hJ)((e=>`WebviewController(${e.id})`))],g)},1753:(e,t,i)=>{i.d(t,{V:()=>WebviewsController,W:()=>p});var r=i(9496),s=i(2215),n=i(9529),o=i(4241),a=i(4336),c=i(6004),l=i(6260),h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?u(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&h(t,i,n),n};class WebviewsController{constructor(e){this.container=e,this.disposables=[],this._panels=new Map,this._views=new Map}dispose(){this.disposables.forEach((e=>{e.dispose()}))}registerWebviewView(e,t,i){const o=(0,c.UH)(),h={descriptor:e};this._views.set(e.id,h);const u=[];u.push(r.window.registerWebviewViewProvider(e.id,{resolveWebviewView:async(n,c,d)=>{if(null!=i&&!1===await i())return;if(h.descriptor.plusFeature){if(!await(0,s.C)())return;if(d.isCancellationRequested)return}a.Yd.debug(o,`Resolving webview view (${e.id})`),n.webview.options={enableCommandUris:!0,enableScripts:!0,localResourceRoots:[r.Uri.file(this.container.context.extensionPath)],...e.webviewOptions},n.title=e.title;const m=await l.wU.create(this.container,e,n,t);h.controller?.dispose(),h.controller=m,u.push(m.onDidDispose((()=>{a.Yd.debug(o,`Disposing webview view (${e.id})`),h.pendingShowArgs=void 0,h.controller=void 0})),m);let g=h.pendingShowArgs;h.pendingShowArgs=void 0,null==g&&p(c)&&(g=[void 0,c]),null!=g?await m.show(!0,...g):await m.show(!0)}},null!=e.webviewHostOptions?{webviewOptions:e.webviewHostOptions}:void 0));const d=r.Disposable.from(...u);return this.disposables.push(d),{id:e.id,get ready(){return h.controller?.ready??!1},get visible(){return h.controller?.visible??!1},dispose:function(){d.dispose()},refresh:async e=>h.controller?.refresh(e),show:async(t,...i)=>{null==h.controller?(a.Yd.debug(o,`Showing webview view (${e.id})`),h.pendingShowArgs=[t,...i],(0,n.dO)(`${e.id}.focus`,t)):h.controller.show(!1,t,...i)}}}registerWebviewPanel(e,t,i,o){const h=(0,c.UH)(),u={descriptor:t};this._panels.set(t.id,u);const d=[],{container:p}=this;let m;async function g(e,...t){if(null!=o&&!1===await o())return;const{descriptor:n}=u;if(n.plusFeature&&!await(0,s.C)())return;p.usage.track(`${n.trackingFeature}:shown`);let c=e?.column??n.column??r.ViewColumn.Beside;c===r.ViewColumn.Beside&&null==r.window.tabGroups.activeTabGroup.activeTab&&(c=r.ViewColumn.Active);let{controller:g}=u;if(null==g){let s;null!=m?(a.Yd.debug(h,`Restoring webview panel (${n.id})`),s=m,m=void 0):(a.Yd.debug(h,`Creating webview panel (${n.id})`),s=r.window.createWebviewPanel(n.id,n.title,{viewColumn:c,preserveFocus:e?.preserveFocus??!1},{enableCommandUris:!0,enableScripts:!0,localResourceRoots:[r.Uri.file(p.context.extensionPath)],...n.webviewOptions,...n.webviewHostOptions})),s.iconPath=r.Uri.file(p.context.asAbsolutePath(n.iconPath)),g=await l.wU.create(p,n,s,i),u.controller=g,d.push(g.onDidDispose((()=>{a.Yd.debug(h,`Disposing webview panel (${n.id})`),u.controller=void 0})),g),await g.show(!0,e,...t)}else a.Yd.debug(h,`Showing webview panel (${n.id})`),await g.show(!1,e,...t)}const f=r.Disposable.from(...d,r.window.registerWebviewPanelSerializer(t.id,{deserializeWebviewPanel:async function(e,t){m=e,null!=t?await g({column:e.viewColumn,preserveFocus:!0},{state:t}):await g({column:e.viewColumn,preserveFocus:!0})}}),(0,n.xR)(e,((...e)=>g(void 0,...e)),this));return this.disposables.push(f),{id:t.id,get ready(){return u.controller?.ready??!1},get visible(){return u.controller?.visible??!1},dispose:function(){f.dispose()},close:()=>{u.controller?.parent.dispose()},refresh:async e=>u.controller?.refresh(e),show:g}}}function p(e){return null!=e&&"object"==typeof e&&"state"in e&&null!=e.state&&"object"==typeof e.state}d([(0,o.fF)({args:{0:e=>e.id,1:!1,2:!1}})],WebviewsController.prototype,"registerWebviewView",1),d([(0,o.fF)({args:{0:e=>e,1:e=>e.id,2:!1,3:!1}})],WebviewsController.prototype,"registerWebviewPanel",1)},7338:(e,t,i)=>{i.d(t,{WelcomeWebviewProvider:()=>WelcomeWebviewProvider});var r=i(9496),s=i(4968),n=i(5148),o=i(5798);const a=new o.ke("welcome/configuration/update"),c=new o.jH("welcome/didChange",!0),l=Object.freeze({dispose:()=>{}});class WelcomeWebviewProvider{constructor(e,t){this.container=e,this.host=t,this._disposable=r.Disposable.from(n.D.onDidChange(this.onConfigurationChanged,this),this.container.git.onDidChangeRepositories((()=>this.notifyDidChange()),this),r.workspace.isTrusted?l:r.workspace.onDidGrantWorkspaceTrust((()=>this.notifyDidChange()),this),this.container.subscription.onDidChange(this.onSubscriptionChanged,this))}dispose(){this._disposable.dispose()}includeBootstrap(){return this.getState()}onReloaded(){this.notifyDidChange()}onSubscriptionChanged(e){this.notifyDidChange(e.current)}onConfigurationChanged(e){(n.D.changed(e,"codeLens.enabled")||n.D.changed(e,"currentLine.enabled"))&&this.notifyDidChange()}onMessageReceived(e){if(e.method===a.method)(0,o.mq)(a,e,(e=>this.updateConfiguration(e)))}async getState(e){return{timestamp:Date.now(),version:this.container.version,config:{codeLens:n.D.get("codeLens.enabled",void 0,!0,!0),currentLine:n.D.get("currentLine.enabled",void 0,!0,!0)},repoFeaturesBlocked:!r.workspace.isTrusted||0===this.container.git.openRepositoryCount||this.container.git.hasUnsafeRepositories(),isTrialOrPaid:await this.getTrialOrPaidState(e)}}async getTrialOrPaidState(e){const t=e??await this.container.subscription.getSubscription(!0);return!![s.jc.FreePlusInTrial,s.jc.Paid].includes(t.state)}updateConfiguration(e){n.D.updateEffective(`${e.type}.enabled`,e.value)}async notifyDidChange(e){this.host.notify(c,{state:await this.getState(e)})}}},3300:(e,t,i)=>{var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i.g)return i.g;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,r.fetch&&(t.default=r.fetch.bind(r)),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},778:(e,t,i)=>{var r=i(2479);function s(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function n(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},i=e.name||"Function wrapped with `once`";return t.onceError=i+" shouldn't be called more than once",t.called=!1,t}e.exports=r(s),e.exports.strict=r(n),s.proto=s((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return s(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return n(this)},configurable:!0})}))},6470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var i,r="",s=0,n=-1,o=0,a=0;a<=e.length;++a){if(a<e.length)i=e.charCodeAt(a);else{if(47===i)break;i=47}if(47===i){if(n===a-1||1===o);else if(n!==a-1&&2===o){if(r.length<2||2!==s||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){-1===c?(r="",s=0):s=(r=r.slice(0,c)).length-1-r.lastIndexOf("/"),n=a,o=0;continue}}else if(2===r.length||1===r.length){r="",s=0,n=a,o=0;continue}t&&(r.length>0?r+="/..":r="..",s=2)}else r.length>0?r+="/"+e.slice(n+1,a):r=e.slice(n+1,a),s=a-n-1;n=a,o=0}else 46===i&&-1!==o?++o:o=-1}return r}var r={resolve:function(){for(var e,r="",s=!1,n=arguments.length-1;n>=-1&&!s;n--){var o;n>=0?o=arguments[n]:(void 0===e&&(e=process.cwd()),o=e),t(o),0!==o.length&&(r=o+"/"+r,s=47===o.charCodeAt(0))}return r=i(r,!s),s?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),s=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!r)).length||r||(e="."),e.length>0&&s&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,i=0;i<arguments.length;++i){var s=arguments[i];t(s),s.length>0&&(void 0===e?e=s:e+="/"+s)}return void 0===e?".":r.normalize(e)},relative:function(e,i){if(t(e),t(i),e===i)return"";if((e=r.resolve(e))===(i=r.resolve(i)))return"";for(var s=1;s<e.length&&47===e.charCodeAt(s);++s);for(var n=e.length,o=n-s,a=1;a<i.length&&47===i.charCodeAt(a);++a);for(var c=i.length-a,l=o<c?o:c,h=-1,u=0;u<=l;++u){if(u===l){if(c>l){if(47===i.charCodeAt(a+u))return i.slice(a+u+1);if(0===u)return i.slice(a+u)}else o>l&&(47===e.charCodeAt(s+u)?h=u:0===u&&(h=0));break}var d=e.charCodeAt(s+u);if(d!==i.charCodeAt(a+u))break;47===d&&(h=u)}var p="";for(u=s+h+1;u<=n;++u)u!==n&&47!==e.charCodeAt(u)||(0===p.length?p+="..":p+="/..");return p.length>0?p+i.slice(a+h):(a+=h,47===i.charCodeAt(a)&&++a,i.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var i=e.charCodeAt(0),r=47===i,s=-1,n=!0,o=e.length-1;o>=1;--o)if(47===(i=e.charCodeAt(o))){if(!n){s=o;break}}else n=!1;return-1===s?r?"/":".":r&&1===s?"//":e.slice(0,s)},basename:function(e,i){if(void 0!==i&&"string"!=typeof i)throw new TypeError('"ext" argument must be a string');t(e);var r,s=0,n=-1,o=!0;if(void 0!==i&&i.length>0&&i.length<=e.length){if(i.length===e.length&&i===e)return"";var a=i.length-1,c=-1;for(r=e.length-1;r>=0;--r){var l=e.charCodeAt(r);if(47===l){if(!o){s=r+1;break}}else-1===c&&(o=!1,c=r+1),a>=0&&(l===i.charCodeAt(a)?-1==--a&&(n=r):(a=-1,n=c))}return s===n?n=c:-1===n&&(n=e.length),e.slice(s,n)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){s=r+1;break}}else-1===n&&(o=!1,n=r+1);return-1===n?"":e.slice(s,n)},extname:function(e){t(e);for(var i=-1,r=0,s=-1,n=!0,o=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===s&&(n=!1,s=a+1),46===c?-1===i?i=a:1!==o&&(o=1):-1!==i&&(o=-1);else if(!n){r=a+1;break}}return-1===i||-1===s||0===o||1===o&&i===s-1&&i===r+1?"":e.slice(i,s)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var i=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return i?i===t.root?i+r:i+e+r:r}("/",e)},parse:function(e){t(e);var i={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return i;var r,s=e.charCodeAt(0),n=47===s;n?(i.root="/",r=1):r=0;for(var o=-1,a=0,c=-1,l=!0,h=e.length-1,u=0;h>=r;--h)if(47!==(s=e.charCodeAt(h)))-1===c&&(l=!1,c=h+1),46===s?-1===o?o=h:1!==u&&(u=1):-1!==o&&(u=-1);else if(!l){a=h+1;break}return-1===o||-1===c||0===u||1===u&&o===c-1&&o===a+1?-1!==c&&(i.base=i.name=0===a&&n?e.slice(1,c):e.slice(a,c)):(0===a&&n?(i.name=e.slice(1,o),i.base=e.slice(1,c)):(i.name=e.slice(a,o),i.base=e.slice(a,c)),i.ext=e.slice(o,c)),a>0?i.dir=e.slice(0,a-1):n&&(i.dir="/"),i},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r},2479:e=>{e.exports=function e(t,i){if(t&&i)return e(t)(i);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){r[e]=t[e]})),r;function r(){for(var e=new Array(arguments.length),i=0;i<e.length;i++)e[i]=arguments[i];var r=t.apply(this,e),s=e[e.length-1];return"function"==typeof r&&r!==s&&Object.keys(s).forEach((function(e){r[e]=s[e]})),r}}},9496:e=>{e.exports=require("vscode")}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{i.r(r),i.d(r,{activate:()=>E,deactivate:()=>$});var e=i(9496),t=i(9376),s=i(429),n=i(5567),o=i(8294);Object.freeze({dispose:()=>{}});class Api{#i;constructor(e){this.#i=e}registerActionRunner(e,t){if(t.name===o.vj)throw new Error(`Cannot use the reserved name '${o.vj}'`);return"hover.commandHelp"===e&&(e="hover.commands"),this.#i.actionRunners.register(e,t)}}var a=i(2540),c=i(5255),l=i(7462),h=i(5367),u=i(6450),d=i(3646),p=i(9502),m=i(7925),g=i(9529);function f(e){!function(e){e.subscriptions.push(n.W.instance.actionRunners.registerBuiltInPartner("liveshare","hover.commands",{name:"Live Share",label:e=>"hover.commands"===e.type&&"You"!==e.commit.author.name?`$(live-share) Invite ${e.commit.author.name}${e.commit.author.presence?.statusText?` (${e.commit.author.presence?.statusText})`:""} to a Live Share Session`:"$(live-share) Start a Live Share Session",run:async e=>{"hover.commands"===e.type&&"You"!==e.commit.author.name?await(0,g.P0)(c.Gh.InviteToLiveShare,{email:e.commit.author.email}):await(0,g.P0)(c.Gh.InviteToLiveShare,{})}}))}(e)}var w=i(5148),v=i(2061),y=i(7512),b=i(2185),C=i(4336),A=i(8227),P=i(9967),S=i(6398),R=i(4241),D=Object.defineProperty,k=Object.getOwnPropertyDescriptor,_=(e,t,i,r)=>{for(var s,n=r>1?void 0:r?k(t,i):t,o=e.length-1;o>=0;o--)(s=e[o])&&(n=(r?s(t,i,n):s(n))||n);return r&&n&&D(t,i,n),n};class Storage{constructor(t){this.context=t,this._onDidChange=new e.EventEmitter,this._onDidChangeSecrets=new e.EventEmitter,this._disposable=this.context.secrets.onDidChange((e=>this._onDidChangeSecrets.fire(e)))}get onDidChange(){return this._onDidChange.event}get onDidChangeSecrets(){return this._onDidChangeSecrets.event}dispose(){this._disposable.dispose()}get(e,t){return this.context.globalState.get(`${c.m1}:${e}`,t)}async delete(e){await this.context.globalState.update(`${c.m1}:${e}`,void 0),this._onDidChange.fire({key:e,workspace:!1})}async deleteWithPrefix(e){const t=`${c.m1}:${e}`,i=`${t}:`;for(const e of this.context.globalState.keys())(e===t||e.startsWith(i))&&(await this.context.globalState.update(e,void 0),this._onDidChange.fire({key:e,workspace:!1}))}async store(e,t){await this.context.globalState.update(`${c.m1}:${e}`,t),this._onDidChange.fire({key:e,workspace:!1})}async getSecret(e){return this.context.secrets.get(e)}async deleteSecret(e){return this.context.secrets.delete(e)}async storeSecret(e,t){return this.context.secrets.store(e,t)}getWorkspace(e,t){return this.context.workspaceState.get(`${c.m1}:${e}`,t)}async deleteWorkspace(e){await this.context.workspaceState.update(`${c.m1}:${e}`,void 0),this._onDidChange.fire({key:e,workspace:!0})}async deleteWorkspaceWithPrefix(e){const t=`${c.m1}:${e}`,i=`${t}:`;for(const e of this.context.workspaceState.keys())(e===t||e.startsWith(i))&&(await this.context.workspaceState.update(e,void 0),this._onDidChange.fire({key:e,workspace:!0}))}async storeWorkspace(e,t){await this.context.workspaceState.update(`${c.m1}:${e}`,t),this._onDidChange.fire({key:e,workspace:!0})}}_([(0,R.fF)({logThreshold:50})],Storage.prototype,"get",1),_([(0,R.fF)({logThreshold:250})],Storage.prototype,"delete",1),_([(0,R.fF)({logThreshold:250})],Storage.prototype,"deleteWithPrefix",1),_([(0,R.fF)({args:{1:!1},logThreshold:250})],Storage.prototype,"store",1),_([(0,R.fF)({args:!1,logThreshold:250})],Storage.prototype,"getSecret",1),_([(0,R.fF)({args:!1,logThreshold:250})],Storage.prototype,"deleteSecret",1),_([(0,R.fF)({args:!1,logThreshold:250})],Storage.prototype,"storeSecret",1),_([(0,R.fF)({logThreshold:25})],Storage.prototype,"getWorkspace",1),_([(0,R.fF)({logThreshold:250})],Storage.prototype,"deleteWorkspace",1),_([(0,R.fF)({logThreshold:250})],Storage.prototype,"deleteWorkspaceWithPrefix",1),_([(0,R.fF)({args:{1:!1},logThreshold:250})],Storage.prototype,"storeWorkspace",1);var T=i(4550),F=i(6922);async function E(i){const r=i.extension.packageJSON.version,o=(0,T.L5)(r,"> 2020.0.0"),R=w.D.get("outputLevel");C.Yd.configure({name:"GitLens",createChannel:function(t){return e.window.createOutputChannel(t)},toLoggable:function(t){return(0,l.uy)(t)?`GitUri(${t.toString(!0)}${t.repoPath?` repoPath=${t.repoPath}`:""}${t.sha?` sha=${t.sha}`:""})`:t instanceof e.Uri?`Uri(${t.toString(!0)})`:(0,d.uC)(t)||(0,h.BF)(t)||(0,u.f_)(t)||(0,p.YR)(t)||(0,F.Jc)(t)?t.toString():"uri"in t&&t.uri instanceof e.Uri?`${"name"in t&&"index"in t?"WorkspaceFolder":(0,C.q4)(t)}(uri=${t.uri.toString(!0)})`:void 0}},(0,a.oE)(R),i.extensionMode===e.ExtensionMode.Development);const D=w.D.get("defaultDateLocale"),k=new S.u(`GitLens${o?" (pre-release)":""} v${r}`,{log:{message:` activating in ${e.env.appName} (${e.version}) on the ${s.$L?"web":"desktop"}; language='${e.env.language}', defaultDateLocale='${D}' (${e.env.machineId}|${e.env.sessionId})`}});if(o){const e=(0,T.mL)(r);if(new Date(e.major,e.minor-1,Number(e.patch.toString().substring(0,2))).getTime()<Date.now()-12096e5)return k.stop({message:` was NOT activated because this pre-release version (${r}) has expired`}),void setTimeout(m.Nl,0,r)}e.workspace.isTrusted||(0,v.v)("gitlens:untrusted",!0),function(e,...t){e.globalState?.setKeysForSync([...t,c.lw.Version,c.lw.HomeViewWelcomeVisible])}(i);const _=new Storage(i),E=_.get(o?"synced:preVersion":"synced:version"),$=_.get(o?"preVersion":"version");let O,x;O=null==$||null==E?E??$:1===(0,T.qu)(E,$)?E:$,C.Yd.enabled(A.i.Debug)&&(x=`syncedVersion=${E}, localVersion=${$}, previousVersion=${O}, welcome=${_.get("views:welcome:visible")}`),null==O&&_.store("views:welcome:visible",!0),w.V.configure(i),(0,y.Cz)(D??e.env.language),i.subscriptions.push(w.D.onDidChange((t=>{w.D.changed(t,"defaultDateLocale")&&(0,y.Cz)(w.D.get("defaultDateLocale")??e.env.language)})));const I=n.W.create(i,_,o,r,O);(0,b.IH)(I.onReady)((()=>{i.subscriptions.push(...(0,g.$$)(I)),function(e){e.context.subscriptions.push(e.actionRunners.registerBuiltIn("createPullRequest",{label:e=>`Create Pull Request on ${e.remote?.provider?.name??"Remote"}`,run:async e=>{"createPullRequest"===e.type&&await(0,g.P0)(c.Gh.CreatePullRequestOnRemote,{base:void 0,compare:e.branch.isRemote?(0,h.S3)(e.branch.name):e.branch.upstream?(0,h.S3)(e.branch.upstream):e.branch.name,remote:e.remote?.name??"",repoPath:e.repoPath})}}),e.actionRunners.registerBuiltIn("openPullRequest",{label:e=>`Open Pull Request on ${e.provider?.name??"Remote"}`,run:async e=>{"openPullRequest"===e.type&&await(0,g.P0)(c.Gh.OpenPullRequestOnRemote,{pr:{url:e.pullRequest.url}})}}))}(I),f(i),e.workspace.isTrusted||i.subscriptions.push(e.workspace.onDidGrantWorkspaceTrust((()=>{(0,v.v)("gitlens:untrusted",void 0),I.telemetry.setGlobalAttribute("workspace.isTrusted",e.workspace.isTrusted)}))),async function(t,i,r,s){if(null==s){if(C.Yd.log(`GitLens first-time install; window.focused=${e.window.state.focused}`),!1===w.D.get("showWelcomeOnInstall"))return;if(e.window.state.focused)await t.storage.delete("pendingWelcomeOnFocus"),await(0,g.P0)(c.Gh.ShowWelcomePage);else{await t.storage.store("pendingWelcomeOnFocus",!0);const i=e.window.onDidChangeWindowState((e=>{e.focused&&(i.dispose(),!0===t.storage.get("pendingWelcomeOnFocus")&&(t.storage.delete("pendingWelcomeOnFocus"),w.D.get("showWelcomeOnInstall")&&(0,g.P0)(c.Gh.ShowWelcomePage)))}));t.context.subscriptions.push(i)}return}s!==i&&C.Yd.log(`GitLens upgraded from v${s} to v${i}; window.focused=${e.window.state.focused}`);const n=(0,T.mL)(i),o=(0,T.mL)(s);if(n.major<o.major||n.major===o.major&&n.minor<o.minor)return;const a=r&&(0,T.L5)(o,"< 2023.6.0800");if(n.major===o.major&&!a)return;if(i=a?"14":String(n.major),(0,g.P0)(c.Gh.ShowHomeView),w.D.get("showWhatsNewAfterUpgrades"))if(e.window.state.focused)await t.storage.delete("pendingWhatsNewOnFocus"),await(0,m.xs)(i);else{await t.storage.store("pendingWhatsNewOnFocus",!0);const r=e.window.onDidChangeWindowState((e=>{e.focused&&(r.dispose(),!0===t.storage.get("pendingWhatsNewOnFocus")&&(t.storage.delete("pendingWhatsNewOnFocus"),w.D.get("showWhatsNewAfterUpgrades")&&(0,m.xs)(i)))}));t.context.subscriptions.push(r)}}(I,r,o,O),_.store(o?"preVersion":"version",r),null!=E&&1!==(0,T.qu)(r,E)||_.store(o?"synced:preVersion":"synced:version",r),R===a.M7.Debug&&setTimeout((async()=>{w.D.get("outputLevel")===a.M7.Debug&&(I.prereleaseOrDebugging||await(0,m.EB)()&&(0,g.P0)(c.Gh.DisableDebugLogging))}),6e4)})),I.debugging?((0,v.v)("gitlens:debugging",!0),(0,v.v)("gitlens:prerelease",!0)):I.prerelease&&(0,v.v)("gitlens:prerelease",!0),await I.ready();const B=(0,P.xH)(w.D.getAll(!0),{prefix:"config",stringify:"all"});I.telemetry.setGlobalAttributes({debugging:I.debugging,prerelease:o,install:null==O,upgrade:null!=O&&r!==O,upgradedFrom:null!=O&&r!==O?O:void 0});const W=new Api(I),L=I.mode,M=k.startTime,U=(0,t.a)(),N=k.elapsed();return k.stop({message:` activated${null!=x?`, ${x}`:""}${null!=L?`, mode: ${L.name}`:""}`}),I.telemetry.sendEvent("activate",{"activation.elapsed":N,"activation.mode":L?.name,...B},M,U),Promise.resolve(W)}function $(){C.Yd.log("GitLens deactivating..."),n.W.instance.deactivate()}})(),module.exports=r})();