exports.id=278,exports.ids=[278],exports.modules={8178:(e,t,o)=>{o.d(t,{d:()=>BlameAnnotationProviderBase});var n=o(9496),r=o(7462),a=o(1062),i=o(5148),s=o(4241),l=o(2022),c=o(248),u=Object.defineProperty,h=Object.getOwnPropertyDescriptor;class BlameAnnotationProviderBase extends l.HU{constructor(e,t,o,n){super(e,t,o),this.container=n,this.blame=this.container.git.getBlame(this.trackedDocument.uri,t.document),t.document.isDirty&&o.setForceDirtyStateChangeOnNextDocumentChange()}blame;hoverProviderDisposable;clear(){null!=this.hoverProviderDisposable&&(this.hoverProviderDisposable.dispose(),this.hoverProviderDisposable=void 0),super.clear()}async validate(){const e=await this.blame;return null!=e&&0!==e.lines.length}async getBlame(){const e=await this.blame;if(null!=e&&0!==e.lines.length)return e}getComputedHeatmap(e){const t=[];let o,n;for(const r of e.lines)n!==r.sha&&(n=r.sha,o=e.commits.get(r.sha),null!=o&&t.push(o.date));t.sort(((e,t)=>e.getTime()-t.getTime()));const r=new Date;r.setDate(r.getDate()-(i.D.get("heatmap.ageThreshold")||90));const a=r.getTime(),s=[],l=[];for(const e of t)e.getTime()<a?l.push(e):s.push(e);let u;u=s.length&&l.length?{hot:d(s),cold:d(l)}:d(t);const h=(e,t)=>Array.isArray(u)?u:t?u.hot.concat(u.cold):e.getTime()<a?u.cold:u.hot,m=(e,t)=>{const o=e.getTime();let n=0;for(let e=0;e<t.length&&(n=e,!(o>=t[e]));e++);return n};return{coldThresholdTimestamp:a,colors:(0,c.HM)(),computeRelativeAge:e=>m(e,h(e)),computeOpacity:e=>{const t=h(e,!0),o=m(e,t);return Math.max(.2,Math.round(100*(1-o/t.length))/100)}}}registerHoverProviders(e){const t=i.D.get("hovers");t.enabled&&t.annotations.enabled&&(e.details||e.changes)&&(this.hoverProviderDisposable=n.languages.registerHoverProvider({pattern:this.document.uri.fsPath},{provideHover:(t,o,n)=>this.provideHover(e,t,o,n)}))}async provideHover(e,t,o,s){if("line"!==i.D.get("hovers.annotations.over")&&0!==o.character)return;if(this.document.uri.toString()!==t.uri.toString())return;const l=await this.getBlame();if(null==l)return;const c=l.lines[o.line],u=l.commits.get(c.sha);if(null==u)return;const h=(await Promise.all([e.details?this.getDetailsHoverMessage(u,t):void 0,e.changes?(0,a.jw)(u,await r.YY.fromUri(t.uri),o.line,t):void 0])).filter((e=>Boolean(e)));return new n.Hover(h,t.validateRange(new n.Range(o.line,0,o.line,1073741824)))}async getDetailsHoverMessage(e,t){let o=this.editor.selection.active.line;const n=o+1;o=(e.lines.find((e=>e.line===n))??e.lines[0]).originalLine-1;const s=i.D.get("hovers");return(0,a.nN)(e,await r.YY.fromUri(t.uri),o,{autolinks:s.autolinks.enabled,dateFormat:i.D.get("defaultDateFormat"),format:s.detailsMarkdownFormat,pullRequests:{enabled:s.pullRequests.enabled}})}}function d(e){const t=[],o=Math.floor(e.length/2),n=e.length%2?e[o].getTime():(e[o-1].getTime()+e[o].getTime())/2;let r=(e[e.length-1].getTime()-n)/5;for(let e=5;e>0;e--)t.push(n+r*e);t.push(n);r=(n-e[0].getTime())/4;for(let e=1;e<=4;e++)t.push(n-r*e);return t}((e,t,o,n)=>{for(var r,a=n>1?void 0:n?h(t,o):t,i=e.length-1;i>=0;i--)(r=e[i])&&(a=(n?r(t,o,a):r(a))||a);n&&a&&u(t,o,a)})([(0,s.cM)({args:!1})],BlameAnnotationProviderBase.prototype,"getComputedHeatmap",1)},79:(e,t,o)=>{o.d(t,{GutterHeatmapBlameAnnotationProvider:()=>GutterHeatmapBlameAnnotationProvider});var n=o(9496),r=o(2540),a=o(4241),i=o(6004),s=o(6398),l=o(248),c=o(8178),u=Object.defineProperty,h=Object.getOwnPropertyDescriptor;class GutterHeatmapBlameAnnotationProvider extends c.d{constructor(e,t,o){super(r.VP.Heatmap,e,t,o)}async onProvideAnnotation(e,t){const o=(0,i.UH)();this.annotationContext=e;const r=await this.getBlame();if(null==r)return!1;const a=(0,s.k)(o),c=new Map,u=this.getComputedHeatmap(r);let h;for(const e of r.lines){const t=e.line-1;h=r.commits.get(e.sha),null!=h&&(0,l.Lx)(h.date,u,new n.Range(t,0,t,0),c)}return a?.restart({suffix:" to compute heatmap annotations"}),c.size&&(this.setDecorations([...c.values()]),a?.stop({suffix:" to apply all heatmap annotations"})),!0}selection(e){return Promise.resolve()}}((e,t,o,n)=>{for(var r,a=n>1?void 0:n?h(t,o):t,i=e.length-1;i>=0;i--)(r=e[i])&&(a=(n?r(t,o,a):r(a))||a);n&&a&&u(t,o,a)})([(0,a.cM)()],GutterHeatmapBlameAnnotationProvider.prototype,"onProvideAnnotation",1)}};