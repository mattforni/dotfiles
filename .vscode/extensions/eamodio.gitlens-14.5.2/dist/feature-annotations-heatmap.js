exports.id=278,exports.ids=[278],exports.modules={8178:(e,t,o)=>{o.d(t,{d:()=>BlameAnnotationProviderBase});var r=o(9496),n=o(7462),s=o(1062),i=o(5148),a=o(4241),l=o(2022),c=o(248),u=Object.defineProperty,p=Object.getOwnPropertyDescriptor;class BlameAnnotationProviderBase extends l.H{constructor(e,t,o,r){super(e,t,o),this.container=r,this.blame=this.container.git.getBlame(this.trackedDocument.uri,t.document),t.document.isDirty&&o.setForceDirtyStateChangeOnNextDocumentChange()}blame;hoverProviderDisposable;clear(){null!=this.hoverProviderDisposable&&(this.hoverProviderDisposable.dispose(),this.hoverProviderDisposable=void 0),super.clear()}async validate(){const e=await this.blame;return null!=e&&0!==e.lines.length}async getBlame(){const e=await this.blame;if(null!=e&&0!==e.lines.length)return e}getComputedHeatmap(e){const t=[];let o,r;for(const n of e.lines)r!==n.sha&&(r=n.sha,o=e.commits.get(n.sha),null!=o&&t.push(o.date));t.sort(((e,t)=>e.getTime()-t.getTime()));const n=new Date;n.setDate(n.getDate()-(i.D.get("heatmap.ageThreshold")||90));const s=n.getTime(),a=[],l=[];for(const e of t)e.getTime()<s?l.push(e):a.push(e);let u;u=a.length&&l.length?{hot:h(a),cold:h(l)}:h(t);const p=(e,t)=>Array.isArray(u)?u:t?u.hot.concat(u.cold):e.getTime()<s?u.cold:u.hot,d=(e,t)=>{const o=e.getTime();let r=0;for(let e=0;e<t.length&&(r=e,!(o>=t[e]));e++);return r};return{coldThresholdTimestamp:s,colors:(0,c.HM)(),computeRelativeAge:e=>d(e,p(e)),computeOpacity:e=>{const t=p(e,!0),o=d(e,t);return Math.max(.2,Math.round(100*(1-o/t.length))/100)}}}registerHoverProviders(e){const t=i.D.get("hovers");t.enabled&&t.annotations.enabled&&(e.details||e.changes)&&(this.hoverProviderDisposable=r.languages.registerHoverProvider({pattern:this.document.uri.fsPath},{provideHover:(t,o,r)=>this.provideHover(e,t,o,r)}))}async provideHover(e,t,o,a){if("line"!==i.D.get("hovers.annotations.over")&&0!==o.character)return;if(this.document.uri.toString()!==t.uri.toString())return;const l=await this.getBlame();if(null==l)return;const c=l.lines[o.line],u=l.commits.get(c.sha);if(null==u)return;const p=(await Promise.all([e.details?this.getDetailsHoverMessage(u,t):void 0,e.changes?(0,s.jw)(this.container,u,await n.YY.fromUri(t.uri),o.line,t):void 0])).filter((e=>Boolean(e)));return new r.Hover(p,t.validateRange(new r.Range(o.line,0,o.line,1073741824)))}async getDetailsHoverMessage(e,t){let o=this.editor.selection.active.line;const r=o+1;o=(e.lines.find((e=>e.line===r))??e.lines[0]).originalLine-1;const a=i.D.get("hovers");return(0,s.nN)(this.container,e,await n.YY.fromUri(t.uri),o,{autolinks:a.autolinks.enabled,dateFormat:i.D.get("defaultDateFormat"),format:a.detailsMarkdownFormat,pullRequests:a.pullRequests.enabled,timeout:250})}}function h(e){const t=[],o=Math.floor(e.length/2),r=e.length%2?e[o].getTime():(e[o-1].getTime()+e[o].getTime())/2;let n=(e[e.length-1].getTime()-r)/5;for(let e=5;e>0;e--)t.push(r+n*e);t.push(r);n=(r-e[0].getTime())/4;for(let e=1;e<=4;e++)t.push(r-n*e);return t}((e,t,o,r)=>{for(var n,s=r>1?void 0:r?p(t,o):t,i=e.length-1;i>=0;i--)(n=e[i])&&(s=(r?n(t,o,s):n(s))||s);r&&s&&u(t,o,s)})([(0,a.cM)({args:!1})],BlameAnnotationProviderBase.prototype,"getComputedHeatmap",1)},79:(e,t,o)=>{o.d(t,{GutterHeatmapBlameAnnotationProvider:()=>GutterHeatmapBlameAnnotationProvider});var r=o(9496),n=o(4241),s=o(6004),i=o(6398),a=o(248),l=o(8178),c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,p=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e);class GutterHeatmapBlameAnnotationProvider extends l.d{constructor(e,t,o){super("heatmap",e,t,o)}async onProvideAnnotation(e,t){var o,n,l,c,u,h,d=[];try{const t=(0,s.UH)();this.annotationContext=e;const o=await this.getBlame();if(null==o)return!1;const n=((e,t,o)=>{if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected");var r;if(o&&(r=t[p("asyncDispose")]),void 0===r&&(r=t[p("dispose")]),"function"!=typeof r)throw TypeError("Object not disposable");e.push([o,r,t])}else o&&e.push([o]);return t})(d,(0,i.k)(t)),l=new Map,c=this.getComputedHeatmap(o);let u;for(const e of o.lines){const t=e.line-1;u=o.commits.get(e.sha),null!=u&&(0,a.Lx)(u.date,c,new r.Range(t,0,t,0),l)}return n?.restart({suffix:" to compute heatmap annotations"}),l.size&&(this.setDecorations([...l.values()]),n?.stop({suffix:" to apply all heatmap annotations"})),!0}catch(e){var m=e,g=!0}finally{o=d,n=m,l=g,c="function"==typeof SuppressedError?SuppressedError:function(e,t,o,r){return(r=Error(o)).name="SuppressedError",r.error=e,r.suppressed=t,r},u=e=>n=l?new c(e,n,"An error was suppressed during disposal"):(l=!0,e),(h=e=>{for(;e=o.pop();)try{var t=e[1]&&e[1].call(e[2]);if(e[0])return Promise.resolve(t).then(h,(e=>(u(e),h())))}catch(e){u(e)}if(l)throw n})()}}selection(e){return Promise.resolve()}}((e,t,o,r)=>{for(var n,s=r>1?void 0:r?u(t,o):t,i=e.length-1;i>=0;i--)(n=e[i])&&(s=(r?n(t,o,s):n(s))||s);r&&s&&c(t,o,s)})([(0,n.cM)()],GutterHeatmapBlameAnnotationProvider.prototype,"onProvideAnnotation",1)}};