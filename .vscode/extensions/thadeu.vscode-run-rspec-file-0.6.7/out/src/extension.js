!function(){var t={527:function(t,e,n){t.exports=function(t){for(var e=-1,n=t?t.length:0,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o}},178:function(t,e,n){var r,o="__lodash_hash_undefined__",i=1/0,a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,c=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,p="object"==typeof global&&global&&global.Object===Object&&global,d="object"==typeof self&&self&&self.Object===Object&&self,h=p||d||Function("return this")(),m=Array.prototype,_=Function.prototype,g=Object.prototype,y=h["__core-js_shared__"];var v=(r=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",S=_.toString,E=g.hasOwnProperty,b=g.toString,T=RegExp("^"+S.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=h.Symbol,O=m.splice,x=A(h,"Map"),N=A(Object,"create"),R=w?w.prototype:void 0,$=R?R.toString:void 0;function j(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function F(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}j.prototype.clear=function(){this.__data__=N?N(null):{}},j.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},j.prototype.get=function(t){var e=this.__data__;if(N){var n=e[t];return n===o?void 0:n}return E.call(e,t)?e[t]:void 0},j.prototype.has=function(t){var e=this.__data__;return N?void 0!==e[t]:E.call(e,t)},j.prototype.set=function(t,e){return this.__data__[t]=N&&void 0===e?o:e,this};function C(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}F.prototype.clear=function(){this.__data__=[]},F.prototype.delete=function(t){var e=this.__data__,n=I(e,t);return!(n<0)&&(n==e.length-1?e.pop():O.call(e,n,1),!0)},F.prototype.get=function(t){var e=this.__data__,n=I(e,t);return n<0?void 0:e[n][1]},F.prototype.has=function(t){return I(this.__data__,t)>-1},F.prototype.set=function(t,e){var n=this.__data__,r=I(n,t);return r<0?n.push([t,e]):n[r][1]=e,this};function I(t,e){for(var n=t.length;n--;)if(function(t,e){return t===e||t!=t&&e!=e}(t[n][0],e))return n;return -1}C.prototype.clear=function(){this.__data__={hash:new j,map:new(x||F),string:new j}},C.prototype.delete=function(t){return P(this,t).delete(t)},C.prototype.get=function(t){return P(this,t).get(t)},C.prototype.has=function(t){return P(this,t).has(t)},C.prototype.set=function(t,e){return P(this,t).set(t,e),this};function P(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function A(t,e){var n,r,o,i=(n=t,r=e,null==n?void 0:n[r]);return!(!U(o=i)||function(t){return!!v&&v in t}(o))&&((function(t){var e=U(t)?b.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e})(o)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(o)?T:f).test(function(t){if(null!=t){try{return S.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(o))?i:void 0}var L=k(function(t){t=function(t){return null==t?"":function(t){if("string"==typeof t)return t;if(G(t))return $?$.call(t):"";var e=t+"";return"0"==e&&1/t==-i?"-0":e}(t)}(t);var e=[];return c.test(t)&&e.push(""),t.replace(u,function(t,n,r,o){e.push(r?o.replace(l,"$1"):n||t)}),e});function k(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(k.Cache||C),n}k.Cache=C;var M=Array.isArray;function U(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function G(t){var e;return"symbol"==typeof t||!!(e=t)&&"object"==typeof e&&"[object Symbol]"==b.call(t)}t.exports=function(t,e,n){var r=null==t?void 0:function(t,e){e=function(t,e){if(M(t))return!1;var n=typeof t;return!!("number"==n||"symbol"==n||"boolean"==n||null==t||G(t))||s.test(t)||!a.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:function(t){return M(t)?t:L(t)}(e);for(var n=0,r=e.length;null!=t&&n<r;)t=t[function(t){if("string"==typeof t||G(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}(e[n++])];return n&&n==r?t:void 0}(t,e);return void 0===r?n:r}},333:function(t,e,n){t.exports=require("vscode")},771:function(t,e,n){t.exports=require("node:path")},275:function(t,e,n){"use strict";n.r(e),n.d(e,{EXTENSION_NAME:function(){return r},SETTINGS_RSPEC_COMMAND_KEY:function(){return o},SETTINGS_RSPEC_FOLDER:function(){return i},SETTINGS_RSPEC_CONTROLLER_FOLDER:function(){return a},SETTINGS_SUFFIX_FILE:function(){return s},SETTINGS_INTEGRATION_TYPE:function(){return c},SETTINGS_DEFAULT:function(){return u}});let r="vscode-run-rspec-file",o=`${r}.custom-command`,i=`${r}.folder`,a=`${r}.controller-spec-directory`,s=`${r}.suffix`,c=`${r}.integration`,u={customCommand:"bundle exec rspec",folder:"spec",suffix:"spec",controllerFolder:"controllers",integration:"rails"}},624:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var r=n("771"),o=n.n(r),i=n("527"),a=n.n(i),s=n("178"),c=n.n(s);class u{filepath;config;constructor(t,e){this.filepath=t,this.config=e||{}}static fromRelativeUri(t,e){return new u(t,e).toJSON()}controllerFolderOrDefault(){return c(this.config,"controllerFolder","controllers")}isExpectation=t=>/^(spec|test)/.test(t);isLibrary=t=>/lib/.test(t);isRailsApp=()=>this.config?.integration=="rails";toJSON(){let t=a(this.filepath.split(o.sep)),e=t[0],n=t.slice(1).join("/"),r=n.match(/(?<ext>\.rb)$/)?.groups?.ext,i=n.match(/(\w+_)(?<suffix>spec|test)\.rb$/)?.groups?.suffix,s=[e,n].join("/");this.isLibrary(e)&&(n=t.join("/"));let c={namespace:e,name:n,suffix:i,ext:r,path:s,inversePath:"",specPath:"",isRailsApp:this.isRailsApp()};if(this.isExpectation(i)){let t=n.replace(RegExp(`_${i}`),"");this.isLibrary(s)?c.inversePath=["lib",t].join("/").replace(/^(lib\/)(lib)/,"$2"):(t=t.replace("requests","controllers"),c.inversePath=["app",t].join("/").replace(/^(app\/)(app)/,"$2"))}else{let t=(this.isRailsApp()?n:s).replace("controllers",this.controllerFolderOrDefault()).replace(".rb",`_${this.config?.suffix}.rb`);c.inversePath=a([this.config?.folder,t]).join("/")}return c.specPath=this.isExpectation(i)?c.path:c.inversePath,c}}},130:function(t,e,n){"use strict";n.r(e),n.d(e,{isMultipleWorkSpaces:function(){return l},getWorkspace:function(){return f},getActiveLine:function(){return d},clearTerminal:function(){return h},factorySettings:function(){return g}});var r=n("333"),o=n("178"),i=n.n(o),a=n("275"),s=n("597");let c={},u={},l=()=>r.workspace.workspaceFolders.length>1;function f(){let t=r.window.activeTextEditor.document.uri.path,e=new s.default(t),n=e.toJSON();return{method:e,path:n.uri,name:n.name}}function p(t,e){return e?t[e]:t}function d(){return r.window.activeTextEditor.selection.active.line+1}function h(){return r.window.activeTextEditor.document.save(),r.commands.executeCommand("workbench.action.terminal.clear")}async function m(){let t=f().name;try{if(u[t])return u[t];function e(t,e){let n=e.get(t),r=e.get(`${a.EXTENSION_NAME}.${t}`),o=e.inspect(`${a.EXTENSION_NAME}.${t}`)?.defaultValue;return n||r||o}let n=r.workspace.getConfiguration(a.EXTENSION_NAME),o=e("custom-command",n),i=e("folder",n),s=e("controller-spec-directory",n),c=e("suffix",n),l=e("integration",n),f={...a.SETTINGS_DEFAULT,customCommand:o,folder:i,suffix:c,controllerFolder:s,integration:l};return u[t]=f,f}catch(t){return console.error(t),a.SETTINGS_DEFAULT}}async function _(){try{let t=f(),e=await r.workspace.findFiles("**/.vscode/settings.json"),n=e.find(e=>String(e.path).includes(t.path));if(!n)return null;let o=await r.workspace.fs.readFile(r.Uri.parse(n.fsPath)),i=JSON.parse(o.toString());return i}catch(t){return console.error(t),r.window.showErrorMessage("RSpec Extension: parse settings.json failed"),null}}async function g(t){let e=f().name;if(c[e])return p(c[e],t);let n=await m();try{let r=await _(),o={customCommand:i(r,a.SETTINGS_RSPEC_COMMAND_KEY)||n.customCommand,folder:i(r,a.SETTINGS_RSPEC_FOLDER)||n.folder,controllerFolder:i(r,a.SETTINGS_RSPEC_CONTROLLER_FOLDER)||n.controllerFolder,suffix:i(r,a.SETTINGS_SUFFIX_FILE)||n.suffix,integration:i(r,a.SETTINGS_INTEGRATION_TYPE)||n.integration};return c[e]=o,p(o,t)}catch(e){return console.error(e),p(n,t)}}},597:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return c}});var r=n("771"),o=n.n(r),i=n("527"),a=n.n(i),s=n("624");class c{name;fileUri;uri;constructor(t){this.fileUri=t}toJSON(){let t=a(this.fileUri.split(o.sep)),e=t.findIndex(t=>RegExp("^(app|spec|test|lib)$").test(t)),n=t.slice(0,e);return this.uri=n.join("/"),this.name=n.slice(-1)[0],{uri:this.uri,name:this.name}}fromFileUri(t){let e=this.fileUri;return e=(e=e.replace(this.uri,"")).replace(/^\/?\/?/,""),s.default.fromRelativeUri(e,t)}}},436:function(t,e,n){"use strict";n.r(e),n.d(e,{activate:function(){return m},deactivate:function(){return _}});var r=n("333"),o=n("178"),i=n.n(o),a=n("624"),s=n("130");let c={},u="";function l(t){let e=function(){let t=(0,s.getWorkspace)(),e=[t.name,"RSpec Run"].join(" - ");if(!(0,s.isMultipleWorkSpaces)()){let n=r.window.terminals.find(t=>t.name==e);return n?n:r.window.createTerminal({name:e,cwd:t.path})}return i(c,e)?i(c,e):(c[e]=r.window.createTerminal({name:e,cwd:t.path}),i(c,e))}();e.sendText(t),e.show(!1),u=t}async function f(){return l((await (0,s.factorySettings)()).customCommand)}async function p(t){let e=await (0,s.factorySettings)(),n=`${e.customCommand} ${(0,s.getWorkspace)().method.fromFileUri(e).specPath}`;return t&&(n=`${n}:${t}`),l(n)}async function d(){let t=r.workspace.textDocuments,e=(0,s.getWorkspace)(),n={},o=[],i=await (0,s.factorySettings)();for(let r of t)if(r.fileName.endsWith(".rb")&&r.fileName.includes(e.path)){let t=r.fileName.replace(e.path,"");t.startsWith("/")&&(t=t.substring(1));let o=a.default.fromRelativeUri(t,i).specPath;n[o]=o}return(o=Object.keys(n).filter(t=>!!t)).length<=0?r.window.showInformationMessage("Not found opened spec files"):l(`${i.customCommand} ${o.join(" ")}`)}async function h(){let t=await (0,s.factorySettings)(),e=(0,s.getWorkspace)(),n=e.method.fromFileUri(t),o=r.Uri.file(`${e.path}/${n.inversePath}`);return r.commands.executeCommand("vscode.open",o)}async function m(t){t.subscriptions.push(r.commands.registerCommand("extension.runOpenSpec",h)),t.subscriptions.push(r.commands.registerCommand("extension.runFileOnRspec",()=>{(0,s.clearTerminal)().then(()=>p())})),t.subscriptions.push(r.commands.registerCommand("extension.runAllFilesOnRspec",()=>{(0,s.clearTerminal)().then(()=>f())})),t.subscriptions.push(r.commands.registerCommand("extension.runAllOpenedFiles",()=>{(0,s.clearTerminal)().then(()=>d())})),t.subscriptions.push(r.commands.registerCommand("extension.runLineOnRspec",async()=>{(0,s.clearTerminal)().then(async()=>p((0,s.getActiveLine)()))})),t.subscriptions.push(r.commands.registerCommand("extension.runOnLastSpec",()=>{(0,s.clearTerminal)().then(()=>void(u?l(u):r.window.showWarningMessage("RSpec : Not found last command executed")))}))}function _(){}r.window.onDidCloseTerminal(t=>{c[t.name]&&delete c[t.name]})}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){return t&&t.__esModule?t.default:t};var r=n("436");module.exports=r}();
//# sourceMappingURL=extension.js.map